{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Algorithm/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%9A%84%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%98%AFO%28log%20n%29/","title":"\u4e3a\u4ec0\u4e48\u8bf4\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(log n)","text":"<p>\u4e3a\u4ec0\u4e48\u8bf4\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(log n)</p> <p>\u8fd9\u4e2a\u95ee\u9898\u672c\u8d28\u4e0a\u4e00\u4e2a\u6570\u5b66\u9898\u3002</p> <p>\u5148\u4e3e\u4e2a\u4f8b\u5b50\u3002 </p> <p>\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a16\u7684\u6709\u5e8f\u6570\u7ec4\uff0c\u5982\u4e0a\u56fe\u6240\u793a\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8981\u67e5\u627e\u5728\u8fd9\u4e2a\u6570\u7ec4\u4e0a\u67e5\u627e13\u8fd9\u4e2a\u6570\u3002</p> <p></p> <p>\u9996\u5148\u6211\u4eec\u5c06(length / 2 )\u62ff\u5230\u4e2d\u95f4\u7684\u5143\u7d20,\u8fd9\u4e2a\u4f5c\u4e3a\u4e00\u4e2a\u57fa\u51c6</p> <p></p> <p>\u6211\u4eec\u53d1\u73b013\u662f\u5c0f\u4e8e16\u7684\uff0c\u6240\u4ee5\u9700\u8981\u5bf9\u5de6\u8fb9\u7684\u6570\u7ec4\u518d\u4e00\u534a\u5bf9\u6bd4\u3002</p> <p></p> <p>\u91cd\u590d\u518d\u5c1d\u8bd5\u53bb\u67e5\u627e</p> <p></p> <p>\u6700\u540e\u62ff\u523013\u8fd9\u4e2a\u6570\u3002</p> <p></p> <p>\u8fd9\u91cc\u4ece\u957f\u5ea6\u4e3a16\u7684\u6570\u7ec4\u91cc\u9762\u67e5\u627e\u5143\u7d20\uff0c\u6700\u591a\u9700\u8981\u67e5\u627e4\u6b21\u624d\u80fd\u67e5\u627e\u5230\u3002</p> <p>\u7b80\u5355\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u7684\u516c\u5f0f\u3002</p> <p></p> <p>\u5047\u8bbe\u6211\u4eec\u6709n\u4e2a\u6709\u5e8f\u5143\u7d20\uff0c\u5bf9n\u4e2a\u5143\u7d20\u8fdb\u884c\u67e5\u627e\u7684\u65f6\u5019\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3ak\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6709\u4e0b\u9762\u7684\u516c\u5f0f\u3002</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>What does the time complexity O(log n) actually mean?</p>"},{"location":"Android/Android%E7%B3%BB%E7%BB%9F%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6%E5%88%86%E6%9E%90/","title":"Android\u7cfb\u7edf\u5de5\u4f5c\u673a\u5236\u5206\u6790","text":"<p>\u6df1\u5165\u5206\u6790AsyncTask</p> <p>\u4ece\u6e90\u7801\u89d2\u5ea6\u5256\u6790Handler\u673a\u5236</p> <p>Android\u542f\u52a8\u6d41\u7a0b\u5206\u6790</p> <p>Activity\u7684\u751f\u547d\u5468\u671f\u548c\u542f\u52a8\u6a21\u5f0f</p> <p>View\u4e8b\u4ef6\u4f20\u9012</p> <p>\u8be6\u89e3\u6ce8\u89e3\u5904\u7406\u5668APT\u6280\u672f</p> <p>APK\u6253\u5305\u53ca\u5b89\u88c5\u8fc7\u7a0b</p> <p>Android\u4e2d\u7684IPC\u673a\u5236</p>"},{"location":"Android/Handler/","title":"Handler","text":"<p>Handler \u4e3a\u4ec0\u4e48\u4f1a\u6cc4\u6f0f</p> <p>Handler\u5982\u4f55\u5728handleMessage\u65b9\u6cd5\u62e6\u622a\u4e4b\u524d\u53d1\u51fa\u7684message</p> <p>\u901a\u5e38\u4f1a\u4f34\u968f\u7740\u4e00\u4e2a\u8017\u65f6\u7684\u540e\u53f0\u7ebf\u7a0b\uff08\u4f8b\u5982\u4ece\u7f51\u7edc\u62c9\u53d6\u56fe\u7247\uff09\u4e00\u8d77\u51fa\u73b0\uff0c\u8fd9\u4e2a\u540e\u53f0\u7ebf\u7a0b\u5728\u4efb\u52a1\u6267\u884c\u5b8c\u6bd5\uff08\u4f8b\u5982\u56fe\u7247\u4e0b\u8f7d\u5b8c\u6bd5\uff09\u4e4b\u540e\uff0c\u901a\u8fc7\u6d88\u606f\u673a\u5236\u901a\u77e5Handler\uff0c\u7136\u540eHandler\u628a\u56fe\u7247\u66f4\u65b0\u5230\u754c\u9762\u3002\u7136\u800c\uff0c\u5982\u679c\u7528\u6237\u5728\u7f51\u7edc\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\u5173\u95ed\u4e86Activity\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0cActivity\u4e0d\u518d\u88ab\u4f7f\u7528\uff0c\u5b83\u5c31\u6709\u53ef\u80fd\u5728GC\u68c0\u67e5\u65f6\u88ab\u56de\u6536\u6389\uff0c\u4f46\u7531\u4e8e\u8fd9\u65f6\u7ebf\u7a0b\u5c1a\u672a\u6267\u884c\u5b8c\uff0c\u800c\u8be5\u7ebf\u7a0b\u6301\u6709Handler\u7684\u5f15\u7528\uff08\u4e0d\u7136\u5b83\u600e\u4e48\u53d1\u6d88\u606f\u7ed9Handler\uff1f\uff09\uff0c\u8fd9\u4e2aHandler\u53c8\u6301\u6709Activity\u7684\u5f15\u7528\uff0c\u5c31\u5bfc\u81f4\u8be5Activity\u65e0\u6cd5\u88ab\u56de\u6536\uff08\u5373\u5185\u5b58\u6cc4\u9732\uff09\uff0c\u76f4\u5230\u7f51\u7edc\u8bf7\u6c42\u7ed3\u675f\uff08\u4f8b\u5982\u56fe\u7247\u4e0b\u8f7d\u5b8c\u6bd5\uff09\u3002\u53e6\u5916\uff0c\u5982\u679c\u4f60\u6267\u884c\u4e86Handler\u7684postDelayed()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5c06\u4f60\u7684Handler\u88c5\u5165\u4e00\u4e2aMessage\uff0c\u5e76\u628a\u8fd9\u6761Message\u63a8\u5230MessageQueue\u4e2d\uff0c\u90a3\u4e48\u5728\u4f60\u8bbe\u5b9a\u7684delay\u5230\u8fbe\u4e4b\u524d\uff0c\u4f1a\u6709\u4e00\u6761MessageQueue -&gt; Message -&gt; Handler -&gt; Activity\u7684\u94fe\uff0c\u5bfc\u81f4\u4f60\u7684Activity\u88ab\u6301\u6709\u5f15\u7528\u800c\u65e0\u6cd5\u88ab\u56de\u6536\u3002</p> <pre><code>\n/**\n* Handle system messages here.\n*/\npublic void dispatchMessage(Message msg) {\n//\u9996\u5148\u68c0\u67e5msg\u662f\u5426\u8bbe\u7f6e\u4e86\u56de\u8c03\n    if (msg.callback != null) {\n        handleCallback(msg);\n    } else {\n        if (mCallback != null) {\n        //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0ccallback\u7684handleMessage()\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u51b3\u5b9a\u4e86\u662f\u5426\u62e6\u622a\u6d88\u606f\n        //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0ccallback\u7684handleMessage()\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u51b3\u5b9a\u4e86\u662f\u5426\u62e6\u622a\u6d88\u606f\n        //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0ccallback\u7684handleMessage()\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u51b3\u5b9a\u4e86\u662f\u5426\u62e6\u622a\u6d88\u606f\n            if (mCallback.handleMessage(msg)) {\n                return;\n            }\n        }\n        handleMessage(msg);\n    }\n}\n\n</code></pre> <ul> <li>Handler</li> <li>Handler\u5982\u4f55\u5728handleMessage\u65b9\u6cd5\u62e6\u622a\u4e4b\u524d\u53d1\u51fa\u7684message</li> <li>HandlerThread\u7684\u539f\u7406</li> <li>IntentService\u7684\u5b9e\u73b0\u539f\u7406</li> <li>Handler\u5b9e\u73b0\u673a\u5236\uff08\u5f88\u591a\u7ec6\u8282\u9700\u8981\u5173\u6ce8\uff1a\u5982\u7ebf\u7a0b\u5982\u4f55\u5efa\u7acb\u548c\u9000\u51fa\u6d88\u606f\u5faa\u73af\u7b49\u7b49</li> <li>Handler\u53d1\u6d88\u606f\u7ed9\u5b50\u7ebf\u7a0b\uff0clooper\u600e\u4e48\u542f\u52a8</li> <li>Handler postDelay\u8fd9\u4e2a\u5ef6\u8fdf\u662f\u600e\u4e48\u5b9e\u73b0\u7684</li> <li>MessageQueue.IdleHandler \u4f60\u4e86\u89e3\u561b</li> <li>Handler \u9020\u6210\u5185\u5b58\u6cc4\u6f0f\uff0c\u662f\u4ec0\u4e48\u4e1c\u897f\u9020\u6210\u7684\u6cc4\u6f0f</li> </ul> <p>Android \u6d88\u606f\u5904\u7406\u673a\u5236\uff08Looper\u3001Handler\u3001MessageQueue,Message\uff09</p> <p>Android\u4e2d\u4e3a\u4ec0\u4e48\u4e3b\u7ebf\u7a0b\u4e0d\u4f1a\u56e0\u4e3aLooper.loop()\u91cc\u7684\u6b7b\u5faa\u73af\u5361\u6b7b\uff1f * \u4e3b\u7ebf\u7a0b\u7684\u5de5\u4f5c\u539f\u7406</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u7b14\u8bb0\u6709\u65b0\u610f\u7684\u601d\u8003\u70b9\u662f\uff1a\u57282.2\u7248\u672c\u4ee5\u524d\uff0c\u8fd9\u5957\u673a\u5236\u662f\u7528\u6211\u4eec\u719f\u6089\u7684\u7ebf\u7a0b\u7684wait\u548cnotify \u6765\u5b9e\u73b0\u7684,\u4e4b\u524d\u7684Android\u7248\u672c\u7528\u7684\u662fJava\u7684\u7ebf\u7a0bwait\u548cnotify\u3002</p> <p>Android\u5e94\u7528\u7a0b\u5e8f\u7684\u4e3b\u7ebf\u7a0b\u5728\u8fdb\u5165\u6d88\u606f\u5faa\u73af\u8fc7\u7a0b\u524d\uff0c\u4f1a\u5728\u5185\u90e8\u521b\u5efa\u4e00\u4e2aLinux\u7ba1\u9053\uff08Pipe\uff09\uff0c\u8fd9\u4e2a\u7ba1\u9053\u7684\u4f5c\u7528\u662f\u4f7f\u5f97Android\u5e94\u7528\u7a0b\u5e8f\u4e3b\u7ebf\u7a0b\u5728\u6d88\u606f\u961f\u5217\u4e3a\u7a7a\u65f6\u53ef\u4ee5\u8fdb\u5165\u7a7a\u95f2\u7b49\u5f85\u72b6\u6001\uff0c\u5e76\u4e14\u4f7f\u5f97\u5f53\u5e94\u7528\u7a0b\u5e8f\u7684\u6d88\u606f\u961f\u5217\u6709\u6d88\u606f\u9700\u8981\u5904\u7406\u65f6\u5524\u9192\u5e94\u7528\u7a0b\u5e8f\u7684\u4e3b\u7ebf\u7a0b\u3002</p> <p>\u8fd9\u4e2a\u4e3b\u7ebf\u7a0b\u7684\u4f11\u7720\u4ee5\u53ca\u5524\u9192\u64cd\u4f5c\u662f\u57fa\u4e8eLinux\u7684epoll\u673a\u5236\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u5728Message\b\bQueue.java\u7684next\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>Message next() \n\n        final long ptr = mPtr;\n        if (ptr == 0) {\n            return null;\n        }\n        int pendingIdleHandlerCount = -1; // -1 only during first iteration\n\n        //nextPollTimeoutMillis \u8868\u793anativePollOnce\u65b9\u6cd5\u9700\u8981\u7b49\u5f85nextPollTimeoutMillis \n        //\u624d\u4f1a\u8fd4\u56de\n        int nextPollTimeoutMillis = 0;\n        for (;;) {\n            if (nextPollTimeoutMillis != 0) {\n                Binder.flushPendingCommands();\n            }\n            //\u8bfb\u53d6\u6d88\u606f\uff0c\u961f\u91cc\u91cc\u6ca1\u6709\u6d88\u606f\u6709\u53ef\u80fd\u4f1a\u5835\u585e\uff0c\u4e24\u79cd\u60c5\u51b5\u8be5\u65b9\u6cd5\u624d\u4f1a\u8fd4\u56de(\u4ee3\u7801\u624d\u80fd\u5f80\u4e0b\u6267\u884c)\n            //\u4e00\u79cd\u662f\u7b49\u5230\u6709\u6d88\u606f\u4ea7\u751f\u5c31\u4f1a\u8fd4\u56de,\n            //\u53e6\u4e00\u79cd\u662f\u5f53\u7b49\u4e86nextPollTimeoutMillis\u65f6\u957f\u540e\uff0cnativePollOnce\u4e5f\u4f1a\u8fd4\u56de\n            nativePollOnce(ptr, nextPollTimeoutMillis);\n            //nativePollOnce \u8fd4\u56de\u4e4b\u540e\u624d\u80fd\u5f80\u4e0b\u6267\u884c\n            synchronized (this) {\n                // Try to retrieve the next message.  Return if found.\n                final long now = SystemClock.uptimeMillis();\n                Message prevMsg = null;\n                Message msg = mMessages;\n                if (msg != null &amp;&amp; msg.target == null) {\n                    // \u5faa\u73af\u627e\u5230\u4e00\u6761\u4e0d\u662f\u5f02\u6b65\u800c\u4e14msg.target\u4e0d\u4e3a\u7a7a\u7684message\n                    do {\n                        prevMsg = msg;\n                        msg = msg.next;\n                    } while (msg != null &amp;&amp; !msg.isAsynchronous());\n                }\n                if (msg != null) {\n                    if (now &lt; msg.when) {\n                       // \u867d\u7136\u6709\u6d88\u606f\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u5230\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u50cf\u6211\u4eec\u7ecf\u5e38\u7528\u7684postDelay,\n                       //\u8ba1\u7b97\u51fa\u79bb\u6267\u884c\u65f6\u95f4\u8fd8\u6709\u591a\u4e45\u8d4b\u503c\u7ed9nextPollTimeoutMillis\uff0c\n                       //\u8868\u793anativePollOnce\u65b9\u6cd5\u8981\u7b49\u5f85nextPollTimeoutMillis\u65f6\u957f\u540e\u8fd4\u56de\n                        nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE);\n                    } else {\n                        // \u83b7\u53d6\u5230\u6d88\u606f\n                        mBlocked = false;\n                       //\u94fe\u8868\u4e00\u4e9b\u64cd\u4f5c\uff0c\u83b7\u53d6msg\u5e76\u4e14\u5220\u9664\u8be5\u8282\u70b9 \n                        if (prevMsg != null) \n                            prevMsg.next = msg.next;\n                        } else {\n                            mMessages = msg.next;\n                        }\n                        msg.next = null\uff1b\n                        msg.markInUse();\n                        //\u8fd4\u56de\u62ff\u5230\u7684\u6d88\u606f\n                        return msg;\n                    }\n                } else {\n                    //\u6ca1\u6709\u6d88\u606f\uff0cnextPollTimeoutMillis\u590d\u4f4d\n                    nextPollTimeoutMillis = -1;\n                }\n                .....\n                .....\n\n    }\n</code></pre> <p>nativePollOnce()\u5f88\u91cd\u8981\uff0c\u662f\u4e00\u4e2anative\u7684\u51fd\u6570\uff0c<code>nativePollOnce</code>\u6700\u7ec8\u8c03\u7528\u5230\u7684\u662f\uff1a</p> <p>/frameworks/base/core/jni/android_os_MessageQueue.cpp\u4e2d\u7684<code>pollOnce</code>\u65b9\u6cd5\uff0cpollOnce\u5185\u90e8\u53c8\u662f\u8c03\u7528<code>pollInner(int timeoutMillis)</code>\u65b9\u6cd5\u3002</p> <p>pollInner\u4e2d\u5c31\u662f\u8c03\u7528epoll_wait\uff0cepoll_wait\u5c31\u662f\u4f7f\u7528\u7684\u662fLinux\u4e2depoll\u673a\u5236\uff0c\u5173\u4e8eepoll\u7684\u673a\u5236\u53ef\u4ee5\u770b\u4e0b\u8fd9\u7bc7\u5173\u4e8eepoll\u7684\u6587\u7ae0\u5206\u6790\u3002epoll\u7684\u539f\u7406\u548c\u5b9e\u73b0\u3002</p> <p>nativePollOnce\u8fd9\u91cc\u4f1a\u8bfb\u53d6\u6d88\u606f\uff0c\u961f\u91cc\u91cc\u6ca1\u6709\u6d88\u606f\u6709\u53ef\u80fd\u4f1a\u5835\u585e\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f1a\u8ba9\u51fa\u5904\u7406\u5668\uff0c\u5f53\u6709\u6d88\u606f\u6765\u4e86\u6216\u8005\u5f53\u8bbe\u7f6e\u7684timeout\u65f6\u95f4\u5230\u4e86\u5c31\u53ef\u4ee5\u5f80\u4e0b\u6267\u884c\u3002</p>"},{"location":"Android/SharedPreference%E5%92%8CContentProvider/","title":"SharedPreference\u548cContentProvider","text":"<p>link</p>"},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/","title":"Android\u542f\u52a8\u6d41\u7a0b\u5206\u6790","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#android","title":"android\u542f\u52a8","text":"<pre><code>int main(int argc, char** argv) {\n\n    .....\n    //\u521b\u5efa\u6587\u4ef6\u5939\uff0c\u6302\u8f7d\n    // Get the basic filesystem setup we need put together in the initramdisk\n    // on / and then we'll let the rc file figure out the rest.\n    if (is_first_stage) {\n         mount(\"tmpfs\", \"/dev\", \"tmpfs\", MS_NOSUID, \"mode=0755\");\n         mkdir(\"/dev/pts\", 0755);\n         mkdir(\"/dev/socket\", 0755);\n         mount(\"devpts\", \"/dev/pts\", \"devpts\", 0, NULL);\n         #define MAKE_STR(x) __STRING(x)\n         mount(\"proc\", \"/proc\", \"proc\", 0, \"hidepid=2,gid=\" MAKE_STR(AID_READPROC));\n         mount(\"sysfs\", \"/sys\", \"sysfs\", 0, NULL);\n    }\n    .....\n\n    //\u6253\u5370\u65e5\u5fd7\uff0c\u8bbe\u7f6elog\u7684\u7ea7\u522b\n    klog_init();\n    klog_set_level(KLOG_NOTICE_LEVEL);\n    .....\n\n    Parser&amp; parser = Parser::GetInstance();\n    parser.AddSectionParser(\"service\",std::make_unique&lt;ServiceParser&gt;());\n    parser.AddSectionParser(\"on\", std::make_unique&lt;ActionParser&gt;());\n    parser.AddSectionParser(\"import\", std::make_unique&lt;ImportParser&gt;());\n    // \u52a0\u8f7dinit.rc\u914d\u7f6e\u6587\u4ef6\n    parser.ParseConfig(\"/init.rc\");\n}\n</code></pre> <p>\u5728init.rc\u6587\u4ef6\u4e2d\uff0c\u6709\u5982\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>import /init.environ.rc\nimport /init.usb.rc\nimport /init.${ro.hardware}.rc\nimport /init.usb.configfs.rc\nimport /init.${ro.zygote}.rc\n</code></pre> <p>\u6ce8\u610f\u5230\u4e0a\u9762\u7684\u4ee3\u7801import /init.${ro.zygote}.rc\uff0c\u8fd9\u91cc\u4f1a\u8bfb\u53d6ro.zygote\u8fd9\u4e2a\u5c5e\u6027\uff0c\u5bfc\u5165\u76f8\u5e94\u7684init.rc\u6587\u4ef6\u3002 ro.zygote\u7684\u5c5e\u6027\u53ef\u4e3a\uff1azygote32\u3001zygote64\u3001zygote32_64\u3001zygote64_32\u3002</p> <p>\u5bf9\u4e8e\u8fd9\u4e2a\u5c5e\u6027\u7684\u89e3\u91ca\u5982\u4e0b\u3002</p> <pre><code>init.zygote32.rc\uff1azygote \u8fdb\u7a0b\u5bf9\u5e94\u7684\u6267\u884c\u7a0b\u5e8f\u662f app_process (\u7eaf 32bit \u6a21\u5f0f)\ninit.zygote64.rc\uff1azygote \u8fdb\u7a0b\u5bf9\u5e94\u7684\u6267\u884c\u7a0b\u5e8f\u662f app_process64 (\u7eaf 64bit \u6a21\u5f0f)\ninit.zygote32_64.rc\uff1a\u542f\u52a8\u4e24\u4e2a zygote \u8fdb\u7a0b (\u540d\u4e3a zygote \u548c zygote_secondary)\uff0c\u5bf9\u5e94\u7684\u6267\u884c\u7a0b\u5e8f\u5206\u522b\u662f app_process32 (\u4e3b\u6a21\u5f0f)\u3001app_process64\u3002\ninit.zygote64_32.rc\uff1a\u542f\u52a8\u4e24\u4e2a zygote \u8fdb\u7a0b (\u540d\u4e3a zygote \u548c zygote_secondary)\uff0c\u5bf9\u5e94\u7684\u6267\u884c\u7a0b\u5e8f\u5206\u522b\u662f app_process64 (\u4e3b\u6a21\u5f0f)\u3001app_process32\n</code></pre> <p>\u4e3b\u6d41\u7684\u673a\u578b\u5c5e\u6027\u90fd\u4e3azygote64_32\uff0c\u6211\u4eec\u6765\u770b\u770binit.zygote64_32.rc\u6587\u4ef6\uff1a</p> <pre><code>service zygote /system/bin/app_process64 -Xzygote /system/bin --zygote --start-system-server --socket-name=zygote\n   class main\n   socket zygote stream 660 root system\n   onrestart write /sys/android_power/request_state wake\n   onrestart write /sys/power/state on\n   onrestart restart audioserver\n   onrestart restart cameraserver\n   onrestart restart media\n   onrestart restart netd\n    writepid /dev/cpuset/foreground/tasks\n\nservice zygote_secondary /system/bin/app_process32 -Xzygote /system/bin --zygote --socket-name=zygote_secondary\n    class main\n    socket zygote_secondary stream 660 root system\n    onrestart restart zygote\n    writepid /dev/cpuset/foreground/tasks\n</code></pre> <p>\u5728 linux \u7cfb\u7edf\u4e2d\uff0cservice \u901a\u5e38\u662f\u4e00\u79cd\u88ab\u79f0\u4e3a\u5b88\u62a4\u8fdb\u7a0b (daemon) \u7684\u7a0b\u5e8f\u3002\u5b83\u901a\u5e38\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u542f\u52a8\uff0c\u5e76\u4e00\u76f4\u8fd0\u884c\u4e8e\u540e\u53f0\uff0c\u76f4\u5230\u7cfb\u7edf\u5173\u95ed\u65f6\u7ec8\u6b62\u3002</p> <p>\u8fd9\u91cc\u4f1a\u4ee5service\u65b9\u5f0f\u6765\u542f\u52a8zygote\u8fdb\u7a0b\uff0capp_process\u7684\u4ee3\u7801\u4f4d\u4e8e/frameworks/base/cmds/app_process/\u8def\u5f84\u4e0b\uff0c\u8be5\u8def\u5f84\u4e0b\u6709\u4e00\u4e2a\u6587\u4ef6app_main.cpp,\u5165\u53e3\u662fmain\u51fd\u6570\u3002</p> <pre><code>int main(int argc, char* const argv[])\n{\n    .....\n    //android\u8fd0\u884c\u65f6\u73af\u5883\n    AppRuntime runtime(argv[0], computeArgBlockSize(argc, argv));\n    // Process command line arguments\n    // ignore argv[0]\n    argc--;\n    argv++;\n\n    .....\n    if (zygote) {\n        //\u542f\u52a8java\u4ee3\u7801\n        runtime.start(\"com.android.internal.os.ZygoteInit\", args, zygote);\n    } else if (className) {\n        runtime.start(\"com.android.internal.os.RuntimeInit\", args, zygote);\n    } else {\n        fprintf(stderr, \"Error: no class name or --zygote supplied.\\n\");\n        app_usage();\n        LOG_ALWAYS_FATAL(\"app_process: no class name or --zygote supplied.\");\n        return 10;\n    }\n}\n</code></pre> <pre><code>    public static void main(String argv[]) {\n        .....\n        try {\n            .....\n            boolean startSystemServer = false;\n            String socketName = \"zygote\";\n            String abiList = null;\n            for (int i = 1; i &lt; argv.length; i++) {\n                if (\"start-system-server\".equals(argv[i])) {\n                    startSystemServer = true;\n                } else if (argv[i].startsWith(ABI_LIST_ARG)) {\n                    abiList = argv[i].substring(ABI_LIST_ARG.length());\n                } else if (argv[i].startsWith(SOCKET_NAME_ARG)) {\n                    socketName = argv[i].substring(SOCKET_NAME_ARG.length());\n                } else {\n                    throw new RuntimeException(\"Unknown command line argument: \" + argv[i]);\n                }\n            }\n\n            .....\n            //\u9884\u52a0\u8f7dandroid\u4f9d\u8d56\u7684\u6587\u4ef6\n            preload();\n            .....\n\n            if (startSystemServer) {\n                //\u542f\u52a8\u7cfb\u7edf\u670d\u52a1\n                startSystemServer(abiList, socketName);\n            }\n\n            .....\n        } catch (MethodAndArgsCaller caller) {\n            caller.run();\n        } catch (Throwable ex) {\n            Log.e(TAG, \"Zygote died with exception\", ex);\n            closeServerSocket();\n            throw ex;\n        }\n    }\n</code></pre> <p>\u770b\u8fd9\u4e2a\u7c7b\u7684main\u65b9\u6cd5\uff0c\u6700\u4e0a\u9762\u6839\u636e\u4f20\u5165\u7684\u53c2\u6570\u5224\u65ad\u662f\u5426\u5c06startSystemServer\u8fd9\u4e2a\u6807\u8bb0\u8bbe\u4e3atrue\uff0c\u63a5\u7740\u9884\u52a0\u8f7dandroid\u4f9d\u8d56\u7684\u6587\u4ef6\uff0c\u6700\u540e\u6839\u636e\u4e0a\u9762\u8bbe\u7f6e\u7684\u6807\u8bb0\u6765\u5224\u65ad\u662f\u5426\u80fd\u542f\u52a8\u7cfb\u7edf\u670d\u52a1\u3002</p> <p>\u63a5\u7740\u770bZygoteInit.java\u4e2dmain\u65b9\u6cd5\u5728\u6700\u540e\u8c03\u7528startSystemServer\u65b9\u6cd5\u5177\u4f53\u5185\u5bb9</p> <pre><code>    private static boolean startSystemServer(String abiList, String socketName)\n            throws MethodAndArgsCaller, RuntimeException {\n        .....\n        /* Hardcoded command line to start the system server */\n        String args[] = {\n            \"--setuid=1000\",\n            \"--setgid=1000\",\n            \"--setgroups=1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1018,1021,1032,3001,3002,3003,3006,3007,3009,3010\",\n            \"--capabilities=\" + capabilities + \",\" + capabilities,\n            \"--nice-name=system_server\",\n            \"--runtime-args\",\n            \"com.android.server.SystemServer\",\n        };\n        .....\n        try {\n            parsedArgs = new ZygoteConnection.Arguments(args);\n            ZygoteConnection.applyDebuggerSystemProperty(parsedArgs);\n            ZygoteConnection.applyInvokeWithSystemProperty(parsedArgs);\n\n            //Zygote\u8fdb\u7a0b\u5f00\u59cbfork\u5b50\u8fdb\u7a0b\uff0c\u542f\u52a8SystemServer\n            /* Request to fork the system server process */\n            pid = Zygote.forkSystemServer(\n                    parsedArgs.uid, parsedArgs.gid,\n                    parsedArgs.gids,\n                    parsedArgs.debugFlags,\n                    null,\n                    parsedArgs.permittedCapabilities,\n                    parsedArgs.effectiveCapabilities);\n        } catch (IllegalArgumentException ex) {\n            throw new RuntimeException(ex);\n        }\n        .....\n    }\n</code></pre> <pre><code>      /**\n    * The main entry point from zygote.\n    */\n      public static void main(String[] args) {\n        new SystemServer().run();\n      }\n\n    private void run() {\n        ......\n        // Start services.\n        try {\n            Trace.traceBegin(Trace.TRACE_TAG_SYSTEM_SERVER, \"StartServices\");\n            startBootstrapServices();\n            //\u542f\u52a8\u6838\u5fc3Service\n            startCoreServices();\n            //\u542f\u52a8\u5176\u4ed6Service\n            startOtherServices();\n        } catch (Throwable ex) {\n            Slog.e(\"System\", \"******************************************\");\n            Slog.e(\"System\", \"************ Failure starting system services\", ex);\n            throw ex;\n        } finally {\n            Trace.traceEnd(Trace.TRACE_TAG_SYSTEM_SERVER);\n        }\n\n        // Loop forever.\n        Looper.loop();\n        throw new RuntimeException(\"Main thread loop unexpectedly exited\");\n    }\n</code></pre> <pre><code>/**\n * Starts a miscellaneous grab bag of stuff that has yet to be refactored\n * and organized.\n */\nprivate void startOtherServices() {\n .....\n // We now tell the activity manager it is okay to run third party\n // code.  It will call back into us once it has gotten to the state\n // where third party code can really run (but before it has actually\n // started launching the initial applications), for us to complete our\n // initialization.\n mActivityManagerService.systemReady(new Runnable() {\n     @Override\n     public void run() {\n         Slog.i(TAG, \"Making services ready\");\n         .....\n      }\n    }\n .....\n}\n</code></pre> <pre><code>   public void systemReady(final Runnable goingCallback) {\n        .....  \n       Slog.i(TAG, \"System now ready\");\n       EventLog.writeEvent(EventLogTags.BOOT_PROGRESS_AMS_READY,\n           SystemClock.uptimeMillis());\n        .....\n\n       synchronized (this) {\n           // Only start up encryption-aware persistent apps; once user is\n           // unlocked we'll come back around and start unaware apps\n           startPersistentApps(PackageManager.MATCH_DIRECT_BOOT_AWARE);\n            .....\n        //\u8c03\u7528ActivityStackSupervisor\u4e2d\u7684resumeFocusedStackTopActivityLocked\u65b9\u6cd5\n           mStackSupervisor.resumeFocusedStackTopActivityLocked();\n           mUserController.sendUserSwitchBroadcastsLocked(-1, currentUserId);\n       }\n   }\n</code></pre> <pre><code>    boolean resumeFocusedStackTopActivityLocked() {\n        return resumeFocusedStackTopActivityLocked(null, null, null);\n    }\n\nboolean resumeFocusedStackTopActivityLocked(\n            ActivityStack targetStack, ActivityRecord target, ActivityOptions targetOptions) {\n        if (targetStack != null &amp;&amp; isFocusedStack(targetStack)) {\n            return targetStack.resumeTopActivityUncheckedLocked(target, targetOptions);\n        }\n        final ActivityRecord r = mFocusedStack.topRunningActivityLocked();\n        if (r == null || r.state != RESUMED) {\n           //\u8c03\u7528ActivityStack\u4e2d\u7684resumeTopActivityUncheckedLocked\u6765\u4fdd\u8bc1\u6808\u4e2d\u7684\u9876\u5c42Activity\u88ab\u91cd\u65b0\u542f\u52a8\n            mFocusedStack.resumeTopActivityUncheckedLocked(null, null);\n        }\n        return false;\n    }\n</code></pre> <pre><code>   boolean resumeTopActivityUncheckedLocked(ActivityRecord prev, ActivityOptions options) {\n\n       ....\n\n       boolean result = false;\n       try {\n           // Protect against recursion.\n           mStackSupervisor.inResumeTopActivity = true;\n           if (mService.mLockScreenShown == ActivityManagerService.LOCK_SCREEN_LEAVING) {\n               mService.mLockScreenShown = ActivityManagerService.LOCK_SCREEN_HIDDEN;\n               mService.updateSleepIfNeededLocked();\n           }\n           result = resumeTopActivityInnerLocked(prev, options);\n       } finally {\n           mStackSupervisor.inResumeTopActivity = false;\n       }\n       return result;\n   }\n</code></pre> <pre><code>   private boolean resumeTopActivityInnerLocked(ActivityRecord prev, ActivityOptions options) {\n        if (DEBUG_LOCKSCREEN) mService.logLockScreen(\"\");\n        if (!mService.mBooting &amp;&amp; !mService.mBooted) {\n           // Not ready yet!\n           return false;\n       } \n       .....\n       if (next == null) {\n            // There are no more activities!\n            final String reason = \"noMoreActivities\";\n            final int returnTaskType = prevTask == null || !prevTask.isOverHomeStack()\n                    ? HOME_ACTIVITY_TYPE : prevTask.getTaskToReturnTo();\n            if (!mFullscreen &amp;&amp; adjustFocusToNextFocusableStackLocked(returnTaskType, reason)) {\n                // Try to move focus to the next visible stack with a running activity if this\n                // stack is not covering the entire screen.\n                return mStackSupervisor.resumeFocusedStackTopActivityLocked(\n                        mStackSupervisor.getFocusedStack(), prev, null);\n            }\n\n            // Let's just start up the Launcher...\n            ActivityOptions.abort(options);\n            if (DEBUG_STATES) Slog.d(TAG_STATES,\n                    \"resumeTopActivityLocked: No more activities go home\");\n            if (DEBUG_STACK) mStackSupervisor.validateTopActivitiesLocked();\n            // Only resume home if on home display\n            //\u8c03\u7528ActivityStackSupervisor\u4e2d\u7684\u65b9\u6cd5\u6765\u6062\u590d Launcher\u6240\u5728\u7684\u6808\n            return isOnHomeDisplay() &amp;&amp;\n                    mStackSupervisor.resumeHomeStackTask(returnTaskType, prev, reason);\n        }\n        .....\n    }    \n</code></pre> <pre><code>   boolean resumeHomeStackTask(int homeStackTaskType, ActivityRecord prev, String reason) {\n        if (!mService.mBooting &amp;&amp; !mService.mBooted) {\n            // Not ready yet!\n            return false;\n        }\n\n        .....\n\n        mHomeStack.moveHomeStackTaskToTop(homeStackTaskType);\n        ActivityRecord r = getHomeActivity();\n        final String myReason = reason + \" resumeHomeStackTask\";\n\n        // Only resume home activity if isn't finishing.\n        if (r != null &amp;&amp; !r.finishing) {\n            mService.setFocusedActivityLocked(r, myReason);\n            return resumeFocusedStackTopActivityLocked(mHomeStack, prev, null);\n        }\n        \u542f\u52a8launcher\u5e94\u7528\u7684\u9501\u5c4f\u754c\u9762\n        return mService.startHomeActivityLocked(mCurrentUser, myReason);\n    }\n</code></pre> <p></p>"},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#linuxandroidinitsystemcoreinitinitcpp","title":"\u5f53\u5f15\u5bfc\u7a0b\u5e8f\u542f\u52a8Linux\u5185\u6838\u540e\uff0c\u4f1a\u52a0\u8f7d\u5404\u79cd\u9a71\u52a8\u548c\u6570\u636e\u7ed3\u6784\uff0c\u5f53\u6709\u4e86\u9a71\u52a8\u4ee5\u540e\uff0c\u5f00\u59cb\u542f\u52a8Android\u7cfb\u7edf\u540c\u65f6\u4f1a\u52a0\u8f7d\u7528\u6237\u7ea7\u522b\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0binit\uff08system\\core\\init\\init.cpp\uff09\u4ee3\u7801\u5982\u4e0b\uff1a","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#initrczygoteandroidandroid","title":"\u52a0\u8f7dinit.rc\u6587\u4ef6\uff0c\u4f1a\u542f\u52a8\u4e00\u4e2aZygote\u8fdb\u7a0b\uff0c\u6b64\u8fdb\u7a0b\u662fAndroid\u7cfb\u7edf\u7684\u4e00\u4e2a\u6bcd\u8fdb\u7a0b\uff0c\u7528\u6765\u542f\u52a8Android\u7684\u5176\u4ed6\u670d\u52a1\u8fdb\u7a0b\uff0c\u4ee3\u7801\uff1a","text":"<p>\u4eceandroid L\u5f00\u59cb\uff0c\u5728 /system/core/rootdir \u76ee\u5f55\u4e2d\u6709 4 \u4e2a zygote \u76f8\u5173\u7684\u542f\u52a8\u811a\u672c\u5982\u4e0b\u56fe\uff1a</p>"},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#app_maincppcjava","title":"\u63a5\u4e0b\u6765\u770bapp_main.cpp\u51fd\u6570\uff0c\u8fd9\u91cc\u5b9e\u73b0\u4ecec++\u4ee3\u7801\u8c03\u5230java\u4ee3\u7801\uff1a","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#zygoteinitjava","title":"ZygoteInit.java \u4ee3\u7801\uff1a","text":"<p>/frameworks/base/core/java/com/android/internal/os/ZygoteInit.java</p>"},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#systemserverjava","title":"SystemServer.java \u4ee3\u7801","text":"<p>/frameworks/base/services/java/com/android/server/SystemServer.java</p>"},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#systemserverjavastartotherservices","title":"\u542f\u52a8SystemServer.java\u7684startOtherServices\u65b9\u6cd5","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#activitymanagerservicejavamstacksupervisorresumefocusedstacktopactivitylocked","title":"ActivityManagerService.java\u4e2d\u7684mStackSupervisor.resumeFocusedStackTopActivityLocked()","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#activitystacksupervisorjavaresumefocusedstacktopactivitylocked","title":"ActivityStackSupervisor.java\u4e2d\u7684resumeFocusedStackTopActivityLocked\u65b9\u6cd5","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#activitystackjavaresumetopactivityuncheckedlocked","title":"ActivityStack.java\u4e2d\u7684resumeTopActivityUncheckedLocked\u65b9\u6cd5","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#activitystacksupervisorjavaresumehomestacktask","title":"ActivityStackSupervisor.java\u4e2dresumeHomeStackTask\u65b9\u6cd5","text":""},{"location":"Android/android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/#androidlauncherhome","title":"Android\u7cfb\u7edf\u542f\u52a8\u5b8c\u6210\uff0c\u6253\u5f00\u4e86Launcher\u5e94\u7528\u7684Home\u754c\u9762\u3002","text":""},{"location":"Android/%E4%B8%BA%E4%BB%80%E4%B9%88RxJava%E7%9A%84observeOn%E4%B8%8D%E8%83%BD%E9%9A%8F%E4%BE%BF%E7%94%A8/","title":"\u4e3a\u4ec0\u4e48RxJava\u7684observeOn\u4e0d\u80fd\u968f\u4fbf\u7528","text":"<p>\u4e4b\u524d\u5728\u9879\u76ee\u4e2d\u901a\u8fc7\u76d1\u542c RecyclerView \u7684scrollEvents\u6765\u5224\u65ad\u662f\u5426\u9700\u8981\u53bb\u52a0\u8f7d\u66f4\u591a\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u5728RecyclerView\u6ed1\u52a8\u7684\u65f6\u5019\u6765\u5224\u65ad\u662f\u5426\u9700\u8981\u52a0\u8f7d\u66f4\u591a\u7684\uff0c\u8fd9\u4e2a\u65f6\u5019scrollEvents\u8fd9\u8fb9\u4f1a\u4e00\u76f4\u4f1a\u6709\u56de\u8c03\uff0c\u6240\u4ee5\u4e3a\u4e86\u9632\u6b62\u5728\u5f31\u7f51\u4e0b\u4f1a\u51fa\u73b0\u591a\u6b21\u8bf7\u6c42\u7684\u60c5\u51b5\uff0c\u9879\u76ee\u4e2d\u7279\u5730\u52a0\u4e86\u4e00\u4e2aisLoading\u7684flag\u6765\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\u3002</p> <pre><code>fun loadMore(remainCount: Int = 6,loadFinish: () -&gt; Boolean):Observable&lt;PagingState&gt; {\n    scrollEvents()\n            .filter { loadFinish() }\n            .map {\n                var realRemainCount = 0\n                if (layoutManager is StaggeredGridLayoutManager) {\n                    (layoutManager as StaggeredGridLayoutManager).let {\n                        val last = IntArray(it.spanCount)\n                        it.findLastVisibleItemPositions(last)\n                        realRemainCount = it.itemCount - last.last()\n                    }\n                }\n                if (layoutManager is LinearLayoutManager) {\n                    (layoutManager as LinearLayoutManager).let {\n                        realRemainCount = it.itemCount - it.findLastVisibleItemPosition()\n                    }\n                }\n\n                when {\n                    realRemainCount == 1 -&gt; {\n                        PagingState.END\n                    }\n                    realRemainCount &lt;= remainCount -&gt; {\n                        PagingState.PAGING\n                    }\n                    else -&gt; PagingState.OTHERS\n                }\n            }\n}\n\nloadMore(){\n    isLoading\n}.subcribe({\n    //\u8fd9\u4e2a\u65f6\u5019\u662f\u7f51\u7edc\u8bf7\u6c42\uff0c\u5728doOnSubscribe\u7684\u65f6\u5019\u4f1aisLoading\u8bbe\u7f6e\u4e3atrue\uff0c\u5728doOnTerminal\u7684\u65f6\u5019\u4f1a\u518d\u5c06isLoading\u8bbe\u7f6e\u4e3afalse\u3002\n    loadMoreAction()\n},{})\n\n</code></pre> <p>\u4f46\u662f\u4e4b\u524d\u5728\u89e3\u5176\u4ed6bug\u7684\u65f6\u5019\u6211\u5728scrollEvents\u7684subscribe\u4e4b\u524d\u5207\u4e86\u4e2a\u7ebf\u7a0b\uff0c\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>loadMore(){\n    isLoading\n}.observeOn(AndroidSchedulers.mainThread())\n.subcribe({\n    loadMoreAction()\n},{})\n\n</code></pre> <p>\u4f46\u662f\u8fd9\u4e4b\u540e\u6709\u7528\u6237\u53cd\u9988feed\u91cc\u51fa\u73b0\u4e86\u91cd\u590d\u7684\u7b14\u8bb0\uff0c\u901a\u8fc7log\u53d1\u73b0\u662f\u7528\u6237\u5728\u5f53\u65f6\u89e6\u53d1\u4e86\u4e24\u6b21\u4e00\u6a21\u4e00\u6837\u7684\u52a0\u8f7d\u66f4\u591a\u7684\u8bf7\u6c42\u3002</p> <p>\u6240\u4ee5\u53c8\u56de\u5934\u68b3\u7406\u8fd9\u4e2a\u90e8\u5206\u7684\u903b\u8f91\uff0c\u4e8e\u662f\u5199\u4e86\u4e0b\u9762\u8fd9\u4e2ademo\u8bd5\u4e86\u4e00\u4e0b\u3002</p> <pre><code>\n    private var isLoading = false\n    var executor = Executors.newSingleThreadExecutor()\n\n    fun testObserveOn() {\n        Observable.fromArray(1,2)\n            .filter {\n                Log.d(\"gaohui\", \"filter\")\n                isLoading.not()\n            }\n            .observeOn(Schedulers.from(executor))\n            .subscribe({\n                isLoading = true\n                Log.d(\"gaohui\", \"subscribe\")\n                Observable.just(it)\n                    .subscribeOn(Schedulers.io())\n                    .observeOn(Schedulers.from(executor))\n                    .subscribe({\n                        Log.d(\"gaohui\", \"it $it\")\n                        isLoading = false\n                    },{})\n            },{})\n    }\n</code></pre> <p>\u5982\u4e0a\u4ee3\u7801\uff0c\u6253\u5370\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a</p> <pre><code>2020-04-03 14:08:40.101 14083-14153/? D/gaohui: filter\n2020-04-03 14:08:40.102 14083-14153/? D/gaohui: filter\n2020-04-03 14:08:40.102 14083-14153/? D/gaohui: subscribe\n2020-04-03 14:08:40.103 14083-14153/? D/gaohui: subscribe\n2020-04-03 14:08:40.103 14083-14153/? D/gaohui: it 1\n2020-04-03 14:08:40.105 14083-14153/? D/gaohui: it 2\n</code></pre> <p>\u5f53\u6211\u4eec\u628a\u5207\u6362\u7ebf\u7a0b\u7684observeOn\u4ee3\u7801\u6ce8\u91ca\u6389\u4e4b\u540e</p> <pre><code>    fun testObserveOn() {\n        Observable.fromArray(1,2)\n            .filter {\n                Log.d(\"gaohui\", \"filter\")\n                isLoading.not()\n            }\n            //.observeOn(Schedulers.from(executor))\n            .subscribe({\n                isLoading = true\n                Log.d(\"gaohui\", \"subscribe\")\n                Observable.just(it)\n                    .subscribeOn(Schedulers.io())\n                    .observeOn(Schedulers.from(executor))\n                    .subscribe({\n                        Log.d(\"gaohui\", \"it $it\")\n                        isLoading = false\n                    },{})\n            },{})\n    }\n\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u6253\u5370\u7ed3\u679c\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u3002</p> <pre><code>2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: filter\n2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: subscribe\n2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: filter\n2020-04-03 14:10:51.058 14258-14340/com.gaohui.android.code.collection D/gaohui: it 1\n</code></pre> <p>\u8fd9\u91cc\u6211\u53d1\u73b0\u628aobserveOn\u5207\u5230\u4e3b\u7ebf\u7a0b\u8fd8\u662f\u5207\u5230\u5f53\u524d\u7ebf\u7a0b\uff0c\u53ea\u8981\u6267\u884c\u4e86\u5207\u7ebf\u7a0b\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u7684isLoading\u8fd9\u4e2aflag\u7684\u63a7\u5236\u6548\u679c\u5c31\u5931\u6548\u4e86\u3002</p> <p>observeOn\u7684\u903b\u8f91\u57fa\u672c\u90fd\u5728ObservableObserveOn.java \u8fd9\u4e2a\u7c7b\u91cc\u9762\u3002</p> <p>\u5728ObservableObserveOn.java\u4e2dObserveOnObserver\u8fd9\u4e2a\u5185\u90e8\u7c7b\u4e2d\u7684OnNext\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>    @Override\n        public void onNext(T t) {\n            if (done) {\n                return;\n            }\n\n            if (sourceMode != QueueDisposable.ASYNC) {\n                queue.offer(t);\n            }\n            schedule();\n        }\n\n</code></pre> <p>\u8fd9\u91cc\u4f1a\u628a\u8fd9\u4e2a t \u653e\u5230queue \u8fd9\u4e2a\u961f\u5217\u4e2d\u3002\u8fd9\u4e2at \u662f\u6211\u4eecObservable\u4e0a\u6e38\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\u6e90\uff0c\u8fd9\u4e2aqueue \u662f\u5728ObserveOnObserver\u8fd9\u4e2a\u5185\u5b58\u7c7b\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u961f\u5217\u3002</p> <pre><code>    static final class ObserveOnObserver&lt;T&gt; extends BasicIntQueueDisposable&lt;T&gt;\n    implements Observer&lt;T&gt;, Runnable {\n\n        private static final long serialVersionUID = 6576896619930983584L;\n        final Observer&lt;? super T&gt; downstream;\n        final Scheduler.Worker worker;\n        final boolean delayError;\n        final int bufferSize;\n\n        SimpleQueue&lt;T&gt; queue;\n        ...\n    }\n</code></pre> <p>\u8fd9\u4e2aqueue\u662f\u7528\u6765\u5b58\u653e\u5f53\u524d\u7ebf\u7a0b\u9700\u8981\u6267\u884c\u7684\u4e00\u4e9b\u4efb\u52a1\u7684\u3002</p> <p>\u63a5\u7740\u5728onNext\u540e\u9762\u8c03\u7528\u4e86schedule\u65b9\u6cd5\u3002\u8fd9\u4e2aschedule\u5c31\u662f\u51c6\u5907\u6267\u884c\u8fd9\u4e2aRunnable\u3002</p> <pre><code> void schedule() {\n            if (getAndIncrement() == 0) {\n                worker.schedule(this);\n            }\n        }\n\n</code></pre> <p>\u8fd9\u4e2aRunnable\u91cc\u7684run\u65b9\u6cd5\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u3002</p> <pre><code>   @Override\n        public void run() {\n            if (outputFused) {\n                drainFused();\n            } else {\n                drainNormal();\n            }\n        }\n</code></pre> <p>\u6211\u4eec\u8fd9\u91cc\u6682\u4e14\u4e0d\u5173\u6ce8outputFused\u8fd9\u4e2aflag\u662f\u5565\u610f\u601d\uff0c\u8fd9\u91cc\u65e0\u8bba\u662fdrainFused\u65b9\u6cd5\u8fd8\u662fdrainNormal\u65b9\u6cd5\uff0c \u57fa\u672c\u90fd\u662f\u8f6e\u8be2queue\u91cc\u7684\u6d88\u606f\uff0c\u5982\u679cqueue\u91cc\u6709\u6d88\u606f\u9700\u8981\u5904\u7406,\u5c31\u53d6\u51fa\u6765\u6267\u884c\u3002\u8fd9\u91cc\u7684\u903b\u8f91\u548c\u4e3b\u7ebf\u7a0b\u7684MessageQueue\u5f88\u7c7b\u4f3c\uff0c\u90fd\u662f\u8f6e\u8be2\uff0c\u53d6\u6d88\u606f\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u770b\u5230\u8fd9\u91cc\u6211\u7a81\u7136\u6709\u70b9\u660e\u767d\u6211\u4eec\u4e0a\u9762\u90a3\u91cc\u8c03\u7528\u4e86observeOn\u4e4b\u540e\u4e3a\u5565\u6211\u4eec\u7684flag isLoading\u7684\u63a7\u5236\u6548\u679c\u5c31\u6ca1\u6709\u751f\u6548\u4e86\uff0cobserveOn\u4e4b\u540e\u7684\u64cd\u4f5c\u76f8\u5f53\u4e8e\u662f\u975e\u963b\u585e\u7684\uff0c\u6211\u4eec\u5207\u4e86\u4e00\u4e2a\u7ebf\u7a0b\uff0cobserveOn\u4e2d\u7684subscribe\u7684\u4ee3\u7801\u65f6\u4e0d\u4f1a\u9a6c\u4e0a\u6267\u884c\u7684\uff0c\u8fd9\u6837\u4ee3\u7801\u53c8\u56de\u5934\u53bb\u53d6\u65b0\u7684\u6570\u636e\u6d41\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019isLoading\u8fd9\u4e2aflag\u662f\u6ca1\u6709\u6539\u53d8\u7684\uff0c\u6240\u4ee5\u5bfc\u81f4\u89e6\u53d1\u4e86\u4e24\u6b21\u7f51\u7edc\u8bf7\u6c42\u3002</p> <p>\u8fd9\u91cc\u7684observeOn \u548c Android \u91cc\u7684 post \u6548\u679c\u662f\u4e00\u6837\u7684\uff0cobserveOn \u8fd9\u4e2a\u8868\u793a\u628a\u8fd9\u4e2a\u4e4b\u540e\u7684\u64cd\u4f5c\u5305\u88c5\u6210\u4e00\u4e2aRunnable \u653e\u5230observeOn\u6307\u5b9a\u7684\u8fd9\u4e2aSchedulers\u4e2d\u53bb\u3002</p>"},{"location":"Android/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%89%96%E6%9E%90Handler%E6%9C%BA%E5%88%B6/","title":"\u4ece\u6e90\u7801\u89d2\u5ea6\u5256\u6790Handler\u673a\u5236","text":"<p>android\u4e2d\uff0c\u5728\u8fdb\u884c\u8017\u65f6\u64cd\u4f5c\u66f4\u65b0UI\u7528\u5230\u6700\u591a\u7684\u65b9\u6cd5\u5c31\u662fHandler\u4e86\uff0c\u4e00\u822c\u5728\u5b50\u7ebf\u7a0b\u4e2d\u8fdb\u884c\u8017\u65f6\u64cd\u4f5c\uff08\u8bbf\u95ee\u7f51\u7edc\u7b49\uff09\uff0c\u7136\u540e\u53d1\u9001\u6d88\u606f\u5230UI\u7ebf\u7a0b\uff08\u4e3b\u7ebf\u7a0b\uff09\uff0c\u4f7f\u5f97\u754c\u9762\u5f97\u4ee5\u66f4\u65b0\u3002</p> <p>\u5bf9\u4e8eHandler\u7684\u7528\u6cd5\uff0c\u76f8\u4fe1\u5927\u5bb6\u90fd\u6bd4\u8f83\u719f\u6089\u4e86\uff0c\u90a3\u4e48Handler\u673a\u5236\u7684\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f\u6211\u4eec\u4eca\u5929\u4ece\u6e90\u7801\u89d2\u5ea6\u6765\u5206\u6790\u4e0bHandler\u673a\u5236\u7684\u539f\u7406\u3002</p> <pre><code>Handler mHandler = new Handler(){  \n\n        public void handleMessage(Message msg) {  \n            //\u5904\u7406\u6d88\u606f\n        };  \n    };  \n\n\n</code></pre> <p>\u9996\u5148\u770b\u4e24\u5f20\u5173\u4e8eHandler\u7684\u56fe\uff1a \u5e0c\u671b\u80fd\u5e2e\u52a9\u5927\u5bb6\u7406\u89e3\u3002</p> <p>\u7b2c\u4e00\u5f20\u4e66\u5e8f\u56fe\u6765\u81ea\u7f51\u7edc\uff0c\u7b2c\u4e8c\u5f20\u7c7b\u662f\u8c03\u7528\u5173\u7cfb\u56fe\u3002 </p> <p></p> <pre><code>    A Handler allows you to send and process Message and Runnable\nobjects associated with a thread's MessageQueue.  Each Handler\ninstance is associated with a single thread and that thread's message\nqueue.  When you create a new Handler, it is bound to the thread /\nmessage queue of the thread that is creating it -- from that point on,\nit will deliver messages and runnables to that message queue and execute\nthem as they come out of the message queue.\n\nThere are two main uses for a Handler: (1) to schedule messages and\nrunnables to be executed as some point in the future; and (2) to enqueue\nan action to be performed on a different thread than your own.\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u770bAPI\u4e2d\u7ed9\u7684\u63cf\u8ff0\uff0c\u4e00\u4e2aHandler\u80fd\u591f\u901a\u8fc7\u5173\u8054\u7684\u7ebf\u7a0b\u7684MessageQueue\u6765\u53d1\u9001\u548c\u5904\u7406Message    \u548cRunnable\u5bf9\u8c61\u3002\u6bcf\u4e00\u4e2aHandler\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u4f1a\u5173\u8054\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u548c\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u6d88\u606f\u961f\u5217\u3002\u5f53    \u4f60\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Handler\uff0c\u5b83\u4f1a\u7ed1\u5b9a\u5230\u521b\u5efa\u5b83\u7684\u7684\u7ebf\u7a0b\u548c\u6d88\u606f\u961f\u5217\u4e0a--\u4ece\u8fd9\u4e2a\u70b9\u4e0a\uff0c\u5f53\u6d88\u606f\u961f\u5217\u4e2d    \u6709\u6d88\u606f\u6765\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u4f20\u9012\u6d88\u606f\u548cRunnable\u5bf9\u8c61\u5230\u90a3\u4e2a\u6d88\u606f\u961f\u5217\u5e76\u4e14\u4f1a\u6267\u884c\u8fd9\u4e9b\u6d88\u606f\u3002</p> <p>Handler\u6709\u4e24\u4e2a\u7528\u6cd5\uff1a\uff081\uff09\u80fd\u591f\u4f7fmessages\u548crunnables\u5728\u5373\u5c06\u5230\u6765\u7684\u67d0\u4e2a\u70b9\u4e00\u540c\u6267\u884c\uff1b\uff082\uff09\u80fd\u591f\u534f\u8c03\u4e00\u4e2a\u64cd\u4f5c\u5728\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\u7684\u6267\u884c</p> <pre><code> public Handler() {\n        this(null, false);\n    }\n\n</code></pre> <p>\u9ed8\u8ba4\u7684\u6784\u9020\u65b9\u6cd5\u4f1a\u8c03\u7528\u4e0b\u9762\u8fd9\u4e2a\u5e26\u4e24\u4e2a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u3002</p> <pre><code> public Handler(Callback callback, boolean async) {\n        if (FIND_POTENTIAL_LEAKS) {\n            final Class&lt;? extends Handler&gt; klass = getClass();\n            if ((klass.isAnonymousClass() || klass.isMemberClass() || klass.isLocalClass()) &amp;&amp;\n                    (klass.getModifiers() &amp; Modifier.STATIC) == 0) {\n                Log.w(TAG, \"The following Handler class should be static or leaks might occur: \" +\n                    klass.getCanonicalName());\n            }\n        }\n        ////////////////////////////////\n        \u83b7\u53d6Looper\n        mLooper = Looper.myLooper();\n        ///////////////////////////////\n        if (mLooper == null) {\n            throw new RuntimeException(\n                \"Can't create handler inside thread that has not called Looper.prepare()\");\n        }\n        mQueue = mLooper.mQueue;\n        mCallback = callback;\n        mAsynchronous = async;\n    }\n</code></pre> <p>\u6211\u4eec\u8fd9\u91cc\u4e3b\u8981\u770bmLooper = Looper.myLooper(); \u8fd9\u884c\u4ee3\u7801\uff0cLooper\u662f\u4ec0\u4e48\u5462\uff0c\u6709\u4ec0\u4e48\u7528\u5462\uff1f</p> <p>\u6211\u4eec\u8ffd\u8e2a\u5230Looper\u7684myLooper\u65b9\u6cd5\uff1a</p> <pre><code>  public static Looper myLooper() {\n        return sThreadLocal.get();\n    }\n</code></pre> <p>\u95ee\u9898\u53c8\u6765\u4e86\uff0c\u8fd9\u4e2aThreadLoacal\u53c8\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\u5462\uff1f</p> <p>ThreadLoacal\u5373\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\uff0cThreadLocal\u8bbe\u8ba1\u51fa\u6765\u662f\u4e3a\u4e86\u907f\u514d\u5728\u7ebf\u7a0b\u95f4\u5171\u4eab\u53d8\u91cf\uff0c\u4f7f\u7528ThreadLoacal\u80fd\u591f\u4e3a\u5404\u4e2a\u7ebf\u7a0b\u63d0\u4f9b\u5404\u81ea\u7684\u5b9e\u4f8b\u3002 ThreadLocal\u7684\u4e24\u4e2a\u65b9\u6cd5\uff1a get\u548cset\u7528\u4e8e\u83b7\u53d6ThreadLocal\u4e2d\u5b58\u50a8\u7684\u5c40\u90e8\u53d8\u91cf</p> <pre><code>/**\n  Returns the value in the current thread's copy of this thread-local variable.\n*/\npublic T get()\uff1b\n\n/**\n  Sets the current thread's copy of this thread-local variable to the specified value.\n*/\npublic void set(T value)\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u53ea\u505a\u7b80\u5355\u7684\u4ecb\u7ecd\uff0c\u5173\u4e8eThreadLoacal\u8fd9\u91cc\u4e0d\u505a\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\u7814\u7a76\u3002</p> <p>\u6211\u4eec\u770b\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\uff0cThreadLocal\u4f5c\u4e3aLooper\u7684\u9759\u6001\u5e38\u91cf\uff0c\u4e00\u822c\u5728\u7c7b\u52a0\u8f7d\u7684\u65f6\u5019\u5c31\u4f1a\u521b\u5efa\uff08\u9759\u6001\u6210\u5458\u53d8\u91cf\u548c\u9759\u6001\u521d\u59cb\u5316\u5757\u7ea7\u522b\u76f8\u540c\uff09\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u770b\u8fd9\u4e2aprepare\u65b9\u6cd5\uff0cprepare\u65b9\u6cd5\u4e2d\u4f1a\u5c06Looper\u653e\u5728ThreadLocal\uff0c\u786e\u4fdd\u6bcf\u4e2a\u7ebf\u7a0b\u53d6\u5f97Looper\u7684\u65f6\u5019\u662f\u5c5e\u4e8e\u81ea\u5df1\u7684\u90a3\u4e2aLooper\u3002</p> <pre><code> //sThreadLocal\u7684\u521b\u5efa\n static final ThreadLocal&lt;Looper&gt; sThreadLocal = new ThreadLocal&lt;Looper&gt;();\n\n\n\nprivate static void prepare(boolean quitAllowed) {\n    if (sThreadLocal.get() != null) {\n        throw new RuntimeException(\"Only one Looper may be created per thread\");\n    }\n    //\u521b\u5efaLooper\u5e76\u5c06Looper\u4fdd\u5b58\u5230sThreadLocal\u4e2d\n    sThreadLocal.set(new Looper(quitAllowed));\n}\n\n</code></pre> <p>\u770b\u5230\u8fd9\u91cc\uff0c\u7ec6\u5fc3\u7684\u4f60\u4e0d\u7531\u5f97\u4f1a\u4ea7\u751f\u8fd9\u6837\u7684\u7591\u95ee\uff0cLooper\u5728\u8c03\u7528myLooper\u65b9\u6cd5\u83b7\u5f97ThreadLocal\u4e2d\u5b58\u653e\u7684Looper\u7684\u65f6\u5019\uff0c\u5982\u679cprepare\u65b9\u6cd5\u6ca1\u6709\u5728\u8fd9\u4e4b\u524d\u8c03\u7528\u7684\u8bdd\uff0c\u90a3\u4e48\u80af\u5b9a\u662f\u53d6\u4e0d\u5230Looper\u7684\uff0c\u4f46\u95ee\u9898\u662f\u5e73\u65f6\u6211\u4eec\u5728\u4f7f\u7528Handler\u7684\u65f6\u5019\uff0c\u5e76\u6ca1\u6709\u8c03\u7528Looper\u4e2d\u7684prepare\u65b9\u6cd5\u554a\uff1f</p> <p>\u5176\u5b9e\u6211\u4eec\u5e73\u65f6\u7528Handler\u7684\u65f6\u5019\uff0c\u90fd\u662f\u5728Main\u7ebf\u7a0b\u4e2d\uff0c\u5728Main\u7ebf\u7a0b\u4e2d\uff0c\u5df2\u7ecf\u63d0\u524d\u8c03\u7528\u8fc7\u8fd9\u4e2aprepare\u65b9\u6cd5\u4e86\u3002</p> <pre><code>public static void main(String[] args) {\n\n        ...............\n\n        //////////////////////////////\n        \u2460\u4e3b\u7ebf\u7a0b\u8c03\u7528prepare\u65b9\u6cd5\uff0c\u521b\u5efaLooper\n        Looper.prepareMainLooper();\n        /////////////////////////////\n\n        ActivityThread thread = new ActivityThread();\n        thread.attach(false);\n\n        if (sMainThreadHandler == null) {\n            sMainThreadHandler = thread.getHandler();\n        }\n\n        AsyncTask.init();\n\n        if (false) {\n            Looper.myLooper().setMessageLogging(new\n                    LogPrinter(Log.DEBUG, \"ActivityThread\"));\n        }\n        //////////////////////////////\n        \u2461\u8c03\u7528loop\u8fdb\u884c\u6d88\u606f\u5faa\u73af\n        Looper.loop();\n        //////////////////////////////\n\n        throw new RuntimeException(\"Main thread loop unexpectedly exited\");\n    }\n</code></pre> <p>\u5728ActivityThread\u7684main\u65b9\u6cd5\u4e2d\uff0c\u2460\u8fd9\u91cc\u4f1a\u8c03\u7528\u6765prepareMainLooper\u521b\u5efaLooper\uff0cprepareMainLooper\u4f1a\u8f6c\u6389Looper\u4e2d\u7684prepare\u65b9\u6cd5\u3002ActivityThread\u7684main\u65b9\u6cd5\u5176\u5b9e\u662fandroid\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u5165\u53e3\uff0c\u6bcf\u542f\u52a8\u4e00\u4e2a\u5e94\u7528\u8fdb\u7a0b\uff0c\u90fd\u4f1a\u521b\u5efaActivityThread\u4e0e\u4e4b\u5bf9\u5e94\u7684\u5b9e\u4f8b\uff0c\u662f\u5e94\u7528\u7a0b\u5e8f\u7684UI\u7ebf\u7a0b\u3002UI\u7ebf\u7a0b\u4e2d\u4f1a\u901a\u8fc7prepareMainLooper\u7b49\u65b9\u6cd5\u6765\u5efa\u7acb\u6d88\u606f\u5faa\u73af\uff08\u5373\u4e3aHandler\u4f5c\u76f8\u5173\u7684\u51c6\u5907\u5de5\u4f5c\uff09\u3002</p> <p>\u53e6\u5916\uff0c\u5982\u679c\u6211\u4eec\u5728\u81ea\u5df1\u5b9a\u4e49\u7684\u7ebf\u7a0b\u4e2d\u4f7f\u7528Handler\u7684\u8bdd\uff0c\u5219\u5fc5\u987b\u8981\u81ea\u5df1\u8c03Looper.prepare()\u6765\u521b\u5efaLooper\u3002</p> <p>\u6211\u4eec\u5728\u6765\u770bmain\u65b9\u6cd5\u2461\u5904\uff0c\u4f1a\u8c03\u7528Looper\u4e2dloop\u65b9\u6cd5\u3002 \u90a3\u4e48loop\u65b9\u6cd5\u662f\u5e72\u4ec0\u4e48\u5462\uff1f</p> <pre><code>    public static void loop() {\n        final Looper me = myLooper();\n        ....\n        final MessageQueue queue = me.mQueue;\n\n        ....\n        ///////////////////////////////\n        \u2460\u6b7b\u5faa\u73af\u3002\u9700\u8981\u4e0d\u505c\u7684\u4eceMessageQueue\u53bb\u6d88\u606f\u8fdb\u884c\u5904\u7406\n        for (;;) {\n            Message msg = queue.next(); // might block\n            if (msg == null) {\n                // No message indicates that the message queue is quitting.\n                return;\n            }\n        //////////////////////////////\n\n            //\u2461\u5206\u53d1\u6d88\u606f\n            msg.target.dispatchMessage(msg);\n\n            msg.recycle();\n        }\n    }\n</code></pre> <p>\u8fd9\u91cc\u5728loop\u65b9\u6cd5\u4e2d\uff0c\u4e3a\u4e86\u663e\u5f97\u6bd4\u8f83\u6574\u6d01\uff0c\u7565\u53bb\u4e86\u4e00\u4e9b\u4e0d\u91cd\u8981\u7684\u4ee3\u7801\uff0c\u8fd9\u91cc\u6211\u4eec\u770b\u4e24\u4e2a\u5730\u65b9\uff0c\u9996\u5148\u6211\u4eec\u6765\u770bloop\u65b9\u6cd5\u7684\u2460\u5904\uff0c\u8fd9\u91cc\u662f\u4e2a\u6b7b\u5faa\u73af\uff0c\u8fd9\u91cc\u53c8\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7c7bMessageQueue\uff0c\u90a3\u4e48MessageQueue\u662f\u4ec0\u4e48\u5462?</p> <p>MessageQueue\u7528\u4e8e\u5b58\u653e\u4e00\u4e2a\u6d88\u606f\u5217\u8868\uff0c\u5176\u6570\u636e\u7ed3\u6784\u5c31\u662f\u4e00\u4e2a\u961f\u5217\u3002\u4e0a\u9762\u7684next\u65b9\u6cd5\u4f1a\u53d6\u51fa\u961f\u5217\u4e2d\u9700\u8981\u9a6c\u4e0a\u5904\u7406\u7684\u6d88\u606f\uff0c\u53d6\u5230\u6d88\u606f\u540e\uff0c\u6267\u884cloop\u65b9\u6cd5\u4e2d\u7684\u2461\uff0cmsg\u662fMessage\u7c7b\u578b\uff0c\u90a3\u4e48Message\u7684target\u662f\u4ec0\u4e48\u5462\uff1f\u7ee7\u7eed\u770bMessage\u7684\u4ee3\u7801\u3002</p> <pre><code> /*package*/ Handler target;   \n\n  public Message() {\n  }\n\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5728Message\u4e2d\u7684target\u5176\u5b9e\u662fHandler\uff0c\u4e0a\u9762\u2461\u5904\uff0c\u5728\u53d6\u5f97\u9700\u8981\u5904\u7406\u7684\u6d88\u606f\u540e\uff0c\u7531\u6d88\u606f\u7684Handler\u6765\u5206\u53d1\u6d88\u606f\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u53e6\u5916\uff0cMessage\u4e2d\u7684Handler\u662f\u5728\u4ec0\u4e48\u65f6\u5019\u4f20\u9012\u8fdb\u53bb\u7684\u5462\uff1f\u6211\u4eec\u6765\u770b\u4e0bHandler\u4e2d\u7684\u76f8\u5173\u65b9\u6cd5\uff1a</p> <p>Handler\u53d1\u9001\u6d88\u606f\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u6784\u9020\u6d88\u606f\u7684\u65b9\u5f0f\uff1a 1. \u4f7f\u7528new \u4e00\u4e2aMessage \u8fd9\u79cd\u65b9\u5f0f\uff0cnew Message\u7684\u65b9\u5f0f\uff0c\u5176\u5b9eMessage\u6784\u9020\u65b9\u6cd5\u5176\u4e2d\u6ca1\u6709\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5173\u952e\u8fd8\u662f\u5728Handler\u8fd9\u91ccsendMessage\u65b9\u6cd5\uff0csendMessage\u6700\u7ec8\u4f1a\u8c03\u7528enqueueMessage\uff0c\u5728enqueueMessage\u4e2d\u5c31\u8bbe\u7f6e\u4e86Message\u7684target\u4e3athis\uff0c\u5373Handler 1. \u4f7f\u7528Handler\u4e2dobtain\u83b7\u53d6\u4e00\u4e2a\u4fe1\u606f</p> <p>\u5f53\u4f7f\u7528\u7b2c\u4e8c\u79cd\u65b9\u5f0fobtainMessage\u6765\u83b7\u5f97\u4e00\u4e2aMessage\u65f6\uff0c\u540c\u6837\u4f1a\u5c06target\u7f6e\u4e3aHandler\u3002</p> <pre><code>public final boolean sendMessage(Message msg)\n{\n    return sendMessageDelayed(msg, 0);\n}\n\npublic boolean sendMessageAtTime(Message msg, long uptimeMillis) {\n    MessageQueue queue = mQueue;\n    if (queue == null) {\n        RuntimeException e = new RuntimeException(\n                this + \" sendMessageAtTime() called with no mQueue\");\n        Log.w(\"Looper\", e.getMessage(), e);\n        return false;\n    }\n    return enqueueMessage(queue, msg, uptimeMillis);\n}\n\nprivate boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) {\n    //\u5c06\u5f53\u524dMessage\u4e2dtarget\u8bbe\u7f6e\u4e3a\u81ea\u5df1\uff0c\u5373Handler\n    msg.target = this;\n    if (mAsynchronous) {\n        msg.setAsynchronous(true);\n    }\n    return queue.enqueueMessage(msg, uptimeMillis);\n}\n\n</code></pre> <pre><code>public final Message obtainMessage()\n{\n    return Message.obtain(this);\n}\n\npublic static Message obtain(Handler h) {\n    Message m = obtain();\n    m.target = h;\n\n    return m;\n}\n</code></pre> <p>\u7531\u4e0a\u9762Handler\u53d1\u9001\u6d88\u606f\u7684\u6d41\u7a0b\u53ef\u77e5\uff0cHandler\u53d1\u9001\u6d88\u606f\u540eMessageQueue\u4e2denqueueMessage\u6765\u5c06\u6d88\u606f\u5165\u961f\uff0c\u6211\u4e48\u6765\u770benqueueMessage\u65b9\u6cd5\uff1a</p> <pre><code> boolean enqueueMessage(Message msg, long when) {\n        .....\n\n        boolean needWake;\n        .........\n\n            msg.when = when;\n            Message p = mMessages;\n            if (p == null || when == 0 || when &lt; p.when) {\n\n                //\u2460 \u5f53\u524d\u53d1\u9001\u7684message\u9700\u8981\u9a6c\u4e0a\u88ab\u5904\u7406\u8c03\uff0cneedWake\u5524\u9192\u72b6\u6001\u7f6etrue\n\n                // New head, wake up the event queue if blocked.\n                msg.next = p;\n                mMessages = msg;\n                needWake = mBlocked;\n            } else {\n\n              // Inserted within the middle of the queue.  Usually we don't have to wake\n                // up the event queue unless there is a barrier at the head of the queue\n                // and the message is the earliest asynchronous message in the queue.\n                needWake = mBlocked &amp;&amp; p.target == null &amp;&amp; msg.isAsynchronous();\n                Message prev;\n\n                // \u2461 \u5f53\u524d\u53d1\u9001\u7684message\u88ab\u6392\u961f\u5230\u5176\u4ed6message\u7684\u540e\u9762\uff0cneedWake\u5524\u9192\u72b6\u6001\u7f6efalse\n\n                for (;;) {\n                    prev = p;\n                    p = p.next;\n                    if (p == null || when &lt; p.when) {\n                        break;\n                    }\n                    if (needWake &amp;&amp; p.isAsynchronous()) {\n                        needWake = false;\n                    }\n                }\n                msg.next = p; // invariant: p == prev.next\n                prev.next = msg;\n            }\n        }\n\n        //\u2462  \u662f\u5426\u5524\u9192\u4e3b\u7ebf\u7a0b\n        if (needWake) {\n            nativeWake(mPtr);\n        }\n        return true;\n    }\n</code></pre> <p>\u5728MessageQueue\u4e2denqueueMessage\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u4e09\u4e2a\u5730\u65b9\uff1a\u2460\u2461\u2462\uff0c\u6839\u636e\u4f20\u8fdb\u6765\u6d88\u606fMessage\u4e2d\u7684\u65f6\u95f4\u548c\u961f\u5217\u4e2d\u6700\u524d\u9762\u4e00\u4e2a\u6d88\u606f\u7684\u65f6\u95f4\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5224\u65ad\u662f\u4e0d\u662f\u9700\u8981\u53ca\u65f6\u5904\u7406\uff0c\u8fd8\u662f\u6392\u5230\u540e\u9762\u53bb\u3002</p> <p>\u5728\u2460\u5904\uff0c\u5f53\u524d\u53d1\u9001\u7684message\u9700\u8981\u9a6c\u4e0a\u88ab\u5904\u7406\u8c03\uff0cneedWake\u5524\u9192\u72b6\u6001\u7f6etrue\u3002</p> <p>\u5728\u2461\u5904\uff0c\u5f53\u524d\u53d1\u9001\u7684message\u88ab\u6392\u961f\u5230\u5176\u4ed6message\u7684\u540e\u9762\uff0cneedWake\u5524\u9192\u72b6\u6001\u7f6efalse\u3002</p> <p>\u5728\u2462\u5904\uff0cneedWake\uff0c\u6765\u786e\u5b9a\u662f\u5426\u5524\u9192\u4e3b\u7ebf\u7a0b\u6765\u5904\u7406\u6d88\u606f\u3002</p> <p>\u8fd9\u6837\u6d88\u606f\u5c31\u80fd\u88ab\u5b58\u653e\u5230\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u5f53\u9700\u8981\u53ca\u65f6\u5904\u7406\uff0c\u4f1a\u901a\u8fc7nativeWake\u6765\u5524\u9192\u4e3b\u7ebf\u7a0b\uff0cnativeWake\u662f\u4e00\u4e2anative\u65b9\u6cd5\uff0c\u7528jni\u6765\u5b9e\u73b0\uff0cHandler\u673a\u5236\u7528\u7684\u662fLinux\u4e0b\u7684\u4e00\u79cd\u901a\u4fe1\u65b9\u5f0f\uff0c\u53eb\u7ba1\u9053\u3002\u7ba1\u9053\uff08Pipe\uff09\uff0c\u662fLinux\u4e2d\u7684\u4e00\u79cd\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff0c\u4f7f\u7528\u4e86\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u6709\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u4e00\u4e2a\u662f\u8bfb\u53d6\uff0c\u4e00\u4e2a\u662f\u5199\u5165\uff09\u3002\u5173\u4e8e\u7ba1\u9053\u6709\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u5df1\u7814\u7a76\u770b\u770b\uff0c\u8fd9\u91cc\u4e0d\u505a\u8fc7\u591a\u4ecb\u7ecd\u3002</p> <p>\u5728Looper.loop()\u65b9\u6cd5\u4e2d,\u6ca1\u6709\u6d88\u606f\u5904\u7406\uff0c\u4e3b\u7ebf\u7a0b\u5c31\u4f1a\u963b\u585e\uff0c\u5f53\u4e3b\u7ebf\u7a0b\u88ab\u5b50\u7ebf\u7a0b\u5524\u9192\u540e\uff0c\u4f1a\u7ee7\u7eed\u6267\u884c\uff0c\u8fd9\u6837\u5c31\u4f1a\u6267\u884c msg.target.dispatchMessage(msg)\u65b9\u6cd5</p> <pre><code>public static void loop() {\n        final Looper me = myLooper();\n        ....\n        final MessageQueue queue = me.mQueue;\n\n        ....\n\n        for (;;) {\n            Message msg = queue.next(); // might block\n            if (msg == null) {\n                // No message indicates that the message queue is quitting.\n                return;\n            }\n            //\u5206\u53d1\u6d88\u606f\n            msg.target.dispatchMessage(msg);\n\n\n            msg.recycle();\n        }\n    }\n</code></pre> <p>dispatchMessage\u65b9\u6cd5\u5982\u4e0b\uff0c\u4f1a\u8c03\u7528handleMessage\uff0c\u800chandleMessage\u662f\u4e2a\u7a7a\u65b9\u6cd5\uff0c\u6b63\u662f\u6211\u4eec\u9700\u8981\u91cd\u5199\u7684\u5730\u65b9\uff0c\u6211\u4eec\u5904\u7406\u6d88\u606f\u7684\u903b\u8f91\u5c31\u5728\u8fd9\u91cc\uff0c\u8fd9\u6837\uff0c\u8fd9\u4e2aHandler\u673a\u5236\u7684\u6d41\u7a0b\u5c31\u8d70\u901a\u4e86\u3002</p> <pre><code>public void dispatchMessage(Message msg) {\n        if (msg.callback != null) {\n            handleCallback(msg);\n        } else {\n            if (mCallback != null) {\n                if (mCallback.handleMessage(msg)) {\n                    return;\n                }\n            }\n            handleMessage(msg);\n        }\n    }\n\npublic void handleMessage(Message msg) {\n}\n</code></pre>"},{"location":"Android/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%89%96%E6%9E%90Handler%E6%9C%BA%E5%88%B6/#handler","title":"Handler \u7684\u6784\u9020\u65b9\u6cd5","text":"<p>\u6211\u4eec\u4eceHandler\u521d\u59cb\u5316\u5f00\u59cb\uff0c\u4ece\u6784\u9020\u65b9\u6cd5\u5165\u53e3\uff0c\u770b\u770b\u5b83\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u505a\u4e86\u4ec0\u4e48\u64cd\u4f5c\u3002</p>"},{"location":"Android/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%89%96%E6%9E%90Handler%E6%9C%BA%E5%88%B6/#handler_1","title":"Handler\u53d1\u9001\u6d88\u606f\u7684\u6d41\u7a0b","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/","title":"\u6df1\u5165\u5206\u6790AsyncTask","text":"<ol> <li>\u4ec0\u4e48\u662fAsyncTask</li> </ol> <p>==AsyncTask \u5373 asynchronous task\uff0c\u5f02\u6b65\u4efb\u52a1==\u3002</p> <p>AsyncTask\u5b9e\u9645\u4e0a\u662f\u56f4\u7ed5Thread\u548cHandler\u8bbe\u8ba1\u7684\u4e00\u4e2a\u8f85\u52a9\u7c7b\uff0c\u5728\u5185\u90e8\u662f\u5bf9Thread\u548cHandler\u7684\u4e00\u79cd\u5c01\u88c5\u3002AsyncTask\u7684\u5f02\u6b65\u4f53\u73b0\u5728\u7531\u540e\u53f0\u7ebf\u7a0b\u8fdb\u884c\u8fd0\u7b97\uff08\u8bbf\u95ee\u7f51\u7edc\u7b49\u6bd4\u8f83\u8017\u65f6\u7684\u64cd\u4f5c\uff09\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u53d1\u5e03\u5230\u7528\u6237\u754c\u9762\u4e0a\u6765\u66f4\u65b0UI\uff0c\u4f7f\u7528AsyncTask\u4f7f\u5f97\u6211\u4e0d\u7528\u64cd\u4f5cThread\u548cHandler\u3002</p> <ol> <li>AsyncTask\u7684\u7b80\u5355\u4f7f\u7528</li> </ol> <pre><code>new AsyncTask&lt;String,String,String&gt;(){\n    //// \u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e2d\uff0c\u505a\u9884\u5907\u5de5\u4f5c/////\n    onPreExecute(){\n\n    }\n    // \u8fd0\u884c\u5728\u5b50\u7ebf\u7a0b\u4e2d\uff0c\u505a\u8017\u65f6\u64cd\u4f5c\n    String doingBackGround(String s){\n\n    }\n    // \u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e2d\uff0c\u8017\u65f6\u64cd\u4f5c\u5b8c\u6210\uff0c\u66f4\u65b0UI\n    onPostExecute(String s){\n\n    }\n\n}.execute(String);\n</code></pre> <p>AsyncTask\u7528\u6cd5\u6bd4\u8f83\u7b80\u5355\uff0cGoogle\u8bbe\u8ba1\u8fd9\u4e2a\u7c7b\u5c31\u662f\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u8fdb\u884c\u7c7b\u4f3cHandler\u8fd9\u6837\u7684\u5f02\u6b65\u64cd\u4f5c\u3002</p>"},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#asynctaskonpreexecuteonpostexecuteonpreexecuteonpostexecuteuionprogressupdateui","title":"\u5982\u4e0a\u4ee3\u7801\uff0c\u4e00\u822c\u4f7f\u7528AsyncTask\u53ea\u8981\u91cd\u5199\u91cc\u9762\u7684\u4e09\u4e2a\u65b9\u6cd5\uff0conPreExecute\u548conPostExecute\u4e0d\u662f\u62bd\u8c61\u65b9\u6cd5\uff0c\u4e0d\u662f\u5fc5\u987b\u5b9e\u73b0\uff0c\u5b9e\u73b0\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e00\u822c\u80fd\u8ba9\u4ee3\u7801\u7684\u903b\u8f91\u66f4\u52a0\u6e05\u6670\u3002onPreExecute\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e2d\uff0c\u505a\u4e00\u4e9b\u51c6\u5907\u5de5\u4f5c\u3002onPostExecute\u540c\u6837\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e2d\uff0c\u7528\u4e8e\u5728\u8017\u65f6\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u66f4\u65b0UI\u3002\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e2aonProgressUpdate\u65b9\u6cd5\uff0c\u7528\u4e8e\u5728\u540e\u53f0\u4efb\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u6765\u5b9e\u65f6\u5730\u66f4\u65b0UI\u3002","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#doingbackgroundasynctaskdoingbackgroundthread-handlerthreadrun","title":"doingBackGround\u5219\u662f\u62bd\u8c61\u65b9\u6cd5\uff0c\u5fc5\u987b\u5b9e\u73b0\uff0c\u6211\u4eec\u4f7f\u7528AsyncTask\u65f6\u5e0c\u671b\u5c06\u4e00\u4e9b\u8017\u65f6\u64cd\u4f5c\u653e\u5728\u5b50\u7ebf\u7a0b\u4e2d\uff0cdoingBackGround\u4e2d\u903b\u8f91\u5c31\u76f8\u5f53\u4e8e\u6211\u4eec\u5728Thread-Handler\u4e2dThread\u4e2d\u7684run\u65b9\u6cd5\u4e2d\u5b9e\u73b0\u7684\u903b\u8f91\u3002","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#execute","title":"execute\u65b9\u6cd5\u7528\u4e8e\u542f\u52a8\u6267\u884c\u4efb\u52a1","text":"<ol> <li>\u4ece\u6e90\u7801\u89d2\u5ea6\u770bAsyncTask\u7684\u8bbe\u8ba1 \u63a5\u4e0b\u6765\u8fdb\u5165\u8fd9\u7bc7\u6587\u7ae0\u7684\u91cd\u70b9\uff0c\u6211\u4eec\u4ece\u6e90\u7801\u89d2\u5ea6\u6765\u5206\u6790AsyncTask\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u3002 </li> </ol> <pre><code>public final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) {\n        return executeOnExecutor(sDefaultExecutor, params);\n    }\n</code></pre> <p>\u4e0a\u9762\u662fexecute\u65b9\u6cd5\uff0c\u53d1\u73b0execute\u5176\u5b9e\u5185\u90e8\u8c03\u7528\u7684executeOnExecutor\u65b9\u6cd5\uff0c\u8c03\u7528executeOnExecutor\u65b9\u6cd5\u4f20\u9012\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd9\u91cc\u7b2c\u4e00\u4e2a\u4f20\u9012\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u6267\u884c\u5668\uff0c\u5173\u4e8e\u8fd9\u4e2asDefaultExecutor\u6211\u4eec\u518d\u6765\u8bb2\uff0c\u6211\u4eec\u73b0\u5728\u6765\u770bAsyncTask\u7684\u6d41\u7a0b\u8bbe\u8ba1\u3002</p> <p>\u6211\u4eec\u6765\u770b\u8fd9\u4e2aexecuteOnExecutor\u65b9\u6cd5,\u8fd9\u91cc\u5c06\u4e0d\u91cd\u8981\u7684\u4ee3\u7801\u7565\u53bb\u4e86\uff0c\u5176\u5b9e\u8fd9\u91cc\u9762\u7684\u903b\u8f91\u6bd4\u8f83\u6e05\u6670\u3002</p> <pre><code> public final AsyncTask&lt;Params, Progress, Result&gt; executeOnExecutor(Executor exec,\n            Params... params) {\n        .....\n        .....\n\n        mStatus = Status.RUNNING;\n        ////////////////////////////////\n        // \u7b2c\u4e00\u6b65\uff1a\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u6267\u884c\u51c6\u5907\u64cd\u4f5c////\n        onPreExecute();\n        // \u7b2c\u4e8c\u6b65\uff1a\u628aparams\u53c2\u6570\u8d4b\u503c\u7ed9mWorker\n        mWorker.mParams = params;\n        // \u7b2c\u4e09\u6b65\uff1a\u7528\u7ebf\u7a0b\u6c60\u6267\u884cmFuture\n        exec.execute(mFuture);\n        ///////////////////////\n        return this;\n    }\n</code></pre> <p>\u7b2c\u4e00\u6b65\uff0conPreExecute\u4e0e\u4e0a\u9762\u7684\u4ecb\u7ecd\u4e00\u6837\uff0c\u8fdb\u884c\u51c6\u5907\u5de5\u4f5c\uff0c\u8fd9\u4e2a\u5c31\u6ca1\u6709\u5fc5\u8981\u5206\u6790\uff0c\u5982\u679c\u6211\u4eec\u6ca1\u6709\u91cd\u5199\uff0c\u5c31\u4e0d\u4f1a\u505a\u76f8\u5173\u7684\u51c6\u5907\u3002\u6211\u4eec\u4e3b\u8981\u7b2c\u4e8c\u6b65\u548c\u7b2c\u4e09\u6b65\uff0c\u7b2c\u4e8c\u6b65\uff0c\u628aparams\u53c2\u6570\u8d4b\u503c\u7ed9mWorker\uff0cparams\u662fexecute\u4e2d\u4f20\u9012\u8fc7\u6765\u7684\u53c2\u6570\uff0c\u540c\u65f6\u4e5f\u662f\u6cdb\u578b\u4e2d\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u5c06params\u8d4b\u503c\u7ed9mWorker\uff0c\u90a3\u4e48mWorker\u662f\u4ec0\u4e48\u5462\uff1f</p> <pre><code>public AsyncTask() {\n        mWorker = new WorkerRunnable&lt;Params, Result&gt;() {\n            public Result call() throws Exception {\n               .....\n            }\n        };\n\n        mFuture = new FutureTask&lt;Result&gt;(mWorker) {\n            @Override\n            protected void done() {\n               .....\n            }\n        };\n    }\n</code></pre> <p>\u9996\u5148\uff0cmWorker\u5728\u6784\u9020\u65b9\u6cd5\u4e2d\u521b\u5efa\uff0c\u5b83\u662f\u4e00\u4e2a\u533f\u540d\u5185\u90e8\u7c7b\uff0c\u90a3WorkerRunnable\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\u5462\uff1f</p> <pre><code> private static abstract class WorkerRunnable&lt;Params, Result&gt; implements Callable&lt;Result&gt; {\n        Params[] mParams;\n    }\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0WorkerRunnable\u5176\u5b9e\u5c31\u662f\u4e00\u4e2aCallable\uff0c\u540c\u65f6\u5728execute\u65b9\u6cd5\u4e2dmFuture\u4e5f\u5728\u8fd9\u91cc\u521b\u5efa\u4e86\u51fa\u6765\uff0c\u8fd9\u91cc\u4f1a\u5c06mWorker\u4f20\u9012\u5230FutureTask\u4e2d\u53bb\uff0c\u90a3\u4e48\u5c06mFuture\u4f20\u8fdb\u53bb\u505a\u4e86\u4ec0\u4e48\u4ec0\u4e48\u64cd\u4f5c\u5462\uff1f</p> <pre><code> public FutureTask(Callable&lt;V&gt; callable) {\n        if (callable == null)\n            throw new NullPointerException();\n        //////\u8fd9\u91cc\u5c06mWorker\u4f20\u9012\u8fdb\u6765\uff0c\u5176\u5b9e\u5c31\u662fcallable///\n        /////////////\n        this.callable = callable;\n        this.state = NEW;       // ensure visibility of callable\n    }\n</code></pre> <p>FutureTask\u662fjava.util.concurrent\uff0cFutureTask\u7ee7\u627f\u4e86Future\uff0c\u901a\u8fc7 Future \u63a5\u53e3\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u53d6\u6d88\u5c1a\u672a\u5b8c\u6210\u7684\u4efb\u52a1\uff0c\u67e5\u8be2\u4efb\u52a1\u5df2\u7ecf\u5b8c\u6210\u8fd8\u662f\u53d6\u6d88\u4e86\uff0c\u4ee5\u53ca\u63d0\u53d6\uff08\u6216\u7b49\u5f85\uff09\u4efb\u52a1\u7684\u7ed3\u679c\u503c\u3002</p> <p>\u5728AsyncTask\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u5c06mWorker\u4f20\u8fdb\u6765\uff0c\u5373\u5c06callable\u4f20\u8fdb\u6765\uff0c\u56e0\u4e3amWorker\u5c31\u662fcallable\u3002</p> <p>\u8fd9\u6837\u5728\u4e0a\u9762\u7684executeOnExecutor\u4e2d\u7684\u7b2c\u4e09\u6b65\u4e2d\uff0c==exec.execute(mFuture)== \u7528\u7ebf\u7a0b\u6c60\u6765\u6267\u884cmFuture\uff0c\u5176\u5b9e\u5c31\u662f\u6267\u884cmFuture\u4e2d\u7684run\u65b9\u6cd5\uff0c\u6211\u4eec\u6765\u770bFutureTask\u4e2d\u7684run\u65b9\u6cd5\uff1a</p> <pre><code> public void run() {\n        if (state != NEW ||\n            !UNSAFE.compareAndSwapObject(this, runnerOffset,\n                                         null, Thread.currentThread()))\n            return;\n        try {\n            Callable&lt;V&gt; c = callable;\n            if (c != null &amp;&amp; state == NEW) {\n                V result;\n                boolean ran;\n                try {\n                   //\u2460 \u8c03\u7528callable\u4e2d\u7684call\u65b9\u6cd5\uff0c\u5176\u5b9e\u5c31\u662fmWorker\u4e2d\u7684call\u65b9\u6cd5\n                   //\u5e76\u4e14\u5c06\u7ed3\u679c\u8d4b\u503c\u7ed9result\n                    result = c.call();\n                    ran = true;\n                } catch (Throwable ex) {\n                    result = null;\n                    ran = false;\n                    setException(ex);\n                }\n                if (ran)\n                    //\u2461 \u8c03\u7528\u81ea\u5df1\u5185\u90e8\u7684set\u65b9\u6cd5\u8bbe\u7f6e\u7ed3\u679c\n                    set(result);\n            }\n        } finally {\n            // runner must be non-null until state is settled to\n            // prevent concurrent calls to run()\n            runner = null;\n            // state must be re-read after nulling runner to prevent\n            // leaked interrupts\n            int s = state;\n            if (s &gt;= INTERRUPTING)\n                handlePossibleCancellationInterrupt(s);\n        }\n    }\n</code></pre> <p>\u5728FutureTask\u4e2d\u7684run\u65b9\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u5173\u6ce8\u4e24\u4e2a\u5730\u65b9\uff0c\u7b2c\u4e00\u4e2a\uff0c\u5c31\u662f\u4e0a\u9762\u4ee3\u7801\u7247\u6bb5\u7684\u2460\u5904\uff0c\u8fd9\u91cc\u8c03\u7528\u4e86mWorker\u4e2d\u7684call\u65b9\u6cd5\uff0c\u8fd9\u6837\u6211\u4eec\u518d\u56de\u5934\u6765\u770bmWorker\u4e2d\u7684call\u65b9\u6cd5\u3002</p> <pre><code>mWorker = new WorkerRunnable&lt;Params, Result&gt;() {\n            public Result call() throws Exception {\n                mTaskInvoked.set(true);\n\n                Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);\n                //noinspection unchecked\n                return postResult(doInBackground(mParams));\n            }\n        };\n</code></pre> <pre><code> private Result postResult(Result result) {\n        @SuppressWarnings(\"unchecked\")\n        Message message = sHandler.obtainMessage(MESSAGE_POST_RESULT,\n                new AsyncTaskResult&lt;Result&gt;(this, result));\n        message.sendToTarget();\n        return result;\n    }\n</code></pre> <p>\u5728mWorker\u4e2dcall\u65b9\u6cd5\u4e2d\u4e3b\u8981\u5c31\u662f\u6267\u884c\u8017\u65f6\u64cd\u4f5c\uff0c\u6b63\u662fdoInBackground\u65b9\u6cd5\uff0c\u5e76\u4e14\u5c06\u6267\u884c\u7684\u7ed3\u679cresult\u8fd4\u56de\u56de\u53bb\uff0c\u7528postResult\u5bf9doInBackground\u8fdb\u884c\u5305\u88f9\u5219\u662f\u4e3a\u4e86\u8fd0\u7528Handler\u673a\u5236\u6765\u66f4\u65b0UI\u3002 \u63a5\u4e0b\u6765\u6211\u4eec\u770bFutureTask\u4e2drun\u65b9\u6cd5\u4e2d\u7684\u2461\u5904\uff0c\u8c03\u7528\u4e86FutureTask\u81ea\u5df1\u7684set\u65b9\u6cd5\u3002</p> <pre><code>protected void set(V v) {\n        if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n            outcome = v;\n            UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state\n            finishCompletion();\n        }\n    }\n</code></pre> <pre><code> private void finishCompletion() {\n        // assert state &gt; COMPLETING;\n        for (WaitNode q; (q = waiters) != null;) {\n            if (UNSAFE.compareAndSwapObject(this, waitersOffset, q, null)) {\n                for (;;) {\n                    Thread t = q.thread;\n                    if (t != null) {\n                        q.thread = null;\n                        LockSupport.unpark(t);\n                    }\n                    WaitNode next = q.next;\n                    if (next == null)\n                        break;\n                    q.next = null; // unlink to help gc\n                    q = next;\n                }\n                break;\n            }\n        }\n        //\u2460 \u8c03\u7528\u4e86FutureTask\u4e2d\u7684done\u65b9\u6cd5\n        done();\n\n        callable = null;        // to reduce footprint\n    }\n</code></pre> <p>\u7531set\u65b9\u6cd5\uff0c\u8c03\u7528finishCompletion\uff0c\u4e3b\u8981\u770bfinishCompletion\u7684\u903b\u8f91\uff0c\u6211\u4eec\u53ea\u5173\u6ce8finishCompletion\u4ee3\u7801\u7684\u2460\u5904\uff0c\u8fd9\u91cc\u8c03\u7528\u4e86done\u65b9\u6cd5\uff0c \u8fd9\u6837\u6211\u4eec\u6765\u770bdone\u65b9\u6cd5\u4e2d\u7684\u903b\u8f91\u3002</p> <pre><code>mFuture = new FutureTask&lt;Result&gt;(mWorker) {\n            @Override\n            protected void done() {\n                try {\n                    postResultIfNotInvoked(get());\n                } catch (InterruptedException e) {\n                    android.util.Log.w(LOG_TAG, e);\n                } catch (ExecutionException e) {\n                    throw new RuntimeException(\"An error occured while executing doInBackground()\",\n                            e.getCause());\n                } catch (CancellationException e) {\n                    postResultIfNotInvoked(null);\n                }\n            }\n        };\n</code></pre> <p>\u5728Future\u4e2d\u8c03\u7528\u4e86postResultIfNotInvoked\uff0c\u5176\u5b9e\u8fd9\u91cc\u5c06\u8fd9\u6bb5\u5904\u7406\u903b\u8f91\u62bd\u53d6\u5230\u65b9\u6cd5\u4e2d\u53bb\u4e86\uff0c\u5728android2.3\u5373\u4ee5\u524d\u7684\u6e90\u7801\u90fd\u662f\u6ca1\u6709\u62bd\u53d6\u7684\uff0c\u8fd9\u4e5f\u662f\u4f7f\u5f97\u73b0\u5728\u7684\u903b\u8f91\u66f4\u52a0\u6e05\u6670\u3002 ==java.util.concurrent.atomic.AtomicBoolean \uff08 \u5728\u8fd9\u4e2aBoolean\u503c\u7684\u53d8\u5316\u7684\u65f6\u5019\u4e0d\u5141\u8bb8\u5728\u4e4b\u95f4\u63d2\u5165\uff0c\u4fdd\u6301\u64cd\u4f5c\u7684\u539f\u5b50\u6027==\uff09 \u7531\u4e8e\u5728mWorker\u4e2d\u7684call\u548c\u5728mFuture\u7684done\u65b9\u6cd5\u90fd\u4f1a\u8c03\u7528postResult\u6765\u66f4\u65b0UI\uff0c\u7531\u4e8e\u662f\u7ebf\u7a0b\u64cd\u4f5c\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u5148\u540e\u987a\u5e8f\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528AtomicBoolean\u6765\u4fdd\u6301\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u3002\u5176\u5b9e\u57282.3\u4e0a\u7684\u4ee3\u7801\u4e0d\u662f\u8fd9\u6837\u5904\u7406\u7684\uff0c2.3\u4e0a\u5c06\u66f4\u65b0UI\u7684\u64cd\u4f5c\u90fd\u653e\u5728mFuture\u4e2d\u7684done\u65b9\u6cd5\u4e2d\u3002</p> <pre><code>private void postResultIfNotInvoked(Result result) {\n        final boolean wasTaskInvoked = mTaskInvoked.get();\n        if (!wasTaskInvoked) {\n            postResult(result);\n        }\n    }\n</code></pre> <p>\u6700\u540e\uff0c\u6211\u4eec\u6765\u770bpostResult\u65b9\u6cd5\u3002</p> <pre><code>  private Result postResult(Result result) {\n        @SuppressWarnings(\"unchecked\")\n        Message message = sHandler.obtainMessage(MESSAGE_POST_RESULT,\n                new AsyncTaskResult&lt;Result&gt;(this, result));\n        message.sendToTarget();\n        return result;\n    }\n</code></pre> <p>\u8fd9\u91cc\u5c31\u662f\u6211\u4eec\u975e\u5e38\u719f\u6089\u7684\u4ee3\u7801\u4e86\uff0c\u4f7f\u7528Message\u53d1\u9001\u6d88\u606f\u7ed9Handler\u6765\u66f4\u65b0UI\u3002 \u5728AsyncTask\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2aInternalHandler\uff0c\u5982\u679c\u8017\u65f6\u64cd\u4f5c\u6267\u884c\u5b8c\u6bd5\uff0c\u5c31\u4f1a\u6267\u884cfinish(result.mData[0])\uff0c\u5982\u679c\u7ed3\u679c\u6b63\u5728\u6267\u884c\uff0c\u5219\u4f1aonProgressUpdate\u6765\u66f4\u65b0\u8fdb\u5ea6\uff0c\u8fd9\u4e2aonProgressUpdate\u6b63\u662f\u6211\u4eec\u524d\u9762\u8bf4\u5230\u7684\u9700\u8981\u5b9e\u73b0\u7684\u66f4\u65b0\u8fdb\u5ea6\u7684\u65b9\u6cd5\u3002</p> <pre><code>private static class InternalHandler extends Handler {\n        @SuppressWarnings({\"unchecked\", \"RawUseOfParameterizedType\"})\n        @Override\n        public void handleMessage(Message msg) {\n            AsyncTaskResult result = (AsyncTaskResult) msg.obj;\n            switch (msg.what) {\n                case MESSAGE_POST_RESULT:\n                    // There is only one result\n                    result.mTask.finish(result.mData[0]);\n                    break;\n                case MESSAGE_POST_PROGRESS:\n                    result.mTask.onProgressUpdate(result.mData);\n                    break;\n            }\n        }\n    }\n</code></pre> <p>AsyncTaskResult\u7c7b\u7684\u53ea\u662f\u4e00\u4e2a\u5c01\u88c5</p> <pre><code>  @SuppressWarnings({\"RawUseOfParameterizedType\"})\n    private static class AsyncTaskResult&lt;Data&gt; {\n        final AsyncTask mTask;\n        final Data[] mData;\n\n        AsyncTaskResult(AsyncTask task, Data... data) {\n            mTask = task;\n            mData = data;\n        }\n    }\n</code></pre> <pre><code>private void finish(Result result) {\n        if (isCancelled()) {\n            onCancelled(result);\n        } else {\n            //////\u8017\u65f6\u64cd\u4f5c\u6267\u884c\u5b8c\u6bd5\uff0c\u66f4\u65b0UI///////////\n            //onPostExecute\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\n            onPostExecute(result);\n            //////////////////////////////////////////\n        }\n        mStatus = Status.FINISHED;\n    }\n</code></pre>"},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#asynctaskexecute","title":"AsyncTask\u7684execute\u65b9\u6cd5","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#asynctask","title":"AsyncTask\u7684\u6784\u9020\u65b9\u6cd5","text":"<p>\u6211\u4eec\u7ee7\u7eed\u770b\u6e90\u7801:\u4e3b\u610f\u5230mWorker\u662f\u5728AsyncTask\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\u521b\u5efa\u7684\u3002</p>"},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#futuretaskrun","title":"FutureTask\u4e2d\u7684run\u65b9\u6cd5","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#_1","title":"\u6df1\u5165\u5206\u6790AsyncTask","text":"<p>\u8fd9\u6837\u6211\u4eec\u5173\u4e8eAsyncTask\u7684\u6d41\u7a0b\u7ec8\u4e8e\u8d70\u901a\u4e86\uff0c\u4e3a\u4ec0\u4e48onPreExecute\u548conPostExecute\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\uff0c\u800cdoingBackGround\u4e3a\u4ec0\u4e48\u8fd0\u884c\u5728\u5b50\u7ebf\u7a0b\u4e2d\uff0c\u8fd9\u4e2a\u903b\u8f91\u662f\u4e0d\u662f\u5c31\u53d8\u5f97\u6e05\u6670\u4e86\u3002\u4e0a\u9762\u8d34\u4e86\u597d\u591a\u4ee3\u7801\uff0c\u4e00\u76f4\u90fd\u662f\u5728\u5206\u6790\u4ee3\u7801\u7684\u610f\u601d\uff0c\u81f3\u4e8e\u5173\u4e8e\u8bbe\u8ba1\u7684\u601d\u60f3\u611f\u89c9\u73b0\u5728\u7684\u81ea\u5df1\u8fd8\u4f53\u609f\u4e0d\u591f\u3002</p> <ol> <li>AsyncTask\u5728\u4e0a\u9762\u9057\u7559\u7684\u95ee\u9898 \u5173\u4e8eAsyncTask\u4e2dexecuteOnExecutor\u4e2d\u7684sDefaultExecutor</li> </ol> <p>\u9879\u76ee\u4e2d\u95ee\u9898\u573a\u666f\uff1a</p> <p>\u64cd\u4f5c\u6b65\u9aa4&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; - \u8bbe\u7f6e\u5b89\u5168\u4e2d\uff0c\u9009\u62e9\u6307\u7eb9\u3002 - \u89e3\u9501\u65b9\u5f0f\u9009\u62e9\u56fe\u6848\u3002 - \u5728\u9009\u62e9\u60a8\u7684\u56fe\u6848\u754c\u9762\uff0c\u70b9\u51fb\u786e\u5b9a\uff0c\u9700\u8981\u4e09\u5230\u4e94\u79d2\u624d\u80fd\u8df3\u8f6c\u5230\u4e0b\u4e00\u754c\u9762\u3002</p> <p>\u95ee\u9898\u5206\u6790\uff1a\u5728\u8bbe\u7f6e\u89e3\u9501\u65b9\u5f0f\u4e3a\u4e3a\u56fe\u6848\u65f6\uff0c\u7b2c\u4e8c\u6b21\u7ed8\u5236\u56fe\u6848\u540e\uff0cSettings\u6e90\u7801\u4e2d\u4f7f\u7528\u4e86AsyncTask\u6765\u5c06\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684\u9a8c\u8bc1\u64cd\u4f5c\u653e\u5728\u5b50\u7ebf\u7a0b\u4e2d\u53bb\u5904\u7406(\u53c2\u770b\u4e0b\u9762\u7684\u90e8\u5206\u4ee3\u7801)\uff0c\u7531\u4e8eandroid\u539f\u751f\u8bbe\u8ba1\u662f\u4f7f\u7528 AsyncTask\u4e2d\u7684\u4e00\u4e2a\u53c2\u6570\u7684\u65b9\u6cd5\uff0c\u4e00\u4e2a\u53c2\u6570\u7684\u65b9\u6cd5\u91c7\u7528\u7684\u662f\u9ed8\u8ba4\u7684\u6267\u884c\u5668\uff0c\u5373\u4e32\u884c\u6267\u884c\u5668</p> <p>==frameworks/base/core/java/com/android/internal/widget/LockPatternChecker.java==</p> <pre><code>public static AsyncTask&lt;?, ?, ?&gt; verifyPattern(final LockPatternUtils utils,\n            final List&lt;LockPatternView.Cell&gt; pattern,\n            final long challenge,\n            final int userId,\n            final OnVerifyCallback callback) {\n        AsyncTask&lt;Void, Void, byte[]&gt; task = new AsyncTask&lt;Void, Void, byte[]&gt;() {\n            private int mThrottleTimeout;\n            @Override\n            protected byte[] doInBackground(Void... args) {\n                try {\n                    return utils.verifyPattern(pattern, challenge, userId);\n                } catch (RequestThrottledException ex) {\n                    mThrottleTimeout = ex.getTimeoutMs();\n                    return null;\n                }\n            }\n            @Override\n            protected void onPostExecute(byte[] result) {\n                callback.onVerified(result, mThrottleTimeout);\n            }\n        };\n        ////////////\u9ed8\u8ba4\u4f7f\u7528\u7684\u4e32\u884c\u7684\u6267\u884c\u5668//////////////\n        task.execute();\n        ///////////////////////////////////////////////\n        return task;\n    }\n</code></pre> <pre><code>public static final Executor SERIAL_EXECUTOR = new SerialExecutor();\nprivate static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR;\n</code></pre> <pre><code>private static class SerialExecutor implements Executor {\n        final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;();\n        Runnable mActive;\n\n        public synchronized void execute(final Runnable r) {\n            mTasks.offer(new Runnable() {\n                public void run() {\n                    try {\n                        r.run();\n                    } finally {\n                        scheduleNext();\n                    }\n                }\n            });\n            if (mActive == null) {\n                scheduleNext();\n            }\n        }\n\n        protected synchronized void scheduleNext() {\n            if ((mActive = mTasks.poll()) != null) {\n                THREAD_POOL_EXECUTOR.execute(mActive);\n            }\n        }\n    }\n</code></pre> <p>\u5982\u679cexecuteOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR,params)\u5219\u4e0d\u4e00\u6837\u3002</p> <pre><code> /**\n     * An {@link Executor} that can be used to execute tasks in parallel.\n     */\n    public static final Executor THREAD_POOL_EXECUTOR\n            = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE,\n                    TimeUnit.SECONDS, sPoolWorkQueue, sThreadFactory);\n</code></pre> <p>SerialExecutor\u662f\u6309\u987a\u5e8f\u6267\u884c\uff0cTHREAD_POOL_EXECUTOR\u5219\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u80fd\u4fdd\u8bc1\u5e76\u884c\u6267\u884c\u3002</p> <p>\u4ee5\u4e0a\u5c31\u662f\u5173\u4e8eAsyncTask\u7684\u5168\u90e8\u5185\u5bb9\uff0c\u5e0c\u671b\u80fd\u5bf9\u4f60\u6709\u4e9b\u5e2e\u52a9\uff0c\u8d34\u4e86\u597d\u591a\u6e90\u7801\uff0c\u5982\u679c\u60f3\u771f\u6b63\u5f04\u6e05\u695a\uff0c\u8fd8\u662f\u5f97\u81ea\u5df1\u53bb\u9605\u8bfb\u9605\u8bfb\u6e90\u7801\uff0c\u6574\u7406\u8fd9\u4e2a\u4e5f\u4e0d\u5bb9\u6613\uff0c\u524d\u524d\u540e\u540e\u82b1\u4e86\u5927\u6982\u4e00\u4e2a\u661f\u671f\u3002 \u6700\u540e\u662fAsyncTask\u7684\u65f6\u5e8f\u56fe\uff0c\u753b\u7684\u4e0d\u592a\u597d\uff0c\u51d1\u5408\u770b\u5427\uff0cO(\u2229_\u2229)O\u54c8\u54c8~ </p>"},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#serialexecutorserialexecutorasynctaskasynctaskexecutor","title":"\u6211\u4eec\u53d1\u73b0SerialExecutor\u5373\u662f\u4e32\u884c\u6267\u884c\u5668\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u4fdd\u8bc1\u4efb\u52a1\u6267\u884c\u7684\u987a\u5e8f\uff0c\u4e5f\u5c31\u662f\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u63d0\u4ea4\u7684\u4efb\u52a1\u786e\u5b9e\u662f\u6309\u7167\u5148\u540e\u987a\u5e8f\u6267\u884c\u7684\u3002\u5b83\u7684\u5185\u90e8\u6709\u4e00\u4e2a\u961f\u5217\u7528\u6765\u4fdd\u5b58\u6240\u63d0\u4ea4\u7684\u4efb\u52a1\uff0c\u4fdd\u8bc1\u5f53\u524d\u53ea\u8fd0\u884c\u4e00\u4e2a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4efb\u52a1\u662f\u5b8c\u5168\u6309\u7167\u987a\u5e8f\u6267\u884c\u7684\u3002\u5982\u679c\u53d1\u73b0\u5f02\u6b65\u4efb\u52a1\u8fd8\u672a\u6267\u884c\uff0c\u53ef\u80fd\u88ab\u6211\u4eec\u53d1\u73b0SerialExecutor\u5373\u662f\u4e32\u884c\u6267\u884c\u5668\u987a\u5e8f\u7684\u4f7f\u7528\u7ebf\u7a0b\u6267\u884c\u3002\u56e0\u4e3a\u5e94\u7528\u4e2d\u53ef\u80fd\u8fd8\u6709\u5176\u4ed6\u5730\u65b9\u4f7f\u7528AsyncTask\uff0c\u6240\u4ee5\u5230\u6211\u4eec\u7684AsyncTask\u4e5f\u8bb8\u4f1a\u7b49\u5f85\u5230\u5176\u4ed6\u4efb\u52a1\u90fd\u5b8c\u6210\u65f6\u624d\u5f97\u4ee5\u6267\u884c\u800c\u4e0d\u662f\u8c03\u7528executor()\u4e4b\u540e\u9a6c\u4e0a\u6267\u884c\u3002","text":""},{"location":"Android/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90AsyncTask/#apithread_pool_executorcorepoolsizecpu","title":"API\u4e2d\u7684\u89e3\u91ca\uff1a\u80fd\u591f\u5e76\u884c\u7684\u6267\u884c\u4efb\u52a1\u3002THREAD_POOL_EXECUTOR\u662f\u4e00\u4e2a\u6570\u91cf\u4e3acorePoolSize\u7684\u7ebf\u7a0b\u6c60\uff0c\u5177\u4f53\u7ebf\u7a0b\u6c60\u7684\u6570\u91cf\u662f\u4f9d\u636eCPU\u7684\u6838\u5fc3\u6765\u8bbe\u7f6e\u7684\uff0c\u5982\u679c\u8d85\u8fc7\u8fd9\u4e2a\u6570\u91cf\u7684\u7ebf\u7a0b\u4e2a\u6570\u5c31\u9700\u8981\u7b49\u5f85","text":""},{"location":"Android/Activity/Activity%E6%B3%84%E9%9C%B2%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%AF%8A%E6%96%AD/","title":"Activity\u6cc4\u9732\u53d1\u73b0\u4e0e\u8bca\u65ad","text":"<p>ADT\u63d2\u4ef6</p> <p>\u53d1\u73b0 Activity \u6cc4\u9732\u7684\u4e09\u79cd\u79cd\u65b9\u6cd5:</p> <ol> <li>\u901a\u8fc7StrictMode\u6a21\u5f0f\u6765\u53d1\u73b0\uff0c\u5982\u679c\u6709Activity\u6cc4\u9732\u76f4\u63a5\u4f1a\u95ea\u9000\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u6709\u65f6\u8fc7\u4e8e\u4e25\u683c\u4e86\uff0c\u4f1a\u628a\u4e00 \u4e9b\u5ef6\u8fdf\u91ca\u653e Activity \u7684\u573a\u666f\u4e5f\u7b97\u5728\u5185; \u5f00\u542f StrictMode \u9700\u8981\u5728 BaseActicity.onCreate() \u52a0\u4e0a:StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder().detectAll().penaltyLog().penaltyDeath().build());</li> <li> <p>\u4f7f\u7528LeakCanary</p> </li> <li> <p>\u901a\u8fc7 adb shell dumpsys meminfo \u548c ddms \u6765\u786e\u5b9a\u6cc4\u9732\u6e90\uff0c\u8fd9\u79cd\u65b9\u6cd5\u66f4\u7cbe\u786e\uff0c\u4e00\u822c\u7528\u4e8e\u7b2c\u4e00\u79cd\u65b9\u6cd5\u53d1\u73b0 \u5177\u4f53\u7684\u53ef\u7591 Activity \u6cc4\u9732\uff0c\u7136\u540e\u518d\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\u518d\u7cbe\u786e\u5b9a\u4f4d\u95ee\u9898\u3002</p> </li> </ol> <p>\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u4e00\u4e0b\u65b9\u6cd5 3 \u7684\u5177\u4f53\u6d41\u7a0b\uff1a</p> <p>\u4f8b\u5b50\u7684\u573a\u666f:\u7531\u4e8e\u5c0f\u7c73\u7cfb\u7edf\u9996\u6b21\u542f\u52a8\u8054\u7cfb\u4eba(PeopleActivity)\u7684\u901f\u5ea6\u7279\u522b\u6162\uff0c\u6240\u4ee5\u6211\u4eec\u91c7\u7528\u4e86\u9884\u52a0\u8f7d\u7684\u6280 \u672f\uff0c\u5728 Application.onCreate \u542f\u52a8\u4e86 PreloadPeopleActivity\uff0c\u4e4b\u540e\u7528\u6237\u5728\u8fdb\u5165 PeopleActivity \u65f6\uff0c PreloadPeopleActivity \u4f1a\u81ea\u52a8 finish\u3002</p> <ol> <li>\u70b9\u51fb\u8054\u7cfb\u4eba PeopleActivity\uff0c\u7136\u540e\u6253\u5f00 ddms , \u627e\u5230\u5bf9\u5e94\u7684\u8fdb\u7a0b com.miui.miuilite:csp\uff0c\u8fdb\u5165\u8fdb\u7a0b\u5bf9\u5e94\u7684 heap \u89c6\u56fe\uff0c\u7136\u540e\u70b9\u51fb\u53f3\u8fb9\u7684\"Cause GC\"\u6765\u624b\u52a8\u89e6\u53d1\u8fdb\u7a0b\u7684 gc \u3002</li> </ol> <p> 2. adb shell dumpsys meminfo com.miui.miuilite:csp</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230 Activities: 3</p> <p>\u8bf4\u660e\u5f53\u524d csp \u8fdb\u7a0b\u6709 3 \u4e2a Activity \u5b9e\u4f8b\uff0c\u800c\u6211\u4eec\u53ea\u542f\u52a8\u4e86 PeopleActivity\uff0c\u4e4b\u524d\u7684 PreloadActivity \u4e5f\u5df2\u7ecf finish\uff0c\u6240\u4ee5\u8fd9\u91cc\u80af\u5b9a\u6709 Activity \u6cc4\u9732!</p> <ol> <li>\u56de\u5230 ddms, Dump HPROF file\uff0c\u7136\u540e\u70b9\u51fb OOL\uff0c\u8f93\u5165 select * from instanceof android.app.Activity\uff0c\u70b9 \u51fb\u53f3\u4e0a\u89d2\u7ea2\u8272\u7684\u6267\u884c\u6309\u94ae\u5f97\u5230\u7ed3\u679c:</li> </ol> <p></p> <p>\u53ef\u4ee5\u770b\u5230 PreloadActivity \u6ca1\u6709\u91ca\u653e\uff0cPeopleActivity \u4e5f\u591a\u4e86\u4e00\u4efd\u5b9e\u4f8b\uff0c\u5148\u6765\u770b\u770b PreloadPeopleActivity \u4e3a\u4ec0 \u4e48\u6cc4\u9732\u3002</p> <ol> <li>\u53f3\u952e\u70b9\u51fb PreloadPeopleActivity --&gt; Merge Shortest Path to GC Roots --&gt; exclude weak/soft references</li> </ol> <p></p> <p>\u6cc4\u9732\u7684\u6839\u6e90:ProviderStatusWatcher \u7684 mContext \u5bf9\u8c61\u6293\u4f4f\u4e86 PreloadPeopleActivity</p> <p>\u4ee3\u7801\u4fee\u6539:</p> <pre><code>\nif(mIsPreload) { \n    // \u9884\u52a0\u8f7d\u65f6\n     mProviderStatusWatcher.setContext(getApplicationContext());\n}\n</code></pre> <ol> <li>\u9a8c\u8bc1\u7ed3\u679c\uff0c\u4fee\u6539\u540e\u91cd\u65b0\u8fdb\u5165\u8054\u7cfb\u4eba\u540e </li> </ol> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u6b21 Activities \u663e\u793a\u4e3a 1 \u4e2a\uff0c\u8bf4\u660e\u5df2\u7ecf\u6ca1\u6709\u6cc4\u9732\u4e86\u3002</p>"},{"location":"Android/Activity/Activity%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/","title":"Activity\u7684\u751f\u547d\u5468\u671f\u548c\u542f\u52a8\u6a21\u5f0f","text":""},{"location":"Android/Activity/Activity%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/#activity","title":"Activity\u7684\u751f\u547d\u5468\u671f","text":""},{"location":"Android/Activity/Activity%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/#application-contextactivitycrash","title":"\u95ee\u9898\uff1a\u4f7f\u7528Application Context\u542f\u52a8Activity\u4e3a\u4ec0\u4e48\u4f1acrash","text":"<p>\u793a\u4f8b\uff1a</p> <pre><code>val intent = Intent(this@MainActivity, SecondActivity::class.java)\napplicationContext.startActivity(intent)\n\n</code></pre> <p>Crash Log:</p> <pre><code>Caused by: android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?\n</code></pre> <p>\u539f\u56e0\u662f\uff0c\u88ab\u542f\u52a8Activity\u9ed8\u8ba4\u653e\u5728\u542f\u52a8\u5b83\u7684Activity\u6240\u5728\u7684\u6808\u3002Application Context\u6ca1\u6709Activity\u6808\uff0c\u6240\u4ee5\u4f1a\u5f02\u5e38\u3002</p> <p>\u89e3\u51b3\u65b9\u6848\u662f\uff0c\u4f7f\u7528<code>flag:FLAG_ACTIVITY_NEW_TASK</code>\uff0c\u8ba9\u88ab\u542f\u52a8Activity\u5904\u5728\u65b0\u5efa\u7684\u6808\u3002</p> <pre><code>val intent = Intent(this@MainActivity, SecondActivity::class.java)\nintent.flags = Intent.FLAG_ACTIVITY_NEW_TASK\napplicationContext.startActivity(intent)\n</code></pre>"},{"location":"Android/Activity/Activity%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F/#launchmodesingleinstance","title":"\u95ee\u9898\uff1a\u7c7b\u4f3c\u5fae\u535a\u5206\u4eab\u529f\u80fd\u9002\u5408\u7684launchMode\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u662fsingleInstance","text":"<p>\u5206\u4eab\u9875\u9762\u6709\u8df3\u8f6c\u5176\u4ed6\u9875\u9762\u6309\u94ae\uff0c\u70b9\u51fb\u8df3\u8f6c\u5176\u4ed6\u9875\u9762\uff0c\u5982\u679c\u4f7f\u7528singleInstance\uff0c\u70b9\u51fb\u56de\u9000\uff0c\u5c31\u56de\u4e0d\u5230\u5206\u4eab\u9875\u9762\u4e86\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0csingleInstance\u662f\u72ec\u5360\u4e00\u4e2a\u6808\u7684\u3002</p> <p>\u65e0\u8bba Dialog \u5f39\u51fa\u8986\u76d6\u9875\u9762\uff0c\u5bf9 Activity \u751f\u547d\u5468\u671f\u6ca1\u6709\u5f71\u54cd\uff0c\u53ea\u6709\u518d\u542f\u52a8\u53e6\u5916\u4e00\u4e2a Activity \u7684\u65f6\u5019\u624d\u4f1a\u8fdb\u5165 onPause \u72b6\u6001\uff0c\u800c\u4e0d\u662f\u60f3\u8c61\u4e2d\u7684\u88ab\u8986\u76d6\u6216\u8005\u4e0d\u53ef\u89c1.</p> <p>\u540c\u65f6\u901a\u8fc7 AlertDialog \u6e90\u7801\u6216\u8005 Toast \u6e90\u7801\u6211\u4eec\u90fd\u53ef\u4ee5\u53d1\u73b0\u5b83\u4eec\u5b9e\u73b0\u7684\u539f\u7406\u90fd\u662f windowmanager.addView();\u6765\u6dfb\u52a0\u7684\uff0c \u5b83\u4eec\u90fd\u662f\u4e00\u4e2a\u4e2a view ,\u56e0\u6b64\u4e0d\u4f1a\u5bf9 activity \u7684\u751f\u547d\u5468\u671f\u6709\u4efb\u4f55\u5f71\u54cd\u3002</p> <p>https://blog.csdn.net/cloud_castle/article/details/56011562</p>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/","title":"Android\u4e2d\u7684IPC\u673a\u5236","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#ipc","title":"\u4ec0\u4e48\u662fIPC","text":"<p>IPC\u662fInter-Process Communication\u7684\u7f29\u5c0f\uff0c\u542b\u4e49\u4e3a\u8fdb\u7a0b\u95f4\u901a\u4fe1\u6216\u8005\u8de8\u8fdb\u7a0b\u901a\u4fe1\uff0c\u662f\u6307\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#_1","title":"\u8fdb\u7a0b\u548c\u7ebf\u7a0b","text":"<p>\u8fdb\u7a0b\uff1a\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u7a0b\u5e8f\u3002\u5176\u5b9e\u8fdb\u7a0b\u5c31\u662f\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u5185\u5b58\u5206\u914d\u7a7a\u95f4\u3002 \u7ebf\u7a0b\uff1a\u5176\u5b9e\u5c31\u662f\u8fdb\u7a0b\u4e2d\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c\u63a7\u5236\u5355\u5143\uff0c\u4e00\u6761\u6267\u884c\u8def\u5f84\u3002 \u8fdb\u7a0b\u8d1f\u8d23\u7684\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u7a7a\u95f4\u7684\u6807\u793a\u3002\u7ebf\u7a0b\u8d1f\u8d23\u7684\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u6267\u884c\u987a\u5e8f\u3002</p>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#androrid","title":"Androrid\u4e2d\u7684\u591a\u8fdb\u7a0b\u6a21\u5f0f","text":"<p>Android\u7684\u56db\u5927\u7ec4\u4ef6\uff08Activity/Service/BroadcastReceiver/ContentProvider\uff09\u6ce8\u518c\u65f6\uff0c\u5982\u679c\u4f7f\u7528android:proces\u4fee\u9970\uff0c\u8bf4\u660e\u8be5\u7ec4\u4ef6\u521b\u5efa\u5728\u65b0\u7684\u8fdb\u7a0b\u4e2d\u3002</p> <p>android:process\uff1a\u4f5c\u7528\u662f\u8bbe\u7f6e\u8fdb\u7a0b\u540d\u79f0\u3002</p> <p>android:process \u4e24\u79cd\u58f0\u660e\u65b9\u5f0f\uff1a</p> <ul> <li> <p>android:process=\u201c:remote\"      \u4ee5\uff1a\u6253\u5934\u7684\u8fdb\u7a0b\u5c5e\u4e8e\u5f53\u524d\u5e94\u7528\u7684\u79c1\u6709\u8fdb\u7a0b\uff0c\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684\u7ec4\u4ef6\u4e0d\u53ef\u4ee5\u548c\u5b83\u8dd1\u5728\u540c\u4e00\u8fdb\u7a0b\u4e2d\u3002</p> </li> <li> <p>android:process=\u201ccom.utils.myapplication.user\"     \u4ee5\u5305\u540d\u5f62\u5f0f\u58f0\u660e\u7684\u8fdb\u7a0b\uff0c\u5c5e\u4e8e\u5168\u5c40\u8fdb\u7a0b\uff0c\u5176\u4ed6\u5e94\u7528\u53ef\u4ee5\u901a\u8fc7shareUserId\u65b9\u5f0f\u548c\u8be5\u8fdb\u7a0b\u8dd1\u5728\u540c\u4e00\u8fdb\u7a0b\u4e2d\uff0c\u4ece\u800c\u5206\u4eab\u5e94\u7528\u95f4\u7684\u79c1\u6709\u6570\u636e\u3002\u4f46\u662f\u8fd9\u4e24\u4e2a\u5e94\u7528\u7684\u7b7e\u540d\u8fd8\u5fc5\u987b\u76f8\u540c\uff0c\u624d\u80fd\u5171\u4eab\u79c1\u6709\u6570\u636e\uff0c\u6bd4\u5982data\u76ee\u5f55\u3001\u7ec4\u4ef6\u4fe1\u606f\u7b49\u3002</p> </li> </ul>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#_2","title":"\u4f7f\u7528\u591a\u8fdb\u7a0b\u7684\u95ee\u9898","text":"<ol> <li>\u9759\u6001\u6210\u5458\u548c\u5355\u4f8b\u6a21\u5f0f\u5931\u6548\uff1b</li> <li>\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\u5b8c\u5168\u5931\u6548\uff1b</li> <li>SharePreference\u53ef\u9760\u6027\u4e0b\u964d\uff1b</li> <li>Application\u4f1a\u591a\u6b21\u521b\u5efa\u3002</li> </ol>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#androidipc","title":"Android\u4e2d\u7684IPC\u65b9\u5f0f","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#bundle","title":"\u4f7f\u7528Bundle","text":"<p>Android\u4e2d\u56db\u5927\u7ec4\u4ef6\u4e2d\u7684\u4e09\u5927\u7ec4\u4ef6\u90fd\u662f\u652f\u6301\u5728Intent\u4e2d\u4f20\u9012Bundle\u6570\u636e\u7684\uff0c\u7531\u4e8eBundle\u4e8b\u5148\u4e86Parcelable\u63a5\u53e3\uff0c\u6240\u4ee5\u5b83\u53ef\u4ee5\u65b9\u4fbf\u5730\u5728\u4e0d\u540c\u7684\u8fdb\u7a0b\u95f4\u4f20\u8f93\u3002</p> <p>GitHub\u4e0a\u6709\u4e2a\u5173\u4e8e\u4f7f\u7528Bundle\u7684\u8ba8\u8bba\uff1aAndroid\u91cc\u9762\u4e3a\u4ec0\u4e48\u8981\u8bbe\u8ba1\u51faBundle\u800c\u4e0d\u662f\u76f4\u63a5\u7528Map\u7ed3\u6784</p>"},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#_3","title":"\u4f7f\u7528\u6587\u4ef6\u5171\u4eab","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#messenger","title":"\u4f7f\u7528Messenger","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#aidl","title":"\u4f7f\u7528AIDL","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#contentprovider","title":"\u4f7f\u7528ContentProvider","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#socket","title":"\u4f7f\u7528Socket","text":""},{"location":"Android/IPC/Android%E4%B8%AD%E7%9A%84IPC%E6%9C%BA%E5%88%B6/#add","title":"Add","text":"<p>\u8865\u5145\uff1a\u4e4b\u524d\u9047\u5230\u8fc7\u7684\u95ee\u9898\uff0c\u5728\u5e94\u7528Application\u4e2d\u5199\u5165SharedPreference\u65f6\uff0c\u5728\u591a\u8fdb\u7a0b\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u4f1a\u8d70Application\u7684\u521b\u5efa\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4\u8fdb\u7a0b\u95f4\u4f1a\u6709\u6570\u636e\u7684\u540c\u6b65\u95ee\u9898\uff0c\u8003\u8651\u5728\u5199\u5165Sp\u7684\u65f6\u5019\u5224\u65ad\u5f53\u524d\u7684\u8fdb\u7a0b\u3002</p>"},{"location":"Android/IPC/%E4%BD%BF%E7%94%A8%E8%BF%9B%E7%A8%8B%E5%AE%8C%E6%88%90%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/","title":"\u4f7f\u7528\u8fdb\u7a0b\u5b8c\u6210\u540e\u53f0\u4efb\u52a1","text":"<p>\u76f4\u63a5\u8fdb\u4e3b\u9898</p> <p>MIUI \u7cfb\u7edf\u4e2d\u6709\u5f88\u591a\u60f3\u5f55\u97f3\u673a\u3001\u6536\u97f3\u673a\u8fd9\u6837\u7684 app \u4ece\u4efb\u52a1\u4e0a\u6765\u5212\u5206\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u90e8\u5206\uff0c\u524d\u53f0 UI \u8d1f\u8d23\u4e0e\u7528\u6237 \u8fdb\u884c\u4ea4\u4e92\uff0c\u540e\u53f0 Service \u8d1f\u8d23\u5177\u4f53\u529f\u80fd\u5b9e\u73b0\u3002\u50cf\u8fd9\u6837\u7684 app\uff0c\u540e\u53f0\u7684\u529f\u80fd\u53ef\u80fd\u662f\u7528\u6237\u4f1a\u957f\u671f\u4f7f\u7528\u5e76\u4e00\u76f4\u5360\u7528\u7684\u4efb\u52a1\uff0c\u524d\u53f0\u7684 UI \u5f80\u5f80\u53ea\u662f\u63d0\u4f9b\u4e86\u4ea4\u4e92\u548c\u529f\u80fd\u7684\u5165\u53e3\uff0c\u5f53\u7528\u6237\u5f00\u542f\u4e86\u4efb\u52a1\u4e4b\u540e(\u6bd4\u5982\u5f00\u542f\u4e86 FM)\uff0c\u5c31\u53ef\u80fd\u76f4\u63a5\u628a\u524d\u53f0\u7684 Activity \u5173\u6389\uff0c\u53ea\u8ba9\u540e\u53f0\u7684 Service \u5b8c\u6210\u5176\u9700\u8981\u7684\u529f\u80fd\u3002\u4ece\u4f7f\u7528\u7684\u7cfb\u7edf\u8d44\u6e90\u4e0a\u6765\u5206\u6790\u8fd9\u4e24\u4e2a \u90e8\u5206:UI \u90e8\u5206\u4f1a\u5360\u7528\u5927\u91cf\u56fe\u7247\u3001View\u3001string \u7b49\u8d44\u6e90\uff0c\u8fd9\u4e9b\u8d44\u6e90\u90fd\u4f1a\u7f13\u5b58\u5728\u6574\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\uff0c\u800c Service \u53ef\u80fd\u4ec5\u4ec5\u7528\u5230\u4e00\u4e9b\u7cfb\u7edf Service Manager\u3001Receiver \u7b49\u4e00\u4e9b\u5f88\u8f7b\u7684\u7c7b\uff0c\u76f8\u6bd4 UI \u90e8\u5206\uff0cService \u5360\u7528\u7684\u5185\u5b58\u662f\u975e\u5e38\u5c0f\u7684\u3002\u800c\u5f53\u7528\u6237\u4f7f\u7528\u8fd9\u4e9b app \u7684\u65f6\u5019\u53ef\u80fd\u6839\u672c\u90fd\u4e0d\u9700\u8981 UI \u7684\u663e\u793a\uff0c\u6240\u4ee5\u63d0\u51fa\u4e86\u4e00\u4e2a\u5185\u5b58\u4f18\u5316\u7684\u60f3\u6cd5\uff1a\u5982\u679c\u80fd\u591f\u5728\u4f7f\u7528\u8fd9\u79cd\u529f\u80fd\u6027 app \u5e76\u81f3\u4e8e\u540e\u53f0\u7684\u65f6\u5019\u91ca\u653e\u6389\u6240\u6709\u7684 UI \u8d44\u6e90\uff0c\u90a3\u4e48\u8fd9\u4e2a app \u8fd0\u884c\u65f6 \u5c31\u80fd\u591f\u7701\u51fa\u5927\u91cf\u5185\u5b58\u3002</p> <p>\u600e\u6837\u624d\u80fd\u8fbe\u5230\u8fd9\u6837\u7684\u6548\u679c?\u5f53 Activity \u8c03\u7528 onDestroy \u7684\u65f6\u5019\uff0c\u8fd9\u4e2a app \u4f7f\u7528\u7684\u5185\u5b58\u5e76\u6ca1\u6709\u76f8\u5e94\u51cf\u5c0f\uff0cUI \u8d44\u6e90\u7684\u5f15\u7528\u662f\u5b58\u5728\u4e8e\u8fdb\u7a0b\u7684\u5185\u5b58\u4e2d\u7684\uff0c\u53ea\u6709\u6740\u6389\u8fd9\u4e2a\u8fdb\u7a0b\uff0c\u76f8\u5e94\u7684\u5185\u5b58\u8d44\u6e90\u624d\u80fd\u591f\u771f\u6b63\u5f97\u5230\u91ca\u653e\u3002\u6240\u4ee5\u73b0\u5728\u7684\u8bbe\u8ba1\u601d\u8def\u5c31\u662f\u5c06 UI \u4e0e Service \u5206\u6210\u4e24\u4e2a\u8fdb\u7a0b\uff0c\u5f53\u4e0d\u518d\u4f7f\u7528 UI \u7684\u65f6\u5019 UI \u6240\u5728\u7684\u8fdb\u7a0b\u76f4\u63a5\u9000\u51fa\uff0c\u6b63\u5728\u8fd0 \u884c\u7684\u4efb\u52a1\u4f1a\u5728\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u4e3a\u7528\u6237\u5b8c\u6210\u3002\u8fd9\u6837\u65e2\u51cf\u5c0f\u4e86\u5185\u5b58\u7684\u4f7f\u7528\uff0c\u8fd8\u80fd\u591f\u6b63\u5e38\u5b8c\u6210\u529f\u80fd\u4efb\u52a1\uff0c\u4ece\u8bbe\u8ba1\u7ed3\u6784\u4e0a\u6765\u8bb2\uff0cUI\u548c\u529f\u80fd\u903b\u8f91\u5206\u5f00\uff0c\u4e5f\u5927\u5927\u964d\u4f4e\u4e86\u4ed6\u4eec\u4e4b\u95f4\u7684\u8026\u5408\u6027\uff0c\u5f88\u5bb9\u6613\u8ba9 service \u590d\u7528\u3002</p> <p>\u4ee5 FM \u4e3a\u4f8b\uff0c\u5982\u4f55\u5c06 UI \u548c service \u5206\u79bb\u6210\u4e24\u4e2a\u8fdb\u7a0b?</p> <p>\u7b2c\u4e00\u6b65\u5728 AndroidManifest.xml \u4e2d\u58f0\u660e Service \u7684\u8fdb\u7a0b</p> <p>AndroidManifest.xml</p> <pre><code>\n&lt;service android:name=\"com.miui.fmservice.FmService\" \n    android:process=\":remote\" /&gt;\n&lt;service android:name=\".FmLocalService\" \n    android:process=\":remote\" /&gt;\n</code></pre> <p>Activity \u662f\u65e0\u6cd5\u653e\u5230 remote \u8fdb\u7a0b\u7684\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ea\u80fd\u5c06 service \u7684 process \u6307\u5b9a\u5230\u53e6\u5916\u7684\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u3002</p> <p>\u7b2c\u4e8c\u90e8\u5efa\u7acb\u8fdb\u7a0b\u95f4\u7684\u901a\u8baf\u673a\u5236\u3002</p> <p>\u6211\u4eec\u4ee5\u5f80\u7684\u4ee3\u7801\u4e2d\u628a Activity \u7ed1\u5b9a\u7684 Service \u4e0a\u53ef\u80fd\u5c31\u53ea\u662f\u7b80\u5355\u7684\u5b9a\u4e49\u4e00\u4e2a Binder \u7c7b\uff0c\u5728 onBind \u7684\u65f6\u5019\u8fd4 \u56de\u8fd9\u4e2a Binder\uff0c\u5e76\u52a0\u4e00\u4e2a getService \u7684\u65b9\u6cd5\u8fd4\u56de\u8fd9\u4e2a service\uff0c\u7136\u540e\u5728 Activity \u4e2d onServiceConnected \u7684 \u65f6\u5019\u628a\u5f97\u5230\u7684 IBinder \u5f3a\u8f6c\u5e76\u5f97\u5230 service\u3002\u5206\u79bb\u6210\u4e24\u4e2a\u8fdb\u7a0b\u540e\uff0c\u8fd9\u79cd\u65b9\u6cd5\u5c31\u884c\u4e0d\u901a\u4e86\uff0c\u56e0\u4e3a\u5728\u5f3a\u8f6c\u7684\u65f6\u5019 \u80af\u5b9a\u4f1a\u51fa\u73b0 ClassNotFoundException\u3002</p> <p>\u90a3\u4e48\u8fdb\u7a0b\u95f4\u7684\u901a\u8baf\u65b9\u5f0f\u76ee\u524d\u5728 Android \u4e0a\u5f00\u53d1\u6bd4\u8f83\u5e38\u7528\u7684\u6709\u56db\u79cd\uff1a</p> <ol> <li>\u4f7f\u7528 Receiver \u8fd9\u79cd\u65b9\u5f0f\u7684\u6240\u6709\u901a\u8baf\u534f\u8bae\u90fd\u9700\u8981\u653e\u5728 intent \u91cc\u9762\u53d1\u9001\u548c\u63a5\u53d7\uff0c\u662f\u4e00\u79cd\u5f02\u6b65\u7684\u901a\u8baf\u65b9\u5f0f\uff0c\u5373\u8c03\u7528\u540e\u65e0\u6cd5\u7acb\u523b \u5f97\u5230\u8fd4\u56de\u7ed3\u679c\u3002\u53e6\u5916\u8fd8\u9700\u8981\u5728 UI \u548c service \u6bb5\u90fd\u8981\u6ce8\u518c receiver \u624d\u80fd\u8fbe\u5230\u4ed6\u4eec\u4e4b\u95f4\u7684\u76f8\u4e92\u901a\u8baf\u3002</li> <li>startService \u5927\u5bb6\u90fd\u77e5\u9053\u8c03\u7528 startService \u540e service \u4f1a\u81ea\u52a8\u8c03\u7528 onStartCommand \u65b9\u6cd5\u5e76\u5f97\u5230\u76f8\u5e94\u7684 intent\uff0c\u8fd8\u662f\u901a\u8fc7 intent \u53d1\u9001\u548c\u63a5\u53d7\uff0c\u5bf9\u4e8e service \u7684\u56de\u8c03\u4f9d\u7136\u53ea\u80fd\u4f9d\u9760 receiver \u5b8c\u6210\u3002\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u662f\u5f02\u6b65\u901a\u8baf\uff0c\u53ea\u9700\u8981\u5728 UI \u90e8\u5206\u6ce8\u518c\u4e00\u4e2a receiver \u5c31\u80fd\u591f\u5b8c\u6210\u3002(V5 \u4e2d\u7684\u5f55\u97f3\u673a\u5c31\u91c7\u7528\u4e86\u8fd9\u79cd\u901a\u8baf\u65b9\u5f0f\uff0c\u867d\u7136\u90fd\u662f\u53ea\u5728\u540c\u4e00\u4e2a\u8fdb\u7a0b\u91cc \u9762)</li> <li>\u4f7f\u7528 Messenger Messenger \u7684\u4f7f\u7528\u65b9\u6cd5\u6bd4\u8f83\u7b80\u5355\uff0c\u5b9a\u4e49\u4e00\u4e2a Messenger \u5e76\u6307\u5b9a\u4e00\u4e2a handler \u4f5c\u4e3a\u901a\u8baf\u7684\u63a5\u53e3\uff0c\u5728 onBind \u7684\u65f6\u5019\u8fd4\u56de Messenger \u7684 getBinder \u65b9\u6cd5\uff0c\u5e76\u5728 UI \u5229\u7528\u8fd4\u56de\u7684 IBinder \u4e5f\u521b\u5efa\u4e00\u4e2a Messenger\uff0c\u4ed6\u4eec\u4e4b\u95f4 \u5c31\u53ef\u4ee5\u8fdb\u884c\u901a\u8baf\u4e86\u3002\u8fd9\u79cd\u8c03\u7528\u65b9\u6cd5\u4e5f\u5c5e\u4e8e\u5f02\u6b65\u8c03\u7528\u3002</li> </ol> <p>\u5177\u4f53\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863</p> <ol> <li>\u91cd\u5199 Binder \u7c7b V6 \u4e2d\u7684\u5f55\u97f3\u673a\uff0c\u6536\u97f3\u673a\u90fd\u91c7\u7528\u4e86\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c UI \u548c service \u4e24\u4e2a\u8fdb\u7a0b\u95f4\u7684\u901a\u8baf\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u8c03\u7528\u662f\u540c\u6b65\u7684\uff0c\u8c03\u7528\u4f1a\u7b49\u5f85\u8c03\u7528\u51fd\u6570\u7684\u7ed3\u675f\u540e\u624d\u4f1a\u7ee7\u7eed\u8fdb\u884c\u4e0b\u9762\u7684\u64cd\u4f5c\uff0c\u53ef\u4ee5\u7acb\u523b\u5f97\u5230\u8c03\u7528\u7684\u8fd4\u56de\u7ed3\u679c\u3002\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u901a\u5e38\u6211\u4eec\u90fd\u4f1a\u5229\u7528 aidl \u4e3a\u6211\u4eec\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u8fdc\u7a0b\u901a\u8baf\u7684\u63a5\u53e3\uff0c\u7ee7\u627f\u8fd9\u4e2a\u63a5\u53e3\u5b9e\u73b0\u8c03\u7528\u7684\u5b9e\u9645\u903b\u8f91\u3002\u5728 \u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u9700\u8981\u4e24\u4e2a\u63a5\u53e3\u7c7b\uff0c\u4e00\u4e2a\u4f5c\u4e3a UI \u8c03\u7528 service \u7684\u63a5\u53e3\uff0c\u4e00\u4e2a\u4f5c\u4e3a service \u56de\u8c03 UI \u7684\u63a5\u53e3\u3002</li> </ol> <p>\u4ee5FM\u4e3a\u4f8b \u5148\u5b9a\u4e49\u4e24\u4e2a aidl</p> <p>IFmLocalService.aidl</p> <pre><code>\npackage com.miui.fmradio;\nimport com.miui.fmradio.IFmLocalServiceCallback; interface IFmLocalService {\n    void registerFmStateListener(IFmLocalServiceCallback cb); \n    void unregisterFmStateListener(IFmLocalServiceCallback cb); \n    ...\n    void turnFmOn();\n    void turnFmOff();\n    ...\n}\n</code></pre> <p>IFmLocalServiceCallback.aidl</p> <pre><code>package com.miui.fmradio; \ninterface IFmLocalServiceCallback {\n    ...\n    void onFmTurnedOn(); \n    void onFmTurnedOff(); \n    ...\n}\n\n</code></pre> <p>\u4ece\u6587\u4ef6\u540d\u53ef\u4ee5\u770b\u51fa\uff0cIFmLocalService \u662f UI \u8c03\u7528 Service \u7684\u903b\u8f91\u65f6\u4f7f\u7528\u7684\u63a5\u53e3\uff0cIFmLocalServiceCallback \u662f Service \u56de\u8c03 UI \u65f6\u4f7f\u7528\u7684\u63a5\u53e3\u3002</p> <p>\u5b9a\u4e49\u4e86\u8fd9\u4e24\u4e2a\u6587\u4ef6\u540e\u8fd8\u9700\u8981\u5728 makefile \u91cc\u9762\u6700\u4e0b\u4fee\u6539</p> <p>Android.mk</p> <pre><code>LOCAL_SRC_FILES := $(call all-java-files-under, src/com/miui/fmradio) \\ \nsrc/com/miui/fmradio/IFmLocalService.aidl \\ \nsrc/com/miui/fmradio/IFmLocalServiceCallback.aidl\n</code></pre> <p>\u8fd9\u6837\uff0c\u7f16\u8bd1\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u5728 out \u76ee\u5f55\u4e2d\u751f\u6210 IFmLocalService.java \u548c IFmLocalServiceCallback.java\u3002</p> <p>\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u91cd\u65b0\u5b9a\u4e49 Service \u4e2d onBind \u7684\u8fd4\u56de\u503c\u4e86</p> <p>FmLocalService.java</p> <pre><code>\nprivate LocalBinder mLocalBinder = new LocalBinder(); \n    public class LocalBinder extends IFmLocalService.Stub {\n        @Override\n        public void registerFmStateListener(IFmLocalServiceCallback cb) throws RemoteException {\n            FmLocalService.this.registerFmStateListener(cb); }\n\n        @Override\n        public void unregisterFmStateListener(IFmLocalServiceCallback cb) throws RemoteException {\n            FmLocalService.this.unregisterFmStateListener(cb); \n        }\n        ...\n        @Override\n        public void turnFmOn(int freq) throws RemoteException {\n            FmLocalService.this.turnFmOn(freq); \n        }\n\n        @Override\n        public void turnFmOff() throws RemoteException {\n            FmLocalService.this.turnFmOff();\n        }\n        ... \n    }\n\n    @Override\n    public IBinder onBind(Intent intent) {\n        return mLocalBinder; \n    }\n</code></pre> <p>UI \u4e2d onServiceConnected \u7684\u4ee3\u7801\u4e5f\u9700\u8981\u6539\u4e00\u4e0b\uff0c\u8fd8\u9700\u8981\u5b9a\u4e49\u4e2a callback \u7684\u63a5\u53e3\u7ee7\u627f IFmLocalServiceCallback</p> <p>FmRadioActivity.java</p> <pre><code>\nprivate IFmLocalService mService;\nprivate ServiceConnection mServiceConnection = new ServiceConnection() {\n    @Override\n    public void onServiceDisconnected(ComponentName name) {\n    }\n    @Override\n    public void onServiceConnected(ComponentName name, IBinder service) {\n        mService = IFmLocalService.Stub.asInterface(service); \n        try {\n            mService.registerFmStateListener(mLocalServiceCallback);\n            mService.initFmService();\n        } catch (RemoteException e) {\n            Log.e(TAG, \"initFmService failed\", e); \n        }\n        requestUpdateUi(ANIM_NO); \n        }\n    };\n\n    private FmLocalServiceCallback mLocalServiceCallback = new FmLocalServiceCallback(); private class FmLocalServiceCallback extends IFmLocalServiceCallback.Stub {\n    ...\n    @Override\n    public void onFmTurnedOn() {\n        requestUpdateUi(ANIM_FM_ON); \n    }\n    @Override\n    public void onFmTurnedOff() {\n        requestUpdateUi(ANIM_FM_OFF);\n    }\n    ...\n}\n</code></pre> <p>(\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728 UI \u7684\u56de\u8c03\u51fd\u6570\u4e2d\u6bd4\u5982 onFmTurnedOn\uff0c\u8fd9\u4e2a\u51fd\u6570\u4e0d\u662f\u8fd0\u884c\u5728 UI \u7ebf\u7a0b\u7684\uff0c\u6240\u4ee5\u4e0d\u8981\u5728 \u8fd9\u91cc\u505a\u4efb\u4f55\u548c UI \u6709\u5173\u7684\u64cd\u4f5c\u3002)</p> <p>\u5728 UI \u7684 onServiceConnected \u4e2d\u76f4\u63a5\u8c03\u7528 mService.registerFmStateListener(mLocalServiceCallback);\u6765 \u6ce8\u518c UI \u7684\u56de\u8c03\u51fd\u6570\uff0c\u8fd9\u6837 Service \u8fdb\u7a0b\u89e6\u53d1\u4e00\u5b9a\u4e8b\u4ef6\u540e\u5c31\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\u901a\u77e5 UI\u3002\u5f53\u7136\u4e00\u5b9a\u8981 \u8bb0\u5f97\u5728\u9002\u5f53\u7684\u65f6\u673a\u8fdb\u884c\u53cd\u6ce8\u518c\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u5185\u5b58\u6cc4\u9732\u7b49\u4e00\u4e9b\u5217\u975e\u5e38\u96be\u4ee5\u89e3\u51b3\u7684\u95ee\u9898(\u4e4b\u524d\u6709\u4e00\u6b21\u5fd8\u8bb0\u505a\u53cd\u6ce8\u518c\uff0c\u6bcf\u6b21\u90fd\u662f\u5728\u7b2c\u4e8c\u6b21\u8c03\u7528\u7684\u65f6\u5019\u65e0\u6cd5\u542f\u52a8 Dialog\uff0c\u539f\u56e0\u662f\u7b2c\u4e00\u6b21\u6ce8\u518c\u7684 Activity \u5df2\u7ecf\u88ab destroy \u4e86\uff0c\u53ef\u662f context \u8fd8\u5728\uff0c\u4f46\u662f\u8fd9\u4e2a context \u5df2\u7ecf\u65e0\u6cd5\u518d\u542f\u52a8 Dialog \u4e86\uff0c\u4e3a\u8fd9\u4e2a\u95ee\u9898\u67e5\u4e86\u6574\u6574\u4e00\u665a\u4e0a\uff0c\u5c31\u662f\u56e0\u4e3a\u5fd8\u8bb0 \u505a\u53cd\u6ce8\u518c)\u3002</p> <p>\u5982\u679c UI \u8fdb\u7a0b\u610f\u5916\u6b7b\u4ea1\u8fd8\u6ca1\u6709\u6765\u5f97\u53ca\u505a\u53cd\u6ce8\u518c\u600e\u4e48\u529e?\u4e0d\u7528\u62c5\u5fc3\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528 RemoteCallbackList \u6765\u7ba1 \u7406\u6240\u6709\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4ee3\u7801\u5982\u4e0b:</p> <p>FmLocalService.java</p> <pre><code>private RemoteCallbackList&lt;IFmLocalServiceCallback&gt; mFmStateListeners = new RemoteCallbackList&lt;IFmLocalServiceCallback&gt;();\n\npublic void registerFmStateListener (IFmLocalServiceCallback l) { \n    synchronized (mFmStateListeners) {\n        mFmStateListeners.register(l); \n    }\n}\npublic void unregisterFmStateListener(IFmLocalServiceCallback l) { \n    mFmStateListeners.unregister(l);\n}\n\n\nprivate void notifyFmTurnedOn() { \n    synchronized (mFmStateListeners) {\n        int cnt = mFmStateListeners.beginBroadcast(); \n        for (int i = 0; i &lt; cnt; ++i) {\n            try { \n                mFmStateListeners.getBroadcastItem(i).onFmTurnedOn();\n            } catch (RemoteException e) {\n                Log.e(TAG, \"Callback onFmTurnedOn Failed\", e);\n            } \n        }\n        mFmStateListeners.finishBroadcast(); \n    }\n}\n\nprivate void notifyFmTurnedOff() { \n    synchronized (mFmStateListeners) {\n        int cnt = mFmStateListeners.beginBroadcast(); \n        for (int i = 0; i &lt; cnt; ++i) {\n            try { \n                mFmStateListeners.getBroadcastItem(i).onFmTurnedOff();\n            } catch (RemoteException e) {\n                Log.e(TAG, \"Callback onFmTurnedOff Failed\", e);\n            } \n        }\n        mFmStateListeners.finishBroadcast(); \n    }\n}\n@Override\npublic void onDestroy() {\n    super.onDestroy();\n    mFmStateListeners.kill(); \n}\n\n</code></pre> <p>\u5229\u7528 RemoteCallbackList \u53ef\u4ee5\u7b80\u5355\u89e3\u51b3 UI \u8fdb\u7a0b\u6ce8\u518c\u56de\u8c03\u51fd\u6570\u540e\u610f\u5916\u6b7b\u4ea1\u7684\u95ee\u9898\uff0c\u4ed6\u4f1a\u4e3a\u6bcf\u4e00\u4e2a\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570(\u66f4\u786e\u5207\u4e00\u70b9\u5e94\u8be5\u662f\u6ce8\u518c\u7684 Binder)\u6dfb\u52a0\u4e00\u4e2a DeathLink\uff0c\u5982\u679c\u8be5 Binder \u7684\u8fdb\u7a0b\u610f\u5916\u6b7b\u4ea1 RemoteCallbackList \u4f1a\u7acb\u5373\u53cd\u6ce8\u518c\u6389\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570(\u8fd9\u4e00\u70b9\u5927\u5bb6\u53ef\u4ee5\u53c2\u8003 RemoteCallbackList.java \u91cc\u9762 \u7684 register \u65b9\u6cd5)\u3002\u56de\u8c03 UI \u8fdb\u7a0b\u65f6\u8bf7\u6ce8\u610f\uff0c\u5728\u56de\u8c03\u4e4b\u524d\u9700\u8981\u8c03\u7528 mFmStateListeners.beginBroadcast()\uff0c \u5e76\u83b7\u53d6\u6240\u6709\u6ce8\u518c\u7684\u56de\u8c03\u51fd\u6570\u7684\u4e2a\u6570\uff0c\u4f9d\u6b21\u56de\u8c03\uff0c\u7ed3\u675f\u540e\u9700\u8981\u8c03\u7528 mFmStateListeners.finishBroadcast()\u544a\u77e5 RemoteCallbackList \u56de\u8c03\u7ed3\u675f\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002\u53e6\u5916\u5728 Service \u9500\u6bc1\u7684\u65f6\u5019\u8c03\u7528 mFmStateListeners.kill() \u65b9\u6cd5\u64a4\u9500\u6389\u6240\u6709\u7684\u56de\u8c03\u51fd\u6570\u3002</p> <p>\u76ee\u524d\u5728 V6 \u7684\u7248\u672c\u4e2d\u5f55\u97f3\u673a\u3001\u6536\u97f3\u673a\u5df2\u7ecf\u6210\u529f\u5c06 UI \u548c Service \u5206\u6210\u4e24\u4e2a\u8fdb\u7a0b\u8fdb\u884c\u5904\u7406\uff0c\u5f55\u97f3\u673a\u7684 Service \u8fdb \u7a0b\u4e3b\u8981\u8fdb\u884c\u5f55\u97f3\u548c\u4e91\u5f55\u97f3\u4e0b\u8f7d\u7684\u4efb\u52a1\uff0c\u6536\u97f3\u673a\u7684 Service \u8fdb\u7a0b\u4e3b\u8981\u8fdb\u884c FM \u7684\u6536\u542c\u5de5\u4f5c\uff0cService \u8fdb\u7a0b\u7684\u4efb \u52a1\u542f\u52a8\u540e\uff0c\u4efb\u610f\u6740\u6389 UI \u8fdb\u7a0b\u90fd\u4e0d\u4f1a\u5f71\u54cd Service \u8fdb\u7a0b\u7684\u5de5\u4f5c\u60c5\u51b5\uff0c\u800c\u4e14\u5728 Service \u8fdb\u7a0b\u4e2d\u5efa\u7acb\u4e86\u826f\u597d\u7684\u72b6 \u6001\u673a\u5236\uff0c\u91cd\u542f UI \u8fdb\u7a0b\u540e\u4e5f\u80fd\u591f\u5b8c\u6574\u6062\u590d\u8fd0\u884c\u72b6\u6001\u3002</p> <p>\u6ce8\u610f\u4e8b\u9879: 1. \u65e2\u7136\u5df2\u7ecf\u8bb2 UI \u548c Service \u5206\u5f00\uff0c\u90a3\u4e48\u5c31\u4e0d\u8981\u5728 Service \u4e2d\u505a\u4efb\u4f55 UI \u76f8\u5173\u7684\u4e8b\u60c5\u4e86\uff0c\u6bd4\u5982\u5728 Service \u4e2d\u5f39 \u4e00\u4e2a toast\uff0c\u8fd9\u6837\u4e5f\u4f1a\u4f7f Service \u4f7f\u7528 UI \u8d44\u6e90\u5e76\u521b\u5efa ViewRoot\uff0c\u867d\u7136\u505a\u7cfb\u7edf GC \u7684\u65f6\u5019\u4f1a\u5c06\u8fd9\u4e9b\u8d44\u6e90 GC \u6389\uff0c\u4e0d\u8fc7\u8fd9\u8fd8\u662f\u505a\u4e86\u4e00\u4e9b\u591a\u4f59\u7684\u4e8b\u60c5\u3002\u4e0d\u8fc7\u72b6\u6001\u680f\u7684 notification \u662f\u4e0d\u4f1a\u6709\u4ec0\u4e48\u5f71\u54cd\u7684\uff0cnotification \u662f\u53ef\u4ee5 \u8ba9 service \u6765\u505a\u7684\uff0c\u6bd5\u7adf\u8fd8\u6709 foreground service \u561b\u3002</p> <ol> <li>\u8fdb\u7a0b\u5206\u6210\u4e86\u4e24\u4e2a\uff0c\u5728\u7528 SharedPreferences \u7684\u65f6\u5019\u9700\u8981\u6709\u4e00\u4e9b\u53d8\u5316\uff0c\u521b\u5efa ShearedPreferences \u7684\u65f6\u5019\u5c31 \u4e0d\u80fd\u7528 PRIVATE \u7684\u65b9\u5f0f\u4e86\uff0c\u4e5f\u4e0d\u80fd\u7528 PreferenceManager.getDefaultSharedPreference\uff0c\u5426\u5219\u53e6\u5916\u4e00\u4e2a\u73b0 \u6210\u5728\u8bfb\u53d6 preference \u6570\u636e\u7684\u65f6\u5019\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u4fee\u6539\u7684\u6570\u636e\u3002\u4fee\u6539\u65b9\u6cd5\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0cMODE \u7528 MULTI_PROCESS\uff0c\u50cf\u4e0b\u9762\u8fd9\u6837\u7528\u5c31\u53ef\u4ee5\u4e86</li> </ol> <p>SharedPreferences</p> <pre><code>SharedPreferences settings = context.getSharedPreferences(PREFERENCE_NAME, Context.MODE_MULTI_PROCESS);\n</code></pre> <p>\u9644\u52a0\u4e00\u4e9b aidl \u7684\u989d\u5916\u7684\u6280\u5de7</p> <p>aidl \u5b9a\u4e49\u7684\u63a5\u53e3\u7684\u8fd4\u56de\u503c\u4e5f\u597d\u53c2\u6570\u4e5f\u597d\u8981\u4e48\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u8981\u4e48\u5fc5\u987b\u662f Parcelable \u7c7b\u578b\uff0c\u5176\u4ed6\u7c7b\u578b\u662f\u65e0 \u6cd5\u901a\u8fc7\u8fd9\u4e2a\u63a5\u53e3\u8fdb\u884c\u4f20\u9012\u7684\u3002\u5982\u679c\u60f3\u4f20\u9012\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u5219\u5fc5\u987b\u7ee7\u627f Parcelable \u5e76\u521b\u5efa\u53e6\u5916\u4e00\u4e2a aidl \u6587\u4ef6\u58f0 \u660e\u8fd9\u4e2a\u7c7b\u662f parcelable \u7684\u3002</p> <p>\u4f8b\u5982\u5f55\u97f3\u673a\u4e2d\u7684 DownloadInfo</p> <p>DownloadInfo.java</p> <pre><code>package com.android.soundrecorder;\nimport android.os.Parcel;\nimport android.os.Parcelable;\npublic class DownloadInfo implements Parcelable {\n    String downloadPath; \n    String name;\n    int status;\n    int progress;\n    long recId;\n    String fileId;\n    long size;\n    long id;\n\npublic static final Creator&lt;DownloadInfo&gt; CREATOR = new Creator&lt;DownloadInfo&gt;() {\n    @Override\n    public DownloadInfo createFromParcel(Parcel source) {\n        DownloadInfo info = new DownloadInfo(); \n        info.downloadPath = source.readString(); \n        info.name = source.readString(); \n        info.status = source.readInt();\n        info.progress = source.readInt(); \n        info.recId = source.readLong(); \n        info.fileId = source.readString(); \n        info.size = source.readLong(); \n        info.id = source.readLong(); r\n        eturn info;\n    }\n    @Override\n    public DownloadInfo[] newArray(int size) {\n        return new DownloadInfo[size]; }\n    }; \n}\n\n</code></pre> <p>\u9700\u8981\u5b9a\u4e49 DownloadInfo.aidl DownloadInfo.aidl</p> <pre><code>package com.android.soundrecorder; \nparcelable DownloadInfo;\n</code></pre> <p>\u5343\u4e07\u4e0d\u8981\u5728 Android.mk \u4e2d\u6dfb\u52a0 DownloadInfo.aidl \u8fd9\u4e2a\u6587\u4ef6\uff0c\u5426\u5219\u4f1a\u7f16\u8bd1\u4e0d\u8fc7\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u63a5\u53e3\u4e2d\u4f7f\u7528 DownloadInfo \u8fd9\u4e2a\u81ea\u5b9a\u4e49\u7c7b\u4e86\u3002 \u4f8b\u5982 IDownloadService.aidl</p> <pre><code>package com.android.soundrecorder;\nimport com.android.soundrecorder.DownloadInfo; \ninterface IDownloadService {\n    ...\n    DownloadInfo getDownloadInfo(long recId); \n    ...\n}\n</code></pre>"},{"location":"Android/IPC/%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E8%87%AA%E5%B7%B1%E7%9A%84%E8%BF%9B%E7%A8%8B%E6%98%AF%E8%A2%ABAndroid_low_memory_killer%E6%9D%80%E6%AD%BB%E7%9A%84/","title":"\u5982\u4f55\u5224\u65ad\u81ea\u5df1\u7684\u8fdb\u7a0b\u662f\u88abAndroid low memory killer\u6740\u6b7b\u7684","text":"<p>\u5728 Android \u7cfb\u7edf\u4e2d\uff0cProcess \u7684\u751f\u547d\u5468\u671f\u662f\u6709\u7cfb\u7edf\u63a7\u5236\u7684\uff0c\u5f53\u7528\u6237\u901a\u8fc7 back \u952e\u5173\u6389 \u7a0b\u5e8f\u65f6\uff0c\u8fdb\u7a0b\u4f9d\u7136\u5b58\u5728\uff0c\u5176\u4f9d\u7136\u5360\u7528\u4e00\u5b9a\u7684\u5185\u5b58\u3002\u968f\u7740\u7cfb\u7edf\u8fd0\u884c\u65f6\u95f4\u8d8a\u957f\uff0c\u7528\u6237\u6253\u5f00\u7684\u7a0b\u5e8f\u8d8a\u591a\uff0c\u6574\u4e2a\u7cfb\u7edf\u5360\u7528\u7684\u5185\u5b58\u8d8a\u591a\uff0cAndroid \u4f1a\u5b9a\u65f6\u6267\u884c\u4e00\u6b21\u68c0\u67e5\uff0c\u6740\u6b7b\u4e00\u4e9b\u8fdb\u7a0b\uff0c\u8fdb\u800c\u91ca\u653e\u4e00\u4e9b\u53ef\u7528\u7684\u5185\u5b58\u7a7a\u95f4\uff0candroid \u7cfb\u7edf\u662f\u901a\u8fc7 low memory killer \u673a\u5236\u6765\u5b9e\u73b0\u7684\u3002</p> <p>Android \u7684 low memory killer \u662f\u57fa\u4e8e linux \u7684 oom \u89c4\u5219\u6539\u8fdb\u800c\u6765\u7684\uff0cOMS \u901a\u8fc7\u4e00\u4e9b\u6bd4\u8f83\u590d\u6742\u7684\u8bc4\u5206\u673a\u5236\uff0c\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u8fdb\u884c\u6253\u5206\uff0c\u7136\u540e\u6839\u636e\u5206\u6570\u9ad8\u4f4e\u548c\u7cfb\u7edf\u914d\u7f6e\u7684\u4e00\u4e9b\u53c2\u6570\u6765\u51b3\u5b9a kill \u54ea\u4e9b\u8fdb\u7a0b\u3002</p> <p>\u51e0\u4e2a\u4e3b\u8981\u6982\u5ff5:</p> <ol> <li>Process Importance:ActivityManager.RunningAppPrcessInfo \u4e2d\u5b9a\u4e49\u4e86\u4e0d\u540c\u79cd\u7c7b App \u7684 Importance</li> <li>oom_adj:ProcessList \u4e2d\u5b9a\u4e49\u4e86\u4e0d\u540c\u7c7b\u578b\u8fdb\u7a0b\u7684 adj\u3002Low memory killer \u4e3b\u8981\u662f\u901a\u8fc7\u8fdb\u7a0b\u7684 oom_adj \u6765\u5224\u5b9a\u8fdb\u7a0b\u7684\u91cd\u8981\u7a0b\u5ea6\u3002oom_adj \u7684\u5927\u5c0f\u548c\u8fdb\u7a0b\u7684\u7c7b\u578b\u4ee5\u53ca\u8fdb\u7a0b\u88ab\u8c03\u5ea6\u7684\u6b21\u5e8f\u6709\u5173\u3002</li> <li>\u7cfb\u7edf\u76ee\u5f55/sys/module/lowmemorykiller/parameters/adj \u4e2d\u5b9a\u4e49\u4e86\u5f53\u524d\u7cfb\u7edf\u914d\u7f6e\u7684 oom_adj\uff0c\u4f8b\u5982:0,1,2,7,14,15\u3002\u8fd9\u4e9b\u503c\u6700\u521d\u662f\u5728 init.rc \u4e2d\u914d\u7f6e\u7684</li> <li>\u7cfb\u7edf\u76ee\u5f55/sys/module/lowmemorykiller/parameters/minfree \u4e2d\u5b9a\u4e49\u4e86\u5f53\u524d\u7cfb\u7edf\u914d\u7f6e \u7684 minfreee(\u5355\u4f4d\u4e3a 4k\uff0cpage \u7684\u5927\u5c0f)\uff0c\u4f8b\u5982:1536,2048,4096,5120,5632,6144</li> <li>\u4ee5\u4e0a\u4e24\u7ec4 int \u6570\u7ec4\u662f\u4e00\u4e00\u5bf9\u5e94\uff0c\u5373\u5f53\u7cfb\u7edf\u5269\u4f59\u5185\u5b58\u5c0f\u4e8e\u67d0\u4e2a minfree \u65f6\uff0c lowmemorykiller \u4f1a\u6740\u6b7b\u5bf9\u5e94 oom_adj \u7684\u8fdb\u7a0b</li> <li>\u6bcf\u4e2a\u8fdb\u7a0b\u5f53\u524d\u7684 oom_adj \u662f\u5b9e\u65f6\u53d8\u5316\u7684\uff0c\u5373\u8fdb\u7a0b\u5904\u4e8e\u4e0d\u540c\u7684\u72b6\u6001\uff0c\u5176 oom_adj \u4f1a\u968f\u65f6\u53d1\u751f\u53d8\u5316\u3002\u5176\u503c\u5b58\u5728\u7cfb\u7edf\u76ee\u5f55/proc//oom_adj \u4e2d <li>\u7cfb\u7edf\u521d\u59cb\u8fdb\u7a0b init \u8fdb\u7a0b\u7684 oom_adj \u4e3a-16\uff0c\u662f\u6700\u5c0f\u7684\uff0c\u6839\u636e oom_adj \u548c minfree \u7684 \u914d\u7f6e\uff0c\u8be5\u8fdb\u7a0b\u6c38\u8fdc\u4e0d\u4f1a\u88ab kill\u3002\u5176\u503c\u662f\u5728 init.rc \u4e2d\u8bbe\u5b9a\u7684:write /proc/1/oom_adj -16 8. \u67e5\u770b\u7cfb\u7edf\u5269\u4f59\u7684\u5185\u5b58:cat /proc/meminfo</li> <li>Low memory killer \u7684\u5177\u4f53\u5b9e\u73b0\u53ef\u53c2\u770b:kernel/drivers/misc/lowmemorykiller.c \u540e\u53f0\u7a0b\u5e8f\u88ab kill \u6709\u591a\u79cd\u539f\u56e0\uff0c\u76ee\u524d\u53d1\u73b0\u7684\u53ef\u4ee5\u89e3\u91ca\u7684\u6709\u4e24\u79cd:</li> <li>\u7531 restartPackage \u4f20\u5165 packageName \u5bfc\u81f4\u8be5\u5305\u91cc\u6240\u6709\u7684\u8fdb\u7a0b\u88ab kill\u3002</li> <li>\u7531 lowmemorykiller \u5f53\u5728\u7cfb\u7edf\u5185\u5b58\u7d27\u5f20\u65f6\u6839\u636e\u4f18\u5148\u7ea7\u9009\u62e9\u4e00\u4e9b\u8fdb\u7a0b kill    \u7b2c\u4e00\u7c7b\u76ee\u524d\u8fd8\u6ca1\u6709\u5f88\u597d\u7684\u529e\u6cd5\u6765\u907f\u514d\uff0c\u76ee\u524d\u53ea\u80fd\u505a\u5230\u81ea\u5df1\u7684 taskkiller \u4e0d\u8981\u901a\u8fc7 restartPackage \u6765 kill \u81ea\u5df1\u5305\u91cc\u7684\u4efb\u4f55\u8fdb\u7a0b\u3002    \u66f4\u591a\u7684\u4e3b\u8981\u662f\u7531\u7b2c\u4e8c\u7c7b\u9020\u6210\u7684\uff0c\u90a3\u4e48\u5982\u4f55\u5224\u65ad\u662f\u5426\u662f\u7531\u7b2c\u4e8c\u7c7b\u9020\u6210\u7684\u5462?\u53ef\u4ee5\u901a\u8fc7 \u5982\u4e0b\u65b9\u6cd5\u6765\u5224\u65ad:</li> <li>adb shell</li> <li>cat /sys/module/lowmemorykiller/parameters/adj\uff0c\u8be5\u547d\u4ee4\u4f1a\u6253\u5370\u51fa\u8be5\u7cfb\u7edf\u914d\u7f6e\u7684\u8fdb    \u7a0b\u4f18\u5148\u7ea7\u503c\u3002\u4f8b\u5982:0,1,2,7,14,15</li> <li>cat /sys/module/lowmemorykiller/parameters/minfree\uff0c\u8be5\u547d\u4ee4\u4f1a\u6253\u5370\u7cfb\u7edf\u914d\u7f6e\u7684\u9488\u5bf9\u4e0d\u540c adj \u7684\u6700\u5c0f\u5185\u5b58\u9608\u503c\u3002\u4f8b\u5982:1536,2048,4096,5120,5632,6144</li> <li>\u6839\u636e ps \u547d\u4ee4\u627e\u5230\u76ee\u6807\u8fdb\u7a0b\u5bf9\u5e94\u7684 pid\uff0c\u6bd4\u5982 com.android.contacts \u8fdb\u7a0b</li> <li>cat /proc/\u684c\u9762\u8fdb\u7a0b pid/oom_adj\uff0c\u4f1a\u5f97\u5230\u6b65\u9aa4 2 \u4e2d\u8f93\u51fa\u7684\u67d0\u4e2a\u503c\u6bd4\u5982 2\uff0c\u6839\u636e\u7b2c\u4e8c\u6b65\u4e2d\u8be5\u503c\u51fa\u73b0\u7684\u987a\u5e8f\uff0c\u627e\u5230\u7b2c\u4e09\u6b65\u4e2d\u8f93\u51fa\u7684\u76f8\u540c\u6570\u636e\u7684\u90a3\u4e2a\u503c B\uff0c\u6bd4\u5982 2048</li> <li>cat /proc/meminfo\uff0c\u627e\u5230 MemFree: \u8fd9\u4e00\u884c\uff0c\u540e\u9762\u4f1a\u6709\u4e00\u4e2a\u503c A\uff0c\u4f8b\u5982 79932 kB</li> <li>\u6bd4\u8f83 B4 \u548c A \u7684\u5927\u5c0f\uff0c\u5982\u679c A&lt;B4 \u6216\u8005\u57fa\u672c\u63a5\u8fd1\uff0c\u5219\u8fd9\u7c7b\u662f\u6709 lowmemorykiller \u5373\u5185\u5b58\u4e0d\u8db3\u6740\u6b7b\u7684\u3002</li>"},{"location":"Android/UI/RecyclerView%E4%B8%AD%E5%87%BA%E7%8E%B0item%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/","title":"RecyclerView\u4e2d\u51fa\u73b0item\u91cd\u590d\u7684\u95ee\u9898\u5206\u6790","text":""},{"location":"Android/UI/RecyclerView%E4%B8%AD%E5%87%BA%E7%8E%B0item%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/#_1","title":"\u95ee\u9898\u80cc\u666f","text":"<p>\u524d\u4e0d\u4e45\u6211\u4eec\u9879\u76ee\u4e2d\u7531\u7528\u6237\u53cd\u9988\u8bf4\u9047\u5230\u7b14\u8bb0\u91cd\u590d\u7684\u95ee\u9898\uff0c\u800c\u4e14\u4e0d\u53ea\u4e00\u6b21\u9047\u5230\u7c7b\u4f3c\u7684\u53cd\u9988\u3002</p> <p>\u8fd9\u79cd\u91cd\u590d\u7b14\u8bb0\u603b\u662f\u51fa\u73b0\u7684feed\u6d41\u7684\u4e2d\u95f4\u4f4d\u7f6e\uff0c\u5982\u4e0b\u793a\u610f\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u56fe\u753b\u7684\u6709\u70b9\u4e11\uff0c\u51d1\u5408\u770b\uff0c\u610f\u601d\u5927\u6982\u5c31\u662f\u8fd9\u6837\u7684\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u5c31\u5f97\u8ffd\u8e2a\u4e0b\u8fd9\u4e2a\u95ee\u9898\u4e86\uff0c\u5f00\u59cb\u65f6\u6211\u51e0\u4e4e\u5c31\u4e00\u53e3\u54ac\u5b9a\u662f\u63a5\u53e3\u8fd4\u56de\u7684\u6709\u95ee\u9898\uff0c\u7531\u4e8e\u524d\u51e0\u6b21\u540e\u7aef\u6ca1\u6709\u65e5\u5fd7\uff0c\u597d\u50cf\u4e4b\u524d\u7684\u53cd\u9988\u5c31\u90a3\u4e48\u8fc7\u53bb\u4e86\uff0c\u76f4\u5230\u540e\u9762\u53c8\u51fa\u73b0\u4e00\u6b21\u91cd\u590d\u7b14\u8bb0\u7684\u95ee\u9898\uff0c\u8fd9\u6b21\u662f\u516c\u53f8\u5185\u90e8\u5458\u5de5\u51fa\u73b0\u7684\uff0c\u4e8e\u662f\u540e\u7aef\u4e5f\u901a\u8fc7\u8fd9\u4e2a\u6293\u5230\u4e86\u76f8\u5e94\u7684\u65e5\u5fd7\uff0c\u53d1\u73b0\u8fd4\u56de\u7684\u7b14\u8bb0\u7684\u786e\u6ca1\u6709\u91cd\u590d\u7684\uff0c\u8fd9\u4e0b\u8dd1\u4e0d\u6389\u4e86\uff0c\u5c31\u662f\u524d\u7aef\u7684\u95ee\u9898\u3002</p>"},{"location":"Android/UI/RecyclerView%E4%B8%AD%E5%87%BA%E7%8E%B0item%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/#_2","title":"\u95ee\u9898\u6392\u67e5","text":"<p>\u4e8e\u662f\uff0c\u6211\u53c8\u91cd\u65b0\u68b3\u7406\u4e86\u4e0b\u4ee3\u7801\u6d41\u7a0b\uff0c\u53d1\u73b0\u6709\u4e00\u5904\u6bd4\u8f83\u6709\u5acc\u7591\uff1a</p> <pre><code>        ...\n        if (...) {\n            mItems[0] = noteItem\n        } else {\n            mItems.add(0, noteItem)\n        }\n        mAdapter.items = mItems\n        mAdapter.notifyItemChanged(0)\n        ...\n</code></pre> <p>\u9274\u4e8e\u662f\u516c\u53f8\u9879\u76ee\uff0c\u6211\u5c31\u7701\u7565\u6389\u4e1a\u52a1\u903b\u8f91\u4e86\uff0c\u8fd9\u91cc\u7684\u4ee3\u7801\u6309\u7167\u5f00\u53d1\u8005\u7684\u610f\u56fe\u662f\u5f53RecyclerView\u7b2c\u4e00\u4e2aitem\u5982\u679c\u5df2\u7ecf\u662fnoteItem\u8fd9\u79cd\u7c7b\u578b\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u5c06\u8fd9\u4e2a\u4f4d\u7f6eitem\u66ff\u6362\u6210\u6700\u65b0\u7684\uff0c\u5982\u679c\u8fd9\u4e2a\u4f4d\u7f6e\u7684item\u4e0d\u662fnoteItem\u8fd9\u4e2a\u6570\u636e\u7684\u8bdd\uff0c\u6211\u4eec\u9700\u8981\u624b\u52a8\u628a\u5b83\u6dfb\u52a0\u5230\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u53bb\uff0c\u5230\u8fd9\u91cc\u5b9e\u9645\u4e0a\u90fd\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\u3002</p> <p>\u4f46\u662f\uff0c\u5f53\u6211\u770b\u5230<code>mAdapter.notifyItemChanged(0)</code>\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u76f4\u89c9\u544a\u8bc9\u6211\u8fd9\u91cc\u597d\u50cf\u6709\u70b9\u95ee\u9898\uff0c\u5f53\u4e0a\u9762\u7684\u903b\u8f91\u8d70\u5230else\u8fd9\u91cc\u7684\u65f6\u5019\uff0c\u4f1a\u5f80list\u91ccadd\u4e00\u4e2a\u65b0\u7684item\uff0c\u4f46\u662f\u8fd9\u65f6\u5019\u8c03\u7528\u7684\u5237\u65b0\u65b9\u6cd5\u5374\u662fnotifyItemChanged(0)\u3002</p> <p>\u8fd9\u4e2anotifyItemChanged\u660e\u663e\u662f\u5237\u65b0\u67d0\u4e2aitem\u7684\u65b9\u6cd5\uff0c\u5373\u5f53\u8fd9\u4e2aitem\u91cc\u7684\u6570\u636e\u6709\u53d8\u5316\u65f6\uff0c\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u53bb\u5237\u65b0\u8fd9\u4e2aitem\u533a\u57df\u7684UI\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u5728adapter\u4e2dadd\u4e86\u4e00\u4e2a\u65b0\u7684item\uff0c\u518d\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u660e\u663e\u662f\u4e0d\u884c\u7684\uff0c\u8fd9\u91cc\u662f\u5bfc\u81f4\u91cd\u590d\u7684\u539f\u56e0\u561b\uff0c\u6211\u5176\u5b9e\u4e5f\u4e0d\u592a\u786e\u5b9a\u3002</p>"},{"location":"Android/UI/RecyclerView%E4%B8%AD%E5%87%BA%E7%8E%B0item%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/#_3","title":"\u95ee\u9898\u590d\u73b0","text":"<p>\u4e8e\u662f\u6211\u5199\u4e86\u4e00\u4e2aDemo\u8bd5\u4e86\u4e0b\u3002</p> <pre><code>class RecyclerViewActivity : AppCompatActivity() {\n\n    private val mDataList = ArrayList&lt;Any&gt;()\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_recycler_view)\n\n        val layoutManager = LinearLayoutManager(this)\n        layoutManager.orientation = RecyclerView.VERTICAL\n        recyclerView.layoutManager = layoutManager\n\n        val customAdapter =  CustomAdapter(mDataList)\n\n        recyclerView.adapter = customAdapter\n\n        for (i in 0..5) {\n            mDataList.add(\"text: $i\")\n        }\n\n        recyclerView.adapter?.notifyDataSetChanged()\n    }\n\n    //\u5237\u65b0\u65b9\u6cd5\n    fun refresh(view: View) {\n        mDataList.add(0, \"add item\")\n        recyclerView.adapter?.notifyItemChanged(0)\n    }\n\n}\n</code></pre> <p>\u6784\u9020\u4e00\u4e2a\u666e\u901a\u7684feed\u5217\u8868\uff0c\u6bcf\u6b21\u70b9\u51fb\u5237\u65b0\u6309\u94ae\uff0c\u5c31\u4f1a\u8c03\u7528\u5237\u65b0\u65b9\u6cd5\uff0c\u8c03\u7528\u5237\u65b0\u65b9\u6cd5\u7684\u65f6\u5019\u5f80index\u4e3a0\u7684\u4f4d\u7f6e\u518dadd\u4e00\u4e2aitem\uff0c\u7136\u540e\u518d\u8c03\u7528notifyItemChanged(0)\u65b9\u6cd5\uff0c\u4e0a\u4e0b\u6ed1\u52a8\u540e\uff0c\u53d1\u73b0\u6570\u636e\u662f\u91cd\u590d\u4e86\u3002</p> <p>\u4e0b\u9762\u653e\u4e2agif\u56fe\u5c55\u793a\u4e0b\u6548\u679c\u3002</p> <p></p> <p>\u4ecegif\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u70b9\u51fb\u5237\u65b0\u6309\u94ae\uff0c\u6dfb\u52a0\u4e86\u201dadd item\u201c,\u5f80\u4e0b\u6ed1\u52a8\u540e\uff0c\u51fa\u73b0\u4e86\u4e24\u4e2a\u201dtext\uff1a5\u201c\u7684item\uff0c\u8fd9\u4e2a\u5c31\u662f\u91cd\u590d\u7684item\u3002</p>"},{"location":"Android/UI/RecyclerView%E4%B8%AD%E5%87%BA%E7%8E%B0item%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90/#_4","title":"\u95ee\u9898\u539f\u56e0","text":"<p>\u6211\u4eec\u770b\u5230notifyItemChanged\u7684\u6587\u6863\u8bf4\u660e\uff1a </p> <p>notifyItemChanged(int position) This is an item change event, not a structural change event.</p> <p>RecyclerView\u4e2d\u6709\u4e24\u79cd\u4e0d\u540c\u6570\u636e\u6539\u53d8\u4e8b\u4ef6\uff0c\u4e00\u79cd\u53eb(item changes)\u9879\u76ee\u6539\u53d8\uff0c\u53e6\u4e00\u79cd\u53eb(structual changes)\u7ed3\u6784\u6539\u53d8\u3002\u9879\u76ee\u6539\u53d8\u6307\u7684\u662f\u67d0\u4e2a\u5355\u4e2aitem\u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\uff0c\u8fd9\u4e2a\u65f6\u5019\u6ca1\u6709\u4f4d\u7f6e\u7684\u6539\u53d8\u3002\u800cstructual changes\u5219\u662f\u6709\u4f4d\u7f6e\u7684\u53d8\u5316\u53d1\u751f\uff0c\u4e3b\u8981\u662f\u6570\u636e\u6e90\u7684\u53d8\u5316\u4f1a\u5bfc\u81f4RecyclerView item\u4f4d\u7f6e\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u6211\u4eec\u8fd9\u4e2a\u95ee\u9898\u662f\u6211\u4eec\u5f80\u6570\u636e\u6e90\u524d\u9762\u52a0\u4e86\u4e00\u4e2aitem\uff0c\u8fd9\u4e2a\u65f6\u5019\u5e94\u8be5\u9700\u8981\u8c03\u7528\u5177\u6709structual changes \u7684\u65b9\u6cd5\u6765\u5237\u65b0\uff0c\u800c\u4e0d\u662f\u91c7\u7528notifyItemChanged\u6765\u5237\u65b0\uff0c\u56e0\u4e3anotifyItemChanged\u662f\u4e00\u4e2aitem changes \u7684\u65b9\u6cd5\u3002</p>"},{"location":"Android/UI/RecyclerView%E7%BC%93%E5%AD%98/","title":"RecyclerView\u7f13\u5b58","text":"<p>\u53ef\u89c6\u5316RecyclerView\u7f13\u5b58\u673a\u5236</p> <p>Android\u4e2dListView\u4e0eRecyclerView\u5bf9\u6bd4\u6d45\u6790--\u7f13\u5b58\u673a\u5236</p>"},{"location":"Android/UI/RecyclerView%E7%BC%93%E5%AD%98/#_1","title":"\u5b58\u7f13\u5b58","text":"<pre><code>\n private void scrapOrRecycleView(Recycler recycler, int index, View view) {\n            final ViewHolder viewHolder = getChildViewHolderInt(view);\n            if (viewHolder.shouldIgnore()) {\n                if (DEBUG) {\n                    Log.d(TAG, \"ignoring view \" + viewHolder);\n                }\n                return;\n            }\n            /**\n             * \u8fd9\u91cc\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\n             * \u7b2c\u4e00\u79cd\uff0c\u5982\u679cviewHolder\u5931\u6548\u5e76\u4e14viewHolder\u6ca1\u6709\u88abremove\n             * \u8fd9\u79cd\u4f1a\u5c1d\u8bd5\u628aviewHolder\u653e\u5230mCachedViews\u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u653e\u8fdb\u53bb\uff0c\u5219\u628aViewHolder\u653e\u5230RecycledViewPool\u4e2d\u53bb\n             * \u7b2c\u4e8c\u79cd\uff0c\u5982\u679cif\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u6b64\u65f6\u5219\u5c1d\u8bd5\u628aviewHolder\u653e\u5230mAttachedScrap\u4e2d\u53bb\n             */\n            if (viewHolder.isInvalid() &amp;&amp; !viewHolder.isRemoved()\n                    &amp;&amp; !mRecyclerView.mAdapter.hasStableIds()) {\n                removeViewAt(index);\n                recycler.recycleViewHolderInternal(viewHolder);\n            } else {\n                detachViewAt(index);\n                recycler.scrapView(view);\n                mRecyclerView.mViewInfoStore.onViewDetached(viewHolder);\n            }\n        }\n</code></pre>"},{"location":"Android/UI/RecyclerView%E7%BC%93%E5%AD%98/#_2","title":"\u53d6\u7f13\u5b58","text":"<pre><code>//\u5c1d\u8bd5\u4eceRecycler\u7684scrap\uff0ccache\uff0cRecyclerViewPool\u4e2d\u83b7\u53d6\u7ed9\u5b9a\u4f4d\u7f6e\u7684ViewHolder\uff0c\u5982\u679c\u83b7\u53d6\u4e0d\u5230\u5c31\u76f4\u63a5\u521b\u5efa\n ViewHolder tryGetViewHolderForPositionByDeadline(int position,\n                boolean dryRun, long deadlineNs) {\n            if (position &lt; 0 || position &gt;= mState.getItemCount()) {\n                throw new IndexOutOfBoundsException(\"Invalid item position \" + position\n                        + \"(\" + position + \"). Item count:\" + mState.getItemCount()\n                        + exceptionLabel());\n            }\n            boolean fromScrapOrHiddenOrCache = false;\n            ViewHolder holder = null;\n            // 0) If there is a changed scrap, try to find from there\n            if (mState.isPreLayout()) {\n                holder = getChangedScrapViewForPosition(position);\n                fromScrapOrHiddenOrCache = holder != null;\n            }\n            // 1) Find by position from scrap/hidden list/cache\n            if (holder == null) {\n                holder = getScrapOrHiddenOrCachedHolderForPosition(position, dryRun);\n                if (holder != null) {\n                    if (!validateViewHolderForOffsetPosition(holder)) {\n                        // recycle holder (and unscrap if relevant) since it can't be used\n                        if (!dryRun) {\n                            // we would like to recycle this but need to make sure it is not used by\n                            // animation logic etc.\n                            holder.addFlags(ViewHolder.FLAG_INVALID);\n                            if (holder.isScrap()) {\n                                removeDetachedView(holder.itemView, false);\n                                holder.unScrap();\n                            } else if (holder.wasReturnedFromScrap()) {\n                                holder.clearReturnedFromScrapFlag();\n                            }\n                            recycleViewHolderInternal(holder);\n                        }\n                        holder = null;\n                    } else {\n                        fromScrapOrHiddenOrCache = true;\n                    }\n                }\n            }\n            if (holder == null) {\n                final int offsetPosition = mAdapterHelper.findPositionOffset(position);\n                if (offsetPosition &lt; 0 || offsetPosition &gt;= mAdapter.getItemCount()) {\n                    throw new IndexOutOfBoundsException(\"Inconsistency detected. Invalid item \"\n                            + \"position \" + position + \"(offset:\" + offsetPosition + \").\"\n                            + \"state:\" + mState.getItemCount() + exceptionLabel());\n                }\n\n                final int type = mAdapter.getItemViewType(offsetPosition);\n                // 2) Find from scrap/cache via stable ids, if exists\n                if (mAdapter.hasStableIds()) {\n                    holder = getScrapOrCachedViewForId(mAdapter.getItemId(offsetPosition),\n                            type, dryRun);\n                    if (holder != null) {\n                        // update position\n                        holder.mPosition = offsetPosition;\n                        fromScrapOrHiddenOrCache = true;\n                    }\n                }\n                if (holder == null &amp;&amp; mViewCacheExtension != null) {\n                    // We are NOT sending the offsetPosition because LayoutManager does not\n                    // know it.\n                    final View view = mViewCacheExtension\n                            .getViewForPositionAndType(this, position, type);\n                    if (view != null) {\n                        holder = getChildViewHolder(view);\n                        if (holder == null) {\n                            throw new IllegalArgumentException(\"getViewForPositionAndType returned\"\n                                    + \" a view which does not have a ViewHolder\"\n                                    + exceptionLabel());\n                        } else if (holder.shouldIgnore()) {\n                            throw new IllegalArgumentException(\"getViewForPositionAndType returned\"\n                                    + \" a view that is ignored. You must call stopIgnoring before\"\n                                    + \" returning this view.\" + exceptionLabel());\n                        }\n                    }\n                }\n                if (holder == null) { // fallback to pool\n                    if (DEBUG) {\n                        Log.d(TAG, \"tryGetViewHolderForPositionByDeadline(\"\n                                + position + \") fetching from shared pool\");\n                    }\n                    holder = getRecycledViewPool().getRecycledView(type);\n                    if (holder != null) {\n                        holder.resetInternal();\n                        if (FORCE_INVALIDATE_DISPLAY_LIST) {\n                            invalidateDisplayListInt(holder);\n                        }\n                    }\n                }\n                if (holder == null) {\n                    long start = getNanoTime();\n                    if (deadlineNs != FOREVER_NS\n                            &amp;&amp; !mRecyclerPool.willCreateInTime(type, start, deadlineNs)) {\n                        // abort - we have a deadline we can't meet\n                        return null;\n                    }\n                    holder = mAdapter.createViewHolder(RecyclerView.this, type);\n                    if (ALLOW_THREAD_GAP_WORK) {\n                        // only bother finding nested RV if prefetching\n                        RecyclerView innerView = findNestedRecyclerView(holder.itemView);\n                        if (innerView != null) {\n                            holder.mNestedRecyclerView = new WeakReference&lt;&gt;(innerView);\n                        }\n                    }\n\n                    long end = getNanoTime();\n                    mRecyclerPool.factorInCreateTime(type, end - start);\n                    if (DEBUG) {\n                        Log.d(TAG, \"tryGetViewHolderForPositionByDeadline created new ViewHolder\");\n                    }\n                }\n            }\n\n            // This is very ugly but the only place we can grab this information\n            // before the View is rebound and returned to the LayoutManager for post layout ops.\n            // We don't need this in pre-layout since the VH is not updated by the LM.\n            if (fromScrapOrHiddenOrCache &amp;&amp; !mState.isPreLayout() &amp;&amp; holder\n                    .hasAnyOfTheFlags(ViewHolder.FLAG_BOUNCED_FROM_HIDDEN_LIST)) {\n                holder.setFlags(0, ViewHolder.FLAG_BOUNCED_FROM_HIDDEN_LIST);\n                if (mState.mRunSimpleAnimations) {\n                    int changeFlags = ItemAnimator\n                            .buildAdapterChangeFlagsForAnimations(holder);\n                    changeFlags |= ItemAnimator.FLAG_APPEARED_IN_PRE_LAYOUT;\n                    final ItemHolderInfo info = mItemAnimator.recordPreLayoutInformation(mState,\n                            holder, changeFlags, holder.getUnmodifiedPayloads());\n                    recordAnimationInfoIfBouncedHiddenView(holder, info);\n                }\n            }\n\n            boolean bound = false;\n            if (mState.isPreLayout() &amp;&amp; holder.isBound()) {\n                // do not update unless we absolutely have to.\n                holder.mPreLayoutPosition = position;\n            } else if (!holder.isBound() || holder.needsUpdate() || holder.isInvalid()) {\n                if (DEBUG &amp;&amp; holder.isRemoved()) {\n                    throw new IllegalStateException(\"Removed holder should be bound and it should\"\n                            + \" come here only in pre-layout. Holder: \" + holder\n                            + exceptionLabel());\n                }\n                final int offsetPosition = mAdapterHelper.findPositionOffset(position);\n                bound = tryBindViewHolderByDeadline(holder, offsetPosition, position, deadlineNs);\n            }\n\n            final ViewGroup.LayoutParams lp = holder.itemView.getLayoutParams();\n            final LayoutParams rvLayoutParams;\n            if (lp == null) {\n                rvLayoutParams = (LayoutParams) generateDefaultLayoutParams();\n                holder.itemView.setLayoutParams(rvLayoutParams);\n            } else if (!checkLayoutParams(lp)) {\n                rvLayoutParams = (LayoutParams) generateLayoutParams(lp);\n                holder.itemView.setLayoutParams(rvLayoutParams);\n            } else {\n                rvLayoutParams = (LayoutParams) lp;\n            }\n            rvLayoutParams.mViewHolder = holder;\n            rvLayoutParams.mPendingInvalidate = fromScrapOrHiddenOrCache &amp;&amp; bound;\n            return holder;\n        }\n</code></pre>"},{"location":"Android/UI/%E4%BB%BF%E4%BA%AC%E4%B8%9C%E3%80%81%E6%B7%98%E5%AE%9D%E9%A6%96%E9%A1%B5%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%A4%E5%B1%82%E5%B5%8C%E5%A5%97%E7%9A%84RecyclerView%E5%AE%9E%E7%8E%B0tab%E7%9A%84%E5%90%B8%E9%A1%B6%E6%95%88%E6%9E%9C/","title":"\u4eff\u4eac\u4e1c\u3001\u6dd8\u5b9d\u9996\u9875\uff0c\u901a\u8fc7\u4e24\u5c42\u5d4c\u5957\u7684RecyclerView\u5b9e\u73b0tab\u7684\u5438\u9876\u6548\u679c","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c\u4eff\u4eac\u4e1c\u3001\u6dd8\u5b9d\u9996\u9875\uff0c\u901a\u8fc7\u4e24\u5c42\u5d4c\u5957\u7684RecyclerView\u5b9e\u73b0tab\u7684\u5438\u9876\u6548\u679c</p>"},{"location":"Android/UI/%E4%BB%BF%E4%BA%AC%E4%B8%9C%E3%80%81%E6%B7%98%E5%AE%9D%E9%A6%96%E9%A1%B5%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%A4%E5%B1%82%E5%B5%8C%E5%A5%97%E7%9A%84RecyclerView%E5%AE%9E%E7%8E%B0tab%E7%9A%84%E5%90%B8%E9%A1%B6%E6%95%88%E6%9E%9C/#_1","title":"\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u7bc7\u6587\u7ae0","text":"<p>\u4e4b\u524d\u5199\u8fc7\u4e00\u7bc7\u6587\u7ae0\u4f7f\u7528CoordinatorLayout\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u4e24\u4e2a\u95ee\u9898\u4ee5\u53ca\u6d45\u6790CoordinatorLayout\u5de5\u4f5c\u673a\u5236\uff0c\u8fd9\u7bc7\u6587\u7ae0\u4e0a\u4e3b\u8981\u8bb2\u4e86\u901a\u8fc7CoordinatorLayout\u5b9e\u73b0tab\u5438\u9876\u7684\u6548\u679c\u65f6\u9047\u5230\u7684\u95ee\u9898\uff0c\u6548\u679c\u8ddf\u4eac\u4e1c\u3001\u6dd8\u5b9d\u9996\u9875\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u5b9e\u73b0\u65b9\u6cd5\u4e0d\u540c\u800c\u5df2\uff0c\u4f46\u662f\u4f7f\u7528CoordinatorLayout\u6765\u5b9e\u73b0\u662f\u4f1a\u6709\u4e0d\u5c11\u7ec6\u8282\u95ee\u9898\u662f\u5f88\u96be\u5904\u7406\u597d\u7684\uff0c\u4e0b\u9762\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u3002</p> <p>\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u770b\u4e0b\u4eac\u4e1c\u9996\u9875\u7684\u6548\u679cgif\uff0c\u6765\u770b\u770b\u6211\u4eec\u5230\u5e95\u662f\u8981\u5b9e\u73b0\u4ec0\u4e48\u6837\u7684\u6548\u679c\uff1a</p> <p></p> <p>\u4eac\u4e1c\u9996\u9875\u7684tab\u7b5b\u9009\u533a\u5c06feed\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c\u4e0a\u9762\u662f\u5404\u79cd\u4e0d\u540citem\uff0ctab\u7684\u4e0b\u534a\u90e8\u5206\u53ef\u4ee5\u5de6\u53f3\u6a2a\u6ed1\uff0c\u5e76\u4e14\u4e0b\u62c9\u53ef\u4ee5\u52a0\u91cd\u66f4\u591a\uff0c\u53ea\u8981\u7f51\u7edc\u6709\u6570\u636e\u7684\u60c5\u51b5\u4e0b\u7406\u8bba\u4e0a\u662f\u53ef\u4ee5\u65e0\u9650\u4e0b\u62c9\u7684\u3002</p> <p>\u5176\u5b9e\u7528CoordinatorLayout\u6765\u5b9e\u73b0tab\u5438\u9876\uff0c\u5982\u679c\u80fd\u5c06\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898\u5904\u7406\u597d\u7684\u8bdd\uff0c\u5176\u5b9e\u5927\u81f4\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u4eac\u4e1c\u9996\u9875\u7684\u8fd9\u4e2a\u6548\u679c\uff0c\u5177\u4f53\u7ec6\u8282\u95ee\u9898\u53ef\u4ee5\u53c2\u8003\u6587\u7ae0\u5f00\u5934\u8bf4\u7684\u4e4b\u524d\u7684\u6587\u7ae0\uff0c\u6587\u7ae0\u91cc\u8bb2\u4e86\u4e0b\u4f7f\u7528CoordinatorLayout\u6765\u5b9e\u73b0\u7c7b\u4f3c\u6548\u679c\u9047\u5230\u7684\u52a8\u753b\u6296\u52a8\u95ee\u9898\u4ee5\u53ca\u9875\u9762\u56de\u5f39\u95ee\u9898\u4ee5\u53ca\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4f1a\u4e0d\u91c7\u7528CoordinatorLayout\u6765\u5b9e\u73b0\uff0c\u8f6c\u800c\u91c7\u7528\u5d4c\u5957RecyclerView\u7684\u65b9\u5f0f\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u6765\u770b\u4e0bCoordinatorLayout\u5b9e\u73b0\u7684\u5927\u81f4\u5e03\u5c40\uff1a</p> <p></p> <p>\u4e00\u4e2a\u95ee\u9898\u662f\u4eceAppBarLayout\u6ed1\u52a8\u6548\u679c\u662f\u4e0d\u80fd\u4f20\u9012\u5230\u4e0b\u9762\u7684ViewPager\u91cc\u53bb\u7684\uff0c\u6211\u5c1d\u8bd5\u4e86\u5404\u79cd\u65b9\u5f0f\u90fd\u6ca1\u80fd\u89e3\u51b3\u6389\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u7b80\u5355\u770b\u4e0bDemo\u6548\u679c\u56fe\uff1a</p> <p></p> <p>\u4ecegif\u56fe\u5927\u81f4\u53ef\u4ee5\u770b\u5230AppBarLayout\u6ed1\u4e0a\u53bb\u4e4b\u540e\u60ef\u6027\u6d88\u5931\u4e86\uff0ctab\u4e0b\u9762\u7684\u533a\u57df\u662f\u4e0d\u80fd\u63a5\u7740\u6eda\u52a8\u7684\u3002</p> <p>\u8fd9\u4e2a\u60ef\u6027\u6d88\u5931\u7684\u95ee\u9898\uff0c\u6211\u5728\u7f51\u4e0a\u627e\u5230\u4e86\u4e00\u4e2a\u4e00\u7bc7\u89e3\u51b3\u60ef\u6027\u6d88\u5931\u7684\u6587\u7ae0\u5982\u4e0b\u652f\u4ed8\u5b9d\u9996\u9875\u4ea4\u4e92\u4e09\u90e8\u66f23\u5b9e\u73b0\u652f\u4ed8\u5b9d\u9996\u9875\u4ea4\u4e92,\u5b9e\u73b0\u65b9\u5f0f\u5927\u81f4\u662f\u81ea\u5df1\u628aCoordinatorLayout\u8fd9\u5957\u673a\u5236\u518d\u5b9e\u73b0\u4e86\u4e00\u904d\uff0c\u56e0\u4e3a\u662f\u81ea\u5df1\u5b9e\u73b0\u7684\uff0c\u91cc\u9762\u7684\u4e00\u4e9b\u673a\u5236\u662f\u6bd4\u8f83\u65b9\u4fbf\u6539\u52a8\u7684\uff0c\u5b83\u5904\u7406\u60ef\u6027\u8fd9\u4e2a\u95ee\u9898\u7684\u903b\u8f91\u5927\u81f4\u662f\u5c06AppBarLayout\u4e2d\u672a\u6d88\u8d39\u7684y\u8f74\u504f\u79fb\u91cf\u62ff\u51fa\u6765\u518d\u4ea4\u7531RecyclerView\u53bb\u6ed1\u52a8\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>mHeaderView.setOnHeaderFlingUnConsumedListener(new APHeaderView.OnHeaderFlingUnConsumedListener() {\n    @Override\n    public int onFlingUnConsumed(APHeaderView header, int targetOffset, int unconsumed) {\n        APHeaderView.Behavior behavior = mHeaderView.getBehavior();\n        int dy = -unconsumed;\n        if (behavior != null) {\n            mRecyclerView.scrollBy(0, dy);\n        }\n        return dy;\n    }\n});\n</code></pre> <p>\u8fd9\u91cc\u7531\u4e8e\u7bc7\u5e45\u539f\u56e0\uff0c\u5c31\u4e0d\u5c55\u5f00\u8be6\u7ec6\u4ecb\u7ecd\u4e86\uff0c\u611f\u5174\u8da3\u5730\u540c\u5b66\u53ef\u4ee5\u70b9\u5f00\u4e0a\u9762\u7684\u94fe\u63a5\u53bb\u7814\u7a76\u7814\u7a76\uff0c\u6587\u7ae0\u4e2d\u4e5f\u8d34\u51fa\u4e86GitHub\u5730\u5740\u3002</p> <p>\u6211\u4eec\u91cd\u65b0\u56de\u5230\u6211\u4eec\u4e00\u5f00\u59cb\u7684\u95ee\u9898\uff0c\u4e3a\u4ec0\u4e48\u60f3\u66ff\u6362\u6389CoordinatorLayout\uff0c\u53e6\u5916\u4e00\u4e2a\u95ee\u9898\u662fCoordinatorLayout\u8fd9\u79cd\u5b9e\u73b0\u76f8\u5bf9\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f\u4f1a\u5bfc\u81f4\u9875\u9762\u7684\u5d4c\u5957\u5c42\u7ea7\u5f88\u6df1\uff0c\u6211\u4eec\u4ece\u4e0a\u9762\u8d34\u51fa\u6765\u7684\u5e03\u5c40\u6765\u770b\uff0cview\u5d4c\u5957\u7684\u5c42\u7ea7\u7279\u522b\u6df1\uff0c\u800c\u4e14\u5982\u679c\u6211\u4eec\u8981\u5b9e\u73b0\u7c7b\u4f3c\u4eac\u4e1c\u6216\u8005\u6dd8\u5b9d\u9996\u9875\u8fd9\u6837\u7684\u6548\u679c\uff0c\u5728TabLayout\u4e0a\u9762\u7684\u533a\u57df\uff0c\u4e5f\u5c31\u662f\u4e0b\u56fe\u7bad\u5934\u6807\u6ce8\u7684\u5730\u65b9\u5fc5\u987b\u8981\u91c7\u7528RecyclerView\u7684\u6765\u5b9e\u73b0\uff0c\u56e0\u4e3atab\u4e0a\u534a\u90e8\u5206\u7684\u5185\u5bb9\u548c\u4e2a\u6570\u90fd\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u4f7f\u7528RecyclerView\u624d\u6bd4\u8f83\u65b9\u4fbf\uff0c\u4f46\u662f\u8fd9\u6837\u9875\u9762\u7684\u5c42\u7ea7\u5c31\u66f4\u6df1\u4e86\uff0c\u52a0\u8f7d\u901f\u5ea6\u4e5f\u53d8\u5f97\u66f4\u6162\u4e86\u3002</p> <p></p>"},{"location":"Android/UI/%E4%BB%BF%E4%BA%AC%E4%B8%9C%E3%80%81%E6%B7%98%E5%AE%9D%E9%A6%96%E9%A1%B5%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%A4%E5%B1%82%E5%B5%8C%E5%A5%97%E7%9A%84RecyclerView%E5%AE%9E%E7%8E%B0tab%E7%9A%84%E5%90%B8%E9%A1%B6%E6%95%88%E6%9E%9C/#_2","title":"\u5982\u4f55\u5b9e\u73b0","text":"<p>\u8981\u629b\u5f03CoordinatorLayout\uff0c\u90a3\u4e48\u5982\u4f55\u5b9e\u73b0\u5462\uff1f</p> <p>\u6211\u4eec\u7528Android Studio\u4e2d\u7684Layout Inspector\u5de5\u5177\u770b\u4e86\u4e0b\u4eac\u4e1c\u9996\u9875\u7684\u5e03\u5c40\uff0c\u53d1\u73b0\u7684\u786e\u662f\u91c7\u7528\u4e24\u5c42RecyclerView\u5d4c\u5957\u6765\u5b9e\u73b0\u7684\uff0c\u5c55\u793a\u7684\u5e03\u5c40\u5927\u81f4\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u90a3\u4e48\u63a5\u4e0b\u6765\u662f\u600e\u4e48\u53bb\u5b9e\u73b0\u8fd9\u4e2a\u6548\u679c\u4e86\u3002\u5176\u5b9e\u4e00\u5f00\u59cb\u6211\u4ee5\u4e3a\u8981\u91c7\u7528\u5d4c\u5957\u6eda\u52a8\u8fd9\u5957\u673a\u5236\u6765\u5b9e\u73b0\uff0c\u540e\u6765\u53d1\u73b0\u4e0d\u91c7\u7528\u5d4c\u5957\u6eda\u52a8\u673a\u5236\u4e5f\u662f\u53ef\u4ee5\u5b9e\u73b0\u7684\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5927\u81f4\u6784\u9020\u8fd9\u6837\u4e00\u4e2a\u5e03\u5c40\uff1a</p> <p></p> <p>\u6211\u4eec\u628aViewPager\u4ee5\u53caTabLayout\u8fd9\u4e00\u5757\u4f5c\u4e3a\u5916\u90e8RecyclerView\u7684\u4e00\u4e2aitem\uff0cViewPager\u53ef\u80fd\u4f1a\u6709\u4e2a\u591a\u4e2a\u5185\u90e8RecyclerView\uff0c\u53ea\u8981\u6211\u4eec\u80fd\u8ba9\u5916\u90e8RecyclerView\u548c\u5185\u90e8RecyclerView\u7684\u6ed1\u52a8\u4e8b\u4ef6\u6b63\u786e\u5206\u53d1\u57fa\u672c\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002</p> <p>\u5982\u679c\u53ea\u662f\u6784\u9020\u51fa\u8fd9\u4e2a\u5e03\u5c40\u51fa\u6765\uff0c\u6211\u4eec\u53d1\u73b0\u5185\u90e8\u7684RecyclerView\u90fd\u4e0d\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u56e0\u4e3a\u6ed1\u52a8\u5b8c\u5168\u7531\u5916\u90e8RecyclerView\u63a5\u7ba1\u4e86\u3002</p> <p>\u90a3\u4e48\u91cd\u70b9\u6765\u4e86\uff0c\u8fd9\u79cd\u60c5\u51b5\u5982\u4f55\u5904\u7406\uff1f</p> <p>\u5176\u5b9eRecyclerView\u7684LayoutManager\u4e2d\u6709\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u7528\u4e8e\u5224\u65adRecyclerView\u5728\u6c34\u5e73\u65b9\u5411\u4e0a\u548c\u7ad6\u76f4\u65b9\u5411\u4e0a\u662f\u5426\u53ef\u4ee5\u6eda\u52a8\u7684\u3002</p> <pre><code>public boolean canScrollHorizontally() {\n    return false;\n}\n\npublic boolean canScrollVertically() {\n    return false;\n}\n</code></pre> <p>\u7136\u540eLayoutManager\u6709\u5404\u79cd\u4e0d\u540c\u7684\u5b9e\u73b0LinearLayoutManager\uff0cStaggeredGridLayoutManager\u7b49</p> <p>\u8fd9\u4e2aLayoutManager\u4e2d\u7684canScrollVertically\u548ccanScrollHorizontally\u5728RecyclerView\u7684onInterceptTouchEvent\u4e2d\u662f\u4f1a\u62ff\u6765\u4f5c\u5224\u65ad\uff0c\u5224\u65ad\u5f53\u524dRecyclerView\u662f\u5426\u9700\u8981\u5904\u7406\u6ed1\u52a8\u4e8b\u4ef6\u7684\u3002</p> <p>\u8fd8\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff1a\u6211\u4eec\u5904\u7406\u5185\u5916\u4e24\u5c42RecyclerView\u7684\u6ed1\u52a8\u51b2\u7a81\u95ee\u9898\uff0c\u4e3b\u8981\u662f\u60f3\u89e3\u51b3\u4e0b\u9762\u4e24\u79cd\u573a\u666f\uff1a\u4e00\u3001\u624b\u6307\u4e0a\u6ed1\u65f6\uff0c\u5f53\u5916\u90e8RecyclerView\u6ed1\u52a8\u5e95\u90e8\u7684\u65f6\u5019\uff0c\u5185\u90e8\u7684RecyclerView\u80fd\u7ee7\u7eed\u53bb\u54cd\u5e94\u7528\u6237\u7684\u6ed1\u52a8\uff0c\u56e0\u4e3a\u5185\u90e8\u7684RecyclerView\u7406\u8bba\u4e0a\u662f\u53ef\u4ee5\u65e0\u9650\u6eda\u52a8\u7684\uff1b\u4e8c\u3001\u624b\u6307\u4e0b\u6ed1\u65f6\uff0c\u5f53\u5185\u90e8\u7684RecyclerView\u6ed1\u52a8\u5230\u9876\u90e8\u7684\u65f6\u5019\uff0c\u5916\u90e8\u7684RecyclerView\u80fd\u591f\u7ee7\u7eed\u54cd\u5e94\u7528\u6237\u7684\u4e0b\u6ed1\u4e8b\u4ef6\u3002</p> <p>\u5176\u5b9e\u4e0a\u9762\u5df2\u7ecf\u8bf4\u51fa\u4e86\u5982\u4f55\u5904\u7406\u5d4c\u5957RecyclerView\u7684\u6700\u91cd\u8981\u7684\u70b9\uff0c\u5176\u4ed6\u7684\u90e8\u5206\u76f8\u5f53\u4e8e\u90fd\u662f\u4e00\u4e9b\u7ec6\u8282\u7684\u5904\u7406\u4e86\u3002</p> <p>\u5728\u5916\u90e8RecyclerView(\u4e0b\u9762\u6210ParentRecyclerView)\u4e2d\u7684\u91cd\u5199LayoutManager\u7684canScrollVertically\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>fun initLayoutManager() {\n    val linearLayoutManager = object :LinearLayoutManager(context) {\n\n        override fun canScrollVertically():Boolean {\n            //\u627e\u5230\u5f53\u524d\u7684childRecyclerView\n            val childRecyclerView = findNestedScrollingChildRecyclerView()\n            //\u53ea\u6709\u5f53\u524dchildRecyclerView\u6ed1\u52a8\u5230\u9876\u90e8\u624d\u8ba4\u4e3aParentRecyclerView\u662f\u53ef\u4ee5\u7ad6\u76f4\u65b9\u5411\u662f\u53ef\u4ee5\u6eda\u52a8\u7684\n            return childRecyclerView == null || childRecyclerView.isScrollTop()\n        }\n\n    }\n    linearLayoutManager.orientation = LinearLayoutManager.VERTICAL\n    layoutManager = linearLayoutManager\n}\n</code></pre> <p>\u5728\u5185\u90e8RecyclerView(\u4ee5\u4e0b\u79f0ChildRecyclerView)\u4e2d\u5b9a\u4e49\u4e86isScrollTop()\uff0c\u7528\u4e8e\u5224\u65adChildRecyclerView\u662f\u5426\u6eda\u52a8\u5230\u9876\u90e8\u3002</p> <pre><code>fun isScrollTop(): Boolean {\n    //RecyclerView.canScrollVertically(-1)\u7684\u503c\u8868\u793a\u662f\u5426\u80fd\u5411\u4e0b\u6eda\u52a8\uff0cfalse\u8868\u793a\u5df2\u7ecf\u6eda\u52a8\u5230\u9876\u90e8\n    return !canScrollVertically(-1)\n}\n</code></pre> <p>\u53e6\u5916\uff0c\u5728ParentRecyclerView\u7684onTouchEvent\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>override fun onTouchEvent(e: MotionEvent): Boolean {\n        if(lastY == 0f) {\n            lastY = e.y\n        }\n        if(isScrollEnd()) {\n            //\u5982\u679c\u7236RecyclerView\u5df2\u7ecf\u6ed1\u52a8\u5230\u5e95\u90e8\uff0c\u9700\u8981\u8ba9\u5b50RecyclerView\u6ed1\u52a8\u5269\u4f59\u7684\u8ddd\u79bb\n            val childRecyclerView = findNestedScrollingChildRecyclerView()\n            childRecyclerView?.run {\n                val deltaY = (lastY - e.y).toInt()\n                if(deltaY != 0) {\n                    scrollBy(0,deltaY)\n                }\n            }\n        }\n        lastY = e.y\n        return try {\n            super.onTouchEvent(e)\n        } catch (e: Exception) {\n            e.printStackTrace()\n            false\n        }\n    }\n</code></pre> <p>\u5173\u4e8e\u6ed1\u52a8\u4e8b\u4ef6\u4e3b\u8981\u4ee3\u7801\u5c31\u662f\u4e0a\u9762\u8fd9\u4e9b\uff0c\u5177\u4f53\u53ef\u4ee5\u53ef\u4ee5\u770b\u770b\u9879\u76ee\u4ee3\u7801NestedRecyclerView\u3002</p> <p>\u8fd8\u6709\u5173\u4e8eRecyclerView\u7684fling\u90e8\u5206\uff0c\u5728RecyclerView\u7684onScrollStateChanged\u56de\u8c03\u4e2d\u76d1\u542cy\u8f74\u7684\u603b\u7684\u504f\u79fb\u91cftotalDy\uff0c\u7136\u540e\u5728RecyclerView\u4e0d\u6eda\u52a8\u7684\u65f6\u5019\u4ea4\u7531\u5185\u90e8\u6216\u8005\u5916\u90e8RecyclerView\u53bbfling\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u9879\u76ee\u7684\u4ee3\u7801\u3002</p> <p>\u6700\u540e\u8d34\u4e0a\u9879\u76ee\u7684\u8fd0\u884cgif\u56fe\u5c55\u793a\uff1a</p> <p></p> <p></p>"},{"location":"Android/UI/%E4%BB%BF%E4%BA%AC%E4%B8%9C%E3%80%81%E6%B7%98%E5%AE%9D%E9%A6%96%E9%A1%B5%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%A4%E5%B1%82%E5%B5%8C%E5%A5%97%E7%9A%84RecyclerView%E5%AE%9E%E7%8E%B0tab%E7%9A%84%E5%90%B8%E9%A1%B6%E6%95%88%E6%9E%9C/#_3","title":"\u6700\u540e","text":"<p>\u5199\u4f5c\u4e0d\u6613\uff0c\u6b22\u8fce\u5927\u5bb6\u70b9\u8d5e\uff0c\u5982\u679c\u6709\u95ee\u9898\uff0c\u6b22\u8fce\u63d0\u51fa\u4e00\u8d77\u8ba8\u8bba\uff0c\u60a8\u7684\u70b9\u8d5e\u662f\u6211\u5199\u4f5c\u7684\u6700\u5927\u52a8\u529b\uff0c\u611f\u8c22\uff01</p>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/","title":"\u89e3\u51b3CoordinatorLayout\u7684\u52a8\u753b\u6296\u52a8\u4ee5\u53ca\u56de\u5f39\u95ee\u9898","text":"<p>\u5728\u4f7f\u7528CoordinatorLayout\u6765\u5b9e\u73b0Android\u4e2d\u7684\u4e00\u79cd\u5438\u9876\u7684\u65f6\u5019\uff0c\u9047\u5230\u4e86\u4e24\u4e2aCoordinatorLayout\u7684\u6ed1\u52a8\u95ee\u9898\uff0c\u8fd9\u91cc\u505a\u4e0b\u8bb0\u5f55\u3002</p> <p>\u8fd9\u91cc\u4f7f\u7528CoordinatorLayout\u5b9e\u73b0\u7684\u662f\u4e00\u4e2atab\u5438\u9876\u7684\u6548\u679c\uff0c\u7c7b\u4f3c\u6dd8\u5b9d\uff0c\u4eac\u4e1c\u9996\u9875\u7684\u4e00\u4e2a\u6548\u679c\u3002 \u5934\u90e8\u533a\u57df\u5c55\u793a\u5404\u79cd\u7c7b\u578bbanner\u5361\u7247\uff0c\u4e2d\u95f4\u662f\u7c7b\u4f3cTabLayout\u7684\u53ef\u70b9\u51fbtab\uff0c\u4e0b\u9762\u662ffeed\u5361\u7247\uff0c\u53ef\u4ee5\u4e00\u76f4\u4e0b\u62c9\u52a0\u8f7d\uff0c\u5e76\u4e14feed\u5361\u7247\u533a\u57df\u4f7f\u7528ViewPager\u53ef\u4ee5\u652f\u6301\u5de6\u53f3\u6a2a\u6ed1\u5207\u6362tab\uff0c\u53e6\u5916\uff0c\u5c31\u662ftab\u6eda\u52a8\u5230\u9876\u90e8\u4e4b\u540e\u4f1a\u6709\u4e2a\u5438\u9876\u7684\u6548\u679c\u3002</p> <p>\u6211\u4eec\u5728\u9879\u76ee\u4e2d\u4e5f\u8981\u5b9e\u73b0\u7684\u6548\u679c\uff0c\u4e00\u5f00\u59cb\u6211\u7684\u60f3\u6cd5\u662f\u4f7f\u7528\u5d4c\u5957RecycleView\u7684\u5f62\u5f0f\u6765\u5b9e\u73b0\uff0c\u56e0\u4e3a\u6211\u53bb\u8c03\u7814\u4e86\u4e0b\u4eac\u4e1c\u548c\u6dd8\u5b9d\u7684\u9996\u9875\u5e03\u5c40\u90fd\u662f\u8fd9\u4e48\u5b9e\u73b0\u7684\uff0c\u4eac\u4e1c\u548c\u6dd8\u5b9d\u9996\u9875\u5b9e\u73b0\u65b9\u5f0f\u548c\u4e0b\u9762\u7684\u56fe\u7c7b\u4f3c\uff0c\u5916\u90e8\u7684\u6574\u4e2aRecycleView\u5d4c\u5957ViewPager\uff0cViewPager\u4e2d\u518d\u6709\u591a\u4e2aRecycleView\uff0c\u8fd9\u4e2a\u5b9e\u73b0\u8d77\u6765\u7a0d\u5fae\u6709\u70b9\u9ebb\u70e6\uff0c\u96be\u70b9\u662f\u8981\u5904\u7406\u597d\u5916\u90e8\u7684RecycleView\u548cViewPager\u4e2d\u5185\u90e8RecycleView\u7684\u6ed1\u52a8\u4e8b\u4ef6\u4f20\u9012\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u662f\u7b80\u5355\u4ecb\u7ecd\u4e0b\uff0c\u540e\u9762\u6211\u4f1a\u4e13\u95e8\u6765\u4ecb\u7ecd\u7c7b\u4f3c\u8fd9\u6837\u7684\u5d4c\u5957RecycleView\u5982\u4f55\u5b9e\u73b0\u3002</p> <p></p> <p>\u63a5\u4e0b\u6765\u662f\u5982\u4f55\u91c7\u7528\u5176\u4ed6\u65b9\u4fbf\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7c7b\u4f3c\u9700\u6c42\uff1f\u6211\u60f3\u5230\u4e86CoordinatorLayout\uff0cCoordinatorLayout\u5728\u5904\u7406\u5438\u9876\u662f\u6709\u4e00\u5957\u5df2\u7ecf\u6210\u719f\u7684\u65b9\u6848\u7684\u3002</p> <p>\u7f51\u4e0a\u5173\u4e8eCoordinatorLayout\u7684\u4f7f\u7528\u6709\u5f88\u591a\u4e0d\u9519\u7684\u6587\u7ae0\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528\uff0c\u5173\u4e8eCoordinatorLayout\u548cBehavior\u6211\u63a8\u8350\u770b\u770b\u8fd9\u7bc7\u6587\u7ae0\u9488\u5bf9 CoordinatorLayout \u53ca Behavior \u7684\u4e00\u6b21\u7ec6\u8282\u8f83\u771f</p> <p>\u800c\u6211\u4eec\u8fd9\u7bc7\u6587\u7ae0\u4e3b\u8981\u662f\u8bb2\u4f7f\u7528CoordinatorLayout\u4e2d\u9047\u5230\u7684\u95ee\u9898\uff0c\u95ee\u9898\u5982\u4f55\u89e3\u51b3\u4ee5\u53caCoordinatorLayout\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u6837\u7684\u95ee\u9898\u3002</p> <p></p> <p>\u5b9e\u73b0\u8fd9\u4e2a\u5927\u6982\u662f\u50cf\u4e0a\u9762\u8fd9\u6837\u7c7b\u4f3c\u7684\u5e03\u5c40\u7ed3\u6784\uff0c\u6765\u770b\u4e0b\u5e03\u5c40\u6587\u4ef6\u3002</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;android.support.design.widget.CoordinatorLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    tools:context=\".MainActivity\"&gt;\n\n    &lt;android.support.design.widget.AppBarLayout\n        app:layout_scrollFlags=\"scroll\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"&gt;\n\n        &lt;android.support.design.widget.CollapsingToolbarLayout\n            app:layout_scrollFlags=\"scroll\"\n            app:scrimVisibleHeightTrigger=\"45dp\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"&gt;\n\n            &lt;ImageView\n                android:background=\"@drawable/header\"\n                app:layout_scrollFlags=\"scroll\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"450dp\" /&gt;\n\n        &lt;/android.support.design.widget.CollapsingToolbarLayout&gt;\n\n        &lt;android.support.design.widget.TabLayout\n            android:id=\"@+id/tabs\"\n            app:layout_collapseMode=\"pin\"\n            app:tabMode=\"scrollable\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"/&gt;\n\n    &lt;/android.support.design.widget.AppBarLayout&gt;\n\n\n    &lt;android.support.v4.view.ViewPager\n        android:id=\"@+id/view_pager\"\n        app:layout_behavior=\"@string/appbar_scrolling_view_behavior\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\"/&gt;\n\n&lt;/android.support.design.widget.CoordinatorLayout&gt;\n</code></pre> <p>\u8fd9\u6837\u7684\u5e03\u5c40\uff0c\u63a5\u7740\u586b\u5145\u6570\u636e\u57fa\u672c\u4e0a\u5c31\u80fd\u5b9e\u73b0tab\u5438\u9876\u6548\u679c\uff0cfeed\u5361\u7247\u533a\u91c7\u7528RecycleView\u5b9e\u73b0\uff0c\u53ef\u4ee5\u4e00\u76f4\u4e0b\u62c9\uff0c\u5e76\u4e14\u80fd\u591f\u652f\u6301\u5de6\u53f3\u6a2a\u6ed1\uff0c\u57fa\u672c\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u4eac\u4e1c\uff0c\u6dd8\u5b9d\u9996\u9875\u7684\u4e00\u4e2a\u6548\u679c\u3002</p> <p>\u4f46\u662f\u5728\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0\u53d1\u73b0\u4e24\u4e2a\u5f88\u660e\u663e\u7684\u95ee\u9898\u3002</p>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/#_1","title":"\u7b2c\u4e00\uff0c\u6296\u52a8\u95ee\u9898","text":"<p>\u8be5\u95ee\u9898\u573a\u666f\u63cf\u8ff0\uff1a\u6211\u4eec\u89e6\u6478AppBarLayout\u4f7fAppBarLayout\u6574\u4f53\u5411\u4e0a\u6ed1\u52a8\uff0c\uff0c\u5373\u624b\u6307\u4e0a\u6ed1\uff0c\u5f53AppBarLayout fling\u7684\u540c\u65f6\uff0c\u6211\u4eec\u89e6\u6478\u4e0b\u90e8ViewPager\u4e2d\u7684RecycleView\u533a\u57df\uff0c\u4f7fRecycleView\u533a\u57df\u6574\u4f53\u5411\u4e0b\u6ed1\u52a8\uff0c\u5373\u624b\u6307\u4e0b\u6ed1\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f1a\u53d1\u73b0\u4e00\u4e2a\u660e\u663e\u9875\u9762\u52a8\u753b\u73b0\u8c61\uff0c\u8fd9\u4e2a\u95ee\u9898\u51e0\u4e4e\u662f\u5fc5\u73b0\u3002</p> <p>\u6765\u770b\u4e0bgif\u6548\u679c\uff1a</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u770b\u95ee\u9898\u7684\u539f\u56e0\uff0c\u5176\u5b9e\u8fd9\u4e2a\u8981\u641e\u6e05\u695a\u539f\u56e0\u9700\u8981\u5bf9CoordinatorLayout\u7684\u5de5\u4f5c\u673a\u5236\u6709\u4e2a\u6bd4\u8f83\u6e05\u6670\u7684\u7406\u89e3\uff0c\u7136\u800cCoordinatorLayout\u8fd9\u91cc\u7275\u626f\u5230\u5d4c\u5957\u6eda\u52a8\u4ee5\u53caBehavior\u8fd9\u4e9b\uff0c</p> <p>\u6211\u4eec\u8fd9\u91cc\u5c1d\u8bd5\u7b80\u5355\u5730\u4ecb\u7ecd\u4e0bCoordinatorLayout\u7684\u5de5\u4f5c\u673a\u5236\u3002</p> <p></p> <ul> <li>CoordinatorLayout\u5b9e\u73b0NestedScrollingParent2\u63a5\u53e3\uff0c\u7528\u4e8e\u5904\u7406\u4e0e\u6ed1\u52a8\u5b50View\u7684\u8054\u52a8\u4ea4\u4e92\uff0c\u5b9e\u9645\u4e0a\u4ea4\u7531Behavior\u8fdb\u884c\u5904\u7406\u3002</li> <li>AppBarLayout\u4e2d\u9ed8\u8ba4\u4f7f\u7528\u4e86AppBarLayout.Behavior\uff0c\u4e3b\u8981\u529f\u80fd\u662f\u63a5\u6536CoordinatorLayout\u4f20\u8f93\u8fc7\u6765\u7684\u6ed1\u52a8\u4e8b\u4ef6\uff0c\u5e76\u4e14\u76f8\u5bf9\u5e94\u7684\u8fdb\u884c\u5904\u7406\uff0c\u5982RecycleView\u5f80\u4e0a\u6ed1\u52a8\u5230\u5934\u65f6\u5019\uff0c\u7ee7\u7eed\u6ed1\u52a8\u79fb\u52a8AppBarLayout\u5230\u5934\u3002</li> <li>RecycleView\u5b9e\u73b0\u4e86NestedScrollingChild2\u63a5\u53e3\uff0c\u7528\u4e8e\u4f20\u8f93\u7ed9CoordinatorLayout\uff0c\u5e76\u4e14\u6d88\u8d39CoordinatorLayout\u4e0d\u6d88\u8d39\u7684\u89e6\u6478\u4e8b\u4ef6\uff0c\u5176\u4e2d\u8fd8\u662f\u4f7f\u7528\u4e86AppBarLayout.ScrollingViewBehavior\uff0c\u529f\u80fd\u662f\u8fdb\u884c\u76d1\u542cAppBarLayout\u7684\u4f4d\u79fb\u53d8\u5316\uff0c\u4ece\u800c\u8fdb\u884c\u76f8\u5bf9\u5e94\u7684\u53d8\u5316\uff0c\u6700\u660e\u663e\u7684\u4f8b\u5b50\u5c31\u662fAppBarLayout\u4e0a\u79fb\u8fc7\u7a0b\u4e2d\uff0cRecycleView\u4e00\u8d77\u4e0a\u79fb\u3002</li> </ul>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/#coordinatorlayoutbehavior","title":"CoordinatorLayout\u4e2dBehavior","text":"<p>\u5176\u5b9eCoordinatorLayout\u5c31\u662f\u901a\u8fc7Behavior\u8fd9\u4e2a\u673a\u5236\u6765\u534f\u8c03\u5404\u4e2a\u5b50View\u7684\u6eda\u52a8\u3002\u6bd4\u5982\u6211\u4eec\u6765\u770bCoordinatorLayout\u7684onStartNestedScroll\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u5176\u5b9e\u662fNestedScrollingParent2\u4e2d\u7684\u65b9\u6cd5\u3002</p> <p>\u5f53CoordinatorLayout\u5b50view\u7684\u8c03\u7528NestedScrollingChild2\u7684\u65b9\u6cd5startNestedScroll\u65f6,\u4f1a\u8c03\u7528\u5230\u8be5\u65b9\u6cd5 \u8be5\u65b9\u6cd5\u51b3\u5b9a\u4e86\u5f53\u524d\u63a7\u4ef6\u662f\u5426\u80fd\u63a5\u6536\u5230\u5176\u5185\u90e8View\uff08\u5e76\u975e\u662f\u76f4\u63a5\u5b50View\uff09\u6ed1\u52a8\u65f6\u7684\u53c2\u6570\u3002</p> <pre><code>//CoordinatorLayout\u4e2d\u7684onStartNestedScroll\u65b9\u6cd5\uff1a\n @Override\n    public boolean onStartNestedScroll(View child, View target, int nestedScrollAxes) {\n        return onStartNestedScroll(child, target, nestedScrollAxes, ViewCompat.TYPE_TOUCH);\n    }\n\n    @Override\n    public boolean onStartNestedScroll(View child, View target, int axes, int type) {\n        boolean handled = false;\n\n        final int childCount = getChildCount();\n        for (int i = 0; i &lt; childCount; i++) {\n            final View view = getChildAt(i);\n            if (view.getVisibility() == View.GONE) {\n                // If it's GONE, don't dispatch\n                continue;\n            }\n            final LayoutParams lp = (LayoutParams) view.getLayoutParams();\n            final Behavior viewBehavior = lp.getBehavior();\n            if (viewBehavior != null) {\n                final boolean accepted = viewBehavior.onStartNestedScroll(this, view, child,\n                        target, axes, type);\n                handled |= accepted;\n                lp.setNestedScrollAccepted(type, accepted);\n            } else {\n                lp.setNestedScrollAccepted(type, false);\n            }\n        }\n        return handled;\n    }\n</code></pre> <p>CoordinatorLayout\u4e2d\u7684onStartNestedScroll\u65b9\u6cd5\u57fa\u672c\u90fd\u4f1a\u8c03\u7528\u5230\u6bcf\u4e2a\u5b50View\u7684Behavior\u4e2d\u76f8\u5e94\u7684\u65b9\u6cd5\u4e2d\u53bb\u3002</p> <p>\u5173\u4e8eNested\u5d4c\u5957\u6eda\u52a8\u673a\u5236\u53ef\u4ee5\u770b\u770b\u4e0b\u9762\u8fd9\u7bc7\u535a\u5ba2\u3002</p> <p>\u4e8b\u4ef6\u5206\u53d1\u548cNestedScrolling</p> <p>\u5d4c\u5957\u6eda\u52a8\u673a\u5236NestedScrollingParent2\u548cNestedScrollingChild2\u7684\u5404\u4e2a\u56de\u8c03\u65b9\u6cd5\u8c03\u7528\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1a </p> <p>\u4e0a\u56fe\u5217\u51fa\u6765\u624b\u6307\u4ece\u6309\u4e0b\u5230\u62ac\u8d77\u65f6\u7684\u6574\u4e2a\u6d41\u7a0b\uff0c\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u5728\u5b50View\u7684onTouchEvent()\u4e2d\u5b8c\u6210\u7684\uff0c\u6240\u4ee5\u7236View\u4e00\u5b9a\u4e0d\u80fd\u62e6\u622a\u5b50View\u7684\u4e8b\u4ef6\uff0c\u5426\u5219\u8fd9\u5957\u673a\u5236\u5c31\u5931\u6548\u4e86\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u7bad\u5934\u7684\u5de6\u8fb9\u5206\u522b\u90fd\u662fNestedScrollingChild2\u4e2d\u7684\u5404\u79cd\u65b9\u6cd5\uff0c\u53f3\u8fb9\u5219\u662fNestedScrollingParent2\u5bf9\u5e94\u7684\u65b9\u6cd5\u3002\u4f7f\u7528\u65f6\uff0c\u4e00\u822c\u662f\u5b50View\u901a\u8fc7dispatchXXX()\u6765\u901a\u77e5\u7236View\uff0c\u7136\u540e\u7236View\u901a\u8fc7onXXX()\u6765\u8fdb\u884c\u56de\u5e94\u3002</p> <p>\u65b9\u6cd5\u8c03\u7528\u7684\u5148\u540e\u65f6\u673a\u4e5f\u6709\u533a\u522b\uff0c\u5bf9\u5e94\u5230\u4e0a\u56fe\u4e2d\uff0c\u56fe\u8d8a\u5f80\u4e0b\uff0c\u8c03\u7528\u7684\u65f6\u673a\u8d8a\u665a\u3002</p>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/#appbarlayoutbehavior","title":"AppBarLayout\u4e2d\u7684Behavior","text":"<p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770bAppBarLayout\u4e2d\u7684Behavior\uff0cApprBarLayout\u7684\u9ed8\u8ba4Behavior\u5c31\u662fAppBarLayout.Behavior\u8fd9\u4e2a\u7c7b\uff0c\u800cAppBarLayout.Behavior\u7ee7\u627f\u81eaHeaderBehavior\uff0cHeaderBehavior\u53c8\u7ee7\u627f\u81eaViewOffsetBehavior\uff0c\u8fd9\u91cc\u5148\u603b\u7ed3\u4e00\u4e0b\u4e24\u4e2a\u7c7b\u7684\u4f5c\u7528\u3002 - ViewOffsetBehavior\uff1a\u8be5Behavior\u4e3b\u8981\u8fd0\u7528\u4e8eView\u7684\u79fb\u52a8\uff0c\u4ece\u540d\u5b57\u5c31\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u8be5\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u4e0a\u4e0b\u79fb\u52a8\uff0c\u5de6\u53f3\u79fb\u52a8\u7684\u65b9\u6cd5\u3002 - HeaderBehavior\uff1a\u8be5\u7c7b\u4e3b\u8981\u7528\u4e8eView\u5904\u7406\u89e6\u6478\u4e8b\u4ef6\u4ee5\u53ca\u89e6\u6478\u540e\u7684fling\u4e8b\u4ef6\u3002</p> <p>\u7531\u4e8e\u4e0a\u9762\u4e24\u4e2a\u7c7b\u529f\u80fd\u7684\u5b9e\u73b0\uff0c\u4f7f\u5f97AppBarLayout.Behavior\u5177\u6709\u4e86\u540c\u65f6\u79fb\u52a8\u672c\u8eab\u4ee5\u53ca\u5904\u7406\u89e6\u6478\u4e8b\u4ef6\u7684\u529f\u80fd\u3002</p> <pre><code>public boolean onTouchEvent(CoordinatorLayout parent, V child, MotionEvent ev) {\n       ...\n        switch (ev.getActionMasked()) {\n            ...\n            case MotionEvent.ACTION_MOVE: {\n                final int activePointerIndex = ev.findPointerIndex(mActivePointerId);\n                if (activePointerIndex == -1) {\n                    return false;\n                }\n\n                final int y = (int) ev.getY(activePointerIndex);\n                int dy = mLastMotionY - y;\n\n                if (!mIsBeingDragged &amp;&amp; Math.abs(dy) &gt; mTouchSlop) {\n                    mIsBeingDragged = true;\n                    if (dy &gt; 0) {\n                        dy -= mTouchSlop;\n                    } else {\n                        dy += mTouchSlop;\n                    }\n                }\n\n                if (mIsBeingDragged) {\n                    mLastMotionY = y;\n                    // We're being dragged so scroll the ABL\n                    scroll(parent, child, dy, getMaxDragOffset(child), 0);\n                }\n                break;\n            }\n\n            case MotionEvent.ACTION_UP:\n                if (mVelocityTracker != null) {\n                    mVelocityTracker.addMovement(ev);\n                    mVelocityTracker.computeCurrentVelocity(1000);\n                    float yvel = mVelocityTracker.getYVelocity(mActivePointerId);\n                    fling(parent, child, -getScrollRangeForDragFling(child), 0, yvel);\n                }\n         ...\n        return true;\n    }\n</code></pre> <p>\u6211\u4eec\u6765\u770bonTouchEvent\u7684\u65b9\u6cd5\uff0c\u4e3b\u8981\u903b\u8f91\u8fd8\u662f\u5728ACTION_MOVE\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\u8c03\u7528\u4e86scroll(...)\u65b9\u6cd5\uff0cscroll(...)\u65b9\u6cd5\u5728HeaderBehavior\u4e2d\u8fdb\u884c\u5b9e\u73b0\uff0c\u6700\u7ec8\u8c03\u7528\u5230\u4e86\u989dsetHeaderTopBottomOffset(...)\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u5728AppBarLayout.Behavior\u4e2d\u8fdb\u884c\u4e86\u91cd\u5199\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u76f4\u63a5\u770bAppBarLayout.Behavior\u4e2d\u7684\u6e90\u7801\u5373\u53ef\uff1a</p> <pre><code>@Override\n   //newOffeset\u4f20\u5165\u4e86dy\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u624b\u6307\u79fb\u52a8\u8ddd\u79bb\u4e0a\u4e00\u6b21\u79fb\u52a8\u7684\u8ddd\u79bb\uff0c\n   //minOffset\u7b49\u4e8eAppBarLayout\u7684\u8d1f\u7684height\uff0cmaxOffset\u7b49\u4e8e0\u3002\n        int setHeaderTopBottomOffset(CoordinatorLayout coordinatorLayout,\n                AppBarLayout appBarLayout, int newOffset, int minOffset, int maxOffset) {\n            final int curOffset = getTopBottomOffsetForScrollingSibling();//\u83b7\u53d6\u5f53\u524d\u7684\u6ed1\u52a8Offset\n            int consumed = 0;\n            //AppBarLayout\u6ed1\u52a8\u7684\u8ddd\u79bb\u5982\u679c\u8d85\u51fa\u4e86minOffset\u6216\u8005maxOffset\uff0c\u5219\u76f4\u63a5\u8fd4\u56de0\n            if (minOffset != 0 &amp;&amp; curOffset &gt;= minOffset &amp;&amp; curOffset &lt;= maxOffset) {\n               //\u77eb\u6b63newOffset\uff0c\u4f7f\u5176minOffset&lt;=newOffset&lt;=maxOffset\n                newOffset = MathUtils.clamp(newOffset, minOffset, maxOffset);\n                //\u7531\u4e8e\u9ed8\u8ba4\u6ca1\u8bbe\u7f6eInterpolator\uff0c\u6240\u4ee5interpolatedOffset=newOffset;\n                if (curOffset != newOffset) {\n                    final int interpolatedOffset = appBarLayout.hasChildWithInterpolator()\n                            ? interpolateOffset(appBarLayout, newOffset)\n                            : newOffset;\n                    //\u8c03\u7528ViewOffsetBehvaior\u7684\u65b9\u6cd5setTopAndBottomOffset(...)\uff0c\u6700\u7ec8\u901a\u8fc7\n                    //ViewCompat.offsetTopAndBottom()\u79fb\u52a8AppBarLayout\n                    final boolean offsetChanged = setTopAndBottomOffset(interpolatedOffset);\n\n                    //\u8bb0\u5f55\u4e0b\u6d88\u8d39\u4e86\u591a\u5c11\u7684dy\u3002\n                    consumed = curOffset - newOffset;\n                   //\u6ca1\u8bbe\u7f6eInterpolator\u7684\u60c5\u51b5\uff0c mOffsetDelta\u6c38\u8fdc=0\n                    mOffsetDelta = newOffset - interpolatedOffset;\n                    ....\n                     //\u5206\u53d1\u56de\u8c03OnOffsetChangedListener.onOffsetChanged(...)\n                    appBarLayout.dispatchOffsetUpdates(getTopAndBottomOffset());\n\n\n                    updateAppBarLayoutDrawableState(coordinatorLayout, appBarLayout, newOffset,\n                            newOffset &lt; curOffset ? -1 : 1, false);\n                }\n           ...\n            return consumed;\n        }\n</code></pre> <p>AppBarLayout\u4e2d\u79fb\u52a8\u4e3b\u8981\u5c31\u662f\u8fd9\u90e8\u5206\u903b\u8f91\u4e86\uff0c\u901a\u8fc7setTopAndBottomOffset()\u6765\u8fbe\u5230\u4e86\u79fb\u52a8\u6211\u4eec\u7684AppBarLayout\uff0c\u90a3\u4e48\u8fd9\u91ccAppBarLayout\u5c31\u53ef\u4ee5\u8ddf\u7740\u624b\u4e0a\u4e0b\u79fb\u52a8\u4e86\u3002</p>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/#recycleviewbehavior","title":"RecycleView\u4e2d\u7684Behavior","text":"<p>\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770bRecycleView\u5728CoordinatorLayout\u4e2d\u5982\u4f55\u662f\u79fb\u52a8\u7684\uff1f</p> <p>\u4e0a\u9762\u8bb2\u4e86AppBarLayout\u662f\u5982\u4f55\u901a\u8fc7Behavior\u6765\u79fb\u52a8\u7684\uff0c\u6211\u4eec\u5728\u4e0a\u9762\u5e03\u5c40\u6587\u4ef6\u4e2d\u6307\u5b9a\u4e86ViewPager\u7684Behavior\u3002</p> <pre><code>app:layout_behavior=\"@string/appbar_scrolling_view_behavior\"\n</code></pre> <p>\u8fd9\u4e2a\"appbar_scrolling_view_behavior\"\u5176\u5b9e\u5c31\u662fScrollingViewBehavior\uff0cScrollingViewBehavior\u4e5f\u7ee7\u627f\u81eaViewOffsetBehavior\uff0c\u6211\u4eec\u5728\u4e0a\u4e0b\u79fb\u52a8AppBarLayout\u7684\u65f6\u5019\uff0c\u4e0b\u9762\u7684RecycleView\u4e5f\u662f\u9700\u8981\u8ddf\u7740\u79fb\u52a8\u7684\uff0c\u5b83\u4e0a\u4e0b\u79fb\u52a8\u5c31\u662f\u9760\u8fd9\u4e2a\u6765ScrollingViewBehavior\u6765\u5b9e\u73b0\u7684\u3002</p> <p>\u5728\u9605\u8bfbScrollingViewBehavior\u6e90\u7801\u4e2d\u53d1\u73b0\u5176\u5b9e\u73b0\u4e86\u5982\u4e0b\u65b9\u6cd5\uff1a</p> <pre><code>@Override\npublic boolean layoutDependsOn(CoordinatorLayout parent, View child, View dependency) {\n    // We depend on any AppBarLayouts\n    return dependency instanceof AppBarLayout;\n}\n\n@Override\npublic boolean onDependentViewChanged(CoordinatorLayout parent, View child,\n        View dependency) {\n    offsetChildAsNeeded(parent, child, dependency);\n    return false;\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u8fd9\u4e2aRecycleView\u4f9d\u8d56\u4e8eAppBarLayout\uff0c\u5728AppBarLayout\u79fb\u52a8\u7684\u8fc7\u7a0b\u4e2d\uff0cRecycleView\u4f1a\u968f\u7740AppBarLayout\u7684\u79fb\u52a8\u56de\u8c03onDependentViewChanged(...)\u65b9\u6cd5\uff0c\u8fdb\u800c\u8c03\u7528offsetChildAsNeeded(parent, child, dependency)\u3002</p> <p>\u7528\u8fd9\u4e48\u591a\u7bc7\u5e45\u4e3b\u8981\u8bb2\u4e86CoordinatorLayout\u5982\u4f55\u534f\u8c03AppBarLayout\u548cRecycleView\u6765\u4e0a\u4e0b\u6eda\u52a8\u7684\uff0c\u63a5\u7740\u56de\u5230\u521a\u5f00\u59cb\u6211\u4eec\u8981\u8ba8\u8bba\u90a3\u4e2a\u52a8\u753b\u6296\u52a8\u95ee\u9898\u3002</p> <p>\u5176\u5b9e\u9020\u6210\u8fd9\u4e2a\u7684\u539f\u56e0\u4e3b\u8981\u662fAppBarLayout\u7684fling\u64cd\u4f5c\u548cRecycleView\u8054\u52a8\u9020\u6210\u7684\u95ee\u9898\u3002</p> <p>\u5728AppBarLayout\u7684Behavior\u4e2d\u7684onTouchEvent()\u4e8b\u4ef6\u4e2d\u5904\u7406\u4e86fling\u4e8b\u4ef6\uff1a</p> <pre><code>public boolean onTouchEvent(CoordinatorLayout parent, V child, MotionEvent ev) {\n    ...\n    case MotionEvent.ACTION_UP:\n        if (mVelocityTracker != null) {\n            mVelocityTracker.addMovement(ev);\n            mVelocityTracker.computeCurrentVelocity(1000);\n            float yvel = mVelocityTracker.getYVelocity(mActivePointerId);\n            fling(parent, child, -getScrollRangeForDragFling(child), 0, yvel);\n        }\n    ...\n    return true;\n}\n</code></pre> <p>\u5728fling\u7684\u65b9\u6cd5\u4e2d\u4f7f\u7528OverScroller\u6765\u6a21\u62df\u8fdb\u884cfling\u64cd\u4f5c\uff0c\u6700\u7ec8\u4f1a\u8c03\u5230setHeaderTopBottomOffset(...)\u6765\u4f7fAppBarLayout\u8fdb\u884cfling\u7684\u6ed1\u52a8\u64cd\u4f5c\u3002</p> <p>\u5728\u7edd\u5927\u90e8\u5206\u6ed1\u52a8\u903b\u8f91\u4e2d\uff0c\u8fd9\u6837\u5904\u7406\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u5982\u679c\u5728AppBarLayout\u5728fling\u7684\u65f6\u5019\u4e3b\u52a8\u6ed1\u52a8RecyclerView\uff0c\u90a3\u4e48\u5c31\u4f1a\u9020\u6210\u52a8\u753b\u6296\u52a8\u7684\u95ee\u9898\u4e86\u3002</p> <p>\u5728\u5f53\u524d\u60c5\u51b5\u4e0b\uff0cRecyclerView\u6ed1\u52a8\u5230\u5934\u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a\u628a\u672a\u6d88\u8d39\u7684\u4e8b\u4ef6\u901a\u8fc7NestedScrollingChild2\u4ea4\u4ed8\u7531CoordinatorLayout(\u5b9e\u73b0\u4e86NestedScrollingParent2)\u5904\u7406\uff0cparent\u53c8\u6700\u7ec8\u4ea4\u4ed8\u7531AppBarLayout.Behavior\u8fdb\u884c\u5904\u7406\u7684\uff0c\u5176\u4e2d\u8c03\u7528\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>@Override\npublic void onNestedScroll(CoordinatorLayout coordinatorLayout, AppBarLayout child,\n        View target, int dxConsumed, int dyConsumed, int dxUnconsumed, int dyUnconsumed,\n        int type) {\n    if (dyUnconsumed &lt; 0) {\n        // If the scrolling view is scrolling down but not consuming, it's probably be at\n        // the top of it's content\n        scroll(coordinatorLayout, child, dyUnconsumed,\n                -child.getDownNestedScrollRange(), 0);\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u7684scroll\u65b9\u6cd5\u6700\u7ec8\u4f1a\u8c03\u7528setHeaderTopBottomOffset(...)\uff0c\u7531\u4e8e\u4e24\u6b21\u5206\u522b\u89e6\u6478\u5728AppBarLayout\u548cRecyclerView\u7684\u65b9\u5411\u4e0d\u4e00\u81f4\uff0c\u5bfc\u81f4\u4e86\u6700\u7ec8\u7684\u6296\u52a8\u7684\u6548\u679c\u3002</p> <p>\u89e3\u51b3\u65b9\u5f0f\u4e5f\u5f88\u7b80\u5355,\u53ea\u8981\u5728CoordinatorLayout\u7684onInterceptedTouchEvent()\u4e2d\u505c\u6b62AppBarLayout\u7684fling\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\uff0c\u76f4\u63a5\u64cd\u4f5c\u7684\u5bf9\u8c61\u5c31\u662fAppBarLayout\u4e2d\u7684Behavior\uff0c\u8be5Behavior\u7ee7\u627f\u81eaHeaderBehavior\uff0c\u800cfling\u64cd\u4f5c\u7531OverScroller\u4ea7\u751f\uff0c\u6240\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2aFixedBehavior\uff1a</p> <pre><code>public class FixedBehavior extends AppBarLayout.Behavior {\n    private OverScroller mOverScroller;\n\n    public FixedBehavior() {\n        super();\n    }\n\n    public FixedBehavior(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    @Override\n    public void onAttachedToLayoutParams(@NonNull CoordinatorLayout.LayoutParams params) {\n        super.onAttachedToLayoutParams(params);\n    }\n\n    @Override\n    public void onDetachedFromLayoutParams() {\n        super.onDetachedFromLayoutParams();\n    }\n\n    @Override\n    public boolean onTouchEvent(CoordinatorLayout parent, AppBarLayout child, MotionEvent ev) {\n        if (ev.getAction() == MotionEvent.ACTION_UP) {\n            reflectOverScroller();\n        }\n        return super.onTouchEvent(parent, child, ev);\n    }\n\n    /**\n     *\n     */\n    public void stopFling() {\n        if (mOverScroller != null) {\n            mOverScroller.abortAnimation();\n        }\n    }\n\n    /**\n     * \u89e3\u51b3AppbarLayout\u5728fling\u7684\u65f6\u5019\uff0c\u518d\u4e3b\u52a8\u6ed1\u52a8RecyclerView\u5bfc\u81f4\u7684\u52a8\u753b\u9519\u8bef\u7684\u95ee\u9898\n     */\n    private void reflectOverScroller() {\n        if (mOverScroller == null) {\n            Field field = null;\n            try {\n                field = getClass().getSuperclass()\n                        .getSuperclass().getDeclaredField(\"mScroller\");\n                field.setAccessible(true);\n                Object object = field.get(this);\n                mOverScroller = (OverScroller) object;\n            } catch (NoSuchFieldException e) {\n                e.printStackTrace();\n            } catch (IllegalAccessException e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n}\n</code></pre> <p>\u7136\u540e\u5728\u91cd\u5199CoordinatorLayout\uff0c\u66b4\u9732\u4e00\u4e2a\u63a5\u53e3\uff1a</p> <pre><code>public class CustomCoordinatorLayout extends CoordinatorLayout {\n    private OnInterceptTouchListener mListener;\n\n    public void setOnInterceptTouchListener(OnInterceptTouchListener listener) {\n        mListener = listener;\n    }\n\n    public CustomCoordinatorLayout(Context context) {\n        super(context);\n    }\n\n    public CustomCoordinatorLayout(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    public CustomCoordinatorLayout(Context context, AttributeSet attrs, int defStyleAttr) {\n        super(context, attrs, defStyleAttr);\n    }\n\n    @Override\n    public boolean onInterceptTouchEvent(MotionEvent ev) {\n        if (mListener != null) {\n            mListener.onIntercept();\n        }\n        return super.onInterceptTouchEvent(ev);\n    }\n\n\n    public interface OnInterceptTouchListener {\n        void onIntercept();\n    }\n}\n</code></pre> <p>\u63a5\u7740\u5728\u63a5\u53e3\u4e2d\u5904\u7406\u6ed1\u52a8\u95ee\u9898\u5373\u53ef\uff1a</p> <pre><code>coordinatorLayout.setOnInterceptTouchListener {\n    //RecyclerView\u6ed1\u52a8\u7684\u65f6\u5019\u7981\u6b62AppBarLayout\u7684\u6ed1\u52a8\n    if (customBehavior != null) {\n        customBehavior!!.stopFling()\n    }\n}\n</code></pre>"},{"location":"Android/UI/%E8%A7%A3%E5%86%B3CoordinatorLayout%E7%9A%84%E5%8A%A8%E7%94%BB%E6%8A%96%E5%8A%A8%E4%BB%A5%E5%8F%8A%E5%9B%9E%E5%BC%B9%E9%97%AE%E9%A2%98/#_2","title":"\u7b2c\u4e8c\uff0c\u56de\u5f39\u95ee\u9898","text":"<p>\u95ee\u9898\u573a\u666f\u63cf\u8ff0\uff0c\u6211\u4eec\u53cd\u590d\u4e0a\u4e0b\u6ed1\u52a8AppBarLayout\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u770b\u5230AppBarLayout\u5728\u6ed1\u51fa\u5c4f\u5e55\u5916\u4e4b\u540e\u53c8\u53cd\u5f39\u56de\u53bb\u4e86\uff0c\u800c\u4e14\u5f53\u4f60\u6ed1\u52a8\u7684\u52a0\u901f\u5ea6\u5f88\u5927\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u53cd\u5f39\u7684\u5e45\u5ea6\u4e5f\u4f1a\u8ddf\u7740\u53d8\u5927\u3002</p> <p></p> <p>\u8fd9\u4e2a\u95ee\u9898\u9020\u6210\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u5728\u624b\u6307\u5411\u4e0a\u6ed1\u52a8\u540e\u9020\u6210RecyclerView\u7684fling\u64cd\u4f5c\u6267\u884c\uff0c\u5177\u4f53\u7684\u4ee3\u7801\u5728RecyclerView\u5185\u90e8\u7c7bViewFlinger\u4e2d\u3002</p> <p>\u6211\u4f7f\u7528Android Studio\u4e2d\u7684Profiler\u6293\u53d6\u4e86\u4e00\u4e0b\u5f53\u51fa\u73b0\u53cd\u5f39\u95ee\u9898\u7684\u65f6\u5019\u51fa\u73b0\u7684\u65b9\u6cd5\u8c03\u7528\u5806\u6808\u5982\u4e0b\u6240\u793a\uff1a </p> <p>\u53d1\u73b0RecyclerView\u4e2dViewFlinger\u8c03\u7528\u540e\uff0c\u63a5\u7740\u89e6\u53d1\u4e86HeaderBehavior\u4e2d\u7684FlingRunnable\u3002\u800cViewFling\u4e2d\u4f1a\u8c03\u7528dispatchNestedScroll(...)\u65b9\u6cd5\uff0cRecyclerView\u4f5c\u4e3aCoordinatorLayout\u7684\u5b50View\uff0c\u5b83\u901a\u8fc7\u5d4c\u5957\u6eda\u52a8\u7684\u673a\u5236\u53c8\u4f1a\u8c03\u7528\u5230CoordinatorLayout\u4e2d\u7684onNestedScroll\uff0c\u8fd9\u91cc\u4e3b\u8981\u5c31\u662f\u901a\u8fc7AppBarLayout\u7684Behavior\u4e2d\u7684\u65b9\u6cd5setHeaderTopBottomOffset\u6765\u5b9e\u73b0AppBarLayout\u7684\u6eda\u52a8\uff0c\u540e\u9762\u4f1a\u53d1\u73b0\u591a\u6b21setHeaderTopBottomOffset\u7684\u8c03\u7528\uff0c\u5176\u5b9e\u76ee\u524d\u770b\u5230\u8fd9\u91cc\uff0c\u5e76\u4e0d\u592a\u786e\u5b9a\u9020\u6210\u8fd9\u4e2a\u95ee\u9898\u7684\u5177\u4f53\u539f\u56e0\u662f\u5565\uff0c\u611f\u89c9\u4e0a\u662f\u56e0\u4e3aRecyclerView\u7684\u6ed1\u52a8\u548cCoordinatorLayout\u7684\u6ed1\u52a8\u51b2\u7a81\u5bfc\u81f4\u4e86\u53cd\u5f39\u6548\u679c\u7684\u51fa\u73b0\u3002</p> <p>\u4e8e\u662f\u5c1d\u8bd5\u4e86\u4e0b\u9762\u7684\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <pre><code>coordinatorLayout.setOnInterceptTouchListener {\n    mRecyclerView.stopScroll()\n}\n</code></pre> <p>\u8bd5\u4e86\u8fd9\u4e2a\u65b9\u6cd5\u53d1\u73b0\u679c\u7136\u6709\u6548\u3002</p> <p>\u53e6\u5916\uff0c\u6211\u5728\u5199demo\u7684\u65f6\u5019\u53d1\u73b0\uff0c\u8fd9\u4e2a\u95ee\u9898\u5728support-27\u662f\u5b58\u5728\u7684\uff0c\u5728support-28 Google\u5df2\u7ecf\u4fee\u590d\u8fc7\u4e86\u3002</p> <p>\u6211\u5c1d\u8bd5\u8fc7\u770b\u770bsupport-28\u91cc\u9762\u7684\u90fd\u6709\u54ea\u4e9b\u6539\u52a8\uff0c\u60f3\u770b\u770bGoogle\u662f\u5982\u4f55\u4fee\u590d\u7684\u3002\u770b\u4e86\u4e0bGoogle\u7684release note\u5e76\u6ca1\u6709\u63d0\u53ca\uff0c\u5982\u679c\u4eceGoogle\u7684commit history\u6765\u770b\u5b9e\u5728\u9875\u770b\u4e0d\u51fa\u6765\u5565\uff0c\u6682\u65f6\u4e5f\u6ca1\u6709\u4e2a\u5177\u4f53\u7684\u539f\u56e0\u3002</p> <p>\u540e\u9762\u53ef\u4ee5\u5c06support-27\u548csupport-28\u7684source\u4e0b\u8f7d\u4e0b\u6765\uff0c\u7136\u540e\u4f7f\u7528Beyond Compare\u6765\u770b\u770b\u5177\u4f53\u7684diff\u6539\u52a8\u662f\u5728\u54ea\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/APK%E6%89%93%E5%8C%85%E5%8F%8A%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/","title":"APK\u6253\u5305\u53ca\u5b89\u88c5\u8fc7\u7a0b","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/APK%E6%89%93%E5%8C%85%E5%8F%8A%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#apk","title":"APK\u7684\u6253\u5305\u6d41\u7a0b","text":"<p>Android\u7684\u5305\u6587\u4ef6APK\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a\u4ee3\u7801\u548c\u8d44\u6e90\uff0c\u6240\u4ee5\u6253\u5305\u4e5f\u5206\u4e3a\u8d44\u6e90\u6253\u5305\u548c\u4ee3\u7801\u6253\u5305\u4e24\u90e8\u5206\u3002</p> <p>APK\u6574\u4f53\u6253\u5305\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1a </p> <ul> <li>1\u3001\u901a\u8fc7AAPT\u5de5\u5177\u8fdb\u884c\u8d44\u6e90\u6587\u4ef6\uff08\u5305\u62ecAndroidManifest.xml\u3001\u5e03\u5c40\u6587\u4ef6\u3001\u5404\u79cdxml\u8d44\u6e90\u7b49\uff09\u7684\u6253\u5305\uff0c\u751f\u6210R.java</li> <li>2\u3001\u901a\u8fc7AIDL\u5de5\u5177\u5904\u7406AIDL\u6587\u4ef6\uff0c\u751f\u6210\u76f8\u5e94\u7684Java\u6587\u4ef6</li> <li>3\u3001\u901a\u8fc7Javac\u5de5\u5177\u7f16\u8bd1\u9879\u76ee\u6e90\u7801\uff0c\u751f\u6210class\u6587\u4ef6</li> <li>4\u3001\u901a\u8fc7DX\u5de5\u5177\u5c06\u6240\u6709\u7684Class\u6587\u4ef6\u8f6c\u6362\u6210DEX\u6587\u4ef6\uff0c\u8be5\u8fc7\u7a0b\u4e3b\u8981\u662f\u5b8c\u6210Java\u5b57\u8282\u7801\u88c5\u6362\u6210Dalvik\u5b57\u8282\u7801\uff0c\u538b\u7f29\u5e38\u91cf\u6c60\u4ee5\u53ca\u6e05\u9664\u4fe1\u606f\u7b49\u5de5\u4f5c</li> <li>5\u3001 \u901a\u8fc7ApkBuilder\u5c06\u8d44\u6e90\u6587\u4ef6\u3001DEX\u6587\u4ef6\u6253\u5305\u751f\u6210APK\u6587\u4ef6</li> <li>6\u3001 \u5229\u7528KeyStore\u5bf9\u751f\u6210\u7684APK\u6587\u4ef6\u8fdb\u884c\u7b7e\u540d</li> <li>7\u3001 \u5982\u679c\u662f\u6b63\u5f0f\u7248\u7684APK\uff0c\u8fd8\u4f1a\u5229\u7528ZIPAlign\u5de5\u5177\u8fdb\u884c\u5bf9\u9f50\u5904\u7406\uff0c\u5bf9\u9f50\u7684\u8fc7\u7a0b\u5c31\u662f\u5c06\u6587\u4ef6\u4e2d\u6240\u6709\u7684\u8d44\u6e90\u6587\u4ef6\u8d77\u59cb\u8ddd\u79bb\u90fd\u504f\u79fb4\u5b57\u8282\u7684\u6574\u6570\u500d\uff0c\u8fd9\u6837\u901a\u8fc7\u5185\u5b58\u6620\u5c04\u8bbf\u95eeAPK\u6587\u4ef6\u7684\u901f\u5ea6\u56de\u66f4\u5feb</li> </ul>"},{"location":"Android/%E5%85%B6%E4%BB%96/APK%E6%89%93%E5%8C%85%E5%8F%8A%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#apk_1","title":"APK\u5b89\u88c5\u8fc7\u7a0b","text":"<ul> <li>1\u3001 \u590d\u5236APK\u5230/data/app\u76ee\u5f55\u4e0b\uff0c\u89e3\u538b\u5e76\u626b\u63cf\u5b89\u88c5\u5305\u3002</li> <li>2\u3001 \u8d44\u6e90\u7ba1\u7406\u5668\u89e3\u6790APK\u6587\u4ef6</li> <li>3\u3001 \u89e3\u6790AndroidManifest.xml\u6587\u4ef6\uff0c\u5e76\u5728data/data\u76ee\u5f55\u4e0b\u521b\u5efa\u5bf9\u5e94\u7684\u5e94\u7528\u6570\u636e\u76ee\u5f55</li> <li>4\u3001 \u7136\u540e\u5bf9dex\u6587\u4ef6\u8fdb\u884c\u4f18\u5316\uff0c\u5e76\u4fdd\u5b58\u5728dalivk-cache\u76ee\u5f55\u4e0b</li> <li>5\u3001 \u5c06AndroidManifest.xml\u4e2d\u89e3\u6790\u51fa\u7684\u56db\u5927\u7ec4\u4ef6\u4fe1\u606f\u6ce8\u518c\u5230PackageMangerService\u4e2d</li> <li>6\u3001 \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53d1\u9001\u5e7f\u64ad</li> </ul>"},{"location":"Android/%E5%85%B6%E4%BB%96/APK%E6%89%93%E5%8C%85%E5%8F%8A%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B/#apk_2","title":"APK\u6587\u4ef6\u7ed3\u6784","text":"<p>\u53c2\u8003\u5185\u5bb9\uff1a</p> <p>APK\u6587\u4ef6\u7ed3\u6784\u548c\u5b89\u88c5\u8fc7\u7a0b</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/Android7.0%E4%B8%8A%E7%9A%84%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91/","title":"Android7.0\u4e0a\u7684\u6df7\u5408\u7f16\u8bd1","text":"<p>Android N\u5f15\u5165\u4e86\u4e00\u79cd\u5305\u542b\u7f16\u8bd1\u3001\u89e3\u91ca\u548cJIT\uff08Just In Time\uff09\u7684\u6df7\u5408\u8fd0\u884c\u65f6\uff0c\u4ee5\u4fbf\u5728\u5b89\u88c5\u65f6\u95f4\u3001\u5185\u5b58\u5360\u7528\u3001\u7535\u6c60\u6d88\u8017\u548c\u6027\u80fd\u4e4b\u95f4\u83b7\u5f97\u6700\u597d\u7684\u6298\u8877\u3002</p> <p>ART\u662f\u5728Android KitKat\uff08\u8bd1\u8005\u6ce8\uff1aAndroid 4.0\uff09\u5f15\u5165\u5e76\u5728Lollipop\uff08\u8bd1\u8005\u6ce8\uff1aAndroid 5.0\uff09\u4e2d\u8bbe\u4e3a\u9ed8\u8ba4\u89e3\u51b3\u65b9\u6848\u7684\u4e3b\u8981\u7279\u6027\u4e4b\u4e00\uff0c\u662f\u5f53\u65f6\u7684\u4e00\u79cd\u65b0\u7684\u8fd0\u884c\u65f6\u3002ART\u53d6\u4ee3\u4e86Dalvik\uff0c\u4f46\u662f\u524d\u8005\u4e0e\u540e\u8005\u4ecd\u7136\u4fdd\u6301\u4e86\u5b57\u8282\u7801\u7ea7\u7684\u517c\u5bb9\uff0c\u56e0\u4e3a\u524d\u8005\u4ecd\u5728\u8fd0\u884cDEX\u6587\u4ef6\u3002ART\u7684\u4e3b\u8981\u7279\u5f81\u4e4b\u4e00\u5c31\u662f\u5b89\u88c5\u65f6\u5bf9\u5e94\u7528\u7684AOT\u7f16\u8bd1\u3002\u8fd9\u79cd\u65b9\u5f0f\u7684\u4e3b\u8981\u4f18\u70b9\u5c31\u662f\u4f18\u5316\u4ea7\u751f\u7684\u672c\u5730\u4ee3\u7801\u6027\u80fd\u66f4\u597d\uff0c\u6267\u884c\u8d77\u6765\u9700\u8981\u66f4\u5c11\u7684\u7535\u91cf\u3002\u52a3\u52bf\u5728\u4e8e\u5b89\u88c5\u6587\u4ef6\u6240\u9700\u7684\u7a7a\u95f4\u548c\u65f6\u95f4\u3002\u5728Lollipop\u548cMarshmallow\uff08\u8bd1\u8005\u6ce8\uff1aAndroid 6.0\uff09\u4e2d\uff0c\u5927\u7684\u5e94\u7528\u9700\u8981\u6570\u5206\u949f\u624d\u80fd\u5b89\u88c5\u5b8c\u3002</p> <p>Android N\u5305\u542b\u4e86\u4e00\u4e2a\u6df7\u5408\u6a21\u5f0f\u7684\u8fd0\u884c\u65f6\u3002\u5e94\u7528\u5728\u5b89\u88c5\u65f6\u4e0d\u505a\u7f16\u8bd1\uff0c\u800c\u662f\u89e3\u91ca\u5b57\u8282\u7801\uff0c\u6240\u4ee5\u53ef\u4ee5\u5feb\u901f\u542f\u52a8\u3002ART\u4e2d\u6709\u4e00\u79cd\u65b0\u7684\u3001\u66f4\u5feb\u7684\u89e3\u91ca\u5668\uff0c\u901a\u8fc7\u4e00\u79cd\u65b0\u7684JIT\u5b8c\u6210\uff0c\u4f46\u662f\u8fd9\u79cdJIT\u7684\u4fe1\u606f\u4e0d\u662f\u6301\u4e45\u5316\u7684\u3002\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\uff0c\u4ee3\u7801\u5728\u6267\u884c\u671f\u95f4\u88ab\u5206\u6790\uff0c\u5206\u6790\u7ed3\u679c\u4fdd\u5b58\u8d77\u6765\u3002\u7136\u540e\uff0c\u5f53\u8bbe\u5907\u7a7a\u8f6c\u548c\u5145\u7535\u7684\u65f6\u5019\uff0cART\u4f1a\u6267\u884c\u9488\u5bf9\u201c\u70ed\u4ee3\u7801\u201d\u8fdb\u884c\u7684\u57fa\u4e8e\u5206\u6790\u7684\u7f16\u8bd1\uff0c\u5176\u4ed6\u4ee3\u7801\u4e0d\u505a\u7f16\u8bd1\u3002\u4e3a\u4e86\u5f97\u5230\u66f4\u4f18\u7684\u4ee3\u7801\uff0cART\u91c7\u7528\u4e86\u51e0\u79cd\u6280\u5de7\u5305\u62ec\u6df1\u5ea6\u5185\u8054\u3002</p> <p>\u5bf9\u540c\u4e00\u4e2a\u5e94\u7528\u53ef\u4ee5\u7f16\u8bd1\u6570\u6b21\uff0c\u6216\u8005\u627e\u5230\u53d8\u201c\u70ed\u201d\u7684\u4ee3\u7801\u8def\u5f84\u6216\u8005\u5bf9\u5df2\u7ecf\u7f16\u8bd1\u7684\u4ee3\u7801\u8fdb\u884c\u65b0\u7684\u4f18\u5316\uff0c\u8fd9\u53d6\u51b3\u4e8e\u5206\u6790\u5668\u5728\u968f\u540e\u7684\u6267\u884c\u4e2d\u7684\u5206\u6790\u6570\u636e\u3002\u8fd9\u4e2a\u6b65\u9aa4\u4ecd\u88ab\u7b80\u79f0\u4e3aAOT\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u201c\u5168\u65f6\u6bb5\u7684\u7f16\u8bd1\u201d\uff08All-Of-the-Time compilation\uff09\u3002</p> <p>\u8fd9\u79cd\u6df7\u5408\u4f7f\u7528AOT\u3001\u89e3\u91ca\u3001JIT\u7684\u7b56\u7565\u7684\u5168\u90e8\u4f18\u70b9\u5982\u4e0b\u3002</p> <ul> <li>\u5373\u4f7f\u662f\u5927\u5e94\u7528\uff0c\u5b89\u88c5\u65f6\u95f4\u4e5f\u80fd\u7f29\u77ed\u5230\u51e0\u79d2</li> <li>\u7cfb\u7edf\u5347\u7ea7\u80fd\u66f4\u5feb\u5730\u5b89\u88c5\uff0c\u56e0\u4e3a\u4e0d\u518d\u9700\u8981\u4f18\u5316\u8fd9\u4e00\u6b65</li> <li>\u5e94\u7528\u7684\u5185\u5b58\u5360\u7528\u66f4\u5c0f\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u964d\u4f4e50%</li> <li>\u6539\u5584\u4e86\u6027\u80fd</li> <li>\u66f4\u4f4e\u7684\u7535\u6c60\u6d88\u8017</li> </ul> <p>\u539f\u6587</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/Android%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92/","title":"Android\u4e2d\u7684\u4e8b\u4ef6\u4f20\u9012","text":"<p>\u5f53\u6211\u4eec\u7684\u624b\u6307\u89e6\u78b0\u5230\u5c4f\u5e55\uff0c\u4e8b\u4ef6\u662f\u6309\u7167Activity-&gt;ViewGroup-&gt;View\u8fd9\u6837\u7684\u6d41\u7a0b\u5230\u8fbe\u6700\u7ec8\u54cd\u5e94\u89e6\u6478\u4e8b\u4ef6\u7684View\u7684\u3002</p> <p>\u800c\u5728\u4e8b\u4ef6\u5206\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6d89\u53ca\u5230\u4e09\u4e2a\u6700\u91cd\u8981\u7684\u65b9\u6cd5\uff1adispatchTouchEvent()\u3001onInterceptTouchEvent()\u3001onTouchEvent\u3002</p> <p>\u6211\u4eec\u7684\u624b\u6307\u89e6\u6478\u5230\u5c4f\u5e55\u7684\u65f6\u5019\uff0c\u4f1a\u89e6\u4e00\u4e2aAction_Down\u7c7b\u578b\u7684\u4e8b\u4ef6\uff0c\u5f53\u524d\u9875\u9762\u7684Activity\u4f1a\u9996\u5148\u505a\u51fa\u76f8\u5e94\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u8d70\u5230Activity\u7684dispatchTouchEvent()\u65b9\u6cd5\u5185\u3002</p> <p>\u5728\u8fd9\u4e2a\u65b9\u6cd5\u5185\u90e8\u6709\u4e0b\u9762\u4e24\u4e2a\u903b\u8f91\uff1a</p> <p>\u8c03\u7528getWindow.superDispatchTouchEvent()\u3002 \u5982\u679c\u4e0a\u4e00\u6b65\u8fd4\u56detrue\uff0c\u5219\u76f4\u63a5\u8fd4\u56detrue\uff1b\u5426\u5219return\u81ea\u5df1\u7684onTouchEvent()\u3002 \u663e\u7136\uff0c\u5f53getWindow.superDispatchTouchEvent()\u8fd4\u56detrue\uff0c\u8868\u793a\u5f53\u524d\u4e8b\u4ef6\u5df2\u7ecf\u88ab\u6d88\u8d39\u6389\uff0c\u65e0\u9700\u8c03\u7528onTouchEvent\uff1b\u5426\u5219\u4ee3\u8868\u4e8b\u4ef6\u5e76\u6ca1\u6709\u88ab\u5904\u7406\uff0c\u56e0\u6b64\u9700\u8981\u8c03\u7528Activity\u7684onTouchEvent\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u6211\u4eec\u90fd\u77e5\u9053\uff0cgetWindow()\u8fd4\u56de\u7684\u662fPhoneWindow\uff0c\u56e0\u6b64\u8fd9\u53e5\u4ee3\u7801\u672c\u8d28\u4e0a\u8c03\u7528\u4e86PhoneWindow\u4e2d\u7684superDispatchTouchEvent()\u3002\u800c\u540e\u8005\u5b9e\u9645\u4e0a\u8c03\u7528\u4e86mDecor.superDispatchTouchEvent(event)\u3002 \u8fd9\u4e2amDecor\u4e5f\u5c31\u662fDecorView\uff0c\u5b83\u662fFrameLayout\u7684\u4e00\u4e2a\u5b50\u7c7b\u3002 \u5728DecorView\u4e2d\u7684superDispatchTouchEvent(event)\u4e2d\u8c03\u7528\u7684\u662fsuper.dispatchTouchEvent()\u3002 \u56e0\u6b64\uff0c\u672c\u8d28\u4e0a\u8c03\u7528\u7684\u662fViewGroup\u7684dispatchTouchEvent()\u3002</p> <p>\u5230\u8fd9\u91cc\uff0c\u4e8b\u4ef6\u5df2\u7ecf\u4eceActivity\u4f20\u9012\u5230ViewGroup\u4e86\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u5206\u6790ViewGroup\u3002</p> <p>\u5728ViewGroup\u7684dispatchTouchEvent()\u4e2d\u903b\u8f91\u5927\u81f4\u5982\u4e0b\uff1a</p> <p>\u901a\u8fc7onInterceptTouchEvent()\u5224\u65ad\u5f53\u524dViewGroup\u662f\u5426\u62e6\u622a\uff0c\u9ed8\u8ba4\u7684ViewGroup\u90fd\u662f\u4e0d\u62e6\u622a\u7684\uff1b</p> <p>\u5982\u679c\u62e6\u622a\uff0c\u5219return\u81ea\u5df1\u7684onTouchEvent()\uff1b\u5982\u679c\u4e0d\u62e6\u622a\uff0c\u5219\u6839\u636echild.dispatchTouchEvent()\u7684\u8fd4\u56de\u503c\u5224\u65ad\u3002\u5982\u679c\u8fd4\u56detrue\uff0c\u5219return true\uff1b\u5426\u5219return\u81ea\u8eab\u7684onTouchEvent()\uff0c\u5728\u8fd9\u91cc\u5b9e\u73b0\u4e86\u672a\u5904\u7406\u4e8b\u4ef6\u7684\u5411\u4e0a\u4f20\u9012\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cViewGroup\u7684onInterceptTouchEvent()\u90fd\u8fd4\u56defalse\uff0c\u8868\u793a\u4e0d\u62e6\u622a\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\u4e8b\u4ef6\u5e8f\u5217\uff0c\u6bd4\u5982Down\u4e8b\u4ef6\u3001Move\u4e8b\u4ef6\u2026Up\u4e8b\u4ef6\uff0c\u4eceDown\u5230Up\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u4e8b\u4ef6\u5e8f\u5217\uff0c\u5bf9\u5e94\u7740\u624b\u6307\u4ece\u6309\u4e0b\u5230\u62ac\u8d77\u8fd9\u4e00\u7cfb\u5217\u4e8b\u4ef6\uff0c\u5982\u679cViewGroup\u62e6\u622a\u4e86Down\u4e8b\u4ef6\uff0c\u90a3\u4e48\u540e\u7eed\u4e8b\u4ef6\u90fd\u4f1a\u4ea4\u7ed9\u8fd9\u4e2aViewGroup\u7684onTouchEvent\u3002\u5982\u679cViewGroup\u62e6\u622a\u7684\u4e0d\u662fDown\u4e8b\u4ef6\uff0c\u90a3\u4e48\u4f1a\u7ed9\u4e4b\u524d\u5904\u7406\u8fd9\u4e2aDown\u4e8b\u4ef6\u7684View\u53d1\u9001\u4e00\u4e2aAction_Cancel\u7c7b\u578b\u7684\u4e8b\u4ef6\uff0c\u901a\u77e5\u5b50View\u8fd9\u4e2a\u540e\u7eed\u7684\u4e8b\u4ef6\u5e8f\u5217\u5df2\u7ecf\u88abViewGroup\u63a5\u7ba1\u4e86\uff0c\u5b50View\u6062\u590d\u4e4b\u524d\u7684\u72b6\u6001\u5373\u53ef\u3002</p> <p>\u8fd9\u91cc\u4e3e\u4e00\u4e2a\u5e38\u89c1\u7684\u4f8b\u5b50\uff1a\u5728\u4e00\u4e2a Recyclerview \u4e2d\u6709\u5f88\u591a\u7684 Button\uff0c\u6211\u4eec\u9996\u5148\u6309\u4e0b\u4e86\u4e00\u4e2a button\uff0c\u7136\u540e\u6ed1\u52a8\u4e00\u6bb5\u8ddd\u79bb\u518d\u677e\u5f00\uff0c\u8fd9\u65f6\u5019 Recyclerview \u4f1a\u8ddf\u7740\u6ed1\u52a8\uff0c\u5e76\u4e0d\u4f1a\u89e6\u53d1\u8fd9\u4e2a button \u7684\u70b9\u51fb\u4e8b\u4ef6\u3002\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5f53\u6211\u4eec\u6309\u4e0b button \u65f6\uff0c\u8fd9\u4e2a button \u63a5\u6536\u5230\u4e86 Action_Down \u4e8b\u4ef6\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u540e\u7eed\u7684\u4e8b\u4ef6\u5e8f\u5217\u5e94\u8be5\u7531\u8fd9button\u5904\u7406\u3002\u4f46\u6211\u4eec\u6ed1\u52a8\u4e86\u4e00\u6bb5\u8ddd\u79bb\uff0c\u8fd9\u65f6  Recyclerview \u5bdf\u89c9\u5230\u8fd9\u662f\u4e00\u4e2a\u6ed1\u52a8\u64cd\u4f5c\uff0c\u62e6\u622a\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\u5e8f\u5217\uff0c\u8d70\u4e86\u81ea\u8eab\u7684 onTouchEvent()\u65b9\u6cd5\uff0c\u53cd\u6620\u5728\u5c4f\u5e55\u4e0a\u5c31\u662f\u5217\u8868\u7684\u6ed1\u52a8\u3002</p> <p>\u800c\u8fd9\u65f6 button \u4ecd\u7136\u5904\u4e8e\u6309\u4e0b\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u5728\u62e6\u622a\u7684\u65f6\u5019\u9700\u8981\u53d1\u9001\u4e00\u4e2a Action_Cancel \u6765\u901a\u77e5 button \u6062\u590d\u4e4b\u524d\u72b6\u6001\u3002\u4e8b\u4ef6\u5206\u53d1\u6700\u7ec8\u4f1a\u8d70\u5230View\u7684dispatchTouchEvent()\u4e2d\u3002\u5728View\u7684dispatchTouchEvent()\u4e2d\u6ca1onInterceptTouchEvent()\uff0c\u8fd9\u91cc\u5f88\u5bb9\u6613\u7406\u89e3\uff0cView\u6ca1\u6709child\uff0c\u4e5f\u5c31\u4e0d\u5b58\u5728\u62e6\u622a\u3002View\u7684dispatchTouchEvent()\u76f4\u63a5return\u4e86\u81ea\u5df1\u7684onTouchEvent()\u3002\u5982\u679conTouchEvent()\u8fd4\u56detrue\u4ee3\u8868\u4e8b\u4ef6\u88ab\u6d88\u8d39\uff0c\u5426\u5219\u672a\u6d88\u8d39\u7684\u4e8b\u4ef6\u4f1a\u5411\u4e0a\u4f20\u9012\uff0c\u76f4\u5230\u6709View\u5904\u7406\u4e86\u4e8b\u4ef6\u6216\u4e00\u76f4\u6ca1\u6709\u6d88\u8d39\uff0c\u6700\u7ec8\u56de\u5230Activity\u7684onTouchEvent()\u7ec8\u6b62\u3002\u6709\u65f6\u5019\u4f1a\u6709\u4eba\u6df7\u6dc6onTouchEvent\u548conTouch\u3002\u9996\u5148\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u90fd\u5728View\u7684dispatchTouchEvent()\u4e2d\uff1a \u5982\u679ctouchListener\u4e0d\u4e3anull\uff0c\u5e76\u4e14\u8fd9\u4e2aView\u662fenable\u7684\uff0c\u800c\u4e14onTouch\u8fd4\u56detrue\uff0c\u90fd\u6ee1\u8db3\u65f6\u76f4\u63a5return true\uff0c\u8d70\u4e0d\u5230onTouchEvent()\u65b9\u6cd5\u3002\u5426\u5219\uff0c\u5c31\u4f1a\u89e6\u53d1onTouchEvent()\u3002\u56e0\u6b64onTouch\u4f18\u5148\u4e8eonTouchEvent\u83b7\u5f97\u4e8b\u4ef6\u5904\u7406\u6743\u3002</p> <p></p>"},{"location":"Android/%E5%85%B6%E4%BB%96/IntentFilter%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99/","title":"IntentFilter\u5339\u914d\u89c4\u5219","text":"<p>Activity\u9690\u5f0f\u8c03\u7528\u65f6\uff0c\u9700\u8981Intent\u80fd\u591f\u5339\u914d\u76ee\u6807\u7ec4\u4ef6\u7684IntentFilter\u8bbe\u7f6e\u7684\u8fc7\u6ee4\u4fe1\u606f\u3002</p> <p>IntentFilter\u8bbe\u7f6e\u7684\u8fc7\u6ee4\u4fe1\u606f\u6709action\u3001category\u3001data\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/IntentFilter%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99/#action","title":"action\u5339\u914d\u89c4\u5219","text":"<ol> <li>Intent\u4e2d\u5fc5\u987b\u6709\u4e14\u4e00\u4e2aaction\uff0c\u6ca1\u6709action\u4f1a\u5339\u914d\u5f02\u5e38</li> <li>Intent\u4e2d\u7684action\uff0c\u5fc5\u987b\u548c\u76ee\u6807\u7ec4\u4ef6IntentFilter\u4e2d\u591a\u4e2aaction\u4e2d\u4e00\u4e2a\u4e25\u683c\u5339\u914d\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09\uff0c\u624d\u80fd\u7b97action\u5339\u914d\u6210\u529f\u3002</li> </ol> <p>\u6ce8\u610f\uff1aIntent\u4e2d\u53ea\u80fd\u8bbe\u7f6e\u4e00\u4e2aaction\uff0cIntent.setAction()</p> <p>\u76ee\u6807\u7ec4\u4ef6\uff1a</p> <pre><code> &lt;activity\n            android:name=\"com.facebook.CustomTabActivity\"\n            android:exported=\"true\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"com.shannon.Activity1\" /&gt;\n                &lt;action android:name=\"com.shannon.Activity2\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.DEFAULT\" /&gt;\n                &lt;category android:name=\"android.intent.category.BROWSABLE\" /&gt;\n\n                &lt;data android:scheme=\"@string/fb_login_protocol_scheme\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n\n</code></pre> <p>\u6240\u4ee5\uff0c</p> <pre><code>Intent.setAction(\"com.shannon.Activity1\")  //\u5339\u914d\u901a\u8fc7\n\nIntent.setAction(\"com.shannon.Activity2\")  //\u5339\u914d\u901a\u8fc7\n\nIntent.setAction(\"com.shannon.Activity3\")  //\u5339\u914d\u5931\u8d25\uff0c\u76ee\u6807\u7ec4\u4ef6\u6ca1\u6709Activity3\u8fd9\u4e2aaction\n</code></pre>"},{"location":"Android/%E5%85%B6%E4%BB%96/IntentFilter%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99/#category","title":"category\u5339\u914d\u89c4\u5219","text":"<p>Intent\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2acategory\u3002\u8981\u6c42\u8fd9\u4e9bcategory\u4e2d\u7684\u6bcf\u4e00\u4e2a\uff0c\u90fd\u5fc5\u987b\u88ab\u5305\u542b\u5728\u76ee\u6807\u7ec4\u4ef6IntentFilter\u4e2d\u7684category\u91cc\u3002</p> <pre><code>Intent.addCategory(\"android.intent.category.DEFAULT\")\nIntent.addCategory(\"android.intent.category.BROWSABLE\")\n\u5339\u914d\u901a\u8fc7\n\nIntent.addCategory(\"android.intent.category.DEFAULT\") //\u76ee\u6807\u7ec4\u4ef6\u80fd\u5339\u914d\u8fd9\u4e2a\nIntent.addCategory(\"android.intent.category.OTHER\") //\u76ee\u6807\u7ec4\u4ef6\u80fd\u65e0\u6cd5\u5339\u914d\u8fd9\u4e2a\n\u4e0d\u80fd\u5168\u90e8\u5339\u914d\u6210\u529f\uff0c\u6240\u4ee5\u7ed3\u679c\u662f\uff1a\u5339\u914d\u5931\u8d25\n</code></pre>"},{"location":"Android/%E5%85%B6%E4%BB%96/IntentFilter%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99/#data","title":"data\u5339\u914d\u89c4\u5219","text":"<p>data\u5339\u914d\u89c4\u5219\u548caction\u7c7b\u4f3c\uff0cIntent\u7684data\u5fc5\u987b\u548c\u76ee\u6807\u7ec4\u4ef6IntentFilter\u591a\u4e2adata\u4e2d\u7684\u4e00\u4e2a\u4e25\u683c\u5339\u914d\uff0c\u624d\u7b97\u5339\u914d\u6210\u529f\u3002</p> <p>data \u7ed3\u6784\uff1ascheme://host:port/path...</p> <p>\u7ed3\u6784\u89e3\u91ca\uff1a</p> <ul> <li>Scheme\uff1a\u6bd4\u5982file\u3001content\u3001http\u7b49\uff0c\u5982\u679cURI\u4e2d\u6ca1\u6307\u5b9ascheme\uff0c\u90a3\u6574\u4e2aURI\u5176\u4ed6\u53c2\u6570\u65e0\u6548\uff0c\u4e5f\u610f\u5473\u7740URI\u662f\u65e0\u6548\u7684\u3002</li> <li>Host\uff1a\u5982\u679chost\u672a\u6307\u5b9a\uff0c\u6574\u4e2aURI\u5176\u4ed6\u53c2\u6570\u65e0\u6548\uff0c\u610f\u5473\u7740URI\u4e5f\u662f\u65e0\u6548\u7684\u3002</li> </ul> <p>\u5982\u679c\u6ca1\u6307\u5b9ascheme\uff0c\u7cfb\u7edf\u4f1a\u9ed8\u8ba4\u52a0\u4e0acontent\u548cfile\u3002\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>&lt;intent-filter&gt;\n    &lt;data android:mimeType=\"image/*\" /&gt;\n&lt;/intent-filter&gt;\n\n\u4f7f\u7528Intent.setDataAndType(Uri.parse(\"file://abc\"), \"image/png\")\uff0c\u80fd\u5339\u914d\n\u4f7f\u7528Intent.setDataAndType(Uri.parse(\"http://abc\"), \"image/png\")\uff0c\u65e0\u6cd5\u5339\u914d\n\n</code></pre> <pre><code>&lt;intent-filter&gt;\n    &lt;action android:name=\"com.shannon.demo.jump\" /&gt;\n    &lt;data\n        android:host=\"shannon\"\n        android:scheme=\"router\" /&gt;\n&lt;/intent-filter&gt;\n\n\u4ee5\u4e0bIntent\u53ef\u4ee5\u5339\u914d\u4e0a\u8ff0\u76ee\u6807\u7ec4\u4ef6\uff1a\nIntent intent = new Intent(\"com.shannon.demo.jump\");\nintent.setData(Uri.parse(\"shannon://router\"));\n</code></pre>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%80%8E%E4%B9%88%E5%81%9A%E7%89%9B%E9%80%BC%E7%9A%84%E5%8A%A8%E7%94%BB/","title":"\u600e\u4e48\u505a\u725b\u903c\u7684\u52a8\u753b","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%80%8E%E4%B9%88%E5%81%9A%E7%89%9B%E9%80%BC%E7%9A%84%E5%8A%A8%E7%94%BB/#_1","title":"\u52a8\u753b\u57fa\u7840","text":"<ul> <li> <p>\u672c\u8d28 \u6bcf\u5e27\u7ed8\u5236\u4e0d\u540c\u7684\u5185\u5bb9</p> </li> <li> <p>\u57fa\u672c\u8fc7\u7a0b \u5f00\u59cb\u52a8\u753b\u540e\uff0c\u8c03\u7528 View \u7684 invalidate \u89e6\u53d1\u91cd\u7ed8\u3002\u91cd\u7ed8\u540e\u68c0\u67e5\u52a8\u753b\u662f\u5426\u505c\u6b62\uff0c\u82e5\u672a\u505c\u6b62\u5219\u7ee7\u7eed\u8c03\u7528 invalidate \u89e6\u53d1\u4e0b\u4e00\u5e27(\u4e0b\u4e00\u6b21\u91cd\u7ed8)\uff0c\u76f4\u5230\u52a8\u753b\u7ed3\u675f\u3002</p> </li> </ul> <p>\u91cd\u7ed8\u65f6 View \u7684 draw \u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\uff0c\u6839\u636e\u52a8\u753b\u7684\u8fdb\u884c\u7ed8\u5236\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u5982\u67d0\u4e2a\u88ab\u7ed8\u5236\u5143\u7d20\u7684\u5927\u5c0f\u53d8\u5316\u3001\u89d2 \u5ea6\u65cb\u8f6c\u3001\u900f\u660e\u5ea6\u53d8\u5316\u7b49\uff0c\u8fd9\u6837\u5373\u4f1a\u4ea7\u751f\u52a8\u753b\u3002</p> <p>\u52a8\u753b\u7684\u63a8\u8fdb\u8fc7\u7a0b\u4e00\u822c\u90fd\u4f1a\u6709\u4e00\u4e2a\u53d8\u5316\u91cf\uff0c\u8fd9\u4e2a\u53d8\u91cf\u4f1a\u88ab\u7528\u5230 draw \u65b9\u6cd5\u5185\u5143\u7d20\u7684\u7ed8\u5236\u3002\u4e00\u822c\u7684\u53d8\u91cf\u90fd\u662f\u65f6 \u95f4\uff0c\u4e5f\u53ef\u4ee5\u662f\u624b\u6307\u79fb\u52a8\u3001\u4f20\u611f\u5668\u7b49\u4efb\u4f55\u5176\u4ed6\u7684\u53d8\u91cf\u3002</p> <ul> <li>Android\u4e2d\u7684\u52a8\u753b\u652f\u6301</li> </ul> <p>Animation:\u65e9\u671f\u5b9e\u73b0\u7684\u8ba9 View \u6574\u4f53\u505a\u52a8\u753b\u7684\u7c7b\u3002\u80fd\u8ba9 View \u505a Matrix(\u79fb\u52a8\u3001\u7f29\u653e\u3001\u65cb\u8f6c\u30013D \u65cb\u8f6c)\u548c Alpha(\u900f\u660e)\u7684\u52a8\u753b\u3002 Animator:\u6709\u786c\u4ef6\u52a0\u901f\u540e\u4e3a\u505a\u52a8\u753b\u5b9e\u73b0\u7684\u7c7b\u3002\u80fd\u65b9\u4fbf\u7684\u8ba9 View \u6574\u4f53\u505a\u52a8\u753b;\u4e5f\u53ef\u4ee5\u53ea\u4ea7\u751f\u968f\u65f6\u95f4\u53d8\u5316\u7684\u53d8 \u91cf\uff0c\u7528\u6765\u5728 onDraw \u91cc\u505a\u7ed8\u56fe\u7ea7\u7684\u52a8\u753b\u3002\u6bd4 Animation \u7075\u6d3b\u5f88\u591a\u3002 AnimationDrawable\u56fe\u7247\u9010\u5e27\u52a8\u753b\u3002\u4e3b\u8981\u7528\u6765\u64ad\u653e\u63d0\u524d\u5236\u4f5c\u597d\u7684\u52a8\u753b\u3002</p> <ul> <li>\u5728\u54ea\u4e2a\u7ea7\u522b\u505a\u52a8\u753b</li> </ul> <p>\u8ba9\u6574\u4e2a View \u505a\u52a8\u753b(\u6bd4\u5982\u6574\u4e2a View \u5e73\u79fb\u3001\u65cb\u8f6c\u7b49)\u5f88\u7b80\u5355\u65b9\u4fbf\uff0c\u4e00\u822c\u8c03\u7528\u51e0\u884c\u4ee3\u7801\u5c31\u884c\u3002\u6211\u628a\u5b83\u79f0\u4f5c View \u7ea7\u7684\u52a8\u753b\u3002</p> <p>\u5728 View \u7684 draw/onDraw \u91cc\u901a\u8fc7 Canvas \u6765\u7ed8\u5236\u65f6\u505a\u52a8\u753b\u66f4\u7075\u6d3b\uff0c\u66f4\u7cbe\u7ec6\uff0c\u80fd\u529b\u66f4\u5f3a\u5927\u3002\u6211\u628a\u5b83\u79f0\u4f5c\u7ed8\u56fe \u7ea7\u7684\u52a8\u753b\u3002(View \u7ea7\u7684\u52a8\u753b\u672c\u8d28\u4e0a\u4e5f\u662f\u8fd9\u4e48\u505a\u7684\uff0c\u53ea\u662f Android \u7cfb\u7edf\u5e2e\u6211\u4eec\u505a\u4e86\u5927\u90e8\u5206\u5de5\u4f5c)</p> <ul> <li>\u7ed8\u56fe\u7ea7\u7684\u52a8\u753b \u4e0b\u9762\u6765\u4e00\u6bb5\u7ed8\u56fe\u7ea7\u52a8\u753b\u7684\u5178\u578b\u5b9e\u73b0:</li> </ul> <pre><code>class MyView extends View { \n    void startAnimator() {\n        ValueAnimator animator = ValueAnimator.ofFloat(1f, 0f);\n        animator.start(); \n        invalidate();\n        }\n\nprotected void onDraw(Canvas canvas) {\n    if (animator.isRunning()) {\n        float ratio = (Float)animator.getAnimatedValue(); \n        canvas.rotate(ratio*360); \n        canvas.drawBitmap(bitmap, 0, 0, null);\n        invalidate(); \n        }\n        ... \n    }\n}\n</code></pre> <p>\u6709\u4e86\u4e0d\u65ad\u53d8\u5316\u7684 ratio \u53d8\u91cf\uff0c\u7ed8\u56fe\u7ea7\u52a8\u753b\u5c31\u53ef\u4ee5\u5927\u5c55\u8eab\u624b\u4e86\u3002 \u7ed8\u56fe\u7ea7\u52a8\u753b\u7684\u5f3a\u5927\u80fd\u529b\u6765\u81ea\u7ed8\u56fe API \u7684\u5f3a\u5927\u80fd\u529b\uff0c\u4e0b\u9762\u4e3b\u8981\u8bb2\u7ed8\u56fe API\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%80%8E%E4%B9%88%E5%81%9A%E7%89%9B%E9%80%BC%E7%9A%84%E5%8A%A8%E7%94%BB/#api","title":"\u7ed8\u56feAPI","text":"<ul> <li>Matrix</li> </ul> <p>Canvas.[translate,scale,rotate,skew]\u65b9\u6cd5</p> <p>Matrix.set/pre/post[translate,scale,rotate,skew]\u65b9\u6cd5</p> <p>\u5e73\u79fb\u3001\u7f29\u653e\u3001\u65cb\u8f6c\u3001\u659c\u5207</p> <p>\u4ece\u4f7f\u7528 API \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u6211\u4eec\u901a\u8fc7\u8c03\u7528 Canvas.translate \u7b49\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u540e\u7eed\u5728\u6b64 Canvas \u4e0a\u7ed8\u5236\u64cd\u4f5c\u7684 \u7ed8\u5236\u533a\u57df\u53d8\u5316\uff0c\u5982 translate(5,0)\uff0c\u5219\u540e\u7eed\u6240\u6709\u7ed8\u5236\u64cd\u4f5c\u7684\u7ed8\u5236\u533a\u57df\u90fd\u4f1a\u5411\u53f3\u79fb\u52a8 5 \u4e2a\u50cf\u7d20\u3002</p> <p>\u539f\u7406:Canvas \u91cc\u6709\u4e00\u4e2a Matrix\uff0cCanvas \u4e0a\u7684\u8fd9\u51e0\u4e2a\u8c03\u7528\u90fd\u4f1a\u6700\u7ec8\u8c03\u7528\u5230 Matrix.pre*\u3002\u8fd9\u4e2a Matrix \u4fdd\u5b58\u6574 \u4e2a\u53d8\u6362\u8fc7\u7a0b\u3002\u5f53\u6709 Canvas.draw \u65f6\uff0c\u8981\u7ed8\u5236\u7684\u70b9\u90fd\u4f1a\u7ecf\u8fc7 Matrix.mapPoints \u65b9\u6cd5\u505a\u4e00\u4e2a\u6620\u5c04\u3002\u4e8e\u662f\u4ea7\u751f\u6211 \u4eec\u671f\u671b\u7684\u53d8\u6362\u6548\u679c\u3002(\u4e8b\u5b9e\u4e0a\u6620\u5c04\u7684\u65f6\u5019\u53ea\u9700\u8981\u6620\u5c04\u5173\u952e\u70b9\uff0c\u5176\u4ed6\u7684\u662f\u63d2\u503c\u6765\u7684)</p> <p>\u5173\u4e8e Matrix \u7684\u66f4\u591a\u4fe1\u606f</p> <p>set/pre/post \u7684\u533a\u522b:set \u662f\u8bbe\u7f6e\uff0c\u51b2\u6389\u4ee5\u524d\u7684\u6570\u636e\u3002pre \u662f\u524d\u4e58\uff0cpost \u662f\u540e\u4e58\uff0c\u6839\u672c\u4e0a\u8bb2\u5c31\u662f\u751f\u6548\u987a \u5e8f\u4e0d\u540c\u3002\u5177\u4f53\u8868\u73b0\u6548\u679c\u53ef\u5728\u7f51\u4e0a\u641c\u7d22\u8d44\u6599\u3002</p> <p>setPolyToPoly:\u4e0e mapPoints \u65b9\u6cd5\u76f8\u53cd\uff0cmapPoints \u662f\u901a\u8fc7\u77e9\u9635\u628a\u539f\u59cb\u70b9\u6620\u5c04\u4e3a\u76ee\u6807\u70b9\u3002  setPolyToPoly \u662f\u8f93\u5165\u539f\u59cb\u70b9\u548c\u6620\u5c04\u540e\u7684\u76ee\u6807\u70b9\uff0c\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u77e9\u9635\u3002</p> <p>Camera:\u6709\u900f\u89c6\u6548\u679c\u7684 3D \u65cb\u8f6c\u3002Camera \u662f\u4e00\u4e2a\u751f\u6210 Matrix \u7684\u5de5\u5177\u7c7b\u3002\u53ef\u7528\u6765\u751f\u6210\u6709\u900f\u89c6\u6548\u679c\u7684 3D \u65cb\u8f6c\u3002</p> <p>Canvas.draw*\u65b9\u6cd5</p> <pre><code>Canvas.draw-Point/s\nCanvas.draw-Line/s \nCanvas.draw-Rect,RoundRect,Circle,Oval,Arc,Path \nCanvas.draw-Text \nCanvas.draw-Bitmap,BitmapMesh \nCanvas.draw-Color,Paint\n</code></pre> <p>\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u8868\u793a\u7ed8\u5236\u4e00\u4e2a\u533a\u57df\u3002\u7ed8\u5236\u7684\u533a\u57df\u4e2d\u7a76\u7adf\u586b\u5145\u4ec0\u4e48\u989c\u8272\uff0c\u7531 Paint \u51b3\u5b9a\u3002</p> <p>Color,Paint,Bitmap,BitmapMesh \u8fd9\u51e0\u4e2a\u5219\u9664\u4e86\u6307\u5b9a\u7ed8\u5236\u533a\u57df\u5916\uff0c\u8fd8\u6307\u5b9a\u4e86\u586b\u5145\u5185\u5bb9\u3002</p> <p>Path \u529f\u80fd\u6bd4\u8f83\u5f3a\u5927\uff0c\u53ef\u81ea\u884c\u7ec4\u7ec7\u6210\u4efb\u4f55\u5f62\u72b6\uff0c\u8fd8\u53ef\u4ee5\u7528\u8d1d\u585e\u5c14\u66f2\u7ebf\u3002</p> <p>\u8fd9\u4e9b\u65b9\u6cd5\u57fa\u672c\u4e0a\u90fd\u5f88\u597d\u7406\u89e3\uff0c\u4ece\u540d\u5b57\u4e0a\u5373\u53ef\u770b\u51fa\u5176\u529f\u80fd\u3002\u8fd9\u91cc\u91cd\u70b9\u63d0\u4e00\u4e0b drawBitmapMesh\u3002</p> <p>drawBitmapMesh \u662f\u8f93\u5165\u4e00\u4e2a\u7f51\u683c\u6a21\u578b\uff0c\u7ed8\u5236\u51fa\u7684\u56fe\u7247\u5185\u5bb9\u5c06\u4f9d\u636e\u8fd9\u4e2a\u7f51\u683c\u6765\u626d\u66f2\u3002\u53ef\u4ee5\u60f3\u50cf\u6210\u628a\u56fe\u7247\u753b \u5728\u4e00\u5757\u6709\u5f39\u6027\u7684\u5e03\u4e0a\uff0c\u5f53\u6211\u4eec\u628a\u5e03\u7684\u67d0\u4e9b\u533a\u57df\u626f\u52a8\u7684\u65f6\u5019\uff0c\u4f1a\u5f62\u6210\u753b\u9762\u626d\u66f2\u6548\u679c\u3002</p> <p>\u793a\u4f8b:\u5047\u8bbe\u6709\u4e2a 30x30 \u5927\u5c0f\u7684\u56fe\u7247\uff0c\u6211\u4eec\u5efa\u7acb\u8fd9\u6837\u7684\u7f51\u683c\u8f93\u5165:</p> 0,0 15,0 30,0 0,15 15,15 30,15 0,30 15,30 30,30 <p>\u5219\u56fe\u7247\u4f1a\u539f\u6837\u8f93\u51fa\uff0c\u6ca1\u6709\u4efb\u4f55\u626d\u66f2\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5efa\u7acb\u8fd9\u6837\u7684\u7f51\u683c\u8f93\u5165:</p> 0,0 15,12 30,0 0,15 15,15 30,15 0,30 15,30 30,30 <p>\u5219\u539f\u672c[15,0]\u7684\u70b9\u4f1a\u88ab\u7ed8\u5236\u5230[15,12]\u7684\u4f4d\u7f6e\u4e0a\u53bb\u3002\u56fe\u7247\u7ed8\u5236\u51fa\u6765\u540e\uff0c\u4e0a\u9762\u90e8\u5206\u4f1a\u7f3a\u4e00\u5757\uff0c\u5f62\u6210\u7528\u624b\u628a\u56fe\u7247\u4ece \u4e0a\u8fb9\u4e2d\u95f4\u4f4d\u7f6e\u5f80\u4e0b\u62c9\u7684\u626d\u66f2\u6548\u679c\u3002\u4f46\u5f88\u9510\u5229\uff0c\u4e0a\u9762\u7f3a\u7684\u4e00\u5757\u662f\u4e2a\u4e09\u89d2\u5f62\u800c\u4e0d\u4f1a\u662f\u534a\u5706\u578b\uff0c\u901a\u5e38\u6211\u4eec\u5e0c\u671b\u7684 \u662f\u534a\u5706\u578b\uff0c\u8fd9\u5c31\u9700\u8981\u6211\u4eec\u628a\u8fd9\u4e2a\u7f51\u683c\u5efa\u5f97\u5bc6\u4e00\u4e9b\u3002</p> <ul> <li>Alpha \u901a\u9053</li> </ul> <p>\u6bcf\u4e2a Color \u91cc\u53ef\u4ee5\u6709\u56db\u4e2a\u901a\u9053 ARGB\uff0c\u5176\u4e2d RGB \u662f\u7ea2\u7eff\u84dd\uff0cA \u5373 Alpha \u901a\u9053\uff0c\u5b83\u901a\u5e38\u7684\u4f5c\u7528\u662f\u7528\u6765\u4f5c\u4e3a\u6b64 \u989c\u8272\u7684\u900f\u660e\u5ea6\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u7684\u663e\u793a\u5c4f\u662f\u6ca1\u6cd5\u900f\u660e\u7684\uff0c\u56e0\u6b64\u6700\u7ec8\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u7684\u989c\u8272\u91cc\u53ef\u4ee5\u8ba4\u4e3a\u6ca1\u6709 Alpha \u901a\u9053\u3002Alpha \u901a\u9053 \u4e3b\u8981\u5728\u4e24\u4e2a\u56fe\u50cf\u6df7\u5408\u7684\u65f6\u5019\u751f\u6548\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u4e00\u4e2a\u989c\u8272\u7ed8\u5236\u5230 Canvas \u4e0a\u65f6\u7684\u6df7\u5408\u6a21\u5f0f\u662f\u8fd9\u6837\u8ba1\u7b97\u7684:(RGB \u901a\u9053) \u6700\u7ec8\u989c\u8272 = \u7ed8\u5236\u7684\u989c \u8272 + (1 - \u7ed8\u5236\u989c\u8272\u7684\u900f\u660e\u5ea6) \u00d7 Canvas \u4e0a\u7684\u539f\u6709\u989c\u8272\u3002</p> <p>\u6ce8\u610f: 1. \u8fd9\u91cc\u6211\u4eec\u4e00\u822c\u628a\u6bcf\u4e2a\u901a\u9053\u7684\u53d6\u503c\u4ece 0 \u5230 255 \u6620\u5c04\u5230 0 \u5230 1 \u7684\u6d6e\u70b9\u6570\u8868\u793a\u3002 2. \u8fd9\u91cc\u7b49\u5f0f\u53f3\u8fb9\u7684\u201c\u7ed8\u5236\u7684\u989c\u8272\"\u3001\u201cCanvas \u4e0a\u7684\u539f\u6709\u989c\u8272\u201d\u90fd\u662f\u7ecf\u8fc7\u9884\u4e58\u4e86\u81ea\u5df1\u7684 Alpha \u901a\u9053\u7684\u503c\u3002\u5982 \u7ed8\u5236\u989c\u8272:0x88ffffff\uff0c\u90a3\u4e48\u53c2\u4e0e\u8fd0\u7b97\u65f6\u7684\u6bcf\u4e2a\u989c\u8272\u901a\u9053\u7684\u503c\u4e0d\u662f 1.0\uff0c\u800c\u662f(1.0 * 0.53125 = 0.53125)\u3002</p> <p>\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u7684\u6df7\u5408\uff0c\u5c31\u4f1a\u9020\u6210\u540e\u7ed8\u5236\u7684\u5185\u5bb9\u4ee5\u534a\u900f\u660e\u7684\u65b9\u5f0f\u53e0\u5728\u4e0a\u9762\u7684\u89c6\u89c9\u6548\u679c\u3002</p> <p>\u5176\u5b9e\u8fd8\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u6df7\u5408\u6a21\u5f0f\u4f9b\u6211\u4eec\u9009\u62e9\uff0c\u7528 Paint.setXfermode\uff0c\u6307\u5b9a\u4e0d\u540c\u7684 PorterDuff.Mode\u3002</p> <p>\u4e0b\u8868\u662f\u5404\u4e2a PorterDuff \u6a21\u5f0f\u7684\u6df7\u5408\u8ba1\u7b97\u516c\u5f0f:(D \u6307\u539f\u672c\u5728 Canvas \u4e0a\u7684\u5185\u5bb9 dst\uff0cS \u6307\u7ed8\u5236\u8f93\u5165\u7684\u5185\u5bb9 src\uff0ca \u6307 alpha \u901a\u9053\uff0cc \u6307 RGB \u5404\u4e2a\u901a\u9053)</p> <p>ADD | Saturate(S + D)  -| :-: |  CLEAR | [0, 0] DARKEN | [Sa + Da - SaDa, Sc(1 - Da) + Dc(1 - Sa) + min(Sc, Dc)] DST | [Da, Dc] DST_ATOP | [Sa,SaDc+Sc(1-Da)] DST_IN | [Sa * Da, Sa * Dc] DST_OUT | [Da * (1 - Sa), Dc * (1 - Sa)] DST_OVER | [Sa + (1 - Sa)Da, Rc = Dc + (1 - Da)Sc] LIGHTEN | [Sa + Da - SaDa, Sc(1 - Da) + Dc(1 - Sa) + max(Sc, Dc)] MULTIPLY | [Sa * Da, Sc * Dc] SCREEN | [Sa + Da - Sa * Da, Sc + Dc - Sc * Dc] SRC | [Sa, Sc] SRC_ATOP | [Da,ScDa+(1-Sa)Dc] SRC_IN | [Sa * Da, Sc * Da] SRC_OUT | [Sa(1-Da),Sc(1-Da)] SRC_OVER | [Sa + (1 - Sa)Da, Rc = Sc + (1 - Sa)Dc] XOR | [Sa + Da - 2 * Sa * Da, Sc * (1 - Da) + (1 - Sa) * Dc]</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u4e4b\u524d\u7684\u9ed8\u8ba4\u6df7\u5408\u6a21\u5f0f\u5176\u5b9e\u5c31\u662f SRC_OVER\u3002</p> <p>\u901a\u8fc7\u9009\u62e9\u5176\u4ed6\u7684 PorterDuff \u6a21\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8fbe\u5230\u4e00\u4e9b\u7279\u6b8a\u7684\u6548\u679c:</p> <p>\u4f7f\u7528 DST_OVER \u7684\u8bdd\uff0c\u76f8\u5f53\u4e8e\u540e\u7ed8\u5236\u7684\u5185\u5bb9\u4f5c\u4e3a\u80cc\u666f\u5728\u5e95\u4e0b\u3002</p> <p>\u4f7f\u7528 DST_IN/DST_OUT \u7684\u8bdd\uff0c\u53ef\u4ee5\u88c1\u526a Canvas \u91cc\u7684\u5185\u5bb9\uff0c\u6216\u7528\u4e00\u5f20\u5e26 alpha \u7684\u56fe\u7247 mask \u6307\u5b9a\u54ea \u4e9b\u533a\u57df\u663e\u793a/\u4e0d\u663e\u793a\u3002</p> <p>\u901a\u8fc7\u9009\u62e9 SRC_ATOP \u53ef\u4ee5\u53ea\u5728 Canvas \u4e0a\u6709\u5185\u5bb9(\u4e0d\u900f\u660e)\u7684\u5730\u65b9\u7ed8\u5236\u3002</p> <p>\u7528\u4e00\u5f20\u793a\u4f8b\u56fe\u6765\u67e5\u770b\u4f7f\u7528\u4e0d\u540c\u6a21\u5f0f\u65f6\u7684\u6df7\u5408\u6548\u679c(src \u8868\u793a\u8f93\u5165\u7684\u56fe\uff0cdst \u8868\u793a\u539f Canvas \u4e0a\u7684\u5185\u5bb9):</p> <p></p> <ul> <li>\u586b\u5145\u989c\u8272</li> </ul> <p>\u4e4b\u524d\u8bf4\u8fc7 Canvas.draw*\u6307\u5b9a\u4e86\u7ed8\u5236\u7684\u533a\u57df\u3002\u800c\u533a\u57df\u91cc\u7684\u586b\u5145\u989c\u8272\u662f\u7531 Paint \u6765\u6307\u5b9a\u7684\u3002 Paint.setColor \u6307\u5b9a\u7eaf\u8272\u3002</p> <p>Paint.setColor \u6307\u5b9a\u7eaf\u8272\u3002</p> <p>Paint.setShader \u53ef\u6307\u5b9a: BitmapShader, LinearGradient, RadialGradient, SweepGradient, ComposeShader</p> <ul> <li>BitmapShader:\u56fe\u7247\u586b\u5145\u3002</li> <li>LinearGradient, RadialGradient, </li> <li>SweepGradient:\u6e10\u53d8\u586b\u5145\u3002</li> <li>ComposeShader:\u53e0\u52a0\u524d\u9762\u7684\u67d0\u4e24\u79cd\u3002\u53ef\u9009\u62e9 PorterDuff \u6df7\u5408\u6a21\u5f0f\u3002</li> </ul> <p>\u5982\u679c\u65e2\u8c03\u7528\u4e86 setColor\uff0c\u53c8\u8c03\u7528\u4e86 setShader\uff0c\u5219 setShader \u751f\u6548\u3002\u5982\u679c\u540c\u65f6\u7528 setColor \u6216 setAlpha \u8bbe\u7f6e \u4e86\u900f\u660e\u5ea6\uff0c\u5219\u900f\u660e\u5ea6\u4e5f\u4f1a\u751f\u6548\u3002(\u4f1a\u548c Shader \u7684\u900f\u660e\u5ea6\u53e0\u52a0)</p> <p>\u5982\u679c\u4f7f\u7528 drawBitmap \u8f93\u5165\u4e00\u4e2a\u53ea\u6709 alpha \u7684\u56fe\u7247(\u53ef\u7528 Bitmap.extractAlpha \u65b9\u6cd5\u83b7\u5f97)\uff0c\u5219\u4f1a\u4ee5 alpha \u56fe\u7247\u4e3a mask\uff0c\u7ed8\u5236\u51fa shader/color \u7684\u989c\u8272\u3002</p> <ul> <li>ColorFilter</li> </ul> <p>\u901a\u8fc7 ColorFilter \u53ef\u4ee5\u5bf9\u4e00\u6b21\u7ed8\u5236\u7684\u6240\u6709\u50cf\u7d20\u505a\u4e00\u4e2a\u901a\u7528\u5904\u7406\u3002</p> <p>Paint.setColorFilter: LightingColorFilter, PorterDuffColorFilter, ColorMatrixColorFilter</p> <p>\u8fd9\u53ef\u4ee5\u6574\u4f53\u4e0a\u6539\u53d8\u8fd9\u4e00\u6b21 draw \u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u8ba9\u989c\u8272\u66f4\u6697\u3001\u66f4\u4eae\u7b49\u3002</p> <p>\u8fd9\u91cc\u91cd\u70b9\u4ecb\u7ecd\u4e0b ColorMatrixColorFilter\u3002</p> <p>ColorMatrixColorFilter \u662f 4x5 \u77e9\u9635\uff0c\u5b9a\u4e49\u5176\u6bcf\u4e2a\u5143\u7d20\u5982\u4e0b:</p> <p>{ a, b, c, d, e, </p> <p>f, g, h, i, j,</p> <p>k, l, m, n, o,</p> <p>p, q, r, s, t }</p> <p>\u5219 ColorMatrix \u7684\u6700\u7ec8\u8fd0\u7b97\u65b9\u5f0f\u5982\u4e0b:</p> <p>R' = aR + bG + cB + dA + e; </p> <p>G' = fR + gG + hB + iA + j; </p> <p>B' = kR + lG + mB + nA + o; </p> <p>A' = pR + qG + rB + sA + t;</p> <ul> <li>\u7ed8\u56fe API \u67b6\u6784</li> </ul> <p>\u6574\u4e2a\u7ed8\u5236\u6d41\u6c34\u7ebf\u5927\u6982\u5982\u4e0b:(\u6211\u4eec\u80fd\u5b9a\u4e49\u7684\u90e8\u5206\u7528\u84dd\u8272\u8868\u793a)</p> <p></p> <p>\u8003\u8651\u52a8\u753b\u5b9e\u73b0\u7684\u65f6\u5019\u4e00\u822c\u4ece\u4e24\u4e2a\u89d2\u5ea6\u6765\u601d\u8003: </p> <p>\u5b8f\u89c2\u89d2\u5ea6:\u6709\u51e0\u4e2a\u53d8\u5316\u91cf\uff0c\u5206\u522b\u662f\u4ec0\u4e48\u3002\u52a8\u753b\u4ece\u5f00\u59cb\u5230\u7ed3\u675f\u7684\u6d41\u7a0b\u3002 </p> <p>\u5fae\u89c2\u89d2\u5ea6:\u4ece\u67d0\u4e00\u5e27\u4e0a\u53bb\u60f3\uff0c\u5728\u53d8\u5316\u91cf\u4e3a\u67d0\u4e2a\u6570\u503c\u65f6\u7684\u56fe\u50cf\uff0c\u8be5\u600e\u4e48\u7ed8\u5236\u3002 \u628a\u8fd9\u4e24\u8005\u5206\u5f00\u53bb\u60f3\uff0c\u5c31\u4f1a\u6bd4\u8f83\u6e05\u6670\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/","title":"\u63d2\u4ef6\u5316 VirtualAPK","text":"<p>\u52a0\u8f7d\u63d2\u4ef6Activity\u65f6\u9047\u5230\u4e0b\u8ff0\u95ee\u9898\uff1ajava.lang.IllegalStateException: You need to use a Theme.AppCompat theme (or descendant) with this activity</p> <p>\u89e3\u51b3\u65b9\u5f0f\uff1a\u6784\u5efa\u63d2\u4ef6\u8bf7\u4f7f\u7528gradle assemblePlugin\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7AndroidStudio run\u51fa\u6765\u4e00\u4e2a\u63d2\u4ef6apk\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#1-apk","title":"1. \u89e3\u6790\u63d2\u4ef6APK","text":"<p>\u4f7f\u7528PackageParser\u5206\u6790APK\uff0c\u4e3b\u8981\u662f\u5229\u7528XMLPullParser\u89e3\u6790AndroidMenifest.xml\u6587\u4ef6\uff0c\u83b7\u53d6\u5305\u540d\uff08package\uff09\u3001Activity\u7b49\u4fe1\u606f\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#2-activity","title":"2. \u652f\u6301\u63d2\u4ef6Activity","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053\uff0cAndroid\u91cc\u9762\u65e0\u6cd5\u542f\u52a8\u4e00\u4e2a\u6ca1\u6709\u5728Manifest\u4e2d\u6ce8\u518c\u7684Activity\u3002\u63d2\u4ef6\u5bf9\u4e8e\u5bbf\u4e3b\u800c\u8a00\u662f\u4e2a\u9ed1\u76d2\uff0c\u4e5f\u5c31\u662f\u8bf4\u5e38\u89c4\u65b9\u6cd5\u65e0\u6cd5\u542f\u52a8\u63d2\u4ef6\u4e2d\u7684Activity\uff0c\u90a3\u4e48VirtualAPK\u5177\u4f53\u662f\u600e\u4e48\u505a\u5230\u7684\u5462\uff1f</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#21-activity","title":"2.1 Activity\u542f\u52a8\u6d41\u7a0b\u4ecb\u7ecd","text":"<p>\u770b\u4e0bActivity\u542f\u52a8\u6d41\u7a0b\u4e2d\u76f8\u5173\u65b9\u6cd5\u7684\u8c03\u7528\u903b\u8f91\uff1a</p> <pre><code>-&gt; Context.startActivity()\n-&gt; ContextImpl.startActivity()\n-&gt; Instrumentation.execStartActivity()\n-&gt; ActivityManagerProxy.startActivity()\n-&gt; ActivityManagerService.startActivity()\n-&gt; ActivityStackSupervisor.startActivityLocked() \n...\n-&gt; ActivityThread.scheduleLaunchActivity()\n-&gt; ActivityThread.handleLaunchActivity()\n-&gt; ActivityThread.performLaunchActivity()\n...\n</code></pre> <p>\u4ece\u7f51\u4e0a\u627e\u4e86\u5f20\u56fe\u7247\uff0c\u7ec6\u8282\u53ef\u770b\u4e0b\u9762\u8fd9\u5f20\u56fe\uff1a</p> <p></p> <p>AMS\uff1a</p> <p>Activity\u7684\u7ba1\u7406\u91c7\u7528binder\u673a\u5236\uff0c\u7ba1\u7406Activity\u7684\u63a5\u53e3\u662fIActivityManager\u3002ActivityManagerService\u5b9e\u73b0\u4e86Activity\u7ba1\u7406\u529f\u80fd,\u4f4d\u4e8esystem_server\u8fdb\u7a0b\u3002\u4eceActivityManagerService\u63d0\u4f9b\u7684\u63a5\u53e3\u6765\u770b\uff0c\u5b83\u8d1f\u8d23\u7ba1\u7406Activity\u7684\u542f\u52a8\u548c\u751f\u547d\u5468\u671f\u3002</p> <p>ActivityManagerProxy\uff1a</p> <p>ActivityManagerProxy\u5bf9\u8c61\u662fActivityManagerService\u5728\u666e\u901a\u5e94\u7528\u8fdb\u7a0b\u7684\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u5e94\u7528\u8fdb\u7a0b\u901a\u8fc7ActivityManagerProxy\u5bf9\u8c61\u8c03\u7528ActivityManagerService\u63d0\u4f9b\u7684\u529f\u80fd\u3002\u5e94\u7528\u8fdb\u7a0b\u5e76\u4e0d\u4f1a\u76f4\u63a5\u521b\u5efaActivityManagerProxy\u5bf9\u8c61\uff0c\u800c\u662f\u901a\u8fc7\u8c03\u7528ActiviyManagerNative\u7c7b\u7684\u5de5\u5177\u65b9\u6cd5getDefault\u65b9\u6cd5\u5f97\u5230ActivityManagerProxy\u5bf9\u8c61\u3002\u6240\u4ee5\u5728\u5e94\u7528\u8fdb\u7a0b\u91cc\u901a\u5e38\u8fd9\u6837\u542f\u52a8Activty:</p> <pre><code>ActivityManagerNative.getDefault().startActivity()\n</code></pre>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#22-activity","title":"2.2 Activity\u5b89\u5168\u6821\u9a8c","text":"<p>\u8ddf\u8fdbstartActivity\u7684\u8c03\u7528\u6d41\u7a0b\uff0c\u4f1a\u53d1\u73b0\u5176\u6700\u7ec8\u4f1a\u8fdb\u5165Instrumentation\u7684execStartActivity\u65b9\u6cd5\uff0c\u7136\u540e\u518d\u901a\u8fc7ActivityManagerProxy\u4e0eAMS\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>Activity\u662f\u5426\u5b58\u5728\u7684\u6821\u9a8c\u662f\u53d1\u751f\u5728AMS\u7aef\uff08\u5b9e\u73b0\u7ec6\u8282\u53ef\u53c2\u8003ActivityStackSupervisor.startActivityLocked\u65b9\u6cd5\uff09\uff0cInstrumentation\u6839\u636eAMS\u4fa7\u8fd4\u56de\u7684\u6821\u9a8c\u7ed3\u679c\uff0c\u5728Instrumentation.checkStartActivityResult\u65b9\u6cd5\u4e2d\u629b\u51fa\u5bf9\u5e94\u7684\u5f02\u5e38\u3002</p> <p>Instrumentation.class</p> <pre><code>public ActivityResult execStartActivity(...) {\n        ...\n        int result = ActivityManagerNative.getDefault()\n            .startActivity(whoThread, who.getBasePackageName(), intent,\n                    intent.resolveTypeIfNeeded(who.getContentResolver()),\n                    token, target != null ? target.mEmbeddedID : null,\n                    requestCode, 0, null, options);\n        checkStartActivityResult(result, intent);\n        ...\n    }\n\n// \u6839\u636eAMS\u4fa7\u7684\u6821\u9a8c\u7ed3\u679c\u629b\u51fa\u5bf9\u5e94\u5f02\u5e38\npublic static void checkStartActivityResult(int res, Object intent) {\n        if (res &gt;= ActivityManager.START_SUCCESS) {\n            return;\n        }\n\n        switch (res) {\n            case ActivityManager.START_INTENT_NOT_RESOLVED:\n            case ActivityManager.START_CLASS_NOT_FOUND:\n                if (intent instanceof Intent &amp;&amp; ((Intent)intent).getComponent() != null)\n                    throw new ActivityNotFoundException(\n                            \"Unable to find explicit activity class \"\n                            + ((Intent)intent).getComponent().toShortString()\n                            + \"; have you declared this activity in your AndroidManifest.xml?\");\n                throw new ActivityNotFoundException(\n                        \"No Activity found to handle \" + intent);\n\n            ...\n        }\n    }\n</code></pre> <p>\u6240\u4ee5\u6211\u4eec\u5728\u4e8eAMS\u4ea4\u4e92\u524d\uff0c\u63d0\u524d\u5c06Activity\u7684ComponentName\u8fdb\u884c\u66ff\u6362\u4e3a\u5360\u5751\u7684\u540d\u5b57\u4e0d\u5c31\u597d\u4e86\u4e48\uff1f \u8fd9\u91cc\u53ef\u4ee5\u9009\u62e9hook Instrumentation\uff0c\u6216\u8005ActivityManagerProxy\u90fd\u53ef\u4ee5\u8fbe\u5230\u76ee\u6807\uff0cVirtualAPK\u9009\u62e9\u4e86hook Instrumentation.</p> <p>\u90a3VirtualAPK\u5982\u4f55hook Instrumentation\u7684\u5462\uff1f</p> <p>\u770b\u4e0bPluginManager\uff1a</p> <pre><code>private void hookInstrumentationAndHandler() {\n        try {\n            Instrumentation baseInstrumentation = ReflectUtil.getInstrumentation(this.mContext);\n            if (baseInstrumentation.getClass().getName().contains(\"lbe\")) {\n                // reject executing in paralell space, for example, lbe.\n                System.exit(0);\n            }\n\n            final VAInstrumentation instrumentation = new VAInstrumentation(this, baseInstrumentation);\n            Object activityThread = ReflectUtil.getActivityThread(this.mContext);\n            ReflectUtil.setInstrumentation(activityThread, instrumentation);\n            ReflectUtil.setHandlerCallback(this.mContext, instrumentation);\n            this.mInstrumentation = instrumentation;\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n</code></pre> <p>\u5176\u4e2dmContext\u662f\u5bbf\u4e3bAPP\u7684Application Context\u3002\u66ff\u6362\u5de5\u4f5c\u4e3b\u8981\u662f\u5c06Context\u7684mInstrumentation\u5bf9\u8c61\u66ff\u6362\u4e3aVAInstrumentation\u5bf9\u8c61\u3002\u90a3\u4e48\uff0c\u542f\u52a8Activity\u65f6\uff0c\u6267\u884c\u7684\u5176\u5b9e\u662fVAInstrumentation\u3002</p> <p>\u542f\u52a8\u76ee\u6807Activity\u65f6\uff0c\u6bd4\u5982PluginDemo\u4e2d\u7684BookManagerActivity\uff0c\u5148hook Instrumentation\uff0c\u5c06\u76ee\u6807Activity\u66ff\u6362\u4e3a\u5360\u5751Activity\uff0c\u5176\u4e2d\u5360\u5751Activity\u5df2\u7ecf\u5728\u5bbf\u4e3bApp\u4e2d\u6ce8\u518c\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u73b0\u95ee\u9898\u4e86\u3002\u5177\u4f53\u7684\u66ff\u6362\u903b\u8f91\u770b\u4e0b\u9762\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#22-activity_1","title":"2.2 \u66ff\u6362\u76ee\u6807Activity","text":"<p>\u901a\u8fc7\u5bf9Activity\u542f\u52a8\u6d41\u7a0b\u7684\u5206\u6790\uff0cstartActivity\u540e\u4f1a\u6267\u884cVAInstrumentation.execStartActivity()\u3001ComponentsHandler.markIntentIfNeeded()</p> <pre><code>ComponentsHandler.class\n\npublic void markIntentIfNeeded(Intent intent) {\n        if (intent.getComponent() == null) {\n            return;\n        }\n\n        String targetPackageName = intent.getComponent().getPackageName();\n        String targetClassName = intent.getComponent().getClassName();\n        // search map and return specific launchmode stub activity\n        if (!targetPackageName.equals(mContext.getPackageName()) &amp;&amp; mPluginManager.getLoadedPlugin(targetPackageName) != null) {\n            intent.putExtra(Constants.KEY_IS_PLUGIN, true);\n            intent.putExtra(Constants.KEY_TARGET_PACKAGE, targetPackageName);\n            intent.putExtra(Constants.KEY_TARGET_ACTIVITY, targetClassName);\n            dispatchStubActivity(intent);\n        }\n    }\n</code></pre> <p>\u8fd9\u5757\u903b\u8f91\u4e3b\u8981\u8bb2\u8981\u542f\u52a8\u7684\u76ee\u6807Activity\u5b58\u50a8\u5230Intent\u4e2d\uff0c\u65b9\u4fbf\u201c\u6b3a\u4e0a\u7792\u4e0b\u201d\u4e4b\u540e\u518d\u62ff\u51fa\u6765\u542f\u52a8\u3002</p> <p>Activity\u66ff\u6362\u7684\u5b9e\u73b0\u5728\u4e0b\u9762\uff1a</p> <pre><code>ComponentsHandler.class\n\nprivate void dispatchStubActivity(Intent intent) {\n        // \u6b64\u5904component\u8fd8\u662fBookManagerActivity\n        ComponentName component = intent.getComponent();\n        String targetClassName = intent.getComponent().getClassName();\n        LoadedPlugin loadedPlugin = mPluginManager.getLoadedPlugin(intent);\n        ActivityInfo info = loadedPlugin.getActivityInfo(component);\n        if (info == null) {\n            throw new RuntimeException(\"can not find \" + component);\n        }\n        int launchMode = info.launchMode;\n        Resources.Theme themeObj = loadedPlugin.getResources().newTheme();\n        themeObj.applyStyle(info.theme, true);\n\n        // \u6839\u636elaunchMode\u83b7\u53d6\u5360\u5751Activity\uff0c\u5360\u5751Activity\u683c\u5f0f\u7c7b\u4f3c\u4e8e\u201ccom.didi.virtualapk.core.A$1\u201d\n        String stubActivity = mStubActivityInfo.getStubActivity(targetClassName, launchMode, themeObj);\n        Log.i(TAG, String.format(\"dispatchStubActivity,[%s -&gt; %s]\", targetClassName, stubActivity));\n\n        // \u5c06BookManagerActivity\u66ff\u6362\u6210\u5360\u5751Activity\n        intent.setClassName(mContext, stubActivity);\n    }\n</code></pre> <p>\u5728StubActivityInfo.getStubActivity\u4e2d\u62ff\u5230\u5360\u5751Activity\uff0c\u628a\u76ee\u6807Activity\u66ff\u6362\u6389\uff0c\u540e\u7eedAMS\u4fa7\u6821\u9a8c\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u4f1a\u51fa\u73b0\u95ee\u9898\u3002</p> <p>\u770b\u4e0b\u83b7\u53d6\u5360\u5751Activity\u7684\u903b\u8f91\uff0c\u4e3b\u8981\u662f\u6839\u636elaunchMode\u3001Theme\u9009\u62e9\u5360\u5751Activity\u3002</p> <pre><code>StubActivityInfo.class\n\npublic static final String corePackage = \"com.didi.virtualapk.core\";\npublic static final String STUB_ACTIVITY_STANDARD = \"%s.A$%d\";\npublic static final String STUB_ACTIVITY_SINGLETOP = \"%s.B$%d\";\npublic static final String STUB_ACTIVITY_SINGLETASK = \"%s.C$%d\";\npublic static final String STUB_ACTIVITY_SINGLEINSTANCE = \"%s.D$%d\";\n\npublic String getStubActivity(String className, int launchMode, Theme theme) {\n        ...\n\n        stubActivity = String.format(STUB_ACTIVITY_STANDARD, corePackage, usedStandardStubActivity);\n        switch (launchMode) {\n            case ActivityInfo.LAUNCH_MULTIPLE: {\n                // format\u540e\u7684\u7ed3\u679c\u7c7b\u4f3c\u4e8e\u201ccom.didi.virtualapk.core.A$1\u201d\uff0c\u8fd9\u4e2aActivity\u662f\u5728AndroidManifest\u4e2d\u6ce8\u518c\u8fc7\u7684\n                stubActivity = String.format(STUB_ACTIVITY_STANDARD, corePackage, usedStandardStubActivity);\n                if (windowIsTranslucent) {\n                    stubActivity = String.format(STUB_ACTIVITY_STANDARD, corePackage, 2);\n                }\n                break;\n            }\n           ...\n        }\n\n        mCachedStubActivity.put(className, stubActivity);\n        return stubActivity;\n    }\n</code></pre> <p>\u5bbf\u4e3bAPP\uff0cAndroidManifest.xml\u4e2d\u9884\u5148\u6ce8\u518c\u4e00\u4e9b\u5360\u5751Activity\u3002</p> <pre><code>&lt;application&gt;\n        &lt;!-- Stub Activities --&gt;\n        &lt;activity android:name=\".A$1\" android:launchMode=\"standard\"/&gt;\n        &lt;activity android:name=\".A$2\" android:launchMode=\"standard\"\n            android:theme=\"@android:style/Theme.Translucent\" /&gt;\n\n        &lt;!-- Stub Activities --&gt;\n        &lt;activity android:name=\".B$1\" android:launchMode=\"singleTop\"/&gt;\n        &lt;activity android:name=\".B$2\" android:launchMode=\"singleTop\"/&gt;\n\n        &lt;!-- Stub Activities --&gt;\n        &lt;activity android:name=\".C$1\" android:launchMode=\"singleTask\"/&gt;\n        &lt;activity android:name=\".C$2\" android:launchMode=\"singleTask\"/&gt;\n\n        &lt;!-- Stub Activities --&gt;\n        &lt;activity android:name=\".D$1\" android:launchMode=\"singleInstance\"/&gt;\n        &lt;activity android:name=\".D$2\" android:launchMode=\"singleInstance\"/&gt;\n        ...\n&lt;/application&gt;\n</code></pre>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#23-activity","title":"2.3 \u8fd8\u539f\u76ee\u6807Activity","text":"<p>\u867d\u7136\u5c06\u76ee\u6807Activity\u66ff\u6362\u6210\u5360\u5751Activity\uff0c\u907f\u514d\u4e86\u542f\u52a8\u4e00\u4e2a\u6ca1\u5728Manifest\u4e2d\u6ce8\u518c\u7684Activity\u7684\u9519\u8bef\u3002\u4f46\u662f\u6700\u7ec8\u9700\u8981\u542f\u52a8\u7684\u4e0d\u53ef\u80fd\u662f\u5360\u5751Activity\uff0c\u800c\u662f\u76ee\u6807Activity\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u5bf9Activity\u542f\u52a8\u6d41\u7a0b\u7684\u5206\u6790\uff0cstartActivity\u540e\u4f1a\u6267\u884c\u5230ActivityThread.performLaunchActivity()\u3002\u8fd9\u4e2a\u65b9\u6cd5\u91cc\u9762\u4f1a\u6267\u884cInstrumentation.newActivity()\uff0c\u5b9e\u4f8b\u5316\u76ee\u6807Activity\u3002\u770b\u770bVAInstrumentation\u8fd9\u5757\u7684\u5b9e\u73b0\uff1a</p> <p>VAInstrumentation.class</p> <pre><code>@Override\npublic Activity newActivity(ClassLoader cl, String className, Intent intent) throws InstantiationException, IllegalAccessException, ClassNotFoundException {\n    try {\n        cl.loadClass(className);\n    } catch (ClassNotFoundException e) {\n        //\u6839\u636eIntent\u83b7\u53d6\u76ee\u6807Activity\n        ComponentName component = PluginUtil.getComponent(intent);\n        LoadedPlugin plugin = this.mPluginManager.getLoadedPlugin(component);\n        String targetClassName = component.getClassName();\n\n        if (plugin != null) {\n            // \u5229\u7528ClassLoader\u5b9e\u4f8b\u5316\u76ee\u6807Activity\n            Activity activity = mBase.newActivity(plugin.getClassLoader(), targetClassName, intent);\n            activity.setIntent(intent);\n            ...\n            return activity;\n        }\n    }\n    return mBase.newActivity(cl, className, intent);\n}\n\n</code></pre> <p>\u5148\u6839\u636eIntent\u83b7\u53d6\u76ee\u6807Activity\uff0c\u5373BookManagerActivity\uff0c\u7136\u540e\u5229\u7528ClassLoader\uff08plugin.getClassLoader()\uff09\u5b9e\u4f8b\u5316\u76ee\u6807Activity\uff0c\u628a\u5360\u5751Activity\u66ff\u6362\u6389\uff0c\u5373\u53ef\u542f\u52a8\u76ee\u6807Activity\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\uff0c\u901a\u8fc7Hook Instrumentation\uff0c\u5c06\u76ee\u6807Activity\u66ff\u6362\u6210\u5df2\u7ecf\u5728\u5bbf\u4e3bAPP\u4e2d\u6ce8\u518c\u7684\u5360\u5751Activity\uff0c\u7ed5\u8fc7AMS\u4fa7\u7684\u6821\u9a8c\uff0c\u7136\u540e\u518d\u66ff\u6362\u56de\u6765\uff0c\u542f\u52a8\u76ee\u6807Activity\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96-VirtualAPK/#3-service","title":"3. \u652f\u6301\u63d2\u4ef6Service","text":"<p>\u53c2\u8003\uff1a</p> <p>VirtualAPK</p> <p>\u6ef4\u6ef4\u63d2\u4ef6\u5316\u65b9\u6848 VirtualApk \u6e90\u7801\u89e3\u6790</p> <p>Activity\u542f\u52a8\u6d41\u7a0b(\u57fa\u4e8eAndroid26)</p> <p>\u56fe\u89e3Activity\u7684\u542f\u52a8\u8fc7\u7a0b</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/","title":"\u63d2\u4ef6\u5316","text":"<p>\u76f8\u5173\u63d2\u4ef6\u5316\u65b9\u6848\u89e3\u6790\uff1a</p> <ul> <li>[\u6ef4\u6ef4VirtualAPK]        (./\u63d2\u4ef6\u5316-VirtualAPK.md)</li> </ul> <p>\u63d2\u4ef6\u5316\u4e3b\u8981\u6280\u672f\u70b9\uff1a</p> <ol> <li>\u5982\u4f55\u6253\u63d2\u4ef6\u5305\u4e48</li> <li>\u63d2\u4ef6\u6ca1\u52a0\u8f7d\u65f6\uff0c\u4e5f\u6ca1\u6cd5\u5f15\u7528\u63d2\u4ef6\uff0c\u6b64\u65f6\u80fd\u8c03\u7528\u63d2\u4ef6\u63a5\u53e3\u4e48</li> <li>\u63d2\u4ef6\u751f\u547d\u5468\u671f</li> <li>\u63d2\u4ef6\u8d44\u6e90</li> <li>\u63d2\u4ef6so</li> <li>\u63d2\u4ef6\u56de\u6eda</li> <li>\u63d2\u4ef6\u5347\u7ea7</li> </ol>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_1","title":"\u57fa\u7840\u77e5\u8bc6","text":"<ol> <li>C/S\u901a\u4fe1\u4e2d\u4ecb--Binder</li> <li>APP\u6253\u5305\u6d41\u7a0b</li> <li>APP\u5b89\u88c5\u6d41\u7a0b</li> <li>APP\u542f\u52a8\u6d41\u7a0b</li> <li>\u8d44\u6e90\u52a0\u8f7d\u673a\u5236</li> <li>\u4f7f\u7528Gradle\u5904\u7406\u63d2\u4ef6\u4f9d\u8d56</li> </ol>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#binder","title":"Binder","text":"<p>\u9996\u5148\uff0c\u505aAndroid\u7cfb\u7edf\u539f\u4ee3\u7801\u7684\u4eba\u5e94\u8be5\u975e\u5e38\u719f\u6089Binder\uff0c\u5982\u679c\u6ca1\u6709\u5b83\u771f\u7684\u5bf8\u6b65\u96be\u884c\u3002Binder\u6d89\u53ca\u4e24\u5c42\u6280\u672f\u3002\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u4e00\u4e2a\u4e2d\u4ecb\u8005\u6a21\u5f0f\uff0c\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4e4b\u95f4\uff0cBinder\u5c31\u8d77\u5230\u4e2d\u4ecb\u7684\u4f5c\u7528\uff0c\u8fd9\u662f\u6211\u8fd9\u6bb5\u65f6\u95f4\u5bf9Binder\u7684\u601d\u8003\u3002\u8981\u5b9e\u73b0\u56db\u5927\u7ec4\u4ef6\u7684\u63d2\u4ef6\u5316\uff0c\u5c31\u9700\u8981\u5728Binder\u4e0a\u505a\u4fee\u6539\u3002Binder\u670d\u52a1\u7aef\u7684\u5185\u5bb9\u6ca1\u529e\u6cd5\u4fee\u6539\uff0c\u53ea\u80fd\u6539\u5ba2\u6237\u7aef\u7684\u4ee3\u7801\u3002\u56db\u5927\u7ec4\u4ef6\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u5ba2\u6237\u7aef\u90fd\u4e0d\u592a\u4e00\u6837\uff0c\u8fd9\u4e2a\u9700\u8981\u5927\u5bb6\u81ea\u5df1\u53bb\u53d1\u73b0\uff0c\u65f6\u95f4\u5173\u7cfb\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002</p> <p>\u5b66\u4e60Binder\u7684\u6700\u597d\u65b9\u5f0f\u5c31\u662fAIDL\u3002\u4f60\u53ef\u4ee5\u8bfb\u5230\u5f88\u591a\u5173\u4e8eAIDL\u7684\u8d44\u6599\uff0c\u901a\u8fc7\u5236\u8ba2\u4e00\u4e2aaidl\u6587\u4ef6\u81ea\u52a8\u751f\u6210\u4e00\u4e2aJava\u7c7b\uff0c\u7814\u7a76\u4e00\u4e0b\u8fd9\u4e2aJava\u7c7b\u7684\u6bcf\u4e2a\u65b9\u6cd5\u548c\u53d8\u91cf\uff0c\u7136\u540e\u518d\u53cd\u8fc7\u6765\u770b\u56db\u5927\u7ec4\u4ef6\uff0c\u5176\u5b9e\u90fd\u662f\u8ddfAIDL\u5dee\u4e0d\u591a\u7684\u65b9\u5f0f\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#app","title":"APP\u6253\u5305\u6d41\u7a0b","text":"<p>\u5176\u6b21\uff0c\u662fApp\u6253\u5305\u7684\u6d41\u7a0b\u3002\u4ee3\u7801\u5199\u5b8c\u4e86\uff0c\u6267\u884c\u4e00\u6b21\u6253\u5305\u64cd\u4f5c\uff0c\u4e2d\u9014\u7ecf\u5386\u4e86\u8d44\u6e90\u6253\u5305\u3001dex\u751f\u6210\u3001\u7b7e\u540d\u7b49\u8fc7\u7a0b\u3002\u5176\u4e2d\u6700\u91cd\u8981\u7684\u5c31\u662f\u8d44\u6e90\u7684\u6253\u5305\uff0c\u5373AAPT\u8fd9\u4e00\u6b65\uff0c\u5982\u679c\u5bbf\u4e3b\u548c\u63d2\u4ef6\u7684\u8d44\u6e90id\u51b2\u7a81\uff0c\u4e00\u79cd\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5728\u8fd9\u91cc\u505a\u4fee\u6539\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#app_1","title":"APP\u5b89\u88c5\u6d41\u7a0b","text":"<p>\u7b2c\u4e09\uff0cApp\u5728\u624b\u673a\u4e0a\u7684\u5b89\u88c5\u6d41\u7a0b\u4e5f\u5f88\u91cd\u8981\u3002\u719f\u6089\u5b89\u88c5\u6d41\u7a0b\u4e0d\u4ec5\u5bf9\u63d2\u4ef6\u5316\u6709\u5e2e\u52a9\uff0c\u5728\u9047\u5230\u5b89\u88c5bug\u7684\u65f6\u5019\u4e5f\u975e\u5e38\u91cd\u8981\u3002\u624b\u673a\u5b89\u88c5App\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u4f1a\u6709\u4e0b\u8f7d\u5f02\u5e38\uff0c\u63d0\u793a\u8d44\u6e90\u5305\u4e0d\u80fd\u89e3\u6790\uff0c\u8fd9\u65f6\u9700\u8981\u77e5\u9053\u5b89\u88c5App\u7684\u8fd9\u6bb5\u4ee3\u7801\u5728\u4ec0\u4e48\u5730\u65b9\uff0c\u8fd9\u53ea\u662f\u7b2c\u4e00\u6b65\u3002\u7b2c\u4e8c\u6b65\u9700\u8981\u77e5\u9053\uff0cApp\u4e0b\u8f7d\u5230\u672c\u5730\u540e\uff0c\u5177\u4f53\u8981\u505a\u54ea\u4e9b\u4e8b\u60c5\u3002\u624b\u673a\u6709\u4e9b\u76ee\u5f55\u4e0d\u80fd\u8bbf\u95ee\uff0cApp\u4e0b\u8f7d\u5230\u672c\u5730\u4e4b\u540e\uff0c\u653e\u5230\u54ea\u4e2a\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u4f1a\u751f\u6210\u54ea\u4e9b\u6587\u4ef6\u3002\u63d2\u4ef6\u5316\u6709\u4e2a\u589e\u91cf\u66f4\u65b0\u7684\u6982\u5ff5\uff0c\u5982\u4f55\u4e0b\u8f7d\u4e00\u4e2a\u589e\u91cf\u5305\uff0c\u4ece\u672c\u5730\u5177\u4f53\u54ea\u4e2a\u4f4d\u7f6e\u53d6\u51fa\u4e00\u4e2a\u5305\uff0c\u8fd9\u4e2a\u5305\u7684\u5177\u4f53\u547d\u540d\u89c4\u5219\u662f\u4ec0\u4e48\uff0c\u7b49\u7b49\u3002\u8fd9\u4e9b\u7ec6\u8282\u90fd\u5fc5\u987b\u8981\u6e05\u695a\u660e\u767d\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#app_2","title":"APP\u542f\u52a8\u6d41\u7a0b","text":"<p>\u7b2c\u56db\uff0c\u662fApp\u7684\u542f\u52a8\u6d41\u7a0b\u3002Activity\u542f\u52a8\u6709\u51e0\u79cd\u65b9\u5f0f\uff1f\u4e00\u79cd\u662f\u5199\u4e00\u4e2astartActivity\uff0c\u7b2c\u4e8c\u79cd\u662f\u70b9\u51fb\u624b\u673aApp\uff0c\u901a\u8fc7\u624b\u673a\u7cfb\u7edf\u91cc\u7684Launcher\u673a\u5236\uff0c\u542f\u52a8App\u91cc\u9ed8\u8ba4\u7684Activity\u3002\u901a\u5e38\uff0cApp\u5f00\u53d1\u4eba\u5458\u559c\u95fb\u4e50\u89c1\u7684\u65b9\u5f0f\u662f\u7b2c\u4e8c\u79cd\u3002\u90a3\u4e48\u7b2c\u4e00\u79cd\u65b9\u5f0f\u7684\u542f\u52a8\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f\u53e6\u5916\uff0c\u542f\u52a8\u7684\u65f6\u5019\uff0cmain\u51fd\u6570\u5728\u54ea\u91cc\uff1f\u8fd9\u4e2amain\u51fd\u6570\u7684\u4f4d\u7f6e\u5f88\u91cd\u8981\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5b83\u6240\u5728\u7684\u7c7b\u505a\u4fee\u6539\uff0c\u4ece\u800c\u5b9e\u73b0\u63d2\u4ef6\u5316\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_2","title":"\u8d44\u6e90\u52a0\u8f7d\u673a\u5236","text":"<p>\u7b2c\u4e94\u70b9\u66f4\u91cd\u8981\uff0c\u505aAndroid\u63d2\u4ef6\u5316\u9700\u8981\u63a7\u5236\u4e24\u4e2a\u5730\u65b9\u3002\u9996\u5148\u662f\u63d2\u4ef6Dex\u7684\u52a0\u8f7d\uff0c\u5982\u4f55\u628a\u63d2\u4ef6Dex\u4e2d\u7684\u7c7b\u52a0\u8f7d\u5230\u5185\u5b58\uff1f\u53e6\u5916\u662f\u8d44\u6e90\u52a0\u8f7d\u7684\u95ee\u9898\u3002\u63d2\u4ef6\u53ef\u80fd\u662fapk\u4e5f\u53ef\u80fd\u662fso\u683c\u5f0f\uff0c\u4e0d\u7ba1\u54ea\u4e00\u79cd\uff0c\u90fd\u4e0d\u4f1a\u751f\u6210R.id\uff0c\u4ece\u800c\u6ca1\u529e\u6cd5\u4f7f\u7528\u3002\u8fd9\u4e2a\u95ee\u9898\u6709\u597d\u51e0\u79cd\u89e3\u51b3\u65b9\u6848\u3002\u4e00\u79cd\u662f\u662f\u91cd\u5199Context\u7684getAsset\u3001getResource\u4e4b\u7c7b\u7684\u65b9\u6cd5\uff0c\u5077\u6362\u6982\u5ff5\uff0c\u8ba9\u63d2\u4ef6\u8bfb\u53d6\u63d2\u4ef6\u91cc\u7684\u8d44\u6e90\uff0c\u4f46\u7f3a\u70b9\u5c31\u662f\u5bbf\u4e3b\u548c\u63d2\u4ef6\u7684\u8d44\u6e90id\u4f1a\u51b2\u7a81\uff0c\u9700\u8981\u91cd\u5199AAPT\u3002\u53e6\u4e00\u79cd\u662f\u91cd\u5199AMS\u4e2d\u4fdd\u5b58\u7684\u63d2\u4ef6\u5217\u8868\uff0c\u4ece\u800c\u8ba9\u5bbf\u4e3b\u548c\u63d2\u4ef6\u5206\u522b\u53bb\u52a0\u8f7d\u5404\u81ea\u7684\u8d44\u6e90\u800c\u4e0d\u4f1a\u51b2\u7a81\u3002\u7b2c\u4e09\u79cd\u65b9\u6cd5\uff0c\u5c31\u662f\u6253\u5305\u540e\uff0c\u6267\u884c\u4e00\u4e2a\u811a\u672c\uff0c\u4fee\u6539\u751f\u6210\u5305\u4e2d\u8d44\u6e90id\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#gradle","title":"\u4f7f\u7528Gradle\u5904\u7406\u63d2\u4ef6\u4f9d\u8d56","text":"<p>\u7b2c\u516d\u70b9\uff0c\u5728\u5b9e\u65bd\u63d2\u4ef6\u5316\u540e\uff0c\u5982\u4f55\u89e3\u51b3\u4e0d\u540c\u63d2\u4ef6\u7684\u5f00\u53d1\u4eba\u5458\u7684\u5de5\u4f5c\u533a\u95ee\u9898\u3002\u6bd4\u5982\uff0c\u63d2\u4ef61\u548c\u63d2\u4ef62\uff0c\u9700\u8981\u5206\u522b\u4e0b\u8f7d\u54ea\u4e9b\u4ee3\u7801\uff0c\u5982\u4f55\u72ec\u7acb\u8fd0\u884c\uff1f\u5c31\u50cf\u673a\u7968\u548c\u706b\u8f66\u7968\uff0c\u5982\u4f55\u53ea\u8fd0\u884c\u81ea\u5df1\u7684\u63d2\u4ef6\uff0c\u800c\u4e0d\u8fd0\u884c\u522b\u4eba\u7684\u63d2\u4ef6\uff1f\u8fd9\u662f\u534f\u540c\u5de5\u4f5c\u7684\u95ee\u9898\u3002\u706b\u8f66\u7968\u548c\u673a\u7968\uff0c\u8fd9\u4e24\u4e2aAndroid\u56e2\u961f\u7684\u5404\u81ea\u5de5\u4f5c\u533a\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u8fd9\u65f6\u5019\u5c31\u8981\u7528\u5230Gradle\u811a\u672c\u4e86\uff0c\u6bcf\u4e2a\u9879\u76ee\u5206\u522b\u6709\u5404\u81ea\u7684\u4ed3\u5e93\uff0c\u6709\u5404\u81ea\u4e0d\u540c\u7684\u6253\u5305\u811a\u672c\uff0c\u53ea\u9700\u8981\u628a\u81ea\u5df1\u7684\u63d2\u4ef6\u8ddf\u5bbf\u4e3b\u9879\u76ee\u4e00\u8d77\u6253\u5305\u8fd0\u884c\u8d77\u6765\uff0c\u800c\u4e0d\u7528\u5f15\u5165\u5176\u4ed6\u63d2\u4ef6\uff0c\u8fd8\u6709\u66f4\u5389\u5bb3\u7684\u662f\uff0c\u4e5f\u53ef\u4ee5\u628a\u81ea\u5df1\u7684\u63d2\u4ef6\u5f53\u4f5c\u4e00\u4e2aApp\u6765\u6253\u5305\u5e76\u8fd0\u884c\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_3","title":"\u63d2\u4ef6\u5316\u6280\u672f\u6d41\u6d3e\uff1a","text":"<p>\u52a8\u6001\u66ff\u6362\uff08\u5373Hook\uff09\u3001\u9759\u6001\u4ee3\u7406\u3001Dex\u5408\u5e76</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_4","title":"\u52a8\u6001\u66ff\u6362","text":"<p>\u7b2c\u4e00\u79cd\u662f\u52a8\u6001\u66ff\u6362\uff0c\u4e5f\u5c31\u662fHook\u3002\u53ef\u4ee5\u5728\u4e0d\u540c\u5c42\u6b21\u8fdb\u884cHook\uff0c\u4ece\u800c\u52a8\u6001\u66ff\u6362\u4e5f\u7ec6\u5206\u4e3a\u82e5\u5e72\u5c0f\u6d41\u6d3e\u3002\u53ef\u4ee5\u76f4\u63a5\u5728Activity\u91cc\u505aHook\uff0c\u91cd\u5199getAsset\u7684\u51e0\u4e2a\u65b9\u6cd5\uff0c\u4ece\u800c\u4f7f\u7528\u81ea\u5df1\u7684ResourceManager\u548cAssetPath\uff1b\u4e5f\u53ef\u4ee5\u5728\u66f4\u62bd\u8c61\u7684\u5c42\u9762\uff0c\u4e5f\u5c31\u662f\u5728startActivity\u65b9\u6cd5\u7684\u4f4d\u7f6e\u505aHook\uff0c\u6d89\u53ca\u7684\u7c7b\u5305\u62ecActivityThread\u3001Instrumentation\u7b49\uff1b\u6700\u9ad8\u5c42\u6b21\u5219\u662f\u5728AMS\u4e0a\u505a\u4fee\u6539\uff0c\u4e5f\u5c31\u662f\u5f20\u52c7\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u8fd9\u91cc\u9700\u8981\u4fee\u6539\u7684\u7c7b\u975e\u5e38\u591a\uff0cAMS\u3001PMS\u7b49\u90fd\u9700\u8981\u6539\u52a8\u3002\u603b\u4e4b\uff0c\u5728\u8d8a\u62bd\u8c61\u7684\u5c42\u6b21\u4e0a\u505aHook\uff0c\u9700\u8981\u505a\u7684\u6539\u52a8\u5c31\u8d8a\u5927\uff0c\u4f46\u597d\u5904\u5c31\u662f\u66f4\u52a0\u7075\u6d3b\u4e86\u3002\u6ca1\u6709\u54ea\u4e00\u4e2a\u65b9\u6cd5\u66f4\u597d\uff0c\u4e00\u5207\u770b\u4f60\u81ea\u5df1\u7684\u9009\u62e9\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_5","title":"\u9759\u6001\u4ee3\u7406","text":"<p>\u7b2c\u4e8c\u79cd\u662f\u9759\u6001\u4ee3\u7406\uff0c\u8fd9\u662f\u4efb\u7389\u521a\u7684\u6846\u67b6\u91c7\u53d6\u7684\u601d\u8def\u3002\u5199\u4e00\u4e2aPluginActivity\u7ee7\u627f\u81eaActivity\u57fa\u7c7b\uff0c\u628aActivity\u57fa\u7c7b\u91cc\u9762\u6d89\u53ca\u751f\u547d\u5468\u671f\u7684\u65b9\u6cd5\u5168\u90fd\u91cd\u5199\u4e00\u904d\uff0c\u63d2\u4ef6\u4e2d\u7684Activity\u662f\u6ca1\u6709\u751f\u547d\u5468\u671f\u7684\uff0c\u6240\u4ee5\u8981\u8ba9\u63d2\u4ef6\u4e2d\u7684Activity\u90fd\u7ee7\u627f\u81eaPluginActivity\uff0c\u8fd9\u6837\u5c31\u6709\u751f\u547d\u5468\u671f\u4e86\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#dex","title":"Dex\u5408\u5e76","text":"<p>\u7b2c\u4e09\u79cd\u662fDex\u5408\u5e76\uff0cDex\u5408\u5e76\u5c31\u662fAndroid\u70ed\u4fee\u590d\u7684\u601d\u60f3\u3002\u521a\u624d\u8bf4\u5230\u4e86\u4e24\u4e2a\u9879\u76ee\u2014\u2014AndFix\u548cNuwa\uff0c\u5b83\u4eec\u7684\u601d\u60f3\u662f\u76f8\u540c\u7684\u3002\u539f\u751fApk\u81ea\u5e26\u7684Dex\u662f\u901a\u8fc7PathClassLoader\u6765\u52a0\u8f7d\u7684\uff0c\u800c\u63d2\u4ef6Dex\u5219\u662f\u901a\u8fc7DexClassLoader\u6765\u52a0\u8f7d\u7684\u3002\u4f46\u6709\u4e00\u4e2a\u987a\u5e8f\u95ee\u9898\uff0c\u662f\u7531Davlik\u7684\u673a\u5236\u51b3\u5b9a\u7684\uff0c\u5982\u679c\u5bbf\u4e3bDex\u548c\u63d2\u4ef6Dex\u90fd\u6709\u4e00\u4e2a\u76f8\u540c\u547d\u540d\u7a7a\u95f4\u7684\u7c7b\u7684\u65b9\u6cd5\uff0c\u90a3\u4e48\u5148\u52a0\u8f7d\u54ea\u4e2aDex\uff0c\u54ea\u4e2aDex\u4e2d\u7684\u8fd9\u4e2a\u7c7b\u7684\u65b9\u6cd5\u5c06\u4f1a\u5360\u5c71\u4e3a\u738b\uff0c\u540e\u9762\u5176\u4ed6\u540c\u540d\u65b9\u6cd5\u90fd\u66ff\u6362\u4e86\u3002\u6240\u4ee5\uff0cAndFix\u70ed\u4fee\u590d\u5c31\u662f\u4f18\u5148\u52a0\u8f7d\u63d2\u4ef6\u5305\u4e2d\u7684Dex\uff0c\u4ece\u800c\u5b9e\u73b0\u70ed\u4fee\u590d\u3002\u7531\u4e8e\u70ed\u4fee\u590d\u7684\u63d2\u4ef6\u5305\u901a\u5e38\u53ea\u5305\u62ec\u4e00\u4e2a\u7c7b\u7684\u65b9\u6cd5\uff0c\u4f53\u91cf\u5f88\u5c0f\uff0c\u548c\u6b63\u5e38\u7684\u63d2\u4ef6\u4e0d\u662f\u4e00\u4e2a\u6570\u91cf\u7ea7\u7684\uff0c\u6240\u4ee5\u53ea\u79f0\u4e3a\u70ed\u4fee\u590d\u8865\u4e01\u5305\uff0c\u800c\u4e0d\u662f\u63d2\u4ef6\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#_6","title":"\u70ed\u4fee\u590d\u4e09\u5927\u6d41\u6d3e","text":"<p>Method\u3001Class\u3001Dex</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#1-method","title":"1. Method","text":"<p>\u6280\u672f\u5b9e\u73b0\uff1a\u5728Native\u5c42\u4fee\u6539\u65b9\u6cd5\u5bfb\u5740\uff0c\u5373\u64cd\u4f5c\u65b9\u6cd5\u6307\u9488\uff0c\u5c06\u6307\u9488\u6307\u5411\u65b0\u7684\u65b9\u6cd5\u3002</p> <p>\u4ee3\u8868\u6846\u67b6\uff1aAndFix\u3001Sophix</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#2-class","title":"2. Class","text":"<p>\u6280\u672f\u5b9e\u73b0\uff1a\u4fee\u6539DexElements\u66ff\u6362\u7c7b\u3002</p> <p>\u4ee3\u8868\u6846\u67b6\uff1aQZone\u8d85\u7ea7\u8865\u4e01\u3001Nuwa\u3001Qfix</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E6%8F%92%E4%BB%B6%E5%8C%96/#3-dex","title":"3. Dex","text":"<p>\u6280\u672f\u5b9e\u73b0\uff1a\u4fee\u6539PathClassLoader\u7684parent\u3002</p> <p>\u4ee3\u8868\u6846\u67b6\uff1aTinker\u3001SigmaPatch</p> <p>\u53c2\u8003\uff1a Android \u63d2\u4ef6\u5316\u539f\u7406\u89e3\u6790\u2014\u2014\u63d2\u4ef6\u52a0\u8f7d\u673a\u5236</p> <p>\u300aInfoQ\uff1aAndroid\u63d2\u4ef6\u5316--\u4ece\u5165\u95e8\u5230\u653e\u5f03\u300b</p> <p>\u300a\u7b80\u4e66\uff1aAndroid \u63d2\u4ef6\u5316\u548c\u70ed\u4fee\u590d\u77e5\u8bc6\u68b3\u7406\u300b</p> <p>VirtualAPK</p> <p>AtLas</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%83%AD%E4%BF%AE%E5%A4%8D/","title":"\u70ed\u4fee\u590d","text":"<p>\u53c2\u8003\uff1a</p> <p>\u5e72\u8d27\u6ee1\u6ee1\uff0cAndroid\u70ed\u4fee\u590d\u65b9\u6848\u4ecb\u7ecd</p> <p>\u963f\u91cc\u63a8\u51fa\u4e1a\u754c\u9996\u4e2a\u975e\u4fb5\u5165\u5f0f\u70ed\u4fee\u590d\u65b9\u6848Sophix\uff0c\u98a0\u8986\u79fb\u52a8\u7aef\u4f20\u7edf\u53d1\u7248\u66f4\u65b0\u6d41\u7a0b\uff01</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/","title":"\u7ec4\u4ef6\u5316","text":"<p>\u968f\u7740APP\u7684\u53d1\u5c55\uff0c\u529f\u80fd\u4e5f\u4f1a\u8d8a\u6765\u8d8a\u4e30\u5bcc\uff0c\u4ee3\u7801\u6025\u5267\u81a8\u80c0\u3001\u7f16\u8bd1\u901f\u5ea6\u6162\uff0c\u4ee3\u7801\u8026\u5408\u3001\u7275\u4e00\u53d1\u800c\u52a8\u5168\u8eab\uff0c\u8fd9\u4e9b\u95ee\u9898\u90fd\u4e25\u91cd\u5f71\u54cd\u5f00\u53d1\u6548\u7387\u548c\u9879\u76ee\u7684\u7a33\u5b9a\u6027\u3002\u8fd9\u65f6\u5019\u7ec4\u4ef6\u5316\u548c\u63d2\u4ef6\u5316\u5c31\u4f1a\u6d3e\u4e0a\u7528\u573a\u3002\u672c\u7bc7\u6587\u7ae0\u662f\u6839\u636e\u6211\u4eec\u56e2\u961f\u7ec4\u4ef6\u5316\u7684\u7ecf\u5386\uff0c\u4ecb\u7ecd\u4e00\u4e9b\u7ec4\u4ef6\u5316\u7684\u77e5\u8bc6\u548c\u76f8\u5173\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u76ee\u5f55\uff1a</p> <p>1.\u63d2\u4ef6\u5316\u548c\u7ec4\u4ef6\u5316\u7684\u533a\u522b 2.\u4e3a\u4ec0\u4e48\u7528\u7ec4\u4ef6\u5316 3.\u7ec4\u4ef6\u5316\u7ed3\u6784     3.1 \u9879\u76ee\u5c42\u7ea7\u7ed3\u6784     3.2 \u4f9d\u8d56\u7ba1\u7406     3.3 \u5de5\u7a0b\u5efa\u8bbe 4. \u7ec4\u4ef6\u5316\u7684\u95ee\u9898\u53ca\u76f8\u5173\u89e3\u51b3\u65b9\u6848 \u00a0 \u00a0 1\uff09\u7ec4\u4ef6\u5f62\u5f0f \u00a0 \u00a0 2\uff09\u8d44\u6e90\u51b2\u7a81 \u00a0 \u00a0 3\uff09\u7ec4\u4ef6\u901a\u4fe1\u00a0 \u00a0 \u00a0 4\uff09\u9875\u9762\u8df3\u8f6c \u00a0 \u00a0 5\uff09\u7ec4\u4ef6\u7248\u672c\u7ba1\u7406 \u00a0 \u00a0 6\uff09\u5206\u652f\u7ba1\u7406</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#1","title":"1.\u7ec4\u4ef6\u5316\u548c\u63d2\u4ef6\u5316\u7684\u533a\u522b","text":"<p>\u63d2\u4ef6\u5316\u5f3a\u8c03\u7ed3\u679c\uff0c\u5141\u8bb8\u529f\u80fd\u6a21\u5757\u4ee5\u63d2\u4ef6\u7684\u5f62\u5f0f\uff0c\u4e0d\u9700\u8981\u9884\u5148\u6253\u5305\u5230apk\u91cc\uff0c\u800c\u662f\u8fd0\u884c\u65f6\u5728\u5408\u9002\u7684\u65f6\u673a\u52a8\u6001\u52a0\u8f7d\u8fdb\u6765\u3002 \u7ec4\u4ef6\u5316\u4f53\u73b0\u8fc7\u7a0b\uff0c\u66f4\u50cf\u662f\u4e00\u79cd\u5f00\u53d1\u6a21\u5f0f\uff0c\u4e0d\u540c\u529f\u80fd\u6a21\u5757\u7684\u4ee3\u7801\u505a\u7269\u7406\u9694\u79bb\uff0c\u6bd4\u5982\u5206\u5230\u4e0d\u540c\u7684module\u6216project\u4e2d\u3002\u7ec4\u4ef6\u5316\u4e0d\u5177\u5907\u63d2\u4ef6\u5316\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u7684\u7279\u6027\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#2","title":"2. \u4e3a\u4ec0\u4e48\u8981\u7528\u7ec4\u4ef6\u5316","text":"<p>1\uff09\u9ad8\u6548\uff1a\u56e0\u4e3a\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684app\uff0c\u53ef\u4ee5\u72ec\u7acb\u8fd0\u884c\uff0c\u6240\u4ee5\u5f00\u53d1\u4eba\u5458\u53ea\u9700\u8981\u5728\u81ea\u5df1\u7684\u7ec4\u4ef6\u4e2d\u5f00\u53d1\u6d4b\u8bd5\u5373\u53ef\uff0c\u5f00\u53d1\u6548\u7387\u66f4\u9ad8\uff0c\u7f16\u8bd1\u901f\u5ea6\u66f4\u5feb 2\uff09\u7a33\u5b9a\uff1a\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u662f\u9ad8\u5185\u805a\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\uff1b\u4e00\u4e2a\u7ec4\u4ef6\u4ee3\u7801\u53d1\u751f\u53d8\u5316\uff0c\u57fa\u672c\u4e0a\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u7ec4\u4ef6\uff1b</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#3","title":"3. \u7ec4\u4ef6\u5316\u7ed3\u6784","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#31","title":"3.1 \u9879\u76ee\u5c42\u7ea7\u7ed3\u6784","text":"<p>\u6bcf\u4e2a\u56e2\u961f\u5bf9\u81ea\u5df1\u9879\u76ee\u7684\u5c42\u7ea7\u5212\u5206\u90fd\u4e0d\u592a\u4e00\u6837\uff0c\u7c97\u7565\u7684\u8bf4\uff0c\u53ef\u4ee5\u5206\u6210\u4e0b\u9762\u4e09\u5c42\uff1a \u57fa\u7840\u4e1a\u52a1\u5c42 \u4e1a\u52a1\u652f\u6491\u5c42 \u516c\u5171\u5c42</p> <p>\u5176\u4e2d\uff0c \u57fa\u7840\u4e1a\u52a1\u5c42\uff1a\u6bcf\u4e2aapp\u7684\u4e1a\u52a1\u7684\u90e8\u5206\uff0c\u6bd4\u5982feed\u6d41\u3001\u4e2a\u4eba\u4e2d\u5fc3\u3001\u767b\u5f55\u6ce8\u518c\u7b49\u7b49 \u4e1a\u52a1\u652f\u6491\u5c42\uff1a\u6bd4\u5982\u7528\u6237Session\u3001AB\u6846\u67b6\u3001\u6253\u70b9\u3001\u914d\u7f6e\u4e2d\u5fc3 \u516c\u5171\u5c42\uff1a\u6bd4\u5982\u56fe\u7247\u3001\u7f51\u7edc\u3001UI\u57fa\u7840\u7ec4\u4ef6\u3001\u8d44\u6e90</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#32","title":"3.2 \u4f9d\u8d56\u7ba1\u7406","text":"<p>\u4e3a\u4e86\u9632\u6b62\u7ec4\u4ef6\u95f4\u5faa\u73af\u4f9d\u8d56\uff0c\u7ec4\u4ef6\u4f9d\u8d56\u65f6\u8981\u9075\u5faa\u4e00\u4e2a\u539f\u5219\uff1a\u540c\u4e00\u5c42\u7684\u7ec4\u4ef6\u4e4b\u95f4\u4e0d\u80fd\u4ea7\u751f\u4f9d\u8d56\uff0c\u4e0a\u5c42\u53ef\u4ee5\u5bf9\u4e0b\u5c42\u7ec4\u4ef6\u4ea7\u751f\u4f9d\u8d56\u3002</p> <p>\u4f9d\u8d56\u65b9\u5f0f\u53c2\u8003\uff1a</p> gralde 3.0\u4ee5\u4e0a gradle 2.x \u8bf4\u660e implementation compile \u7f16\u8bd1\u671f\u95f4\u53ea\u5bf9\u76f4\u63a5\u4f9d\u8d56\u7684\u7ec4\u4ef6\u53ef\u89c1\uff0c\u5728\u8fd0\u884c\u671f\u95f4\u6240\u6709\u7ec4\u4ef6\u53ef\u89c1 api compile \u7f16\u8bd1\u671f\uff0c\u8fd0\u884c\u671f\u5bf9\u6240\u6709\u7ec4\u4ef6\u53ef\u89c1 compileOnly provided \u53ea\u53c2\u4e0e\u7f16\u8bd1\u4e0d\u6253\u5305\u5230apk runtimeOnly apk \u7f16\u8bd1\u671f\u95f4\u4e0d\u53ef\u89c1\uff0c\u4f1a\u6253\u5305\u5230apk <p>\u5bf9\u4e8eimplemention\uff0c\u5047\u5982\u6a21\u5757A\u4f9d\u8d56\u6a21\u5757B\uff0c\u6a21\u5757B\u4f9d\u8d56\u6a21\u5757C\uff0c\u5373A-&gt;B-&gt;C\uff0c\u7f16\u8bd1\u671f\u95f4A\u4e0d\u80fd\u8bbf\u95eeC\uff0c\u5f53C\u4fee\u6539\u65f6\uff0cgradle\u53ea\u4f1a\u91cd\u65b0\u7f16\u8bd1B\uff0c\u4e0d\u4f1a\u7f16\u8bd1A\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#33","title":"3.3 \u5de5\u7a0b\u5efa\u8bbe","text":"<p>\u9879\u76ee\u5927\u4e86\uff0c\u5f00\u53d1\u4eba\u5458\u4e5f\u4f1a\u53d8\u591a\uff0c\u4e00\u4e9b\u57fa\u7840\u8bbe\u65bd\u548c\u81ea\u52a8\u5316\u7684\u5de5\u5177\u4e5f\u6709\u642d\u5efa\u8d77\u6765\u3002\u8fd9\u91cc\u5217\u4e3e\u4e00\u4e9b\u5e38\u7528\u7684\uff1a  git\u3001\u5206\u652f\u7ba1\u7406\u3001\u6301\u7eed\u96c6\u6210\uff08CI\uff09\u3001\u9759\u6001\u7f16\u8bd1\u3001lint\u3001\u5feb\u901f\u6253\u5305\u3001\u7070\u5ea6\u53d1\u5e03\u3001bugly\u3001\u534f\u8bae\u6587\u6863\u7b49\u7b49\u3002\u5f53\u7136\uff0c\u5b9e\u73b0\u63d2\u4ef6\u5316\u7684\uff0c\u8fd8\u6709\u63d2\u4ef6\u7ba1\u7406\u5e73\u53f0\u3002 </p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#4","title":"4. \u7ec4\u4ef6\u5316\u7684\u95ee\u9898\u53ca\u76f8\u5173\u89e3\u51b3\u65b9\u6848","text":"<p>\u7ec4\u4ef6\u5316\u4e4b\u540e\uff0c\u5f88\u591a\u4ee3\u7801\u4e0d\u5728\u4e00\u4e2a\u9879\u76ee\u91cc\uff0c\u6ca1\u529e\u6cd5\u76f4\u63a5\u901a\u4fe1\u3001\u5f15\u7528\u4ee3\u7801\uff0c\u76f8\u5173\u95ee\u9898\u968f\u4e4b\u800c\u6765\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#41","title":"4.1 \u7ec4\u4ef6\u5f62\u5f0f","text":"<p>\u7ec4\u4ef6\u53ef\u4ee5\u505a\u662f\u4e00\u4e2a\u72ec\u7acb\u7684project\uff0c\u4e5f\u53ef\u4ee5\u653e\u5230\u4e00\u4e2a\u9879\u76ee\u4e2d\uff0c\u4ee5module\u5f62\u5f0f\u5b58\u5728\u3002 \u5982\u679c\u628a\u7ec4\u4ef6\u505a\u6210\u4e00\u4e2aproject\uff0c\u53ef\u4ee5\u7ed9project\u5efaapp\u548clibrary\u4e24\u4e2amodule\uff0c\u5176\u4e2dapp\u6a21\u5757\u662f\u4e3a\u4e86\u7ec4\u4ef6\u72ec\u7acb\u8fd0\u884c\uff0clibrary\u624d\u662f\u7ec4\u4ef6\u7684\u771f\u8eab\uff0c\u7ed9\u5176\u4ed6\u7ec4\u4ef6\u63d0\u4f9b\u4f9d\u8d56\u3002 \u6211\u4eec\u90fd\u77e5\u9053\uff0c\u4e00\u4e2amodule\u662fAndroid Library\u8fd8\u662fApplication\uff0c\u53d6\u51b3\u4e8ebuild.gradle\u4e2dapply plugin\u7684\u65b9\u5f0f\u3002 \u5982\u679c\u628a\u7ec4\u4ef6\u505a\u6210\u4e3b\u9879\u76ee\u4e2d\u7684\u4e00\u4e2amodule\uff0c\u5982\u679c\u8981\u7ec4\u4ef6\u72ec\u7acb\u8fd0\u884c\uff0c\u9700\u8981apply plugin\u4e3acom.andorid.application\uff0c\u5982\u679c\u8981\u4ee5\u7ec4\u4ef6\u63d0\u4f9b\u5bf9\u5916\u4f9d\u8d56\uff0c\u5219\u8981\u4fee\u6539\u4e3acom.android.library\u3002 \u53ef\u4ee5\u7528\u6761\u4ef6\u53d8\u91cf\u5bf9apply\u7684\u5f62\u5f0f\u505a\u7ba1\u7406\uff0c\u4e1a\u754c\u4e5f\u6709\u66f4\u4f18\u96c5\u7684\u4fee\u6539\u65b9\u5f0f\uff0c\u4f46\u57fa\u672c\u4e0a\u7ed5\u4e0d\u5f00\u8fd9\u4e2a\u5957\u8def\u3002</p> <pre><code>if (isModule) {\n    apply plugin: 'com.android.library'\n} else {\n    apply plugin: 'com.andorid.application'\n}\n</code></pre> <p>\u6bcf\u6b21\u5207\u6362\uff0c\u90fd\u9700\u8981\u91cd\u65b0gradle async\uff0c\u6548\u7387\u4f1a\u6253\u6298\u6263\u3002\u5e76\u4e14\u6bcf\u6b21\u8ba9\u5f00\u53d1\u4eba\u5458\u624b\u52a8\u64cd\u4f5c\uff0c\u603b\u907f\u514d\u4e0d\u4e86\u54ea\u5929\u624b\u6296\u72af\u9519\u8bef\u3002\u6240\u4ee5\uff0c\u8fd8\u662f\u5efa\u8bae\u91c7\u7528\u7b2c\u4e00\u79cd\u65b9\u6cd5\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#42","title":"4.2 \u8d44\u6e90\u51b2\u7a81","text":"<p>\u4e0d\u540c\u7ec4\u4ef6\u6709\u540c\u540d\u8d44\u6e90\u65f6\uff0c\u5f53\u7ec4\u4ef6\u6253\u5305\u5230\u4e00\u8d77\uff0c\u5c31\u4f1a\u4ea7\u751f\u8d44\u6e90\u51b2\u7a81\u95ee\u9898\u3002 \u89e3\u51b3\u65b9\u6cd5\u662f\uff0c\u5728build.gradle\u4e2d\u6dfb\u52a0\u8d44\u6e90\u524d\u7f00\uff1a</p> <pre><code>resourcePrefix 'module-a'\n</code></pre> <p>\u8fd9\u79cd\u505a\u6cd5IDE\u5e76\u4e0d\u4f1a\u5bf9\u8d44\u6e90\u91cd\u547d\u540d\uff0c\u800c\u662f\u505a\u4e86lint\u68c0\u67e5\u3002\u5f00\u53d1\u4eba\u5458\u9700\u8981\u624b\u52a8\u4e3a\u8d44\u6e90\u6dfb\u52a0\u524d\u7f00\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#43","title":"4.3 \u7ec4\u4ef6\u95f4\u901a\u4fe1","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#44","title":"4.4 \u9875\u9762\u8df3\u8f6c","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#45","title":"4.5 \u7ec4\u4ef6\u7248\u672c\u7ba1\u7406","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E7%BB%84%E4%BB%B6%E5%8C%96/#46","title":"4.6 \u5206\u652f\u7ba1\u7406","text":"<p>\u53c2\u8003git flow\u6d41\u7a0b\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E8%AF%A6%E8%A7%A3APT/","title":"\u8be6\u89e3APT","text":""},{"location":"Android/%E5%85%B6%E4%BB%96/%E8%AF%A6%E8%A7%A3APT/#_1","title":"\u6ce8\u89e3\u57fa\u7840","text":"<p>\u5143\u6ce8\u89e3 @Retention\uff1a \u8868\u793a\u6ce8\u89e3\u5b58\u5728\u4e8e\u4ec0\u4e48\u9636\u6bb5\uff0c\u6709\u4ee5\u4e0b\u4e09\u79cd\uff0c RetentionPolicy.SOURCE: \u53ea\u5b58\u5728\u4e8e\u6e90\u7801\uff0c\u7f16\u8bd1\u671f\u5c31\u4f1a\u88ab\u64e6\u9664\u3002\u7c7b\u4f3c\u4e8e@override\uff0c\u53ea\u662f\u7ed9\u5f00\u53d1\u4eba\u5458\u770b\u7684\u3002 RetentionPolicy.CLASS: \u5b58\u5728\u4e8e\u6e90\u7801\u548c\u7f16\u8bd1\u671f\uff0c\u4e0d\u5728\u8fd0\u884c\u65f6\u3002\u662f\u9ed8\u8ba4\u7684policy\u3002 RetentionPolicy.RUNTIME: \u5b58\u5728\u4e8e\u6e90\u7801\u3001\u7f16\u8bd1\u671f\u3001\u8fd0\u884c\u65f6\u3002</p> <p>https://www.race604.com/annotation-processing/</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E8%AF%A6%E8%A7%A3APT/#_2","title":"\u8c03\u8bd5\u6ce8\u89e3\u5904\u7406\u5668\u4ee3\u7801","text":"<p>http://www.jianshu.com/p/80a14bc35000</p> <p>1\uff09\u5728\u81ea\u5b9a\u4e49AbstractProcessor#process()\u6dfb\u52a0\u65ad\u70b9</p> <p>2\uff09project/ gradle.properties\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff0c\u5e76sync\u3002\u5982\u679c\u7aef\u53e3\u88ab\u5360\u7528\uff0c\u53ef\u4ee5\u6362\u4e2a\u7aef\u53e3 org.gradle.daemon=true org.gradle.jvmargs=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5006</p> <p>3\uff09\u547d\u4ee4\u884c\u8fd0\u884c ./gradlew --daemon\uff0c\u542f\u52a8\u5b88\u62a4\u7ebf\u7a0b</p> <p>4\uff09\u5728AS\u4e2d\u65b0\u5efaRemote Debugger (\u5982\u679c\u6709\uff0c\u53ea\u9700\u8981\u5728Select Configuration\u4e2d\u9009\u4e2dAnnotationProcessor\u5bf9\u5e94\u7684Remote Debugger)\uff0c\u7136\u540e\u70b9\u51fbDebug\u6309\u94ae\uff0c\u542f\u52a8\u8c03\u8bd5\u3002\u6ce8\u610f\u7aef\u53e3\u8981\u548cgradle.properties\u914d\u7f6e\u7684\u7aef\u53e3\u4e00\u81f4\u3002</p> <p>5\uff09\u547d\u4ee4\u884c\u8fd0\u884c ./gradlew clean connectedCheck \u6ce8\u610f\uff0c\u5982\u679c\u6267\u884c\u6539\u547d\u4ee4\u4ecd\u7136\u4e0d\u80fd\u8c03\u8bd5\uff0c\u90a3\u5c31./gradlew --stop\u5173\u95ed\u6240\u4ee5daemon\uff0c\u518d./gradlew --deamon\u91cd\u542f\uff0c\u53733\uff0c4\uff0c5\u6b65\u91cd\u65b0\u8d70\u4e00\u904d\u3002</p> <p>\u5e38\u89c1\u95ee\u9898\uff1a 1\uff09gradle.properties\u6dfb\u52a0daemon\u914d\u7f6e\u540c\u6b65\u540e\uff0cAS\u4e2d\u51fa\u73b0\u5982\u4e0b</p> <p>A: daemon\u9ed8\u8ba4\u5360\u75285005\u7aef\u53e3\uff0c\u4e0a\u9762\u9519\u8bef\u8bf4\u660e\u8be5\u7aef\u53e3\u5df2\u7ecf\u88ab\u5360\u7528\uff0c\u53ef\u4ee5\u4fee\u6539\u6210\u5176\u4ed6\u7aef\u53e3\u3002</p> <p>\u5e38\u89c1\u547d\u4ee4\uff1a ./gradlew --daemon \u542f\u52a8\u5b88\u62a4\u7ebf\u7a0b ./gradlew --daemon --stop \u5173\u95ed\u6240\u4ee5\u5b88\u62a4\u7ebf\u7a0b ./gradlew --daemon --status \u67e5\u770b\u5b88\u62a4\u7ebf\u7a0b\u72b6\u6001</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E8%AF%A6%E8%A7%A3APT/#_3","title":"\u6ce8\u89e3\u5904\u7406\u5668\u7cbe\u9ad3","text":"<p>\u5de5\u4f5c\u5927\u4f53\u5185\u5bb9\uff1a 1) \u83b7\u53d6\u88ab\u6ce8\u89e3\u7684Element; 2) \u4ee3\u7801\u6821\u9a8c\uff0c\u6bd4\u5982\u88ab\u6ce8\u89e3\u7684\u7c7b\u8981\u80fd\u5b9e\u4f8b\u5316\uff0c\u6240\u4ee5\u8981\u662fpublic\uff0c\u4e0d\u80fd\u662fabstract\uff0c\u65b9\u6cd5\u5fc5\u987bpublic\u7b49\uff1b 3) \u6839\u636eElement\u83b7\u53d6\u8981\u751f\u6210\u4ee3\u7801\u7684\u4fe1\u606f\uff0c\u7ed3\u5408JavaPoet\uff0c\u751f\u6210\u4ee3\u7801\uff1b</p> <p>JavaPoet\uff1ahttps://github.com/square/javapoet</p> <p>======================== Element ========================= Element:</p> <p>TypeElement:      \u4ee3\u8868\u7684\u662f\u6e90\u4ee3\u7801\u4e2d\u7684\u7c7b\u578b\u5143\u7d20\uff0c\u4f8b\u5982\u7c7b\u3002\u7136\u800c\uff0cTypeElement\u5e76\u4e0d\u5305\u542b\u7c7b\u672c\u8eab\u7684\u4fe1\u606f\u3002\u4f60\u53ef\u4ee5\u4eceTypeElement\u4e2d\u83b7\u53d6\u7c7b\u7684\u540d\u5b57\uff0c\u4f46\u662f\u4f60\u83b7\u53d6\u4e0d\u5230\u7c7b\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u5b83\u7684\u7236\u7c7b\u3002\u8fd9\u79cd\u4fe1\u606f\u9700\u8981\u901a\u8fc7TypeMirror\u83b7\u53d6\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528elements.asType()\u83b7\u53d6\u5143\u7d20\u7684TypeMirror\u3002</p> <p>======================== \u521b\u5efaCompiler Module ========================= \u521b\u5efa\u4e00\u4e2a\u540d\u4e3acompiler\u7684Java Library\uff0c\u8fd9\u4e2a\u7c7b\u5c06\u4f1a\u5199\u4ee3\u7801\u751f\u6210\u7684\u76f8\u5173\u4ee3\u7801\u3002\u6838\u5fc3\u5c31\u662f\u5728\u8fd9\u91cc\u3002</p> <p>\u914d\u7f6ebuild.gradle</p> <p>apply plugin: 'java' sourceCompatibility = 1.7 targetCompatibility = 1.7 dependencies { compile fileTree(dir: 'libs', include: ['*.jar']) compile 'com.google.auto.service:auto-service:1.0-rc2' compile 'com.squareup:javapoet:1.7.0' compile project(':annotation') }</p> <p>\u5b9a\u4e49\u7f16\u8bd1\u7684jdk\u7248\u672c\u4e3a1.7\uff0c\u8fd9\u4e2a\u5f88\u91cd\u8981\uff0c\u4e0d\u5199\u4f1a\u62a5\u9519\u3002 AutoService \u4e3b\u8981\u7684\u4f5c\u7528\u662f\u6ce8\u89e3 processor \u7c7b\uff0c\u5e76\u5bf9\u5176\u751f\u6210 META-INF \u7684\u914d\u7f6e\u4fe1\u606f\u3002 JavaPoet \u8fd9\u4e2a\u5e93\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u5e2e\u52a9\u6211\u4eec\u901a\u8fc7\u7c7b\u8c03\u7528\u7684\u5f62\u5f0f\u6765\u751f\u6210\u4ee3\u7801\u3002 \u4f9d\u8d56\u4e0a\u9762\u521b\u5efa\u7684annotation Module\u3002</p>"},{"location":"Android/%E5%85%B6%E4%BB%96/%E9%80%9A%E8%BF%87%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E5%8A%A0%E5%BF%ABsqlite%E6%95%B0%E6%8D%AE%E5%BA%93%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C%E7%9A%84%E6%95%88%E7%8E%87/","title":"\u901a\u8fc7\u4e8b\u52a1\u652f\u6301\u52a0\u5febsqlite\u6570\u636e\u5e93\u6279\u91cf\u64cd\u4f5c\u7684\u6548\u7387","text":"<p>\u67e5\u770b ContentProvider \u7684\u6e90\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5728 Provider \u57fa\u7c7b\u4e2d\u5df2\u7ecf\u652f\u6301\u4e86\u6570\u636e\u5e93\u7684\u6279\u91cf\u64cd\u4f5c</p> <pre><code>// Override this to handle requests to perform a batch of operations, or the default implementation will iterate over the operations and call\n\npublic @NonNull ContentProviderResult[] applyBatch(\n            @NonNull ArrayList&lt;ContentProviderOperation&gt; operations)\n                    throws OperationApplicationException {\n        final int numOperations = operations.size();\n        final ContentProviderResult[] results = new ContentProviderResult[numOperations];\n        for (int i = 0; i &lt; numOperations; i++) {\n            results[i] = operations.get(i).apply(this, results, i);\n        }\n        return results;\n    }\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 provider \u7684\u65b9\u6cd5\u6279\u91cf\u5bf9\u6570\u636e\u5e93\u505a\u6570\u636e\u4fee\u6539\uff0c\u901a\u8fc7\u8fd9\u4e2a\u51fd\u6570\u7684\u6ce8\u91ca\u53ef\u4ee5\u770b\u5230\uff0c\u57fa\u7c7b\u7684\u9ed8\u8ba4 \u5b9e\u73b0\u53ea\u662f\u4f1a\u628a\u6240\u6709\u7684 operation \u62ff\u51fa\u6765\u9010\u4e2a\u6267\u884c\uff0c\u5bf9\u6570\u636e\u5e93\u7684\u5199\u5165\u6027\u80fd\u5e76\u6ca1\u6709\u592a\u5927\u7684\u63d0\u5347\u3002</p> <p>\u6570\u636e\u5e93\u7684\u4e8b\u52a1:\u6570\u636e\u5e93\u4e8b\u52a1\u662f\u7531\u4e00\u7ec4\u6570\u636e\u5e93\u64cd\u4f5c\u5e8f\u5217\u7ec4\u6210\uff0c\u4e8b\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u88ab\u6267\u884c\u3002</p> <p>\u4e8b\u52a1\u7684\u539f\u5b50\u6027:\u5305\u542b\u5728\u5176\u4e2d\u7684\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u5e8f\u5217\u6700\u7ec8\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c\u3002\u5f53\u5168\u90e8\u6267\u884c\u65f6\uff0c \u4e8b\u52a1\u5bf9\u6570\u636e\u5e93\u7684\u4fee\u6539\u5c06\u751f\u6548;\u5f53\u5168\u90e8\u4e0d\u6267\u884c\u65f6\uff0c\u6570\u636e\u5e93\u7ef4\u6301\u539f\u6709\u7684\u72b6\u6001\uff0c\u4e0d\u4f1a\u88ab\u4fee\u6539\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8986\u5199 ContentProvider \u7684 applyBatch(Stringauthority, ArrayList operations)\u65b9\u6cd5\u6765\u5b9e\u73b0\u5bf9\u4e8b\u52a1\u5904\u7406\u7684\u652f\u6301 <pre><code>\npublic @NonNull ContentProviderResult[] applyBatch(\n            @NonNull ArrayList&lt;ContentProviderOperation&gt; operations)\n                    throws OperationApplicationException {\n        SQLiteDatabase db = mDbHelper.getWritableDatabase();\n        db.beginTransaction();\n        try {\n            ContentProviderResult[] results = super.applyBatch(operations); \n            db.setTransactionSuccessful();\n            return results;\n            } finally { \n                db.endTransaction();\n            }\n    }\n</code></pre> <p>\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u6267\u884c\u6279\u91cf\u5bf9\u6570\u636e\u5e93\u7684\u4fee\u6539\uff0c\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u5199\u5165\u6570\u636e\u5e93\u7684\u6548\u7387\u3002</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/Best_Practices_for_Using_Alpha/","title":"Best Practices for Using Alpha","text":"<p>Alpha \u662f\u56fe\u5f62\u754c\u9762\u5f00\u53d1\u4e2d\u5e38\u7528\u7684\u7279\u6548\uff0c\u901a\u5e38\u6211\u4eec\u4f1a\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u6765\u5b9e\u73b0 Alpha \u7279\u6548:</p> <pre><code>view.setAlpha(0.5f);\nView.ALPHA.set(view, 0.5f); \nObjectAnimator.ofFloat(view, \"alpha\", 0.5f).start(); \nview.animate().alpha(0.5f).start(); \nview.setAnimation(new AlphaAnimation(1.0f, 0.5f));\n</code></pre> <p>\u5176\u6548\u679c\u90fd\u7b49\u540c\u4e8e:</p> <p>canvas.saveLayer(l, r, t, b, 127, Canvas.CLIP_TO_LAYER_SAVE_FLAG);</p> <p>\u6240\u4ee5\u5e38\u89c1\u7684 alpha \u7279\u6548\u662f\u901a\u8fc7\u5c06\u56fe\u50cf\u7ed8\u5236\u5230 offscreen buffer \u4e2d\u7136\u540e\u663e\u793a\u51fa\u6765\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u662f\u975e\u5e38\u6d88\u8017\u8d44\u6e90 \u7684\uff0c\u751a\u81f3\u53ef\u80fd\u5bfc\u81f4\u6027\u80fd\u95ee\u9898\uff0c\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u907f\u514d\u521b\u5efa offsreen buffer\u3002</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/Best_Practices_for_Using_Alpha/#textview","title":"TextView","text":"<p>\u5bf9\u4e8e TextView \u6211\u4eec\u901a\u5e38\u9700\u8981\u6587\u5b57\u900f\u660e\u6548\u679c\uff0c\u800c\u4e0d\u662f View \u672c\u8eab\u900f\u660e\uff0c\u6240\u4ee5\uff0c\u76f4\u63a5\u8bbe\u7f6e\u5e26\u6709 alpha \u503c\u7684 TextColor \u662f\u6bd4\u8f83\u9ad8\u6548\u7684\u65b9\u5f0f\u3002</p> <pre><code>// Not this \ntextView.setAlpha(alpha);\n// \u4ee5\u4e0b\u65b9\u5f0f\u53ef\u4ee5\u907f\u514d\u521b\u5efa offscreen buffer\nint newTextColor = (int) (0xFF * alpha) &lt;&lt; 24 | baseTextColor &amp; 0xFFFFFF; textView.setTextColor(newTextColor);\n\n</code></pre>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/Best_Practices_for_Using_Alpha/#imageview","title":"ImageView","text":"<p>\u540c\u6837\u7684\u5bf9\u4e8e\u53ea\u5177\u6709 src image \u7684 ImageView\uff0c\u76f4\u63a5\u8c03\u7528 setImageAlpha()\u65b9\u6cd5\u66f4\u4e3a\u5408\u7406\u3002</p> <pre><code>// Not this, setAlpha \u65b9\u6cd5\u7531 View \u7ee7\u627f\u800c\u6765\uff0c\u6027\u80fd\u4e0d\u4f73 \nimageView.setAlpha(0.5f);\n// \u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u65f6\uff0cImageView \u4f1a\u5728\u7ed8\u5236\u56fe\u7247\u65f6\u5355\u72ec\u4e3a\u56fe\u7247\u6307\u5b9a Alpha // \u53ef\u4ee5\u907f\u514d\u521b\u5efa offScreenBuffer\nimageView.setImageAlpha((int) alpha * 255);\n</code></pre>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/Best_Practices_for_Using_Alpha/#customview","title":"CustomView","text":"<p>\u7c7b\u4f3c\u7684\uff0c\u81ea\u5b9a\u4e49\u63a7\u4ef6\u65f6\uff0c\u5e94\u8be5\u76f4\u63a5\u53bb\u8bbe\u7f6e paint \u7684 alpha\u3002</p> <pre><code>\n// Not this \ncustomView.setAlpha(alpha);\n// But this\npaint.setAlpha((int) alpha * 255); canvas.draw*(..., paint);\n</code></pre> <p>\u540c\u65f6 Android \u63d0\u4f9b\u4e86 hasOverlappingRendering()\u63a5\u53e3\uff0c\u901a\u8fc7\u91cd\u5199\u8be5\u63a5\u53e3\u53ef\u4ee5\u544a\u77e5\u7cfb\u7edf\u5f53\u524d View \u662f\u5426\u5b58\u5728\u5185\u5bb9\u91cd\u53e0\u7684\u60c5\u51b5\uff0c\u5e2e\u52a9\u7cfb\u7edf\u4f18\u5316\u7ed8\u5236\u6d41\u7a0b\uff0c\u539f\u7406\u662f\u8fd9\u6837\u7684:\u5bf9\u4e8e\u6709\u91cd\u53e0\u5185\u5bb9\u7684 View\uff0c\u7cfb\u7edf\u7b80\u5355\u7c97\u66b4\u7684\u4f7f\u7528 offscreen buffer \u6765\u534f\u52a9\u5904\u7406\u3002\u5f53\u544a\u77e5\u7cfb\u7edf\u8be5 View \u65e0\u91cd\u53e0\u5185\u5bb9\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5206\u522b\u4f7f\u7528\u5408\u9002\u7684 alpha \u503c\u7ed8\u5236\u6bcf\u4e00\u5c42\u3002</p> <pre><code>\n/**\n* Returns whether this View has content which overlaps. This function, intended to be\n* overridden by specific View types, is an optimization when alpha is set on a view. If\n* rendering overlaps in a view with alpha &lt; 1, that view is drawn to an offscreen buffer\n* and then composited it into place, which can be expensive. If the view has no overlapping * rendering, the view can draw each primitive with the appropriate alpha value directly.\n* An example of overlapping rendering is a TextView with a background image, such as a\n* Button. An example of non-overlapping rendering is a TextView with no background, or\n* an ImageView with only the foreground image. The default implementation returns true;\n* subclasses should override if they have cases which can be optimized. *\n* @return true if the content in this view might overlap, false otherwise. */\npublic boolean hasOverlappingRendering() { \n    return true;\n}\n</code></pre> <p>\u6700\u540e\u5f15\u7528 Chet Haase \u7684\u4e00\u53e5\u8bdd\u4f5c\u4e3a\u603b\u7ed3 \u201cYou know what your view is doing, so do the right thing for your situation.\u201d</p> <p>\u53c2\u8003</p> <p>\u7ed9 App \u63d0\u901f\uff1aAndroid \u6027\u80fd\u4f18\u5316\u603b\u7ed3</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/Bitmap%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0/","title":"Bitmap\u76f8\u5173\u6587\u7ae0","text":"<p>\u4eceassets\u76ee\u5f55\u548cdrawable\u52a0\u8f7d\u7684Bitmap\u7684\u533a\u522b</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/DiskLruCache/","title":"DiskLruCache","text":"<p>\u57fa\u672c\u539f\u7406\uff1a</p> <p>\u5c06\u56fe\u7247\u4fdd\u5b58\u5728\u78c1\u76d8\u4e2d\uff0c\u7ef4\u62a4\u4e00\u4e2ajournal\u6587\u4ef6\u7528\u6765\u8bb0\u5f55\u7528\u6237\u5bf9\u6587\u4ef6\u76844\u79cd\u64cd\u4f5c\u8bb0\u5f55\u3002\u521d\u59cb\u5316\u548c\u4efb\u4f55\u4e00\u79cd\u884c\u4e3a\u90fd\u4f1a\u5237\u65b0\u8be5journal\u6587\u4ef6\uff0c\u5e76\u4e14\u6839\u636e\u8be5journal\u6587\u4ef6\uff0c\u5c06\u7f13\u5b58\u6587\u4ef6\u8bb0\u5f55\u5230LinkedHashMap\u3002\u548cLruCache\u4e00\u6837\uff0c\u4f7f\u7528\u4e86LinkedHashMap\uff0c\u4f5c\u4e3aLRU\u7b97\u6cd5\u7684\u6570\u636e\u57fa\u7840\u3002</p> <p>\u64cd\u4f5c\u884c\u4e3a\u67094\u79cd\uff1a</p> <ul> <li> <p>DIRTY: \u542b\u4e49\u5982\u5176\u540d\uff0c\u610f\u5473\u7740\u4e00\u6761\u810f\u6570\u636e\u3002\u5f53\u8c03\u7528edit()\u65f6\uff0c\u5c31\u4f1a\u5411journal\u6587\u4ef6\u5199\u5165\u4e00\u6761DIRTY\u8bb0\u5f55\uff0c\u8868\u793a\u6211\u4eec\u6b63\u51c6\u5907\u5199\u5165\u4e00\u6761\u7f13\u5b58\u6570\u636e\uff0c\u4f46\u4e0d\u77e5\u7ed3\u679c\u5982\u4f55\u3002</p> </li> <li> <p>CLEAN: \u8868\u793a\u6570\u636e\u662f\u5e72\u51c0\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u5f53\u8c03\u7528commit()\uff0c\u4f1a\u5411journal\u6587\u4ef6\u5199\u5165\u4e00\u6761CLEAN\u8bb0\u5f55\uff0c\u8868\u793a\u7f13\u51b2\u6570\u636e\u53ef\u7528\uff0c\u53ef\u4ee5READ\u3002</p> </li> <li> <p>READ: \u5f53\u8c03\u7528get()\uff0c\u4f1a\u5411journal\u6587\u4ef6\u5199\u5165\u4e00\u6761READ\u8bb0\u5f55\uff0c\u8868\u793a\u8bfb\u53d6\u4e00\u6761\u7f13\u5b58\u6570\u636e\u3002</p> </li> <li> <p>REMOVE: \u5f53\u8c03\u7528remove()\uff0c\u4f1a\u5411journal\u6587\u4ef6\u5199\u5165\u4e00\u6761REMOVE\u8bb0\u5f55\uff0c\u8868\u793a\u5220\u9664\u4e00\u6761\u7f13\u5b58\u6570\u636e\u3002</p> </li> </ul> <p>journal\u6587\u4ef6\uff1a</p> <pre><code>libcore.io.DiskLruCache     // DiskLruCache\u7684\u6807\u8bb0\uff0c\u56fa\u5b9a\u5e38\u91cf\n1                           // DiskLruCache\u7248\u672c\u53f7\n100                         // \u5e94\u7528\u7a0b\u5e8f\u7248\u672c\u53f7\n2                           // open()\u65b9\u6cd5\u4e2d\u4f20\u5165\u7684\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u4e3a1\n\nCLEAN 3400330d1dfc7f3f7f4b8d4d803dfcf6 832 21054\nDIRTY 335c4c6028171cfddfbaae1a9c313c52\nCLEAN 335c4c6028171cfddfbaae1a9c313c52 3934 2342\nREMOVE 335c4c6028171cfddfbaae1a9c313c52\nDIRTY 1ab96a171faeeee38496d8b330771a7a\nCLEAN 1ab96a171faeeee38496d8b330771a7a 1600 234\nREAD 335c4c6028171cfddfbaae1a9c313c52\nREAD 3400330d1dfc7f3f7f4b8d4d803dfcf6\n\n</code></pre> <p>\u95ee\uff1a</p> <ol> <li>\u5373\u4fbfget()\u65f6\uff0c\u4eceLinkedHashMap\u4e2d\u83b7\u5f97\u4e86\u7f13\u5b58\u6587\u4ef6\u7684\u540d\u5b57(\u5373hash\u540e\u7684key)\uff0c\u4ece\u6587\u4ef6\u5217\u8868\u4e2d\u62ff\u5230\u6587\u4ef6\u4e0d\u8fd8\u662f\u8981\u9010\u4e2a\u904d\u5386\u4e48\uff0c\u5b9a\u4f4d\u540d\u5b57\u662f\u5426\u5339\u914d\u7684\u6587\u4ef6\u4e48\uff1f</li> </ol> <p>A: \u8bfb\u6587\u4ef6\u65f6\uff0c\u6839\u636ekey\uff0c\u4eceLinkedHashMap\u4e2d\u83b7\u53d6Entry\uff0c\u5224\u65adEntry\u662f\u5426\u5b58\u5728\uff0c\u4e14readable\u3002\u6ee1\u8db3\u6761\u4ef6\u540e\uff0c\u6839\u636eDiskLruCache\u5185\u90e8\u4fdd\u5b58\u7684\u5b58\u653e\u7f13\u5b58\u6587\u4ef6\u7684directory\uff0c\u7ed3\u5408key\uff0c\u5bf9\u5e94\u7f13\u5b58\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u5c31\u6709\u4e86\uff0c\u5373directory + key\u3002\u6240\u4ee5\u83b7\u53d6\u5bf9\u5e94\u7f13\u5b58\u6587\u4ef6\u4e5f\u5c31\u7b80\u5355\u4e86\uff0c\u5373</p> <pre><code>new File(directory, key)\n</code></pre>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/LruCache/","title":"LruCache","text":""},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/LruCache/#_1","title":"\u76f8\u5173\u77e5\u8bc6\u70b9","text":"<ul> <li>\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u539f\u5219</li> <li>LinkedHashMap</li> </ul>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/LruCache/#_2","title":"\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u539f\u5219","text":"<p>\u8fd1\u671f\u4e00\u6bb5\u65f6\u95f4\uff08\u7b80\u5355\u7406\u89e3\u4e3a\u5bb9\u5668\u5bb9\u91cf\uff09\uff0c\u6700\u5c11\u4f7f\u7528\u7684\u6392\u5728\u6700\u540e\uff0c\u6700\u591a\u4f7f\u7528\u7684\u6392\u5728\u6700\u524d\u3002\u5f53\u5bb9\u5668\u8d1f\u8f7d\u8fbe\u5230\u4e0a\u9650\u65f6\uff0c\u9996\u5148\u79fb\u9664\u6392\u5728\u6700\u540e\u7684\u8282\u70b9\u3002</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/LruCache/#linkedhashmap","title":"LinkedHashMap","text":"<p>\u56e0\u4e3aLruCache\u4e2dLru\u7b97\u6cd5\u7684\u5b9e\u73b0\u5c31\u662f\u901a\u8fc7LinkedHashMap\u6765\u5b9e\u73b0\u7684\u3002   LinkedHashMap\u7ee7\u627f\u4e8eHashMap\uff0c\u5b83\u4f7f\u7528\u4e86\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\u6765\u5b58\u50a8Map\u4e2d\u7684Entry\u987a\u5e8f\u5173\u7cfb\uff0c\u8fd9\u79cd\u987a\u5e8f\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662fLRU\u987a\u5e8f\uff0c\u4e00\u79cd\u662f\u63d2\u5165\u987a\u5e8f\uff0c\u8fd9\u53ef\u4ee5\u7531\u5176\u6784\u9020\u51fd\u6570public LinkedHashMap(int initialCapacity,float loadFactor, boolean accessOrder)\u6307\u5b9a\u3002   \u6240\u4ee5\uff0c\u5bf9\u4e8eget\u3001put\u3001remove\u7b49\u64cd\u4f5c\uff0cLinkedHashMap\u9664\u4e86\u8981\u505aHashMap\u505a\u7684\u4e8b\u60c5\uff0c\u8fd8\u505a\u4e9b\u8c03\u6574Entry\u987a\u5e8f\u94fe\u8868\u7684\u5de5\u4f5c\u3002LruCache\u4e2d\u5c06LinkedHashMap\u7684\u987a\u5e8f\u8bbe\u7f6e\u4e3aLRU\u987a\u5e8f\u6765\u5b9e\u73b0LRU\u7f13\u5b58\uff0c\u6bcf\u6b21\u8c03\u7528get(\u4e5f\u5c31\u662f\u4ece\u5185\u5b58\u7f13\u5b58\u4e2d\u53d6\u56fe\u7247)\uff0c\u5219\u5c06\u8be5\u5bf9\u8c61\u79fb\u5230\u94fe\u8868\u7684\u5c3e\u7aef\u3002\u8c03\u7528put\u63d2\u5165\u65b0\u7684\u5bf9\u8c61\u4e5f\u662f\u5b58\u50a8\u5728\u94fe\u8868\u5934\u90e8\uff0c\u8fd9\u6837\u5f53\u5185\u5b58\u7f13\u5b58\u8fbe\u5230\u8bbe\u5b9a\u7684\u6700\u5927\u503c\u65f6\uff0c\u5c06\u94fe\u8868\u5934\u90e8\u7684\u5c3e\u7aef\uff08\u6700\u5c11\u7528\u5230\u7684\uff09\u79fb\u9664\u3002</p> <p>LruCache:</p> <pre><code>package android.support.v4.util;\n\nimport java.util.LinkedHashMap;\nimport java.util.Map;\n\n\npublic class LruCache&lt;K, V&gt; {\n    private final LinkedHashMap&lt;K, V&gt; map; \n\n    /** Size of this cache in units. Not necessarily the number of elements. */\n    private int size;    //\u5f53\u524dcache\u7684\u5927\u5c0f\n    private int maxSize; //cache\u6700\u5927\u5927\u5c0f\n\n    private int putCount;       //put\u7684\u6b21\u6570\n    private int createCount;    //create\u7684\u6b21\u6570\n    private int evictionCount;  //\u56de\u6536\u7684\u6b21\u6570\n    private int hitCount;       //\u547d\u4e2d\u7684\u6b21\u6570\n    private int missCount;      //\u672a\u547d\u4e2d\u6b21\u6570\n\n    /**\n     * @param maxSize for caches that do not override {@link #sizeOf}, this is\n     *     the maximum number of entries in the cache. For all other caches,\n     *     this is the maximum sum of the sizes of the entries in this cache.\n     */\n    public LruCache(int maxSize) {\n        if (maxSize &lt;= 0) {\n            throw new IllegalArgumentException(\"maxSize &lt;= 0\");\n        }\n        this.maxSize = maxSize;\n        //\u5c06LinkedHashMap\u7684accessOrder\u8bbe\u7f6e\u4e3atrue\u6765\u5b9e\u73b0LRU\n        this.map = new LinkedHashMap&lt;K, V&gt;(0, 0.75f, true);  \n    }\n\n    /**\n     * Returns the value for {@code key} if it exists in the cache or can be\n     * created by {@code #create}. If a value was returned, it is moved to the\n     * head of the queue. This returns null if a value is not cached and cannot\n     * be created.\n     * \u901a\u8fc7key\u83b7\u53d6\u76f8\u5e94\u7684item\uff0c\u6216\u8005\u521b\u5efa\u8fd4\u56de\u76f8\u5e94\u7684item\u3002\u76f8\u5e94\u7684item\u4f1a\u79fb\u52a8\u5230\u961f\u5217\u7684\u5c3e\u90e8\uff0c\n     * \u5982\u679citem\u7684value\u6ca1\u6709\u88abcache\u6216\u8005\u4e0d\u80fd\u88ab\u521b\u5efa\uff0c\u5219\u8fd4\u56denull\u3002\n     */\n    public final V get(K key) {\n        if (key == null) {\n            throw new NullPointerException(\"key == null\");\n        }\n\n        V mapValue;\n\n        // \u5bf9Map\u7684get()\u64cd\u4f5c\u540c\u6b65\n        synchronized (this) {\n            mapValue = map.get(key);\n            if (mapValue != null) {\n                //mapValue\u4e0d\u4e3a\u7a7a\u8868\u793a\u547d\u4e2d\uff0chitCount+1\u5e76\u8fd4\u56demapValue\u5bf9\u8c61\n                hitCount++;\n                return mapValue;\n            }\n            missCount++;  //\u672a\u547d\u4e2d\n        }\n\n        /*\n         * Attempt to create a value. This may take a long time, and the map\n         * may be different when create() returns. If a conflicting value was\n         * added to the map while create() was working, we leave that value in\n         * the map and release the created value.\n         * \u5982\u679c\u672a\u547d\u4e2d\uff0c\u5219\u8bd5\u56fe\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u91cccreate\u65b9\u6cd5\u8fd4\u56denull,\u5e76\u6ca1\u6709\u5b9e\u73b0\u521b\u5efa\u5bf9\u8c61\u7684\u65b9\u6cd5\n         * \u5982\u679c\u9700\u8981\u4e8b\u9879\u521b\u5efa\u5bf9\u8c61\u7684\u65b9\u6cd5\u53ef\u4ee5\u91cd\u5199create\u65b9\u6cd5\u3002\u56e0\u4e3a\u56fe\u7247\u7f13\u5b58\u65f6\u5185\u5b58\u7f13\u5b58\u6ca1\u6709\u547d\u4e2d\u4f1a\u53bb\n         * \u6587\u4ef6\u7f13\u5b58\u4e2d\u53bb\u53d6\u6216\u8005\u4ece\u7f51\u7edc\u4e0b\u8f7d\uff0c\u6240\u4ee5\u5e76\u4e0d\u9700\u8981\u521b\u5efa\u3002\n         */\n        V createdValue = create(key);\n        if (createdValue == null) {\n            return null;\n        }\n        //\u5047\u5982\u521b\u5efa\u4e86\u65b0\u7684\u5bf9\u8c61\uff0c\u5219\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\n        synchronized (this) {\n            createCount++;  \n            //\u5c06createdValue\u52a0\u5165\u5230map\u4e2d\uff0c\u5e76\u4e14\u5c06\u539f\u6765\u952e\u4e3akey\u7684\u5bf9\u8c61\u4fdd\u5b58\u5230mapValue\n            mapValue = map.put(key, createdValue);   \n            if (mapValue != null) {\n                // There was a conflict so undo that last put\n                //\u5982\u679cmapValue\u4e0d\u4e3a\u7a7a\uff0c\u5219\u64a4\u9500\u4e0a\u4e00\u6b65\u7684put\u64cd\u4f5c\u3002\n                map.put(key, mapValue);\n            } else {\n                //\u52a0\u5165\u65b0\u521b\u5efa\u7684\u5bf9\u8c61\u4e4b\u540e\u9700\u8981\u91cd\u65b0\u8ba1\u7b97size\u5927\u5c0f\n                size += safeSizeOf(key, createdValue);\n            }\n        }\n\n        if (mapValue != null) {\n            entryRemoved(false, key, createdValue, mapValue);\n            return mapValue;\n        } else {\n            //\u6bcf\u6b21\u65b0\u52a0\u5165\u5bf9\u8c61\u90fd\u9700\u8981\u8c03\u7528trimToSize\u65b9\u6cd5\u770b\u662f\u5426\u9700\u8981\u56de\u6536\n            trimToSize(maxSize);\n            return createdValue;\n        }\n    }\n\n    /**\n     * Caches {@code value} for {@code key}. The value is moved to the head of\n     * the queue.\n     *\n     * @return the previous value mapped by {@code key}.\n     */\n    public final V put(K key, V value) {\n        if (key == null || value == null) {\n            throw new NullPointerException(\"key == null || value == null\");\n        }\n\n        V previous;\n        synchronized (this) {\n            putCount++;\n            size += safeSizeOf(key, value);  //size\u52a0\u4e0a\u9884put\u5bf9\u8c61\u7684\u5927\u5c0f\n            previous = map.put(key, value);\n            if (previous != null) {\n                //\u5982\u679c\u4e4b\u524d\u5b58\u5728\u952e\u4e3akey\u7684\u5bf9\u8c61\uff0c\u5219size\u5e94\u8be5\u51cf\u53bb\u539f\u6765\u5bf9\u8c61\u7684\u5927\u5c0f\n                size -= safeSizeOf(key, previous);\n            }\n        }\n\n        if (previous != null) {\n            entryRemoved(false, key, previous, value);\n        }\n        //\u6bcf\u6b21\u65b0\u52a0\u5165\u5bf9\u8c61\u90fd\u9700\u8981\u8c03\u7528trimToSize\u65b9\u6cd5\u770b\u662f\u5426\u9700\u8981\u56de\u6536\n        trimToSize(maxSize);\n        return previous;\n    }\n\n    /**\n     * @param maxSize the maximum size of the cache before returning. May be -1\n     *     to evict even 0-sized elements.\n     * \u6b64\u65b9\u6cd5\u6839\u636emaxSize\u6765\u8c03\u6574\u5185\u5b58cache\u7684\u5927\u5c0f\uff0c\u5982\u679cmaxSize\u4f20\u5165-1\uff0c\u5219\u6e05\u7a7a\u7f13\u5b58\u4e2d\u7684\u6240\u6709\u5bf9\u8c61\n     */\n    private void trimToSize(int maxSize) {\n        while (true) {\n            K key;\n            V value;\n            synchronized (this) {\n                if (size &lt; 0 || (map.isEmpty() &amp;&amp; size != 0)) {\n                    throw new IllegalStateException(getClass().getName()\n                            + \".sizeOf() is reporting inconsistent results!\");\n                }\n                //\u5982\u679c\u5f53\u524dsize\u5c0f\u4e8emaxSize\u6216\u8005map\u6ca1\u6709\u4efb\u4f55\u5bf9\u8c61,\u5219\u7ed3\u675f\u5faa\u73af\n                if (size &lt;= maxSize || map.isEmpty()) {\n                    break;\n                }\n                //\u79fb\u9664\u94fe\u8868\u5934\u90e8\u7684\u5143\u7d20\uff0c\u5e76\u8fdb\u5165\u4e0b\u4e00\u6b21\u5faa\u73af\n                Map.Entry&lt;K, V&gt; toEvict = map.entrySet().iterator().next();\n                key = toEvict.getKey();\n                value = toEvict.getValue();\n                map.remove(key);\n                size -= safeSizeOf(key, value);\n                evictionCount++;  //\u56de\u6536\u6b21\u6570+1\n            }\n\n            entryRemoved(true, key, value, null);\n        }\n    }\n\n    /**\n     * Removes the entry for {@code key} if it exists.\n     *\n     * @return the previous value mapped by {@code key}.\n     * \u4ece\u5185\u5b58\u7f13\u5b58\u4e2d\u6839\u636ekey\u503c\u79fb\u9664\u67d0\u4e2a\u5bf9\u8c61\u5e76\u8fd4\u56de\u8be5\u5bf9\u8c61\n     */\n    public final V remove(K key) {\n        if (key == null) {\n            throw new NullPointerException(\"key == null\");\n        }\n\n        V previous;\n        synchronized (this) {\n            previous = map.remove(key);\n            if (previous != null) {\n                size -= safeSizeOf(key, previous);\n            }\n        }\n\n        if (previous != null) {\n            entryRemoved(false, key, previous, null);\n        }\n\n        return previous;\n    }\n\n    /**\n     * Called for entries that have been evicted or removed. This method is\n     * invoked when a value is evicted to make space, removed by a call to\n     * {@link #remove}, or replaced by a call to {@link #put}. The default\n     * implementation does nothing.\n     *\n     * &lt;p&gt;The method is called without synchronization: other threads may\n     * access the cache while this method is executing.\n     *\n     * @param evicted true if the entry is being removed to make space, false\n     *     if the removal was caused by a {@link #put} or {@link #remove}.\n     * @param newValue the new value for {@code key}, if it exists. If non-null,\n     *     this removal was caused by a {@link #put}. Otherwise it was caused by\n     *     an eviction or a {@link #remove}.\n     */\n    protected void entryRemoved(boolean evicted, K key, V oldValue, V newValue) {}\n\n    /**\n     * Called after a cache miss to compute a value for the corresponding key.\n     * Returns the computed value or null if no value can be computed. The\n     * default implementation returns null.\n     *\n     * &lt;p&gt;The method is called without synchronization: other threads may\n     * access the cache while this method is executing.\n     *\n     * &lt;p&gt;If a value for {@code key} exists in the cache when this method\n     * returns, the created value will be released with {@link #entryRemoved}\n     * and discarded. This can occur when multiple threads request the same key\n     * at the same time (causing multiple values to be created), or when one\n     * thread calls {@link #put} while another is creating a value for the same\n     * key.\n     */\n    protected V create(K key) {\n        return null;\n    }\n\n    private int safeSizeOf(K key, V value) {\n        int result = sizeOf(key, value);\n        if (result &lt; 0) {\n            throw new IllegalStateException(\"Negative size: \" + key + \"=\" + value);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the size of the entry for {@code key} and {@code value} in\n     * user-defined units.  The default implementation returns 1 so that size\n     * is the number of entries and max size is the maximum number of entries.\n     *\n     * &lt;p&gt;An entry's size must not change while it is in the cache.\n     * \u7528\u6765\u8ba1\u7b97\u5355\u4e2a\u5bf9\u8c61\u7684\u5927\u5c0f\uff0c\u8fd9\u91cc\u9ed8\u8ba4\u8fd4\u56de1\uff0c\u4e00\u822c\u9700\u8981\u91cd\u5199\u8be5\u65b9\u6cd5\u6765\u8ba1\u7b97\u5bf9\u8c61\u7684\u5927\u5c0f\n     * xUtils\u4e2d\u521b\u5efaLruMemoryCache\u65f6\u5c31\u91cd\u5199\u4e86sizeOf\u65b9\u6cd5\u6765\u8ba1\u7b97bitmap\u7684\u5927\u5c0f\n     * mMemoryCache = new LruMemoryCache&lt;MemoryCacheKey, Bitmap&gt;(globalConfig.getMemoryCacheSize()) {\n     *       @Override\n     *       protected int sizeOf(MemoryCacheKey key, Bitmap bitmap) {\n     *           if (bitmap == null) return 0;\n     *           return bitmap.getRowBytes() * bitmap.getHeight();\n     *       }\n     *   };\n     *\n     */\n    protected int sizeOf(K key, V value) {\n        return 1;\n    }\n\n    /**\n     * Clear the cache, calling {@link #entryRemoved} on each removed entry.\n     * \u6e05\u7a7a\u5185\u5b58\u7f13\u5b58\n     */\n    public final void evictAll() {\n        trimToSize(-1); // -1 will evict 0-sized elements\n    }\n\n    /**\n     * For caches that do not override {@link #sizeOf}, this returns the number\n     * of entries in the cache. For all other caches, this returns the sum of\n     * the sizes of the entries in this cache.\n     */\n    public synchronized final int size() {\n        return size;\n    }\n\n    /**\n     * For caches that do not override {@link #sizeOf}, this returns the maximum\n     * number of entries in the cache. For all other caches, this returns the\n     * maximum sum of the sizes of the entries in this cache.\n     */\n    public synchronized final int maxSize() {\n        return maxSize;\n    }\n\n    /**\n     * Returns the number of times {@link #get} returned a value.\n     */\n    public synchronized final int hitCount() {\n        return hitCount;\n    }\n\n    /**\n     * Returns the number of times {@link #get} returned null or required a new\n     * value to be created.\n     */\n    public synchronized final int missCount() {\n        return missCount;\n    }\n\n    /**\n     * Returns the number of times {@link #create(Object)} returned a value.\n     */\n    public synchronized final int createCount() {\n        return createCount;\n    }\n\n    /**\n     * Returns the number of times {@link #put} was called.\n     */\n    public synchronized final int putCount() {\n        return putCount;\n    }\n\n    /**\n     * Returns the number of values that have been evicted.\n     */\n    public synchronized final int evictionCount() {\n        return evictionCount;\n    }\n\n    /**\n     * Returns a copy of the current contents of the cache, ordered from least\n     * recently accessed to most recently accessed.\n     */\n    public synchronized final Map&lt;K, V&gt; snapshot() {\n        return new LinkedHashMap&lt;K, V&gt;(map);\n    }\n\n    @Override public synchronized final String toString() {\n        int accesses = hitCount + missCount;\n        int hitPercent = accesses != 0 ? (100 * hitCount / accesses) : 0;\n        return String.format(\"LruCache[maxSize=%d,hits=%d,misses=%d,hitRate=%d%%]\",\n                maxSize, hitCount, missCount, hitPercent);\n    }\n}\n\n</code></pre>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/%E4%BB%8Eassets%E7%9B%AE%E5%BD%95%E5%92%8Cdrawable%E5%8A%A0%E8%BD%BD%E7%9A%84Bitmap%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"\u4eceassets\u76ee\u5f55\u548cdrawable\u52a0\u8f7d\u7684Bitmap\u7684\u533a\u522b","text":"<p>\u4e00\u5f20\u56fe\u7247\u4eceassert\u76ee\u5f55\u4e0b\u52a0\u8f7d\u5230\u5185\u5b58\u548c\u4ecedrawable\u76ee\u5f55\u4e0b\u52a0\u8f7d\u5230\u5185\u5b58\u6709\u4ec0\u4e48\u533a\u522b\uff1f</p> <p>\u5728assert\u76ee\u5f55\u4e0b\u653e\u4e00\u5f20\u56fe\u7247\uff0c<code>image_asserts.png</code></p> <p>\u7136\u540e\u5c1d\u8bd5\u4f7f\u7528BitmapFactory\u89e3\u7801\u8fd9\u4e2a\u56fe\u7247\u5f97\u5230\u4e00\u4e2aBitmap\uff0c\u901a\u8fc7Bitmap\u4e2dbyteCount\u65b9\u6cd5\u6765\u83b7\u53d6\u5b83\u6240\u5360\u7684\u5b57\u8282\u6570\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6bd4\u8f83\u8fd9\u4e9bBitmap\u6240\u5360\u7528\u7684\u5185\u5b58\u5927\u5c0f\u4e86\u3002</p> <pre><code>val bitmapAssert = BitmapFactory.decodeStream(assets.open(\"image_assets.png\"))\nLog.d(\"gaohui\",\"bitmapAssert bitmap size: \" + bitmapAssert.byteCount)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u662f\uff1a</p> <pre><code>gaohui: bitmapAssert bitmap size: 186624\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u4e0b\u628a\u540c\u4e00\u5f20\u56fe\u7247\u653e\u5728drawable-xxh\u76ee\u5f55\u4e0b\u4f1a\u662f\u4ec0\u4e48\u6548\u679c\uff1f</p> <pre><code>val bitmapXxh = BitmapFactory.decodeResource(resources, R.drawable.image_xxh, options)\n\nLog.d(\"gaohui\",\"bitmapXxh size: \" + bitmapXxh.byteCount)\n</code></pre> <p>\u8fd0\u884c\u540e\uff0c\u6253\u5370\u7ed3\u679c\u662f\uff1a</p> <pre><code>gaohui: bitmapXxh size: 156816\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u6253\u5370\u7ed3\u679c\u770b\u53d1\u73b0\u76f8\u6bd4\u4e8eAssert\u76ee\u5f55\u4e0b\u52a0\u8f7d\u7684Bitmap\uff0c\u5728drawable-xxxh\u76ee\u5f55\u4e0b\u89e3\u7801\u51fa\u6765\u7684Bitmap\u5b57\u8282\u6570\u8981\u5c0f\u3002</p> <p>\u6211\u4eec\u518d\u628a\u8fd9\u5f20\u56fe\u7247\u653e\u5230drawable-xxxh\u76ee\u5f55\u4e0b\uff0c\u770b\u770b\u662f\u4e0d\u662f\u8fd8\u4f1a\u6709\u6539\u53d8\uff1f</p> <pre><code>val bitmapXxxh = BitmapFactory.decodeResource(resources, R.drawable.image_xxxh, options)\n\nLog.d(\"gaohui\",\"bitmapXxxh size: \" + bitmapXxxh.byteCount)\n</code></pre> <p>\u6253\u5370\u7ed3\u679c\uff1a</p> <pre><code>gaohui: bitmapXxxh size: 156816\n</code></pre> <p>\u6253\u5370\u540e\u53d1\u73b0\u7adf\u7136\u548cdrawable-xxh\u76ee\u5f55\u4e0b\u7684\u4e00\u6837\u3002</p> <p>\u8fd9\u91cc\u5c31\u611f\u89c9\u6bd4\u8f83\u5947\u602a\uff0c\u6309\u7167Android\u5b98\u7f51\u7684\u8bf4\u6cd5\uff0c\u4e0d\u540cdrawable\u76ee\u5f55\u4e0b\u7684\u52a0\u8f7d\u51fa\u6765\u7684Bitmap\u5e94\u8be5\u662f\u4e0d\u4e00\u6837\u7684\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u4fee\u6539\u6210\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>//val bitmapXxxh = BitmapFactory.decodeResource(resources, R.drawable.image_xxxh, options)\nval bitmapXxxh = BitmapFactory.decodeResource(resources, R.drawable.image_xxxh, BitmapFactory.Options())\nLog.d(\"gaohui\",\"bitmapXxxh size: \" + bitmapXxxh.byteCount)\n</code></pre> <p>\u8fd9\u6837\u5904\u7406\u7684\u6253\u5370\u7ed3\u679c\u5c31\u662f\u6b63\u786e\u7684\u4e86\u3002</p> <pre><code>gaohui: bitmapXxxh size: 88804\n</code></pre> <p>\u4e0a\u9762drawable-xxxh\u76ee\u5f55\u4e0b\u548cdrawable-xxh\u76ee\u5f55\u4e0b\u540c\u4e00\u5f20\u56fe\u7247decode\u51fa\u6765\u7684Bitmap\u5360\u7528\u5185\u5b58\u4e00\u6837\u7684\u539f\u56e0\u4e3b\u8981\u56e0\u4e3aBitmapFactory.Options()\u590d\u7528\u5bfc\u81f4\u7684\u3002 \u540e\u9762\u7684\u4fee\u6539\u91cd\u65b0new\u4e86\u4e00\u4e2aBitmapFactory.Options()\uff0c\u53d1\u73b0Bitmap\u7684\u5b57\u8282\u6570\u53d8\u5c0f\u4e86\uff0c\u5b9e\u9645\u4e0a\u8fd9\u624d\u662f\u6b63\u786e\u7684\u5360\u7528\u5185\u5b58\u5927\u5c0f\u3002</p> <p>\u90a3\u4e48\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\u4e3a\u4ec0\u4e48\u4e0d\u540c\u76ee\u5f55\u4e0b\u52a0\u8f7d\u7684\u540c\u4e00\u5f20\u56fe\u7247\u4f46\u662fBitmap\u5360\u7528\u7684\u5927\u5c0f\u5374\u4e0d\u4e00\u6837\u5462\uff1f</p> <p>\u5173\u4e8eBitmap\u7684\u5185\u5b58\u5360\u7528\u8fd9\u91cc\u6709\u4e2a\u8ba1\u7b97\u516c\u5f0f\uff1a</p> <p>\u56fe\u7247\u5185\u5b58\u5927\u5c0f = (\u56fe\u7247width * scale + 0.5) * (\u56fe\u7247height * scale + 0.5)  * \u6bcf\u4e2a\u50cf\u7d20\u5b57\u8282</p> <p>\u800c\u8fd9\u4e2ascale\u662f\u8fd9\u6837\u8ba1\u7b97\u7684\uff1a</p> <p>scale = \u8bbe\u5907\u7684\u5c4f\u5e55\u5bc6\u5ea6 / drawable\u76ee\u5f55\u8bbe\u5b9a\u7684\u5c4f\u5e55\u5bc6\u5ea6</p> <p>\u8bbe\u5907\u7684\u5c4f\u5e55\u5bc6\u5ea6\u8ddf\u624b\u673a\u6709\u5173\uff0c\u4e0d\u540c\u7684\u624b\u673a\u53ef\u80fd\u8868\u73b0\u4e0d\u4e00\u6837\u3002</p> <p>\u4f7f\u7528\u8fd9\u4e2a\u5c31\u53ef\u4ee5\u83b7\u5f97\u8bbe\u5907\u7684\u5c4f\u5e55\u5bc6\u5ea6\u3002</p> <pre><code> getResources().getDisplayMetrics().densityDpi\n</code></pre> <p>\u4e0d\u540c\u7684drawable\u76ee\u5f55\u4e0b\u5c4f\u5e55\u5bc6\u5ea6\uff1a</p> \u76ee\u5f55 \u5c4f\u5e55\u5bc6\u5ea6 drawable-ldpi 120dpi drawable-mdpi 160dpi drawable-hdpi 240dpi drawable-xhdpi 320dpi drawable-xxhdpi 480dpi drawable-xxxhdpi 640dpi <p>\u5f53\u6211\u4eec\u4f7f\u7528decodeResource\u65b9\u6cd5\u8bfb\u53d6drawable\u76ee\u5f55\u4e0b\u9762\u7684\u56fe\u7247\u65f6\uff0c\u4f1a\u6839\u636e\u624b\u673a\u7684\u5c4f\u5e55\u5bc6\u5ea6\uff0c\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\u5939\u4e2d\u67e5\u627e\u8be5\u56fe\u7247\u3002\u82e5\u8be5\u56fe\u7247\u5b58\u5728\u4e8e\u5176\u4ed6\u76ee\u5f55\u4e0b\uff0c\u7cfb\u7edf\u5148\u5bf9\u8be5\u56fe\u7247\u8fdb\u884c\u7f29\u653e\u5904\u7406\uff0c\u518d\u663e\u793a\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u4e0b\u6bcf\u4e2a\u50cf\u7d20\u5360\u7528\u7684\u5b57\u8282\u3002</p> <p>BitmapFactory.Options\u4e2d\u7684inPreferredConfig\u8868\u793a\u7684\u662f\u56fe\u7247\u89e3\u7801\u683c\u5f0f\uff0c\u5373\u56fe\u7247\u7684\u6bcf\u4e2a\u50cf\u7d20\u5360\u7528\u7684\u5b57\u8282\u6570\u3002</p> <p>\u5e38\u89c1\u7684\u89e3\u7801\u683c\u5f0f\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a * Bitmap.Config.ARGB_8888: ARGB 4\u4e2a\u901a\u9053\uff0c\u6bcf\u4e2a\u50cf\u7d204\u4e2a\u5b57\u8282\u3002\u90e8\u5206\u56fe\u7247\u663e\u793a\u65f6\u4e0d\u9700\u8981Alpha\uff0c\u6240\u4ee5\u53ef\u4f7f\u7528565\u683c\u5f0f\u3002 * Bitmap.Config.ARGB_4444: \u5b98\u65b9\u6807\u6ce8Deprecated\u3002ARGB 4\u4e2a\u901a\u9053\uff0c\u6bcf\u4e2a\u50cf\u7d202\u4e2a\u5b57\u8282\u3002 * Bitmap.Config.RGB_565\uff1aRGB 3\u4e2a\u901a\u9053\uff0c\u6bcf\u4e2a\u50cf\u7d202\u4e2a\u5b57\u8282\u3002 * Bitmap.Config.ALPHA_8\uff1a\u6bcf\u4e2a\u50cf\u7d201\u4e2a\u5b57\u8282\u3002\u4e3b\u8981\u7528\u4e8eAlpha\u901a\u9053\u6a21\u677f\uff0c\u76f8\u5f53\u505a\u4e00\u4e2a\u67d3\u8272\u3002\u56fe\u50cf\u6e32\u67d3\u4e24\u6b21\uff0c\u867d\u7136\u8282\u7701\u5185\u5b58\uff0c\u4f46\u589e\u52a0\u4e86\u7ed8\u5236\u5f00\u9500</p> <p>\u4ecb\u7ecd\u4e86\u8fd9\u4e48\u591a\u6211\u4eec\u6765\u81ea\u5df1\u5c1d\u8bd5\u8ba1\u7b97\u4e0b\u56fe\u7247\u7684\u5185\u5b58\u5927\u5c0f\u662f\u5426\u548c\u6253\u5370\u51fa\u6765\u7684\u7ed3\u679c\u4e00\u6837\u3002</p> <pre><code>    val scaleXxh = densityDpi/480f\n    Log.d(\"gaohui\",\"scaleXxh: $scaleXxh\")\n    //\u56fe\u7247\u9ad8\u5ea6\u548c\u5bbd\u5ea6\u90fd\u662f216\n    val byteCountXxh = (scaleXxh * 216 + 0.5)* (scaleXxh * 216 + 0.5) * 4\n    Log.d(\"gaohui\", \"Calculator bitmapXxh size: $byteCountXxh\")\n\n     val scaleXxxh = densityDpi/640f\n    //\u56fe\u7247\u9ad8\u5ea6\u548c\u5bbd\u5ea6\u90fd\u662f216\n    val byteCountXxxh = (scaleXxxh * 216  + 0.5f)* (scaleXxxh * 216 + 0.5) * 4\n    Log.d(\"gaohui\", \"Calculator bitmapXxXh size: $byteCountXxxh\")\n\n</code></pre> <p>\u6253\u5370\u51fa\u6765\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>gaohui: Calculator bitmapXxh size: 157609.0\ngaohui: Calculator bitmapXxXh size: 88804.0\n</code></pre> <p>\u8fd9\u91cc\u6709\u4eba\u53c8\u4f1a\u95ee\u95ee\u9898\u4e86\uff0c\u4f60\u8fd9\u4e2a\u4e0d\u5bf9\uff0cdrawable-xxh\u4e0b\u901a\u8fc7getByteCount\u62ff\u5230\u7684\u5927\u5c0f\u662f156816\uff0c\u800c\u4f60\u8fd9\u91cc\u662f157619\uff0c\u660e\u663e\u4e0d\u5bf9\u554a\u3002</p> <p>\u5176\u5b9e\u8fd9\u91cc\u4e3b\u8981\u662f\u7cbe\u5ea6\u95ee\u9898\u5bfc\u81f4\u7684\u5dee\u8ddd\u3002</p> <p>\u5177\u4f53Bitmap\u7684decode\u6d41\u7a0b\u53ef\u4ee5\u770b\u4e0b\u8fd9\u7bc7\u6587\u7ae0\uff1aAndroid\u4e2dBitmap\u5360\u7528\u5185\u5b58\u8ba1\u7b97</p> <p>\u8fd9\u91cc\u6211\u8bf4\u4e0b\u5f15\u8d77\u4e0a\u8ff0\u7cbe\u5ea6\u95ee\u9898\u7684\u5dee\u8ddd\u4e3b\u8981\u5728BitmapFactory.cpp\u4e2ddoDecode\u65b9\u6cd5\u4e2d\uff0cBitmapFactory.cpp\u4e2d\u7684doDecode\u65b9\u6cd5\u662fBitmapFactory.java\u4e0a\u5c42\u8c03\u7528\u8fc7\u6765\u7684\u3002</p> <p>\u5728BitmapFactory.cpp\u4e2d\u7684doDecode\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>static jobject doDecode(JNIEnv* env, SkStream* stream, jobject padding,\n        jobject options, bool allowPurgeable, bool forcePurgeable = false,\n        bool applyScale = false, float scale = 1.0f) {\n\n        ...\n        int scaledWidth = decoded-&gt;width();\n        int scaledHeight = decoded-&gt;height();\n        if (willScale &amp;&amp; mode != SkImageDecoder::kDecodeBounds_Mode) {\n        scaledWidth = int(scaledWidth * scale + 0.5f);\n        scaledHeight = int(scaledHeight * scale + 0.5f);\n\n        //...\n    }\n    }\n\n</code></pre> <p>\u8fd9\u91cc\u8ba1\u7b97Bitmap\u5bbd\u5ea6\u7684\u5730\u65b9\u4f1a\u5148\u52a0\u4e2a0.5f\u7136\u540e\u518d\u8f6c\u6210int\uff0c\u800c\u8fd9\u91cc\u7684scaledWidth\u548cscaledHeight\u4f1a\u88ab\u7528\u5230\u5185\u5b58\u8ba1\u7b97\u90a3\u91cc\u4f7f\u7528\u3002</p> <p>\u6211\u4eec\u6765\u6539\u4e0b\u8fd9\u4e2a\u90e8\u5206\u7684\u4ee3\u7801\uff1a</p> <pre><code> val scaleXxh = densityDpi/480f\n//\u56fe\u7247\u9ad8\u5ea6\u548c\u5bbd\u5ea6\u90fd\u662f216\nval w =  (scaleXxh * 216 + 0.5).toInt()\nval h = (scaleXxh * 216 + 0.5).toInt()\nval byteCountXxh = w * h * 4\nLog.d(\"gaohui\", \"Calculator bitmapXxh size: $byteCountXxh\")\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u8ddf\u6700\u5f00\u59cb\u901a\u8fc7Bitmap\u7684getByteCount\u65b9\u6cd5\u83b7\u53d6\u662f\u4e00\u81f4\u7684\u4e86\u3002</p> <pre><code>gaohui: Calculator bitmapXxh size: 156816\n</code></pre> <p>Options.inSampleSize \u56fe\u7247\u89e3\u7801\u5c3a\u5bf8</p> <p>\u4f7f\u7528inSampleSize\u53ef\u4ee5\u4f7f\u89e3\u7801\u540e\u7684\u56fe\u7247\u5c3a\u5bf8\uff08\u5bbd\u9ad8\uff09\u7f29\u5c0f\uff0c\u4ece\u800c\u8282\u7701\u5185\u5b58\u3002 \u6bd4\u5982\uff0cinSampleSize=4\uff0c\u89e3\u7801\u540e\u56fe\u7247\u5bbd\u9ad8\u5206\u522b\u662f\u539f\u56fe\u76841/4\u3002 \u539f\u7406\u662f\uff0c\u89e3\u7801\u5668\u4f1a\u6839\u636e\u8fd9\u4e2a\u503c\uff0c\u6bcf\u51e0\u4e2a\u50cf\u7d20\u8bfb\u5165\u4e00\u6b21\u3002</p> <p>3.Options.inBitmap \u91cd\u7528\u5185\u5b58</p> <p>Android3.0\u5f15\u5165\u4e86\u6b64\u5b57\u6bb5\u3002\u4f7f\u7528\u4e86\u6b64\u5b57\u6bb5\uff0cdecode\u65b9\u6cd5\u4f1a\u5c1d\u8bd5\u91cd\u7528\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u4f4d\u56fe\u3002\u8fd9\u5c31\u610f\u5473\u7740\u4f4d\u56fe\u5185\u5b58\u88ab\u91cd\u7528\u4e86\uff0c\u4ece\u800c\u6539\u5584\u6027\u80fd\uff0c\u5e76\u4e14\u6ca1\u6709\u5185\u5b58\u5206\u914d\u548c\u91ca\u653e\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"Android/%E5%9B%BE%E7%89%87%E7%9B%B8%E5%85%B3/%E5%9B%BE%E5%83%8F%E6%98%BE%E7%A4%BA%E5%8E%9F%E7%90%86/","title":"\u56fe\u50cf\u663e\u793a\u539f\u7406","text":"<p>blog: Android\u56fe\u5f62\u663e\u793a\u7cfb\u7edf\u2014\u2014\u4e00\u5f20\u56fe\u7247\u7684\u663e\u793a\u6d41\u7a0b</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/","title":"ARouter","text":"<p>\u5199\u8fd9\u7bc7\u6587\u7ae0\u7684\u76ee\u7684\uff0c\u4e00\u4e2a\u662f\u4e3a\u4e86\u4e86\u89e3ARouter\u7684\u539f\u7406\uff0c\u53e6\u5916\u4e00\u4e2a\u5c31\u662f\u770b\u770bARouter\u4f7f\u7528\u4e86\u54ea\u4e9b\u6709\u610f\u601d\u7684\u6280\u672f\uff0c\u54ea\u4e9b\u6280\u672f\u53ef\u4ee5\u5e94\u7528\u5230\u6211\u4eec\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u3002</p> <p>ARouter\u672c\u8d28\u4e0a\u662f\u4e2a\u8def\u7531\u6846\u67b6\uff0c\u5e38\u7528\u5728\u7ec4\u4ef6\u5316\u67b6\u6784\u4e2d\uff0c\u6ee1\u8db3\u89e3\u8026\u7684\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u4fe1\u3001\u9875\u9762\u8def\u7531\u3001\u6570\u636e\u4f20\u9012\u7b49\u3002\u5b83\u6240\u652f\u6301\u7684Router\u7c7b\u578b\u4ece\u4e0b\u9762\u8fd9\u4e2a\u7c7b\u5c31\u53ef\u4ee5\u770b\u51fa\uff1a</p> <pre><code>enum RouteType {\n    ACTIVITY(0, \"android.app.Activity\"),\n    SERVICE(1, \"android.app.Service\"),\n    PROVIDER(2, \"com.alibaba.android.arouter.facade.template.IProvider\"),\n    CONTENT_PROVIDER(-1, \"android.app.ContentProvider\"),\n    BOARDCAST(-1, \"\"),\n    METHOD(-1, \"\"),\n    FRAGMENT(-1, \"android.app.Fragment\"),\n    UNKNOWN(-1, \"Unknown route type\");\n}\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#_1","title":"\u9875\u9762\u8def\u7531","text":"<p>\u5927\u5bb6\u4f7f\u7528ARouter\uff0c\u6700\u5e38\u7528\u7684\u5c31\u662f\u9875\u9762\u8def\u7531\u7684\u529f\u80fd\u3002\u7814\u7a76\u9875\u9762\u5982\u4f55\u8def\u7531\u65f6\uff0c\u5148\u63d0\u51e0\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u66f4\u6709\u9488\u5bf9\u6027\u7684\u770b\u4ee3\u7801\uff1a</p> <ol> <li>\u542f\u52a8\u9875\u9762\u65f6\u7528\u7684\u662f\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u548c\u5bf9\u5e94\u9875\u9762\u6709\u4ec0\u4e48\u5173\u7cfb\uff1f</li> <li>\u9875\u9762\u7684\u8def\u7531\u8868\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f</li> <li>\u9875\u9762\u8def\u7531\u8868\u600e\u4e48\u521d\u59cb\u5316\u7684\uff1f</li> <li>\u5982\u4f55\u62e6\u622a\u8df3\u8f6c\u8fc7\u7a0b\uff0c\u5904\u7406\u767b\u9646\u3001\u57cb\u70b9\u7b49\u903b\u8f91\uff1f</li> <li>\u4e3a\u4ec0\u4e48\u52a0\u5165\u5206\u7ec4(group)\u7684\u6982\u5ff5\uff0c\u6709\u4ec0\u4e48\u597d\u5904\uff1f</li> <li>\u542f\u52a8Activity\u53ef\u4ee5\u901a\u8fc7startActivityForResult\u83b7\u53d6\u56de\u8c03\uff0c\u90a3\u542f\u52a8\u4e00\u4e2aView\u3001Fragment\u6216Service\uff0c\u5982\u4f55\u56de\u8c03\uff1f</li> </ol> <p>\u884d\u751f\u95ee\u9898\uff1a</p> <ol> <li>\u5982\u4f55\u8c03\u8bd5\u81ea\u5b9a\u4e49\u6ce8\u89e3\u5904\u7406\u5668\u91cc\u7684\u4ee3\u7801\uff1f</li> <li>\u5982\u4f55\u8de8\u8fdb\u7a0b\u542f\u52a8\u9875\u9762\uff1f</li> <li>\u5982\u4f55\u5728\u9879\u76ee\u5b9e\u6218\u4e2d\uff0c\u4f18\u96c5\u7684\u4f7f\u7528\u9875\u9762URL\uff0c\u4ee5\u53ca\u4f20\u53c2\uff1f</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#1","title":"1.\u542f\u52a8\u9875\u9762\u65f6\u7528\u7684\u662f\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u548c\u5bf9\u5e94\u9875\u9762\u662f\u4ec0\u4e48\u5173\u7cfb\uff1f","text":"<p>\u6bcf\u4e2a\u9875\u9762\u90fd\u7528\u81ea\u5b9a\u4e49\u6ce8\u89e3Route\u8fdb\u884c\u6ce8\u89e3\uff0c\u5176\u4e2d\u542f\u52a8\u9875\u9762\u7684\u5b57\u7b26\u4e32\u5c31\u662f\u6ce8\u89e3\u7684\u53c2\u6570path\u3002\u4e5f\u5c31\u662f\u5229\u7528\u6ce8\u89e3\u7ed9\u9875\u9762\u8d77\u4e86\u4e2a\u522b\u540d\u3002\u542f\u52a8\u9875\u9762\u65f6\uff0c\u56e0\u4e3a\u6a21\u5757\u95f4\u89e3\u8026\u7684\u5173\u7cfb\uff0c\u4e0d\u80fd\u76f4\u63a5\u663e\u793a\u542f\u52a8Activity\uff0c\u6240\u4ee5ARouter\u4f7f\u7528\u5b57\u7b26\u4e32\u522b\u540d\u542f\u52a8Activity\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#2","title":"2.\u9875\u9762\u7684\u8def\u7531\u8868\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f","text":"<p>\u9875\u9762\u8def\u7531\u8868\u6307\u4e00\u4e2aMap\uff0c\u8fd9\u4e2aMap\u5efa\u7acb\u4e86\u9875\u9762\u7684\u5b57\u7b26\u4e32\u522b\u540d\u548cActivity\u7684Class\u4fe1\u606f\u3002\u542f\u52a8\u9875\u9762\u65f6\uff0c\u6839\u636e\u4f20\u5165\u7684\u9875\u9762\u522b\u540d\uff0c\u4eceMap\u91cc\u62ff\u5230\u9875\u9762Class\uff0c\u518dstartActivity\u542f\u52a8\u76ee\u6807\u9875\u9762\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#3","title":"3.\u5982\u4f55\u521d\u59cb\u5316\u9875\u9762\u8def\u7531\u8868\uff1f","text":"<p>\u9875\u9762\u8def\u7531\u8868\u5728\u9879\u76ee\u4e2d\u5c31\u662f\u6307Warehouse#routes\u8fd9\u4e2aMap\u3002 ARouter\u548c\u5176\u4ed6\u9875\u9762\u8def\u7531\u5e93\uff08\u6bd4\u5982ActivityRouter\uff09\u4e00\u6837\u4f7f\u7528\u4e86APT\u7684\u6280\u672f\u3002\u7f16\u8bd1\u671f\uff0c\u6839\u636e\u9875\u9762\u7684\u6ce8\u89e3\u4fe1\u606f\uff0c\u5efa\u7acb\u9875\u9762URL\uff08\u5373Route path\u4e2d\u7684\u53c2\u6570\uff09\u548c\u9875\u9762\u7684Class\u4fe1\u606f\u7684\u6620\u5c04\u5173\u7cfb\u3002 \u76f8\u5173\u5b9e\u73b0\u90fd\u5728\u81ea\u5b9a\u4e49\u7684AbstractProcessor\u7c7b\u91cc\uff0c\u5373<code>RouteProcessor</code>\u3002 APT\u751f\u6210\u7684\u7c7b\uff0c\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684<code>ARouter$$Group$$test</code>\u3002</p> <pre><code>public class ARouter$$Group$$test implements IRouteGroup {\n  @Override\n  public void loadInto(Map&lt;String, RouteMeta&gt; atlas) {\n    atlas.put(\"/test/activity1\", RouteMeta.build(RouteType.ACTIVITY, Test1Activity.class));\n  }\n}\n\n</code></pre> <p>\u5373\u521d\u59cb\u5316\u4e86\u4e00\u4e2a\u6620\u5c04\u9875\u9762URL\u548c\u9875\u9762\u4fe1\u606f\u7684Map\u3002</p> <p>\u8def\u7531\u8868\u521d\u59cb\u5316\u5165\u53e3\uff1a</p> <pre><code>class LogisticsCenter {\n    public synchronized static void completion(Postcard postcard) {\n        // \u8c03\u7528\u7f16\u8bd1\u671f\u751f\u6210\u7684\u7c7b\uff0c\u521d\u59cb\u5316\u9875\u9762\u8def\u7531\u8868\n        iGroupInstance.loadInto(Warehouse.routes);\n    }\n}\n\nclass Warehouse {\n    // \u9875\u9762\u8def\u7531\u8868\n    // Key\u4e3aActivity\u7684\u6ce8\u89e3path\uff0c\u6bd4\u5982Test1Activity\u7684key\u5c31\u662f\"/test/activity1\"\n    // Value\u662f\u5b58\u50a8Activity\u4fe1\u606f\u7684Module\uff0c\u6bd4\u5982Test1Activity.class\n    static Map&lt;String, RouteMeta&gt; routes = new HashMap&lt;&gt;();\n}\n</code></pre> <p>\u8def\u7531\u5176\u4ed6\u9875\u9762\u65f6\uff0c\u90fd\u4f1a\u6267\u884cARouter#navigation()\uff0c\u770b\u4e0b\u5b9e\u73b0\u3002</p> <p>\u9875\u9762\u8df3\u8f6c\uff1a</p> <pre><code>class _ARouter {\n\nprivate Object _navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback) {\n    ...\n\n    switch (postcard.getType()) {\n        case ACTIVITY:\n            // Build intent\n            final Intent intent = new Intent(currentContext, postcard.getDestination());\n            intent.putExtras(postcard.getExtras());\n\n            // Set flags.\n            ...\n\n            // Set Actions\n            ...\n\n            // Navigation in main looper.\n            new Handler(Looper.getMainLooper()).post(new Runnable() {\n                @Override\n                public void run() {\n                    if (requestCode &gt; 0) {  // Need start for result\n                        ActivityCompat.startActivityForResult((Activity) currentContext, intent, requestCode, postcard.getOptionsBundle());\n                    } else {\n                        ActivityCompat.startActivity(currentContext, intent, postcard.getOptionsBundle());\n                    }\n\n                    ...\n\n                    if (null != callback) { // Navigation over.\n                        callback.onArrival(postcard);\n                    }\n                }\n            });\n            break;\n        case PROVIDER:\n            return postcard.getProvider();\n        case BOARDCAST:\n        case CONTENT_PROVIDER:\n        case FRAGMENT:\n            Class fragmentMeta = postcard.getDestination();\n            try {\n                Object instance = fragmentMeta.getConstructor().newInstance();\n                if (instance instanceof Fragment) {\n                    ((Fragment) instance).setArguments(postcard.getExtras());\n                } else if (instance instanceof android.support.v4.app.Fragment) {\n                    ((android.support.v4.app.Fragment) instance).setArguments(postcard.getExtras());\n                }\n\n                return instance;\n            } catch (Exception ex) {\n                ...\n            }\n        case METHOD:\n        case SERVICE:\n        default:\n            return null;\n    }\n\n    return null;\n}\n\n}\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#4","title":"4. \u5982\u4f55\u4f18\u5316\u6570\u636e\u4f20\u9012\uff1f","text":"<p>\u8fd9\u4e2a\u95ee\u9898\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u5b9e\u9645\u9879\u76ee\u4e2d\u4f7f\u7528ARouter\u505a\u9875\u9762\u8def\u7531\uff0c\u6bd4\u5982demo\u4e2d\u542f\u52a8kotlin\u6d4b\u8bd5\u9875\u9762\uff1a</p> <pre><code>ARouter.getInstance()\n        .build(\"/kotlin/test\")\n        .withString(\"name\", \"\u8001\u738b\")\n        .withInt(\"age\", 23)\n        .navigation();\n</code></pre> <p>\u8fd9\u79cd\u505a\u6cd5\u4f1a\u6709\u4e24\u4e2a\u95ee\u9898\uff1a</p> <p>1\uff09\u4f1a\u51fa\u73b0\u8f83\u591ahardcode\uff0c\u5305\u62ec\u9875\u9762path\u53ca\u53c2\u6570\uff0c\u5bb9\u6613\u72af\u62fc\u5199\u9519\u8bef 2\uff09\u542f\u52a8\u4e00\u4e2a\u9875\u9762\u65f6\uff0c\u5fc5\u987b\u9884\u5148\u4e86\u89e3\u76ee\u6807\u9875\u9762\u7684path\uff0c\u53ca\u652f\u6301\u54ea\u4e9b\u53c2\u6570\uff0c\u7136\u540e\u518d\u53bb\u542f\u52a8</p> <p>\u5f53\u7136\uff0c\u6709\u540c\u5b66\u4f1a\u8bf4\uff0cpath\u53ca\u53c2\u6570\u8fd9\u4e9b\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u7528\u5e38\u91cf\u4e8b\u5148\u58f0\u660e\u5728\u57fa\u7840\u7ec4\u4ef6\u5c42\uff0c\u5373\u5404\u4e2a\u4e1a\u52a1Module\u90fd\u4f9d\u8d56\u7684\u516c\u5171\u5c42\u3002\u8fd9\u79cd\u505a\u6cd5\u867d\u7136\u53ef\u884c\uff0c\u4f46\u662f\u4ecd\u907f\u514d\u4e0d\u4e86\u5927\u91cf\u7684\u5e38\u91cf\u51fa\u73b0\u3002\u540c\u6837\uff0c\u95ee\u98982\u4e5f\u5f97\u4e0d\u5230\u89e3\u51b3\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u9047\u5230\u4e0a\u8ff0\u95ee\u9898\uff0c\u4e8e\u662f\u5bf9ARouter\u505a\u4e86\u4fee\u6539\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387\u540c\u65f6\u8fd8\u80fd\u907f\u514d\u72af\u4f4e\u7ea7\u9519\u8bef\u3002</p> <p>\u6539\u52a8\u540e\uff0c\u5982\u679c\u542f\u52a8\u4e00\u4e2a\u76ee\u6807\u9875\u9762\u65f6\uff0c\u5927\u81f4\u7684\u505a\u6cd5\u662f\u4e0b\u9762\u8fd9\u6837\u7684\uff1a</p> <pre><code>ARouter.getInstance()\n        .build(new KotlinPage(\"\u8001\u738b\", 23))\n        .navigation();\n</code></pre> <p>\u8981\u662f\u4f7f\u7528Kotlin\uff0c\u7ed3\u5408\u65b9\u6cd5\u53c2\u6570\u7684\u53ef\u9009\u7279\u6027\uff0c\u53caIDE\u7684\u63d0\u793a\uff0c\u662f\u4e0d\u662f\u5f00\u53d1\u6548\u7387\u66f4\u9ad8\uff0c\u7b80\u76f4\u95ed\u7740\u773c\u775b\u5c31\u53ef\u4ee5\u542f\u52a8\u76ee\u6807\u9875\u9762\u3002</p> <p>\u8fd9\u79cd\u6539\u8fdb\u7684\u597d\u5904\u6709\u4e24\u70b9\uff1a 1.\u4e0d\u9700\u8981\u5728\u516c\u5171\u5c42\u58f0\u660epath\u548cparam\u8fd9\u4e9b\u5e38\u91cf\uff0c\u53ea\u9700\u8981\u58f0\u660e\u4e00\u4e2a\u6570\u636e\u7c7b\u5373\u53ef 2.\u542f\u52a8\u76ee\u6807\u9875\u9762\u65f6\uff0c\u4e0d\u9700\u8981\u8fc7\u591a\u5173\u5fc3\u76ee\u6807\u9875\u9762\u7684\u5b9e\u73b0\uff0c\u53ea\u9700\u8981\u548c\u5bf9\u5e94\u6570\u636e\u7c7b\u6253\u4ea4\u9053\u5373\u53ef\uff0c\u505a\u5230\u76ee\u6807\u9875\u9762\u4e00\u5b9a\u7a0b\u5ea6\u5f00\u95ed\u539f\u5219\u4e0a\u7684\u4fdd\u62a4\u3002</p> <p>\u5b9e\u73b0\u65b9\u5f0f\u7b80\u5355\u4ecb\u7ecd\u4e0b\uff1a \u3002\u3002\u3002</p> <p>\u5177\u4f53\u4ee3\u7801\u53ef\u4ee5\u53c2\u8003\uff1a \u3002\u3002\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#_2","title":"\u6a21\u5757\u95f4\u901a\u4fe1","text":"<p>\u540c\u6837\uff0c\u7814\u7a76\u4ee3\u7801\u4e4b\u524d\u63d0\u51e0\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u600e\u4e48\u505a\u5230\u8de8\u6a21\u5757API\u8c03\u7528\uff1f</li> <li>\u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53cd\u8f6c\u6765\u505a\u7ec4\u4ef6\u89e3\u8026\uff1f</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#q1api","title":"Q1.\u600e\u4e48\u505a\u5230\u8de8\u6a21\u5757API\u8c03\u7528\uff1f","text":"<p>\u6a21\u5757\u5bf9\u5916\u63d0\u4f9b\u652f\u6491\u7684\u63a5\u53e3\u7c7b\uff0c\u9700\u8981\u5b9e\u73b0IProvider\u63a5\u53e3\uff08\u6bd4\u5982demo\u4e2d\u7684HelloService\uff09\u3002\u63a5\u53e3\u5b9e\u73b0\u7c7b\uff08HelloServiceImpl\uff09\u4f7f\u7528Route\u6ce8\u89e3\u3002 \u5176\u5b9e\u539f\u7406\u548c\u9875\u9762\u8def\u7531\u4e00\u6837\uff0c\u5c31\u662f\u5728\u7f16\u8bd1\u65f6\uff0c\u521b\u5efa\u6a21\u5757API\u63a5\u53e3\u7684\u8def\u7531\u8868\u3002\u4f7f\u7528\u65f6\uff0c\u901a\u8fc7URL\uff0c\u5728\u63a5\u53e3\u8def\u7531\u8868\u4e2d\u6620\u5c04\u5230\u6a21\u5757\u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0c\u8fdb\u884c\u8de8\u6a21\u5757API\u8c03\u7528\u3002</p> <p>\u4ee5demo\u4e2d\u7684HelloService\u4e3a\u4f8b\uff0c</p> <pre><code>\u63a5\u53e3\u7c7b\uff1a\npublic interface HelloService extends IProvider {\n    void sayHello(String name);\n}\n\n\u5b9e\u73b0\u7c7b\uff0c\u4f7f\u7528Route\u6ce8\u89e3\uff0c\u65b9\u4fbfAPT\u521b\u5efa\u63a5\u53e3\u8def\u7531\u8868\uff1a\n@Route(path = \"/service/hello\")\npublic class HelloServiceImpl implements HelloService {\n    Context mContext;\n\n    @Override\n    public void sayHello(String name) {\n        ...\n    }\n\n    /**\n     * Do your init work in this method, it well be call when processor has been load.\n     *\n     * @param context ctx\n     */\n    @Override\n    public void init(Context context) {\n        mContext = context;\n        ...\n    }\n}\n\nAPT\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u521d\u59cb\u5316\u63a5\u53e3\u8def\u7531\u8868\uff1a\npublic class ARouter$$Group$$service implements IRouteGroup {\n  @Override\n  public void loadInto(Map&lt;String, RouteMeta&gt; atlas) {\n    atlas.put(\"/service/hello\", RouteMeta.build(RouteType.PROVIDER, HelloServiceImpl.class));\n  }\n}\n\n\n\u5176\u4ed6\u7ec4\u4ef6\u901a\u8fc7\u63a5\u53e3\u8c03\u7528Hello\u7ec4\u4ef6\uff1a\n\nHelloService helloService = (HelloService) ARouter.getInstance().build(\"/service/hello\").navigation();\nhelloService.sayHello(\"mike\");\n\n</code></pre> <p>\u6a21\u5757\u63a5\u53e3\u7c7b\u53ef\u4ee5\u6c89\u6dc0\u5230\u516c\u5171\u5c42\uff0c\u5b9e\u73b0\u7c7b\u8fd8\u5728\u81ea\u5df1\u7684Module\u4e2d\u3002\u8fd9\u6837\u53ef\u4ee5\u505a\u5230\u63a5\u53e3\u548c\u5b9e\u73b0\u5206\u79bb\uff0c\u53ea\u9700\u901a\u8fc7\u63a5\u53e3\u63d0\u4f9b\u670d\u52a1\uff0c\u505a\u5230\u6a21\u5757\u95f4\u89e3\u8026\u3002</p> <p>\u4e0d\u8fc7\u8fd9\u79cd\u505a\u6cd5\uff0c\u63a5\u53e3\u548c\u7ec4\u4ef6\u95f4\u901a\u4fe1\u7684\u6570\u636e\u7ed3\u6784\u90fd\u8981\u4e0b\u6c89\u5230\u516c\u5171\u5c42\uff0c\u5bfc\u81f4\u516c\u5171\u5c42\u4e2d\u5fc3\u5316\u95ee\u9898\u8d8a\u6765\u8d8a\u51f8\u663e\uff0c\u6709\u6ca1\u6709\u4e00\u79cd\u53bb\u4e2d\u5fc3\u5316\u7684\u901a\u4fe1\u65b9\u5f0f\u5462\uff1f</p> <p>Q2.\u5982\u4f55\u901a\u8fc7\u63a7\u5236\u53cd\u8f6c\u6765\u505a\u7ec4\u4ef6\u89e3\u8026\uff1f \u7b54\u6848\u5728\u4e0b\u9762\u4e00\u8282\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#_3","title":"\u5982\u4f55\u5b9e\u73b0\u4f9d\u8d56\u6ce8\u5165","text":"<p>\u5728\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\u4e4b\u524d\uff0c\u5bf9\u4f9d\u8d56\u6ce8\u5165\u548c\u63a7\u5236\u53cd\u8f6c\u4e0d\u719f\u6089\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u770b\u4e0b\u9762\u8fd9\u8fb9\u6587\u7ae0\u3002 \u4f9d\u8d56\u6ce8\u5165\u548c\u63a7\u5236\u53cd\u8f6c</p> <p>wiki\u4e2d\u4e5f\u5bf9\u5982\u4f55\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u8fdb\u884c\u89e3\u8026\u7ed9\u4e86\u4ee3\u7801\u5b9e\u4f8b\uff1a</p> <pre><code>public class Test {\n    @Autowired\n    HelloService helloService;\n\n    @Autowired(name = \"/service/hello\")\n    HelloService helloService2;\n\n    HelloService helloService3;\n\n    HelloService helloService4;\n\n    public Test() {\n        ARouter.getInstance().inject(this);\n    }\n\n    public void testService() {\n     // 1. (\u63a8\u8350)\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165\u7684\u65b9\u5f0f\u53d1\u73b0\u670d\u52a1,\u901a\u8fc7\u6ce8\u89e3\u6807\u6ce8\u5b57\u6bb5,\u5373\u53ef\u4f7f\u7528\uff0c\u65e0\u9700\u4e3b\u52a8\u83b7\u53d6\n     // Autowired\u6ce8\u89e3\u4e2d\u6807\u6ce8name\u4e4b\u540e\uff0c\u5c06\u4f1a\u4f7f\u7528byName\u7684\u65b9\u5f0f\u6ce8\u5165\u5bf9\u5e94\u7684\u5b57\u6bb5\uff0c\u4e0d\u8bbe\u7f6ename\u5c5e\u6027\uff0c\u4f1a\u9ed8\u8ba4\u4f7f\u7528byType\u7684\u65b9\u5f0f\u53d1\u73b0\u670d\u52a1(\u5f53\u540c\u4e00\u63a5\u53e3\u6709\u591a\u4e2a\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u4f7f\u7528byName\u7684\u65b9\u5f0f\u53d1\u73b0\u670d\u52a1)\n    helloService.sayHello(\"Vergil\");\n    helloService2.sayHello(\"Vergil\");\n\n    // 2. \u4f7f\u7528\u4f9d\u8d56\u67e5\u627e\u7684\u65b9\u5f0f\u53d1\u73b0\u670d\u52a1\uff0c\u4e3b\u52a8\u53bb\u53d1\u73b0\u670d\u52a1\u5e76\u4f7f\u7528\uff0c\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f\u5206\u522b\u662fbyName\u548cbyType\n    helloService3 = ARouter.getInstance().navigation(HelloService.class);\n    helloService4 = (HelloService) ARouter.getInstance().build(\"/service/hello\").navigation();\n    helloService3.sayHello(\"Vergil\");\n    helloService4.sayHello(\"Vergil\");\n    }\n}\n</code></pre> <p>\u5173\u952e\u7684\u4e0b\u9762\u8fd9\u884c\u4ee3\u7801\uff1a</p> <pre><code>ARouter.getInstance().inject(this);\n</code></pre> <p>\u8fd9\u884c\u4ee3\u7801\u7684\u5de5\u4f5c\u5185\u5bb9\u5c31\u662f\u5728\u628aTest\u7684\u51e0\u4e2a\u4f9d\u8d56\uff08helloService ~ helloService4\uff09\u5728\u4f9d\u8d56\u6ce8\u5165\u5668\u4e2d\u521d\u59cb\u5316\uff0c\u7136\u540e\u6ce8\u5165\u7ed9Test\uff0c\u4ece\u800c\u5b9e\u73b0\u89e3\u8026\u3002\u4e14Test\u5bf9HelloService\u7684\u4f9d\u8d56\u4e5f\u90fd\u662f\u57fa\u4e8e\u63a5\u53e3\uff0c\u66f4\u7b26\u5408\u4f9d\u8d56\u53cd\u8f6c\u539f\u5219\u3002</p> <p>\u53ef\u4ee5\u7ed3\u5408\u300a\u4f9d\u8d56\u6ce8\u5165\u548c\u63a7\u5236\u53cd\u8f6c\u300b\u548c\u4e0a\u9762\u7684\u5b9e\u4f8b\u4ee3\u7801\u4f53\u4f1a\u4e0b\u4f9d\u8d56\u6ce8\u5165\u548c\u4f9d\u8d56\u67e5\u627e\u7684\u533a\u522b\u3002\u5373\u4f9d\u8d56\u6ce8\u5165\u6bd4\u8f83\u88ab\u52a8\uff0c\u8ddf\u4f9d\u8d56\u6ce8\u5165\u5668\u6253\u58f0\u62db\u547c\u540e\uff0c\u6240\u6709\u5de5\u4f5c\u90fd\u4ea4\u7ed9\u6ce8\u5165\u5668\u4e86\u3002\u4f9d\u8d56\u67e5\u627e\u66f4\u52a0\u4e3b\u52a8\uff0c\u5728\u9700\u8981\u7684\u65f6\u5019\u901a\u8fc7\u8c03\u7528\u6846\u67b6\u63d0\u4f9b\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u5bf9\u8c61\u3002</p> <p>\u770b\u4e0binject()\u5de5\u4f5c\u6d41\u7a0b\uff1a</p> <pre><code>class Test1Activity {\n    @Autowired\n    String url;\n\n    @Autowired\n    HelloService helloService;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        ...\n        // \u5f00\u59cb\u6ce8\u5165\n        ARouter.getInstance().inject(this);\n\n        // \u4f7f\u7528\u670d\u52a1\n        helloService.sayHello(\"Hello moto.\");\n        ...\n    }\n}\n</code></pre> <pre><code>class _ARouter {\n    // \u5f00\u59cb\u6ce8\u5165\n    static void inject(Object thiz) {\n        // \u83b7\u53d6AutowiredService\u7684\u5b9e\u73b0\uff0c\u8fc7\u7a0b\u548c\u9875\u9762\u8def\u7531\u8868\u4e00\u6837\uff0c\u7528APT\u505a\u89e3\u8026\u7b56\u7565\n        AutowiredService autowiredService = ((AutowiredService) ARouter.getInstance().build(\"/arouter/service/autowired\").navigation());\n        if (null != autowiredService) {\n            // \u5f00\u59cb\u88c5\u914d\n            autowiredService.autowire(thiz);\n        }\n    }\n}\n\n@Route(path = \"/arouter/service/autowired\")\npublic class AutowiredServiceImpl implements AutowiredService {\n    @Override\n    public void autowire(Object instance) {\n        ...\n        ISyringe autowiredHelper = classCache.get(className);\n        // \u8fd9\u91cc\u7684autowiredHelper\u5c31\u662f\u4e0b\u9762\u7684Test1Activity$$ARouter$$Autowired\n        autowiredHelper.inject(instance);\n        ...\n    }\n}\n</code></pre> <p>APT\u521b\u5efa\u7684\u6587\u4ef6\uff1a</p> <pre><code>/**\n * DO NOT EDIT THIS FILE!!! IT WAS GENERATED BY AROUTER. */\npublic class Test1Activity$$ARouter$$Autowired implements ISyringe {\n  private SerializationService serializationService;\n\n  @Override\n  public void inject(Object target) {\n        serializationService = ARouter.getInstance().navigation(SerializationService.class);\n        Test1Activity substitute = (Test1Activity)target;\n        // field \u8d4b\u503c\n        substitute.url = substitute.getIntent().getStringExtra(\"url\");\n        // \u4f9d\u8d56\u6ce8\u5165\n        substitute.helloService = ARouter.getInstance().navigation(HelloService.class);\n    }\n}\n</code></pre> <p>\u6240\u4ee5\uff0c\u6838\u5fc3\u70b9\u662f\u5728\u4e8e<code>Test1Activity$$ARouter$$Autowired</code>\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48<code>Test1Activity</code>\u4e2d\u7684helloService\u5e76\u6ca1\u6709\u770b\u5230\u521d\u59cb\u5316\u5c31\u80fd\u76f4\u63a5\u4f7f\u7528\u3002\u806a\u660e\u7684\u4f60\u662f\u4e0d\u662f\u53d1\u73b0\u8fd9\u5757\u505a\u6cd5\u6709\u70b9butterknife\u7684\u5473\u9053\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#instantrunmultidex","title":"\u652f\u6301InstantRun\u548cMultiDex","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#_4","title":"\u652f\u6301\u62e6\u622a\u5668\uff0c\u9762\u5411\u5207\u9762\u7f16\u7a0b","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ARouter/#gradle","title":"Gradle\u63d2\u4ef6\u5b9e\u73b0\u8def\u7531\u8868\u7684\u81ea\u52a8\u52a0\u8f7d","text":"<p>\u521d\u59cb\u5316ARouter\u65f6\uff0c\u4f1a\u6267\u884c\u4e0b\u9762\u7684\u65b9\u6cd5\u3002</p> <pre><code>class LogisticsCenter {\n    private static void loadRouterMap() {\n        registerByPlugin = false;\n        //auto generate register code by gradle plugin: arouter-auto-register\n        // looks like below:\n        // registerRouteRoot(new ARouter..Root..modulejava());\n        // registerRouteRoot(new ARouter..Root..modulekotlin());\n    }\n}\n</code></pre> <p>\u5b9e\u9645\u9879\u76ee\u4e2d\u6211\u4eec\u53ef\u4ee5\u5199gradle\u63d2\u4ef6\u505a\u5f88\u591a\u8f85\u52a9\u5de5\u4f5c\uff0c\u6bd4\u5982ARouter\u7528\u6765\u751f\u4ea7\u4ee3\u7801\u521d\u59cb\u5316\u8def\u7531\u8868\uff0c\u4e5f\u53ef\u4ee5\u4ee3\u7801\u68c0\u67e5\u3001\u4ee3\u7801\u4fee\u6539\u3001\u4ee5\u53ca\u4e0a\u4f20maven\u7b49\u5404\u79cdtask\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ActivityRouter/","title":"ActivityRouter","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ActivityRouter/#1-router","title":"1. @Router\u7684\u4f5c\u7528","text":"<p>\u7f16\u8bd1\u65f6\uff0c\u6ce8\u89e3\u5904\u7406\u5668\u4f1a\u626b\u63cf\u6240\u6709Java\u6e90\u6587\u4ef6\u3002\u6700\u7ec8\u4f1a\u6267\u884c\u81ea\u5b9a\u4e49\u6ce8\u89e3\u5904\u7406\u5668<code>RouterProcessor</code>\u4e2d\u7684\u51e0\u4e2a\u5173\u952e\u65b9\u6cd5</p> <pre><code>@AutoService(Processor.class)\npublic class RouterProcessor extends AbstractProcessor {\n\n    @Override\n    public synchronized void init(ProcessingEnvironment processingEnv) {}\n\n    @Override\n    public Set&lt;String&gt; getSupportedAnnotationTypes() {}\n\n    @Override\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {}\n\n}\n\n</code></pre> <p>\u5728process()\u65b9\u6cd5\u4e2d\uff0c\u901a\u8fc7Element\u3001RoundEnvironment\u7b49\u83b7\u53d6\u5230\u88ab\u6ce8\u89e3\u7684\u7c7b\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u7c7b\u540d\u3001\u6ce8\u89e3\u5185\u5bb9\u3002\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\uff0c\u501f\u52a9JavaPoet\u751f\u6210Java\u6587\u4ef6\uff0c\u6b64Java\u6587\u4ef6\u5c31\u662f\u8fde\u63a5\u6ce8\u89e3\u548c\u4f7f\u7528\u65b9\u7684\u7ebd\u5e26\u3002</p> <p>PS: \u7f16\u8bd1\u65f6\u6ce8\u89e3\u5904\u7406\u5668\u4e0d\u719f\u6089\u7684\uff0c\u53ef\u4ee5\u53c2\u8003Java\u6ce8\u89e3\u5904\u7406\u5668</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ActivityRouter/#2-apt","title":"2. APT\u5de5\u4f5c\u6d41\u7a0b","text":"<p>\u7f16\u8bd1\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8c03\u7528RouterProcessor#process()\uff0c\u5728\u6b64\u65b9\u6cd5\u4e2d\u505a\u4e0b\u9762\u76f8\u5173\u5904\u7406\uff1a</p> <ol> <li>\u83b7\u53d6\u6240\u6709\u88abRouter\u6ce8\u89e3\u7684Element\uff0cElement\u662f\u7a0b\u5e8f\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u662f\u5305\u3001\u7c7b\u3001\u65b9\u6cd5</li> <li>\u521b\u5efamap\u65b9\u6cd5</li> <li>\u904d\u5386Element\uff0c\u83b7\u53d6@Routers.value\u548c\u88ab\u6ce8\u89e3\u7684Activity(\u6216\u8005\u662f\u65b9\u6cd5)</li> <li>\u5c06Routers\u6ce8\u89e3\u4e2d\u7684value(\u4ee3\u7801\u4e2d\u7684format)\u548c\u9875\u9762(className)\u7ed1\u5b9a\uff0c\u653e\u5230\u6570\u636e\u7c7bMapping\u4e2d</li> <li>\u7a0b\u5e8f\u8fd0\u884c\u5c31\u4f1a\u521d\u59cb\u5316Router\uff0c\u6267\u884cRouterInit.init()\uff0c\u8fdb\u800c\u6267\u884cRouterMapping_app.map()(\u8fd9\u4e00\u6b65\u662f\u6ce8\u89e3\u5904\u7406\u5668\u6dfb\u52a0\u7684\u521d\u59cb\u5316\u4ee3\u7801)\uff0c\u5373\u5904\u7406\u5668\u751f\u6210\u7684\u4ee3\u7801\u6587\u4ef6\u3002\u6b64\u523b\uff0c\u6240\u6709\u6d41\u7a0b\u4e32\u4e86\u8d77\u6765\u3002</li> </ol> <pre><code>RouterProcessor.java\n\nprivate boolean handleRouter(String genClassName, RoundEnvironment roundEnv) {\n\n    // \u83b7\u53d6\u88abRouter\u6ce8\u89e3\u7684Element\n    Set&lt;? extends Element&gt; elements = roundEnv.getElementsAnnotatedWith(Router.class);\n\n    // \u521b\u5efamap\u65b9\u6cd5\n        MethodSpec.Builder mapMethod = MethodSpec.methodBuilder(\"map\")\n                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n                .addStatement(\"java.util.Map&lt;String,String&gt; transfer = null\")\n                .addStatement(\"com.github.mzule.activityrouter.router.ExtraTypes extraTypes\")\n                .addCode(\"\\n\");\n\n\n    for (String format : router.value()) {\n\n        // \u83b7\u53d6\u88ab\u6ce8\u89e3\u7684\u7c7b\u540d\u6216\u65b9\u6cd5\u540d\n        ClassName className;\n        Name methodName = null;\n        if (element.getKind() == ElementKind.CLASS) {\n            className = ClassName.get((TypeElement) element);\n        } else if (element.getKind() == ElementKind.METHOD) {\n            className = ClassName.get((TypeElement) element.getEnclosingElement());\n            methodName = element.getSimpleName();\n        } else {\n            throw new IllegalArgumentException(\"unknow type\");\n        }\n\n        ... // \u5b89\u5168\u68c0\u67e5\n\n        // \u5173\u952e!!! \u5c06@Routers\u6ce8\u89e3\u4e2d\u7684value(\u5373\u4ee3\u7801\u4e2d\u7684format)\u548c\u9875\u9762(className)\u7ed1\u5b9a\n        if (element.getKind() == ElementKind.CLASS) {\n     mapMethod.addStatement(\"com.github.mzule.activityrouter.router.Routers.map($S, $T.class, null, extraTypes)\", format, className);\n        } else {\n            mapMethod.addStatement(\"com.github.mzule.activityrouter.router.Routers.map($S, null, \" +\n                    \"new MethodInvoker() {\\n\" +\n                    \"   public void invoke(android.content.Context context, android.os.Bundle bundle, int requestCode) {\\n\" +\n                    \"       $T.$N(context, bundle, requestCode);\\n\" +\n                    \"   }\\n\" +\n                    \"}, \" +\n                    \"extraTypes)\", format, className, methodName);\n        }\n    }\n\n}\n</code></pre> <p>\u6ce8\u89e3\u5904\u7406\u5668\u751f\u6210\u7684\u6587\u4ef6\uff1a</p> <pre><code>RouterMapping_app.java\n\npublic final class RouterMapping_app {\n  public static final void map() {\n    java.util.Map&lt;String,String&gt; transfer = null;\n    com.github.mzule.activityrouter.router.ExtraTypes extraTypes;\n\n    transfer = null;\n    extraTypes = new com.github.mzule.activityrouter.router.ExtraTypes();\n    extraTypes.setTransfer(transfer);\n\n    // \u6700\u91cd\u8981\uff01\uff01\uff01\u6ce8\u89e3\u548c\u9875\u9762\u7684\u7ed1\u5b9a\n    com.github.mzule.activityrouter.router.Routers.map(\"home/:homeName\", HomeActivity.class, null, extraTypes);\n\n  }\n}\n</code></pre> <p>\u5176\u4e2d\uff0cRouters.map()\u5c31\u662f\u5c06@Routers\u6ce8\u89e3\u7684value\u3001param\u548c\u5bf9\u5e94\u7684Activity\u653e\u5230mappings\u4e2d\u3002\u5f53\u4f7f\u7528Routers.open(context, url)\u542f\u52a8\u4e00\u4e2aActivity\u65f6\uff0c\u4f1a\u904d\u5386mappings\uff0c\u627e\u5230\u548curl\u5bf9\u5e94\u7684Mapping\uff0c\u62ff\u5230Mapping\u4e2d\u4e8b\u5148\u5b58\u50a8\u7684\u76ee\u6807Activity\uff0c\u518d\u4f7f\u7528Intent\u542f\u52a8Activity\u3002</p> <pre><code>Routers.java\n\nstatic void map(String format, Class&lt;? extends Activity&gt; activity, MethodInvoker method, ExtraTypes extraTypes) {\n        mappings.add(new Mapping(format, activity, method, extraTypes));\n    }\n\nprivate static boolean doOpen(Context context, Uri uri, Bundle extras, int requestCode) {\n        initIfNeed();\n        Path path = Path.create(uri);\n\n        for (Mapping mapping : mappings) {\n\n            //\u627e\u5230\u548c\u76ee\u6807url\u5339\u914d\u7684Mapping\n            if (mapping.match(path)) {\n\n                // \u89e3\u6790Url\u4e2d\u7684\u53c2\u6570\u653e\u5230Bundle\u4e2d\n                Bundle bundle = mapping.parseExtras(uri);\n                appendExtras(uri, extras, bundle);\n\n                // \u5982\u679c\u88ab\u6ce8\u89e3\u7684\u662f\u65b9\u6cd5\uff0c\u76f4\u63a5\u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u65b9\u6cd5\n                if (mapping.getActivity() == null) {\n                    mapping.getMethod().invoke(context, bundle, requestCode);\n                    return true;\n                }\n\n                // \u5982\u679c\u88ab\u6ce8\u89e3\u7684\u662fActivity\uff0c\u5219\u901a\u8fc7Intent\u542f\u52a8\n                Intent intent = new Intent(context, mapping.getActivity());\n                intent.putExtras(bundle);\n                if (!(context instanceof Activity)) {\n                    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n                }\n\n                ...\n\n                context.startActivity(intent);\n\n                return true;\n            }\n        }\n        return false;\n    }\n</code></pre> <pre><code>Mapping.java\n\npublic class Mapping {\n\n    private final String format;\n    private final Class&lt;? extends Activity&gt; activity;\n    private final MethodInvoker method;\n    private final ExtraTypes extraTypes;\n    private Path formatPath;\n\n    public Mapping(String format, Class&lt;? extends Activity&gt; activity, MethodInvoker method, ExtraTypes extraTypes) {\n        if (format == null) {\n            throw new NullPointerException(\"format can not be null\");\n        }\n        this.format = format;\n        this.activity = activity;\n        this.method = method;\n        this.extraTypes = extraTypes;\n\n        if (format.toLowerCase().startsWith(\"http://\") || format.toLowerCase().startsWith(\"https://\")) {\n            this.formatPath = Path.create(Uri.parse(format));\n        } else {\n            this.formatPath = Path.create(Uri.parse(\"helper://\".concat(format)));\n        }\n    }\n}\n</code></pre> <p>\u5e94\u7528\u793a\u4f8b\uff1a</p> <pre><code>Routers.open(LaunchActivity.this, \"router://home/somebody?id=123\")\n\n\u53ef\u6253\u5f00\u5982\u4e0b\u9875\u9762\n\n@Router(value = \"home/:homeName\", stringParams = \"source\")\npublic class HomeActivity extends DumpExtrasActivity {\n\n}\n\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/ActivityRouter/#3-routersopenurl","title":"\u95ee\u9898 3. \u6709\u6ca1\u6709\u597d\u529e\u6cd5\u53ef\u4ee5\u53d6\u4ee3Routers.open()\u4f7f\u7528\u5b57\u6bb5\u4e32\u62fc\u63a5Url\u7684\u65b9\u5f0f","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/BlockCanary/","title":"BlockCanary","text":"<pre><code>   public static void loop() {\n        final Looper me = myLooper();\n        if (me == null) {\n            throw new RuntimeException(\"No Looper; Looper.prepare() wasn't called on this thread.\");\n        }\n        final MessageQueue queue = me.mQueue;\n\n        // Make sure the identity of this thread is that of the local process,\n        // and keep track of what that identity token actually is.\n        Binder.clearCallingIdentity();\n        final long ident = Binder.clearCallingIdentity();\n\n        for (;;) {\n            Message msg = queue.next(); // might block\n            if (msg == null) {\n                // No message indicates that the message queue is quitting.\n                return;\n            }\n\n            // This must be in a local variable, in case a UI event sets the logger\n            final Printer logging = me.mLogging;\n            if (logging != null) {\n                logging.println(\"&gt;&gt;&gt;&gt;&gt; Dispatching to \" + msg.target + \" \" +\n                        msg.callback + \": \" + msg.what);\n            }\n\n            final long slowDispatchThresholdMs = me.mSlowDispatchThresholdMs;\n\n            final long traceTag = me.mTraceTag;\n            if (traceTag != 0 &amp;&amp; Trace.isTagEnabled(traceTag)) {\n                Trace.traceBegin(traceTag, msg.target.getTraceName(msg));\n            }\n            final long start = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis();\n            final long end;\n            try {\n                msg.target.dispatchMessage(msg);\n                end = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis();\n            } finally {\n                if (traceTag != 0) {\n                    Trace.traceEnd(traceTag);\n                }\n            }\n            if (slowDispatchThresholdMs &gt; 0) {\n                final long time = end - start;\n                if (time &gt; slowDispatchThresholdMs) {\n                    Slog.w(TAG, \"Dispatch took \" + time + \"ms on \"\n                            + Thread.currentThread().getName() + \", h=\" +\n                            msg.target + \" cb=\" + msg.callback + \" msg=\" + msg.what);\n                }\n            }\n\n            if (logging != null) {\n                logging.println(\"&lt;&lt;&lt;&lt;&lt; Finished to \" + msg.target + \" \" + msg.callback);\n            }\n\n            // Make sure that during the course of dispatching the\n            // identity of the thread wasn't corrupted.\n            final long newIdent = Binder.clearCallingIdentity();\n            if (ident != newIdent) {\n                Log.wtf(TAG, \"Thread identity changed from 0x\"\n                        + Long.toHexString(ident) + \" to 0x\"\n                        + Long.toHexString(newIdent) + \" while dispatching to \"\n                        + msg.target.getClass().getName() + \" \"\n                        + msg.callback + \" what=\" + msg.what);\n            }\n\n            msg.recycleUnchecked();\n        }\n    }\n\n</code></pre> <p>\u539f\u7406:\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u6253\u5370\u8fd9\u4e24\u5929 log \u7684\u65f6\u95f4\u5dee\uff0c\u5c31\u80fd\u5f97\u5230 dispatchMessage \u7684\u8017\u65f6\uff0candroid \u63d0\u4f9b\u4e86 Looper.getMainLooper().setMessageLogging(Printer printer)\u6765\u8bbe\u7f6e\u8fd9\u4e2a logging \u5bf9 \u8c61\uff0c\u6240\u4ee5\u53ea\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a Printer\uff0c\u7136\u540e\u91cd\u5199 println(String x)\u65b9\u6cd5\u5373\u53ef\u5b9e\u73b0\u8017\u65f6\u7edf\u8ba1\u4e86\u3002 \u901a\u8fc7\u5728 DispatchMessage \u7684\u65b9\u6cd5\u7684\u6267\u884c\u65f6\u95f4\uff0c\u6765\u5224\u65ad\u5361\u987f\uff0c\u7ba1\u662f\u54ea\u79cd\u56de\u8c03\u65b9\u5f0f\uff0c\u56de\u8c03\u4e00\u5b9a\u53d1 \u751f\u5728 UI \u7ebf\u7a0b\u3002\u56e0\u6b64\u5982\u679c\u5e94\u7528\u53d1\u751f\u5361\u987f\uff0c\u4e00\u5b9a\u662f\u5728 dispatchMessage \u4e2d\u6267\u884c\u4e86\u8017\u65f6\u64cd\u4f5c\u3002\u6211 \u4eec\u901a\u8fc7\u7ed9\u4e3b\u7ebf\u7a0b\u7684 Looper \u8bbe\u7f6e\u4e00\u4e2a Printer\uff0c\u6253\u70b9\u7edf\u8ba1 dispatchMessage \u65b9\u6cd5\u6267\u884c\u7684\u65f6\u95f4\uff0c \u5982\u679c\u8d85\u51fa\u9600\u503c\uff0c\u8868\u793a\u53d1\u751f\u5361\u987f\uff0c\u5219 dump \u51fa\u5404\u79cd\u4fe1\u606f\uff0c\u63d0\u4f9b\u5f00\u53d1\u8005\u5206\u6790\u6027\u80fd\u74f6\u9888\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/EventBus/","title":"EventBus","text":"<p>\u672c\u7bc7\u535a\u5ba2\u6d89\u53ca\u5230\u7684\u5185\u5bb9\u5982\u4e0b\uff1a</p> <ol> <li>EventBus.register()\u8fc7\u7a0b</li> <li>EventBus.post()\u8fc7\u7a0b</li> <li>\u6ce8\u89e3Subscribe.priority\u4f5c\u7528</li> <li>ConcurrentHashMap</li> <li>CopyOnWriteArrayList</li> <li>ThreadLocal</li> <li>EventBus\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u8de8\u8fdb\u7a0b\u901a\u4fe1</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/EventBus/#1-register","title":"1. register\u8fc7\u7a0b\uff1a","text":"<p>1\uff09\u901a\u8fc7\u53cd\u5c04\u67e5\u627e\u662f\u5426\u88ab@Subscribe\u6ce8\u89e3\u7b49\u8fc7\u6ee4\u6761\u4ef6\uff0c\u627e\u5230EventBus\u6240\u9700\u8981\u7684onEvent\u7cfb\u5217\u56de\u8c03\u65b9\u6cd5\uff1b\u5f53\u7136\uff0c\u8fc7\u6ee4\u6761\u4ef6\u8fd8\u5305\u62ec\u65b9\u6cd5\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u3001\u5fc5\u987b\u662fpublic\u8bbf\u95ee\u7c7b\u578b\u7b49\uff1b</p> <p>2\uff09\u5b9a\u4f4d\u5230onEvent\u7cfb\u5217\u56de\u8c03\u65b9\u6cd5(\u5373\u540e\u9762\u5c06\u5230\u7684Method)\u540e\uff0c\u5c06Method\u3001threadMode\u3001eventType\u7b49\u5b58\u5230SubscriberMethod\uff1b</p> <p>3\uff09\u5c06Subscriber(\u5373\u6ce8\u518cEventBus\u7684\u7c7b\uff0c\u793a\u4f8b\u4ee3\u7801\u4e2d\u7684EventBusActivity)\u548c\u81ea\u5df1\u7684SubscriberMethod\u5b58\u5230subscriptionsByEventType\u3002post\u65f6\u5c31\u4ecesubscriptionsByEventType\u83b7\u53d6\u5bf9\u5e94Event\u7684\u6240\u6709subscriber\u8fdb\u884c\u56de\u8c03\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>\u9875\u9762\u4e00\uff1a\npublic class EventBusActivity extends Activity {\n\n    protected void onCreate(Bundle savedInstanceState) {\n        EventBus.getDefault().register(this);\n    }\n\n    @Subscribe(threadMode = ThreadMode.MAIN)\n    public void onStatusEvent(StatusEvent statusEvent) {\n    }\n\n    @Subscribe(threadMode = ThreadMode.BACKGROUND)\n    public void onDescEvent(DescribeEvent event) {\n    }\n\n\u9875\u9762\u4e8c\uff1a\npublic class PostEventActivity extends Activity {\n\n    protected void onCreate(Bundle savedInstanceState) {\n        EventBus.getDefault().register(this);\n    }\n\n    public void postEvent(View v) {\n        EventBus.getDefault().post(new StatusEvent(\"idle\"));\n    }\n\n    @Subscribe(threadMode = ThreadMode.MAIN, priority = 1)\n    public void onStatusEvent(StatusEvent statusEvent) {\n    }\n}\n</code></pre> <p>\u5176\u4e2d\uff0c\u4e24\u4e2a\u9875\u9762\u90fd\u6ce8\u518c\u4e86StatusEvent\u3002</p> <p>EventBus.java</p> <pre><code>\u6838\u5fc3\u6570\u636e\u7ed3\u6784 subscriptionsByEventType\n\n// key: Event, \u5bf9\u5e94demo\u4e2d\u7684StatusEvent\u548cDescribeEvent\n// value: \u6ce8\u518c\u4e86Event\u7684\u6240\u6709subscriber\u3002\n// StatusEvent\u5c31\u6709EventBusActivity\u548cPostEventActivity\u4e24\u4e2asubscriber\uff0c\u6240\u4ee5\u53d1\u5c04StatusEvent\uff0c\u4e24\u4e2aActivity\u90fd\u4f1a\u63a5\u6536\u5230\nMap&lt;Class&lt;?&gt;, CopyOnWriteArrayList&lt;Subscription&gt;&gt; subscriptionsByEventType;\n\n\npublic void register(Object subscriber) { \n        Class&lt;?&gt; subscriberClass = subscriber.getClass();\n\n        // \u83b7\u53d6\u8ba2\u9605\u8005\u7c7b\u91cc\u6240\u6709\u7684\u6ce8\u518c\u56de\u8c03\u65b9\u6cd5\uff0c\u5b9e\u73b0\u8fc7\u7a0b\u5728SubscriberMethodFinder.java\n        // \u5bf9\u5e94demo\u4e2d\u7684onStatusEvent()\u548conDescEvent()\n\n        List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass);\n\n        synchronized (this) {\n            for (SubscriberMethod subscriberMethod : subscriberMethods) {\n                subscribe(subscriber, subscriberMethod);\n            }\n        }\n    }\n\n\n// \u7ec4\u88c5 subscriptionsByEventType\nprivate void subscribe(Object subscriber, SubscriberMethod subscriberMethod) {\n        Class&lt;?&gt; eventType = subscriberMethod.eventType;\n        Subscription newSubscription = new Subscription(subscriber, subscriberMethod);\n        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);\n        if (subscriptions == null) {\n            subscriptions = new CopyOnWriteArrayList&lt;&gt;();\n            subscriptionsByEventType.put(eventType, subscriptions);\n        } else {\n            ...\n        }\n\n        int size = subscriptions.size();\n        for (int i = 0; i &lt;= size; i++) {\n\n            // \u6839\u636emethod priority\u987a\u5e8f\u586b\u5165\uff0c\u6240\u4ee5\u56de\u8c03\u4e5f\u4f1a\u987a\u5e8f\u6267\u884c\u3002\u5185\u5bb93\u7684\u7b54\u6848\u3002\n            if (i == size || subscriberMethod.priority &gt; subscriptions.get(i).subscriberMethod.priority) {\n                subscriptions.add(i, newSubscription);\n                break;\n            }\n        }\n\n        List&lt;Class&lt;?&gt;&gt; subscribedEvents = typesBySubscriber.get(subscriber);\n        if (subscribedEvents == null) {\n            subscribedEvents = new ArrayList&lt;&gt;();\n            typesBySubscriber.put(subscriber, subscribedEvents);\n        }\n        subscribedEvents.add(eventType);\n\n        ...\n    }\n</code></pre> <p>SubscriberMethodFinder.java</p> <pre><code>// key: subscriber, value: subscriber\u6240\u6709\u7684\u6ce8\u518c\u56de\u8c03\u65b9\u6cd5\nprivate static final Map&lt;Class&lt;?&gt;, List&lt;SubscriberMethod&gt;&gt; METHOD_CACHE = new ConcurrentHashMap&lt;&gt;();\n\n// \u83b7\u53d6\u8ba2\u9605\u8005\u7c7b\u91cc\u6240\u6709\u7684\u6ce8\u518c\u56de\u8c03\u65b9\u6cd5\nList&lt;SubscriberMethod&gt; findSubscriberMethods(Class&lt;?&gt; subscriberClass) {\n        List&lt;SubscriberMethod&gt; subscriberMethods = METHOD_CACHE.get(subscriberClass);\n        if (subscriberMethods != null) {\n            return subscriberMethods;\n        }\n\n        if (ignoreGeneratedIndex) {\n            subscriberMethods = findUsingReflection(subscriberClass);\n        } else {\n            // \u83b7\u53d6\u56de\u8c03\u65b9\u6cd5\u5177\u4f53\u8fc7\u7a0b\n            subscriberMethods = findUsingInfo(subscriberClass);\n        }\n        if (subscriberMethods.isEmpty()) {\n            throw new EventBusException(\"Subscriber \" + subscriberClass\n                    + \" and its super classes have no public methods with the @Subscribe annotation\");\n        } else {\n            METHOD_CACHE.put(subscriberClass, subscriberMethods);\n            return subscriberMethods;\n        }\n    }    \n\n\n// \u53cd\u5c04\u83b7\u53d6 Event \u6ce8\u89e3\u4fe1\u606f\nprivate void findUsingReflectionInSingleClass(FindState findState) {\n        Method[] methods;\n        try {\n            // This is faster than getMethods, especially when subscribers are fat classes like Activities\n            methods = findState.clazz.getDeclaredMethods();\n        } catch (Throwable th) {\n            methods = findState.clazz.getMethods();\n            findState.skipSuperClasses = true;\n        }\n\n        for (Method method : methods) {\n            int modifiers = method.getModifiers();\n\n            // \u56de\u8c03\u65b9\u6cd5\u5fc5\u987b\u662fpublic\n            if ((modifiers &amp; Modifier.PUBLIC) != 0 &amp;&amp; (modifiers &amp; MODIFIERS_IGNORE) == 0) {\n                Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();\n\n                // \u56de\u8c03\u65b9\u6cd5\u7684\u53c2\u6570\u5fc5\u987b\u53ea\u67091\u4e2a\n                if (parameterTypes.length == 1) {\n\n                    Subscribe subscribeAnnotation = method.getAnnotation(Subscribe.class);\n                    if (subscribeAnnotation != null) {\n                        Class&lt;?&gt; eventType = parameterTypes[0];\n                        if (findState.checkAdd(method, eventType)) {\n                            ThreadMode threadMode = subscribeAnnotation.threadMode();\n\n                            //\u5c06\u56de\u8c03\u65b9\u6cd5\u76f8\u5173\u4fe1\u606f\u7ec4\u88c5\u6210 SubscriberMethod\n                            findState.subscriberMethods.add(new SubscriberMethod(method, eventType, threadMode, subscribeAnnotation.priority(), subscribeAnnotation.sticky()));\n                        }\n                    }\n                } else if (...) {\n                    ...\n                }\n            } else if (...)) {\n                ...\n            }\n        }\n    }\n\n</code></pre> <p>PS\uff1aMap&lt;Class&lt;?&gt;, CopyOnWriteArrayList&gt; subscriptionsByEventType key\u662fEvent\u7c7b\u578b(\u793a\u4f8b\u4e2d\u7684StatusEvent\u548cDescribeEvent)\uff0cvalue\u662f\u4f7f\u7528\u4e86\u8be5Event\u7684\u7c7b\uff0c\u4e3aList\u7c7b\u578b\u3002\u8bf4\u660e\uff0c\u4e00\u4e2aEvent\u53ef\u4ee5\u5bf9\u5e94\u591a\u4e2asubscriber\u3002"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/EventBus/#2-post","title":"2. post\u8fc7\u7a0b\uff1a","text":"<p>1\uff09\u6839\u636epost\u53c2\u6570\u4e2d\u7684Event\u7c7b\u578b\uff0c\u627e\u5230\u6ce8\u518c\u4e86\u8be5Event\u7684\u7c7b\uff08\u5373Subscriber\uff09\u53caonEvent\u7cfb\u5217\u56de\u8c03\u65b9\u6cd5\uff1b</p> <p>2\uff09\u4f7f\u7528Method.invoke()\uff0c\u8c03\u7528Subscriber\u7684\u56de\u8c03\u65b9\u6cd5\uff1b</p> <p>EventBus.java</p> <pre><code>private boolean postSingleEventForEventType(Object event, PostingThreadState postingState, Class&lt;?&gt; eventClass) {\n\n        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions;\n        synchronized (this) {\n            // \u6839\u636eEvent\uff0c\u83b7\u53d6subscriber\n            subscriptions = subscriptionsByEventType.get(eventClass);\n        }\n        if (subscriptions != null &amp;&amp; !subscriptions.isEmpty()) {\n\n            // \u904d\u5386\u6240\u6709subscriber\n            for (Subscription subscription : subscriptions) {\n                postingState.event = event;\n                postingState.subscription = subscription;\n                boolean aborted = false;\n                try {\n                    postToSubscription(subscription, event, postingState.isMainThread);\n                    aborted = postingState.canceled;\n                } finally {\n                    postingState.event = null;\n                    postingState.subscription = null;\n                    postingState.canceled = false;\n                }\n                if (aborted) {\n                    break;\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n\n// \u6839\u636eThreadMode\uff0c\u5728\u5bf9\u5e94\u7ebf\u7a0b\u6267\u884c\u56de\u8c03\n private void postToSubscription(Subscription subscription, Object event, boolean isMainThread) {\n        switch (subscription.subscriberMethod.threadMode) {\n            case POSTING:\n                invokeSubscriber(subscription, event);\n                break;\n            case MAIN:\n                if (isMainThread) {\n                    invokeSubscriber(subscription, event);\n                } else {\n                    mainThreadPoster.enqueue(subscription, event);\n                }\n                break;\n            case BACKGROUND:\n                if (isMainThread) {\n                    backgroundPoster.enqueue(subscription, event);\n                } else {\n                    invokeSubscriber(subscription, event);\n                }\n                break;\n            case ASYNC:\n                asyncPoster.enqueue(subscription, event);\n                break;\n            default:\n                throw new IllegalStateException(\"Unknown thread mode: \" + subscription.subscriberMethod.threadMode);\n        }\n    }\n\n</code></pre> <p>\u56db\u79cdThreadMode:</p> <ul> <li>POSTING\uff1a\u53d1\u9001\u548c\u63a5\u6536\u5728\u540c\u4e00\u7ebf\u7a0b</li> <li>MAIN\uff1a\u65e0\u6cd5\u53d1\u9001\u5728\u54ea\u4e2a\u7ebf\u7a0b\uff0c\u63a5\u6536\u90fd\u5728UI\u7ebf\u7a0b\uff1b\u8a00\u5916\u4e4b\u610f\uff0c\u53d1\u9001\u8981\u662f\u5728UI\u7ebf\u7a0b\uff0c\u63a5\u6536\u548c\u53d1\u9001\u5728\u540c\u4e00\u7ebf\u7a0b</li> <li>BACKGROUND\uff1a\u63a5\u6536\u5728\u5f02\u6b65\u7ebf\u7a0b\uff1b\u5982\u679c\u53d1\u9001\u5728\u5f02\u6b65\u7ebf\u7a0b\uff0c\u63a5\u6536\u548c\u53d1\u9001\u5728\u540c\u4e00\u7ebf\u7a0b</li> <li>ASYNC\uff1a\u63a5\u6536\u5728\u5f02\u6b65\u7ebf\u7a0b\uff0c\u4e14\u548c\u53d1\u9001\u4e0d\u5728\u540c\u4e00\u7ebf\u7a0b\uff0c\u5373\u4f7f\u53d1\u9001\u4e5f\u5728\u5f02\u6b65\u7ebf\u7a0b</li> </ul>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/EventBus/#3-subscribepriority","title":"3. \u6ce8\u89e3Subscribe.priority\u4f5c\u7528","text":"<p>\u56e0\u4e3a\u591a\u4e2asubscriber\u53ef\u4ee5\u6ce8\u518c\u540c\u4e00Event\uff0c\u6bd4\u5982Demo\u4e2dEventBusActivity\u548cPostEventActivity\u4e24\u4e2asubscriber\u90fd\u6ce8\u518c\u4e86StatusEvent\u3002</p> <p>priority\u7684\u4f5c\u7528\u5c31\u662f\u51b3\u5b9a\u591a\u4e2asubscriber\u4e2d\u7684\u56de\u8c03\u65b9\u6cd5\u7684\u6267\u884c\u987a\u5e8f\u3002</p> <p>demo\u4e2d\uff0cPostEventActivity\u6ce8\u518cStatusEvent\u6307\u5b9a\u4e86priority = 1\uff0c\u800cEventBusActivity\u6ca1\u6307\u5b9aStatusEvent\u7684priority\uff08\u9ed8\u8ba40\uff09\uff0c\u6240\u4ee5post(StatusEvent)\u65f6\uff0cPostEventActivity\u5148\u56de\u8c03\u3002</p> <p>\u8fd9\u4e2a\u5b9e\u73b0\u539f\u7406\uff0c\u662fregister()\u8fc7\u7a0b\u4e2d\uff0c\u5c31\u5df2\u7ecf\u6309\u7167priority\u5c06subscriber\u6309\u987a\u5e8f\u653e\u5230subscriptionsByEventType\u4e2d\u3002\u6240\u4ee5\u53d6subscriber\u8fdb\u884c\u56de\u8c03\u65f6\uff0c\u81ea\u7136\u5c31\u6309\u7167priority\u987a\u5e8f\u56de\u8c03\u4e86\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/EventBus/#4-concurrenthashmap","title":"4. ConcurrentHashMap","text":"<p>\u6838\u5fc3\u6570\u636e\u7ed3\u6784subscriptionsByEventType\uff0c\u5c31\u662f\u4e00\u4e2aConcurrentHashMap\u3002</p> <p>\u5177\u4f53\u5185\u5bb9\u89c1\uff1alink</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/","title":"Frsco","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#fresco","title":"Fresco\u4e00\u4e9b\u9ad8\u7ea7\u4f7f\u7528\u6280\u5de7","text":"<ol> <li>\u4f7f\u7528RGB_565</li> <li>\u533a\u57df\u89e3\u7801</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#_1","title":"\u76f8\u5173\u95ee\u9898\uff1a","text":"<ol> <li> <p>Fresco \u4e0b\u8f7d\u6a21\u5757\u5982\u4f55\u8bbe\u8ba1\uff1f \u9ed8\u8ba4\u4f7f\u7528HTTPURLConnection\uff0c\u4e5f\u652f\u6301\u4f7f\u7528OkHttp\u3002\u4e0b\u8f7d\u7c7b\u662fNetworkFetcher\u3002</p> </li> <li> <p>Fresco \u56fe\u7247\u7f13\u5b58\u6a21\u5757\u5982\u4f55\u8bbe\u8ba1\uff1f \u4e09\u7ea7\u7f13\u5b58\uff1aBitmap\u7f13\u5b58(5.0\u4ee5\u524d\u653eAshmen) + \u672a\u89e3\u7801\u56fe\u7247\u7f13\u5b58 + \u786c\u76d8\u7f13\u5b58</p> </li> <li> <p>\u786c\u76d8\u7f13\u5b58\u5982\u4f55\u8bbe\u8ba1\uff1f</p> </li> <li> <p>Fresco\u7684\u7f13\u5b58\u548c\u5176\u4ed6\u6709\u4ec0\u4e48\u4e0d\u4e00\u6837\uff1f </p> </li> <li> <p>SimpleDraweeView layout_width/height \u4e3a\u4f55\u4e0d\u652f\u6301 wrap_content?</p> <p>wrap_content\u7684\u9650\u5236</p> </li> </ol> <p>\u4eba\u4eec\u7ecf\u5e38\u4f1a\u95ee\uff0c\u4e3a\u4ec0\u4e48Fresco\u4e2d\u4e0d\u53ef\u4ee5\u4f7f\u7528wrap_content\uff1f</p> <p>\u4e3b\u8981\u7684\u539f\u56e0\u662f\uff0cDrawee\u6c38\u8fdc\u4f1a\u5728getIntrinsicHeight/getIntrinsicWidth\u4e2d\u8fd4\u56de-1\u3002</p> <p>\u8fd9\u4e48\u505a\u7684\u539f\u56e0\u662f Drawee \u4e0d\u50cfImageView\u4e00\u6837\u3002\u5b83\u540c\u4e00\u65f6\u523b\u53ef\u80fd\u4f1a\u663e\u793a\u591a\u4e2a\u5143\u7d20\u3002\u6bd4\u5982\u5728\u4ece\u5360\u4f4d\u56fe\u6e10\u53d8\u5230\u76ee\u6807\u56fe\u65f6\uff0c\u4e24\u5f20\u56fe\u4f1a\u6709\u540c\u65f6\u663e\u793a\u7684\u65f6\u5019\u3002\u518d\u6bd4\u5982\u53ef\u80fd\u6709\u591a\u5f20\u76ee\u6807\u56fe\u7247\uff08\u4f4e\u6e05\u6670\u5ea6\u3001\u9ad8\u6e05\u6670\u5ea6\u4e24\u5f20\uff09\u3002\u5982\u679c\u8fd9\u4e9b\u56fe\u50cf\u90fd\u662f\u4e0d\u540c\u7684\u5c3a\u5bf8\uff0c\u90a3\u4e48\u5f88\u96be\u5b9a\u4e49\u201dintrinsic\u201d\u5c3a\u5bf8\u3002</p> <p>\u5982\u679c\u6211\u4eec\u8981\u5148\u7528\u5360\u4f4d\u56fe\u7684\u5c3a\u5bf8\uff0c\u7b49\u52a0\u8f7d\u5b8c\u6210\u540e\u518d\u4f7f\u7528\u771f\u5b9e\u56fe\u7684\u5c3a\u5bf8\uff0c\u90a3\u4e48\u56fe\u7247\u5f88\u53ef\u80fd\u663e\u793a\u9519\u8bef\u3002\u5b83\u53ef\u80fd\u4f1a\u88ab\u6839\u636e\u5360\u4f4d\u56fe\u7684\u5c3a\u5bf8\u6765\u7f29\u653e\u3001\u88c1\u526a\u3002\u552f\u4e00\u9632\u6b62\u8fd9\u79cd\u4e8b\u60c5\u7684\u65b9\u5f0f\u5c31\u53ea\u6709\u5728\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\u540e\u5f3a\u5236\u89e6\u53d1\u4e00\u6b21layout\u3002\u8fd9\u6837\u7684\u8bdd\u4e0d\u4ec5\u4f1a\u5f71\u54cd\u6027\u80fd\uff0c\u800c\u4e14\u4f1a\u8ba9\u5e94\u7528\u7684\u754c\u9762\u7a81\u53d8\uff0c\u5f88\u5f71\u54cd\u7528\u6237\u4f53\u9a8c\uff01\u5982\u679c\u7528\u6237\u6b63\u5728\u8bfb\u4e00\u7bc7\u6587\u7ae0\uff0c\u7136\u540e\u5728\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\u540e\u6574\u7bc7\u6587\u7ae0\u7a81\u7136\u5411\u4e0b\u79fb\u52a8\uff0c\u8fd9\u662f\u975e\u5e38\u4e0d\u597d\u7684\u3002</p> <p>\u6240\u4ee5\u4f60\u5fc5\u987b\u6307\u5b9a\u5c3a\u5bf8\u6216\u8005\u7528match_parent\u6765\u5e03\u5c40\u3002</p> <p>\u4f60\u5982\u679c\u4ece\u670d\u52a1\u7aef\u8bf7\u6c42\u56fe\u7247\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u505a\u5230\u8fd4\u56de\u56fe\u7247\u5c3a\u5bf8\u3002\u7136\u540e\u4f60\u62ff\u5230\u4e4b\u540e\u901a\u8fc7setLayoutParams \u6765\u7ed9View\u8bbe\u7f6e\u5bbd\u9ad8\u3002</p> <p>\u5f53\u7136\u5982\u679c\u4f60\u5fc5\u987b\u8981\u4f7f\u7528wrap_content\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u53c2\u8003StackOverflow\u4e0a\u7684\u4e00\u4e2a\u56de\u7b54\u3002\u4f46\u662f\u6211\u4eec\u4ee5\u540e\u4f1a\u79fb\u9664\u8fd9\u4e2a\u529f\u80fd\uff0cUgly things should look ugly\u3002</p> <ol> <li>DraweeView\u591a\u5c42\u7ed3\u6784\uff1f</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#_2","title":"\u6a21\u5757\u7ed3\u6784","text":"<pre><code>demo\n    compile project(':drawee-backends:drawee-pipeline')\n\ndrawee-pipeline (\u5305\u542b\u5728drawee-backends\u76ee\u5f55\u4e2d\uff0c\u540c\u7ea7\u8fd8\u6709drawee-volly)\n    compile project(':drawee')\n    compile project(':fbcore')\n    compile project(':imagepipeline')\n\ndrawee\n    compile project(':fbcore')\n\nimagepipeline\n    compile project(':fbcore')\n\nfbcore\n    \u6700\u5e95\u5c42module\uff0c\u63d0\u4f9bfile, log, datasource, memory\u7b49\u57fa\u7840\u529f\u80fd\n\n</code></pre> <pre><code>SimpleDraweeView.setImageUri(Uri, Context) \u6d41\u7a0b\uff1a\n\n-&gt; AbstractDraweeControllerBuilder.build(): AbstractDraweeController\n-&gt; AbstractDraweeControllerBuilder. buildController(): AbstractDraweeController\n-&gt; PipelineDraweeControllerBuilder. obtainController(): PipelineDraweeController\n-&gt; AbstractDraweeControllerBuilder. obtainDataSourceSupplier(): Supplier&lt;DataSource&lt;IMAGE&gt;&gt;\n-&gt; AbstractDraweeControllerBuilder. getDataSourceSupplierForRequest(): Supplier&lt;DataSource&lt;IMAGE&gt;&gt;\n-&gt; PipelineDraweeControllerBuilder. getDataSourceForRequest(): DataSource&lt;CloseableReference&lt;CloseableImage&gt;&gt;\n-&gt; ImagePipeline. fetchDecodedImage(): DataSource&lt;CloseableReference&lt;CloseableImage&gt;&gt;\n-&gt; ImagePipeline. submitFetchRequest(): DataSource&lt;CloseableReference&lt;CloseableImage&gt;&gt;\n-&gt; CloseableProducerToDataSourceAdapter. create(): DataSource&lt;CloseableReference&lt;T&gt;&gt;\n-&gt; AbstractProducerToDataSourceAdapter. construtor()\n-&gt; Producer. produceResults()\n\n\nSimpleDraweeView attach\u5230window\u65f6\uff0c\u6267\u884c\u5982\u4e0b\u6d41\u7a0b\uff1a\n-&gt; DraweeView. onAttachedwindow()\n-&gt; DraweeHolder. onAttach()\n-&gt; DraweeHolder. attachController()\n-&gt; AbstrackDraweeController. onAttach()\n-&gt; AbstrackDraweeController. submitRequest()\n-&gt; AbstractDataSource. subscribe()\n\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#_3","title":"\u4e3b\u8981\u7c7b","text":"<pre><code>ImagePipline\uff1a\u8d1f\u8d23\u4ece\u7f51\u7edc\u3001\u672c\u5730\u6587\u4ef6\u3001\u672c\u5730\u8d44\u6e90\u52a0\u8f7d\u56fe\u7247\uff0c\u5e76\u5c06\u5176\u89e3\u7801\u5230\u5185\u5b58\u4e2d\u4f9b\u7cfb\u7edf\u4f7f\u7528\u3002\n\nImageRequest, \n\nSupplier&lt;DataSource&lt;T&gt;&gt;\n\nDraweeController:\n\nSimpleDraweeControllerBuilder(I):\nDraweeController\u7684\u6784\u9020\u5668\uff0c\u4e3b\u8981\u5b9e\u73b0\u7c7b\u662fPipelineDraweeControllerBuilder\u3002\n\u7ee7\u627f\u7ed3\u6784\uff1a\nPipelineDraweeControllerBuilder -&gt; \nAbstractDraweeControllerBuilder -&gt; \nSimpleDraweeControllerBuilder\n\n\n**AbstractDataSource:**\n\u5c01\u88c5\u4e86Producer\uff0c\n\u5177\u4f53\u5b9e\u73b0\u7c7b AbstractProducerToDataSourceAdapter\n\nAbstractDataSource\n    -&gt;  VolleyDataSource\n    -&gt;  AbstractProducerToDataSourceAdapter\n        -&gt;  CloseableProducerToDataSourceAdapter\n\n\n**Producer:**\n\u5c01\u88c5\u4e86Fetcher\u3002\n\u4f7f\u7528\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f(Producer-Consumer)\uff0c\u83b7\u53d6\u4e0d\u540c\u6765\u6e90\u7684\u56fe\u7247\u8d44\u6e90(cache, file, url)\u3002\n\n\u7ee7\u627f\u5173\u7cfb\uff1a\n-&gt; Producer (I)\n    -&gt; LocalFetchProducer\n        -&gt; LocalAssetFetchProducer\n        -&gt; LocalFileFetchProducer\n        -&gt; LocalResourceFetchProducer\n    -&gt; NetworkFetchProducer\n    -&gt; LocalVideoThumbnailProducer\n\n\n\n**Fetcher:**\n\u7f51\u7edc\u8bf7\u6c42\u5b9e\u73b0\u7c7b\uff0c\u53ea\u5728NetworkFetchProducer\u4e2d\u4f7f\u7528\u3002\n\n\u7ee7\u627f\u5173\u7cfb\uff1a\n-&gt; NetworkFetcher (I)\n    -&gt; BaseNetworkFetcher\n        -&gt; HttpUrlConnectionNetworkFetcher (fresco\u9ed8\u8ba4\u4f7f\u7528\u7684)\n        -&gt; OkHttpNetworkFetcher\n\n\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#_4","title":"\u6838\u5fc3\u6a21\u5757","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#imagepipeline","title":"ImagePipeline","text":"<p>Fresco \u4e2d\u8bbe\u8ba1\u6709\u4e00\u4e2a\u53eb\u505a Image Pipeline \u7684\u6a21\u5757\u3002\u5b83\u8d1f\u8d23\u4ece\u7f51\u7edc\uff0c\u4ece\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\uff0c\u672c\u5730\u8d44\u6e90\u52a0\u8f7d\u56fe\u7247\u3002\u4e3a\u4e86\u6700\u5927\u9650\u5ea6\u8282\u7701\u7a7a\u95f4\u548cCPU\u65f6\u95f4\uff0c\u5b83\u542b\u67093\u7ea7\u7f13\u5b58\u8bbe\u8ba1\uff082\u7ea7\u5185\u5b58\uff0c1\u7ea7\u78c1\u76d8\uff09\u3002</p> <p>Image pipeline \u8d1f\u8d23\u5b8c\u6210\u52a0\u8f7d\u56fe\u50cf\uff0c\u53d8\u6210Android\u8bbe\u5907\u53ef\u5448\u73b0\u7684\u5f62\u5f0f\u6240\u8981\u505a\u7684\u6bcf\u4e2a\u4e8b\u60c5\u3002</p> <p>\u5927\u81f4\u6d41\u7a0b\u5982\u4e0b:</p> <ul> <li>\u68c0\u67e5\u5185\u5b58\u7f13\u5b58\uff0c\u5982\u6709\uff0c\u8fd4\u56de</li> <li>\u540e\u53f0\u7ebf\u7a0b\u5f00\u59cb\u540e\u7eed\u5de5\u4f5c</li> <li>\u68c0\u67e5\u662f\u5426\u5728\u672a\u89e3\u7801\u5185\u5b58\u7f13\u5b58\u4e2d\u3002\u5982\u6709\uff0c\u89e3\u7801\uff0c\u53d8\u6362\uff0c\u8fd4\u56de\uff0c\u7136\u540e\u7f13\u5b58\u5230\u5185\u5b58\u7f13\u5b58\u4e2d\u3002</li> <li>\u68c0\u67e5\u662f\u5426\u5728\u78c1\u76d8\u7f13\u5b58\u4e2d\uff0c\u5982\u679c\u6709\uff0c\u53d8\u6362\uff0c\u8fd4\u56de\u3002\u7f13\u5b58\u5230\u672a\u89e3\u7801\u7f13\u5b58\u548c\u5185\u5b58\u7f13\u5b58\u4e2d\u3002</li> <li>\u4ece\u7f51\u7edc\u6216\u8005\u672c\u5730\u52a0\u8f7d\u3002\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u89e3\u7801\uff0c\u53d8\u6362\uff0c\u8fd4\u56de\u3002\u5b58\u5230\u5404\u4e2a\u7f13\u5b58\u4e2d\u3002</li> </ul> <p>\u65e2\u7136\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u56fe\u7247\u52a0\u8f7d\u7ec4\u4ef6\uff0c\u90a3\u4e48\u4e00\u56fe\u80dc\u5343\u8a00\u3002 </p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#drawees","title":"Drawees","text":"<p>Fresco \u4e2d\u8bbe\u8ba1\u6709\u4e00\u4e2a\u53eb\u505a Drawees \u6a21\u5757\uff0c\u5b83\u4f1a\u5728\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\u524d\u663e\u793a\u5360\u4f4d\u56fe\uff0c\u52a0\u8f7d\u6210\u529f\u540e\u81ea\u52a8\u66ff\u6362\u4e3a\u76ee\u6807\u56fe\u7247\u3002\u5f53\u56fe\u7247\u4e0d\u518d\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u65f6\uff0c\u5b83\u4f1a\u53ca\u65f6\u5730\u91ca\u653e\u5185\u5b58\u548c\u7a7a\u95f4\u5360\u7528\u3002  </p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#_5","title":"\u7279\u6027","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#1","title":"1. \u5185\u5b58","text":"<p>[\u4e09\u7ea7\u7f13\u5b58]</p> <pre><code>**1. Bitmap\u7f13\u5b58**\nBitmap\u7f13\u5b58\u5b58\u50a8Bitmap\u5bf9\u8c61\uff0c\u8fd9\u4e9bBitmap\u5bf9\u8c61\u53ef\u4ee5\u7acb\u523b\u7528\u6765\u663e\u793a\u6216\u8005\u7528\u4e8e\u540e\u5904\u7406\n\n\u57285.0\u4ee5\u4e0b\u7cfb\u7edf\uff0cBitmap\u7f13\u5b58\u4f4d\u4e8eAshmem\uff0c\u8fd9\u6837Bitmap\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u91ca\u653e\u5c06\u4e0d\u4f1a\u5f15\u53d1GC\uff0c\u66f4\u5c11\u7684GC\u4f1a\u4f7f\u4f60\u7684APP\u8fd0\u884c\u5f97\u66f4\u52a0\u6d41\u7545\u3002\u57285.0\u4ee5\u4e0b\uff0c\u9891\u7e41GC\u5c06\u4f1a\u663e\u8457\u5730\u5f15\u53d1\u754c\u9762\u5361\u987f\u3002\n\nAshmem\u5b58\u50a8\u533a\u57df\uff1a\u5b83\u662f\u4e00\u4e2a\u4e0d\u5728Java\u5806\u533a\u7684\u4e00\u7247\u5b58\u50a8\u5185\u5b58\u7a7a\u95f4\uff0c\u5b83\u7684\u7ba1\u7406\u7531Linux\u5185\u6838\u9a71\u52a8\u7ba1\u7406\uff0c\u4e0d\u5fc5\u6df1\u7a76\uff0c\u53ea\u8981\u77e5\u9053\u8fd9\u5757\u5b58\u50a8\u533a\u57df\u662f\u522b\u4e8e\u5806\u5185\u5b58\u4e4b\u5916\u7684\u4e00\u5757\u7a7a\u95f4\u5c31\u884c\u4e86\uff0c\u4e14\u8fd9\u5757\u7a7a\u95f4\u662f\u53ef\u4ee5\u591a\u8fdb\u7a0b\u5171\u4eab\u7684\uff0cGC\u7684\u6d3b\u52a8\u4e0d\u4f1a\u5f71\u54cd\u5230\u5b83\u3002\n\n5.0\u53ca\u5176\u4ee5\u4e0a\u7cfb\u7edf\uff0c\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5185\u5b58\u7ba1\u7406\u6709\u4e86\u5f88\u5927\u6539\u8fdb\uff0c\u6240\u4ee5Bitmap\u7f13\u5b58\u76f4\u63a5\u4f4d\u4e8eJava\u7684heap\u4e0a\u3002\n\n\u5f53\u5e94\u7528\u5728\u540e\u53f0\u8fd0\u884c\u65f6\uff0c\u8be5\u5185\u5b58\u4f1a\u88ab\u6e05\u7a7a\u3002\n\n**2. \u672a\u89e3\u7801\u56fe\u7247\u7684\u5185\u5b58\u7f13\u5b58**\n\u8fd9\u4e2a\u7f13\u5b58\u5b58\u50a8\u7684\u662f\u539f\u59cb\u538b\u7f29\u683c\u5f0f\u7684\u56fe\u7247\u3002\u4ece\u8be5\u7f13\u5b58\u53d6\u5230\u7684\u56fe\u7247\u5728\u4f7f\u7528\u4e4b\u524d\uff0c\u9700\u8981\u5148\u8fdb\u884c\u89e3\u7801\u3002\n\n\u5982\u679c\u6709\u8c03\u6574\u5927\u5c0f\uff0c\u65cb\u8f6c\uff0c\u6216\u8005WebP\u7f16\u7801\u8f6c\u6362\u5de5\u4f5c\u9700\u8981\u5b8c\u6210\uff0c\u8fd9\u4e9b\u5de5\u4f5c\u4f1a\u5728\u89e3\u7801\u4e4b\u524d\u8fdb\u884c\u3002\n\n**3. \u78c1\u76d8\u7f13\u5b58**\n\u548c\u672a\u89e3\u7801\u7684\u5185\u5b58\u7f13\u5b58\u76f8\u4f3c\uff0c\u78c1\u76d8\u7f13\u5b58\u5b58\u50a8\u7684\u662f\u672a\u89e3\u7801\u7684\u539f\u59cb\u538b\u7f29\u683c\u5f0f\u7684\u56fe\u7247\uff0c\u5728\u4f7f\u7528\u4e4b\u524d\u540c\u6837\u9700\u8981\u7ecf\u8fc7\u89e3\u7801\u7b49\u5904\u7406\u3002\n\n\u548cBitmap\u7f13\u5b58\u4e0d\u4e00\u6837\uff0cAPP\u5728\u540e\u53f0\u65f6\uff0c\u5185\u5bb9\u662f\u4e0d\u4f1a\u88ab\u6e05\u7a7a\u7684\u3002\u5373\u4f7f\u5173\u673a\u4e5f\u4e0d\u4f1a\u3002\u7528\u6237\u53ef\u4ee5\u968f\u65f6\u7528\u7cfb\u7edf\u7684\u8bbe\u7f6e\u83dc\u5355\u4e2d\u8fdb\u884c\u6e05\u7a7a\u7f13\u5b58\u64cd\u4f5c\u3002\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#bitmap","title":"\u4f7f\u7528\u4e09\u7ea7\u7f13\u5b58\uff1aBitmap\u7f13\u5b58 + \u672a\u89e3\u7801\u56fe\u7247\u7f13\u5b58 + \u786c\u76d8\u7f13\u5b58","text":"<p>\u5176\u4e2d\u524d\u4e24\u4e2a\u5c31\u662f\u5185\u5b58\u7f13\u5b58\uff0cBitmap\u7f13\u5b58\u6839\u636e\u7cfb\u7edf\u7248\u672c\u4e0d\u540c\u653e\u5728\u4e86\u4e0d\u540c\u5185\u5b58\u533a\u57df\u4e2d\uff0c\u800c\u672a\u89e3\u7801\u56fe\u7247\u7684\u7f13\u5b58\u53ea\u5728\u5806\u5185\u5b58\u4e2d\uff0cFresco\u5206\u4e86\u4e24\u6b65\u505a\u5185\u5b58\u7f13\u5b58\uff0c\u8fd9\u6837\u505a\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u597d\u5904\u662f\u52a0\u5feb\u56fe\u7247\u7684\u52a0\u8f7d\u901f\u5ea6\u3002</p> <p>Fresco\u7684\u52a0\u8f7d\u56fe\u7247\u7684\u6d41\u7a0b\u4e3a\uff1a 1\uff09\u67e5\u627eBitmap\u7f13\u5b58\u4e2d\u662f\u5426\u5b58\u5728\uff0c\u5b58\u5728\u5219\u76f4\u63a5\u8fd4\u56deBitmap\u76f4\u63a5\u4f7f\u7528\uff1b 2\uff09\u4e0d\u5b58\u5728\u5219\u67e5\u627e\u672a\u89e3\u7801\u56fe\u7247\u7684\u7f13\u5b58\uff0c\u5982\u679c\u5b58\u5728\u5219\u8fdb\u884cDecode\u6210Bitmap\u7136\u540e\u76f4\u63a5\u4f7f\u7528\u5e76\u52a0\u5165Bitmap\u7f13\u5b58\u4e2d\uff1b 3\uff09\u5982\u679c\u672a\u89e3\u7801\u56fe\u7247\u7f13\u5b58\u4e2d\u67e5\u627e\u4e0d\u5230\uff0c\u5219\u8fdb\u884c\u786c\u76d8\u7f13\u5b58\u7684\u68c0\u67e5\uff0c\u5982\u6709\uff0c\u5219\u8fdb\u884cIO\u3001\u8f6c\u5316\u3001\u89e3\u7801\u7b49\u4e00\u7cfb\u5217\u64cd\u4f5c\uff0c\u6700\u540e\u6210Bitmap\u4f9b\u6211\u4eec\u76f4\u63a5\u4f7f\u7528\uff0c\u5e76\u628a\u672a\u89e3\u7801\uff08Encode\uff09\u7684\u56fe\u7247\u52a0\u5165\u672a\u89e3\u7801\u56fe\u7247\u7f13\u5b58\uff0c\u628aBitmap\u52a0\u5165Bitmap\u7f13\u5b58\u4e2d\uff0c\u5982\u786c\u76d8\u7f13\u5b58\u4e2d\u6ca1\u6709\uff0c\u5219\u8fdb\u884cNetwork\u64cd\u4f5c\u4e0b\u8f7d\u56fe\u7247\uff0c\u7136\u540e\u52a0\u5165\u5230\u5404\u4e2a\u7f13\u5b58\u4e2d\u3002</p> <p>\u65e2\u7136Fresco\u4f7f\u7528\u4e86\u4e09\u7ea7\u7f13\u5b58\uff0c\u800c\u6709\u4e24\u7ea7\u662f\u5185\u5b58\u7f13\u5b58\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u7684App\u5728\u540e\u53f0\u65f6\u6216\u8005\u5728\u5185\u5b58\u4f4e\u7684\u60c5\u51b5\u4e0b\u5728onLowMemory()\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5e94\u8be5\u624b\u52a8\u6e05\u9664\u5e94\u7528\u7684\u5185\u5b58\u7f13\u5b58\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u65b9\u5f0f\uff1a</p> <pre><code>ImagePipeline imagePipeline = Fresco.getImagePipeline();\n//\u6e05\u7a7a\u5185\u5b58\u7f13\u5b58\uff08\u5305\u62ecBitmap\u7f13\u5b58\u548c\u672a\u89e3\u7801\u56fe\u7247\u7684\u7f13\u5b58\uff09\nimagePipeline.clearMemoryCaches();\n//\u6e05\u7a7a\u786c\u76d8\u7f13\u5b58\uff0c\u4e00\u822c\u5728\u8bbe\u7f6e\u754c\u9762\u4f9b\u7528\u6237\u624b\u52a8\u6e05\u7406\nimagePipeline.clearDiskCaches();\n\n//\u540c\u65f6\u6e05\u7406\u5185\u5b58\u7f13\u5b58\u548c\u786c\u76d8\u7f13\u5b58\nimagePipeline.clearCaches();\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#2","title":"2. \u786c\u76d8\u7f13\u5b58","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#3-mvc","title":"3. MVC\u7ed3\u6784","text":"<pre><code>DraweeView          --  View\nDraweeController    -- Controller\nDataSource          -- Model\n</code></pre> <p>\u4f5c\u7528\uff1a DraweeView\u7528\u6765\u663e\u793a\u9876\u5c42\u89c6\u56fe\uff08getTopLevelDrawable()\uff09\u3002 DraweeController\u63a7\u5236\u52a0\u8f7d\u56fe\u7247\u7684\u914d\u7f6e\u3001\u9876\u5c42\u663e\u793a\u54ea\u4e2a\u89c6\u56fe\u4ee5\u53ca\u63a7\u5236\u4e8b\u4ef6\u7684\u5206\u53d1\u3002  DraweeHierarchy\u610f\u4e3a\u89c6\u56fe\u7684\u5c42\u6b21\u7ed3\u6784\uff0c\u7528\u6765\u5b58\u50a8\u548c\u63cf\u8ff0\u56fe\u7247\u7684\u4fe1\u606f\uff0c\u540c\u65f6\u4e5f\u5c01\u88c5\u4e86\u4e00\u4e9b\u56fe\u7247\u7684\u663e\u793a\u548c\u89c6\u56fe\u5c42\u7ea7\u7684\u65b9\u6cd5\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Fresco/#draweeholder","title":"DraweeHolder","text":"<p>DraweeHolder\u662f\u534f\u8c03DraweeView\u3001DraweeHierarchy\u3001DraweeController\u8fd9\u4e09\u4e2a\u7c7b\u4ea4\u4e92\u5de5\u4f5c\u7684\u6838\u5fc3\u7c7b\u3002</p> <p>\u53c2\u8003\uff1a * Github \u5730\u5740 * \u4e2d\u6587\u5b98\u65b9\u6587\u6863 * \u4f18\u79c0\u535a\u5ba2</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/LeakCanary/","title":"LeakCanary","text":"<p>\u4f18\u79c0\u535a\u5ba2</p> <p>LeakCanary\u5185\u5b58\u6cc4\u6f0f\u68c0\u6d4b\u673a\u5236\uff0c\u5927\u6982\u662f\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u5229\u7528 application.registerActivityLifecycleCallbacks(lifecycleCallbacks) \u6765\u76d1\u542c\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\u7684 Activity onDestoryed \u4e8b\u4ef6;</p> </li> <li> <p>\u5f53\u67d0\u4e2a Activity \u88ab destory \u540e\uff0c\u5c06\u5b83\u4f20\u7ed9 RefWatcher \u53bb\u505a\u89c2\u6d4b\uff0c\u89c2\u5bdf\u540e\u7eed\u4f1a\u88ab\u6b63\u5e38\u56de\u6536\uff1b</p> </li> <li> <p>RefWatcher \u9996\u5148\u628a Activity \u4f7f\u7528 KeyedWeakReference \u5f15\u7528\u8d77\u6765\uff0c\u5e76\u4f7f\u7528\u4e00\u4e2a ReferenceQueue \u6765\u8bb0\u5f55\u8be5 KeyedWeakReference \u6307\u5411\u7684\u5bf9\u8c61\u662f\u5426\u5df2\u88ab\u56de\u6536\uff1b</p> </li> <li> <p>AndroidWatchExecutor \u4f1a\u5728 5s \u540e\uff0c\u5f00\u59cb\u68c0\u67e5\u8fd9\u4e2a\u5f31\u5f15\u7528\u5185\u7684 Activity \u662f\u5426\u88ab\u6b63\u5e38\u56de\u6536\u3002\u5224\u65ad\u6761\u4ef6\u662f\uff1a\u82e5 Activity \u88ab\u6b63\u5e38\u56de\u6536\uff0c\u90a3\u4e48\u5f15\u7528\u5b83\u7684 KeyedWeakReference \u4f1a\u88ab\u81ea\u52a8\u653e\u5165 ReferenceQueue \u4e2d\u3002</p> </li> <li> <p>\u5224\u65ad\u65b9\u5f0f\u662f\uff1a\u5148\u770b Activity \u5bf9\u5e94\u7684 KeyedWeakReference \u662f\u5426\u5df2\u7ecf\u653e\u5165 ReferenceQueue \u4e2d\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5219\u624b\u52a8 GC\uff1agcTrigger.runGc();\uff1b\u7136\u540e\u518d\u4e00\u6b21\u5224\u65ad ReferenceQueue \u662f\u5426\u5df2\u7ecf\u542b\u6709\u5bf9\u5e94\u7684 KeyedWeakReference\u3002\u82e5\u8fd8\u672a\u88ab\u56de\u6536\uff0c\u5219\u8ba4\u4e3a\u53ef\u80fd\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\u3002</p> </li> <li> <p>\u5229\u7528 HeapAnalyzer \u5bf9 dump \u7684\u5185\u5b58\u60c5\u51b5\u8fdb\u884c\u5206\u6790\u5e76\u8fdb\u4e00\u6b65\u786e\u8ba4\uff0c\u82e5\u786e\u5b9a\u53d1\u751f\u6cc4\u6f0f\uff0c\u5219\u5229\u7528 DisplayLeakService \u53d1\u9001\u901a\u77e5\u3002</p> </li> </ol> <p>\u5bf9\u4e8e\u6700\u540e\u4e00\u6b65\u7684\u5206\u6790\u8fc7\u7a0b\uff0c\u8be6\u7ec6\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u5982\u679c\u5f15\u7528\u8fd8\u662f\u672a\u88ab\u6e05\u9664\uff0c\u628a heap \u5185\u5b58 dump \u5230\u4e00\u4e2a .hprof \u6587\u4ef6\u4e2d\uff1b</p> </li> <li> <p>\u5728\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684 HeapAnalyzerService \u6709\u4e00\u4e2a HeapAnalyzer \u4f7f\u7528HAHA \u89e3\u6790\u8fd9\u4e2a\u6587\u4ef6\uff1b</p> </li> <li> <p>\u5f97\u76ca\u4e8e\u552f\u4e00\u7684 reference key, HeapAnalyzer \u627e\u5230 KeyedWeakReference\uff0c\u5b9a\u4f4d\u5185\u5b58\u6cc4\u9732\uff1b</p> </li> <li> <p>HeapAnalyzer \u8ba1\u7b97 \u5230 GC roots \u7684\u6700\u77ed\u5f3a\u5f15\u7528\u8def\u5f84\uff0c\u5e76\u786e\u5b9a\u662f\u5426\u662f\u6cc4\u9732\u3002\u5982\u679c\u662f\u7684\u8bdd\uff0c\u5efa\u7acb\u5bfc\u81f4\u6cc4\u9732\u7684\u5f15\u7528\u94fe\uff1b</p> </li> <li> <p>\u5f15\u7528\u94fe\u4f20\u9012\u5230 APP \u8fdb\u7a0b\u4e2d\u7684 DisplayLeakService\uff0c \u5e76\u4ee5\u901a\u77e5\u7684\u5f62\u5f0f\u5c55\u793a\u51fa\u6765\u3002</p> </li> </ol> <p>LeakCanary \u4f7f\u7528\u65b9\u5f0f\uff1a</p> <pre><code>public class ExampleApplication extends Application {\n  @Override public void onCreate() {\n    super.onCreate();\n    if (LeakCanary.isInAnalyzerProcess(this)) {\n      // This process is dedicated to LeakCanary for heap analysis.\n      // You should not init your app in this process.\n      return;\n    }\n\n    // \u521d\u59cb\u5316\n    LeakCanary.install(this);\n  }\n}\n\ndependencies {\n debugCompile 'com.squareup.leakcanary:leakcanary-android:1.5.1'\n releaseCompile 'com.squareup.leakcanary:leakcanary-android-no-op:1.5.1'\n testCompile 'com.squareup.leakcanary:leakcanary-android-no-op:1.5.1'\n}\n\n</code></pre> <p>\u76f8\u5173\u51fd\u6570\uff1a</p> <pre><code>ActivityRefWatcher\n\n// LeakCanary\u7684\u521d\u59cb\u5316\u65b9\u6cd5\npublic static RefWatcher install(Application application) {\n    return refWatcher(application).listenerServiceClass(DisplayLeakService.class)\n        .excludedRefs(AndroidExcludedRefs.createAppDefaults().build())\n        .buildAndInstall();\n  }\n\n\n**AndroidRefWatcherBuilder.java**\n\n  /**\n   * Creates a {@link RefWatcher} instance and starts watching activity references \n   */\n  public RefWatcher buildAndInstall() {\n    RefWatcher refWatcher = build();\n    if (refWatcher != DISABLED) {\n      LeakCanary.enableDisplayLeakActivity(context);\n      ActivityRefWatcher.install((Application) context, refWatcher);\n    }\n    return refWatcher;\n  }\n\n\n**ActivityRefWatcher.java **\n\npublic static void install(Application application, RefWatcher refWatcher) {\n    new ActivityRefWatcher(application, refWatcher).watchActivities();\n  }\n\n    // \u76d1\u542c\u6240\u6709Activity\u751f\u547d\u5468\u671f\n  private final Application.ActivityLifecycleCallbacks lifecycleCallbacks =\n      new Application.ActivityLifecycleCallbacks() {\n        @Override public void onActivityCreated(Activity activity, Bundle savedInstanceState) {\n        }\n\n        @Override public void onActivityStarted(Activity activity) {\n        }\n\n        @Override public void onActivityResumed(Activity activity) {\n        }\n\n        @Override public void onActivityPaused(Activity activity) {\n        }\n\n        @Override public void onActivityStopped(Activity activity) {\n        }\n\n        @Override public void onActivitySaveInstanceState(Activity activity, Bundle outState) {\n        }\n\n        @Override public void onActivityDestroyed(Activity activity) {\n\n        // \u5b9e\u9645\u4e0a\u53ea\u76d1\u542conDestroy()\n          ActivityRefWatcher.this.onActivityDestroyed(activity);\n        }\n      };\n\n\n// \u4f7f\u7528RefWatcher\u76d1\u63a7Activity\n  void onActivityDestroyed(Activity activity) {\n    refWatcher.watch(activity);\n  }\n</code></pre> <p>\u5f88\u597d\u7406\u89e3\uff0c\u5f53\u4e00\u4e2aActivity\u7684onDestroy()\u6267\u884c\u540e\uff0c\u8be5Activity\u5e94\u8be5\u4e3anull\u3002\u5982\u679c\u4e0d\u4e3anull\uff0c\u8bf4\u660e\u5185\u5b58\u6cc4\u6f0f\u4e86\u3002\u6240\u4ee5\uff0c\u53ea\u9700\u8981\u5728onDestroy()\u5c06\u5f53\u524dActivity\u4e22\u7ed9RefWatcher\u76d1\u542c\u5c31\u597d\u3002</p> <pre><code>**RefWatcher.java**\n\npublic void watch(Object watchedReference, String referenceName) {\n    if (this == DISABLED) {\n      return;\n    }\n    checkNotNull(watchedReference, \"watchedReference\");\n    checkNotNull(referenceName, \"referenceName\");\n    final long watchStartNanoTime = System.nanoTime();\n\n    // \u6bcf\u4e2a\u88ab\u76d1\u63a7\u7684Activity\u90fd\u5bf9\u5e94\u751f\u6210\u4e00\u4e2aKey\n    String key = UUID.randomUUID().toString();\n\n    // \u5c06\u6240\u6709Activity\u7684key\u5b58\u50a8\u4e0b\u6765\n    retainedKeys.add(key);\n\n    // \u5c06\u4f20\u5165\u7684 Activity \u5305\u88c5\u6210\u4e86\u4e00\u4e2a KeyedWeakReference\n    final KeyedWeakReference reference =\n        new KeyedWeakReference(watchedReference, key, referenceName, queue);\n\n    ensureGoneAsync(watchStartNanoTime, reference);\n  }\n\n\nRetryable.Result ensureGone(final KeyedWeakReference reference, final long watchStartNanoTime) {\n    long gcStartNanoTime = System.nanoTime();\n    long watchDurationMs = NANOSECONDS.toMillis(gcStartNanoTime - watchStartNanoTime);\n\n    // \u628a\u5df2\u88ab\u56de\u6536\u7684\u5bf9\u8c61\u7684Key\u4eceretainedKeys\u4e2d\u79fb\u9664\uff0c\u5373ReferenceQueue\u4e2d\u7684Reference\u3002\u5269\u4e0b\u7684\u90fd\u662f\u6cc4\u6f0f\u7684Activity\u3002\n    removeWeaklyReachableReferences();\n\n    if (debuggerControl.isDebuggerAttached()) {\n      // The debugger can create false leaks.\n      return RETRY;\n    }\n\n    // \u5224\u65ad\u67d0\u4e2areference\u7684key\u662f\u5426\u4ecd\u5728 retainedKeys \u91cc\uff0c\u82e5\u4e0d\u5728\uff0c\u8868\u793a\u5df2\u56de\u6536\uff0c\u5426\u5219\u7ee7\u7eed\n    if (gone(reference)) {\n      return DONE;\n    }\n\n    // \u624b\u52a8GC\uff0c\u56de\u6536\u6240\u6709\u8d70\u5b8conDestroy()\u7684Activity\n    gcTrigger.runGc();\n\n    // \u518d\u6b21\u79fb\u9664\u88abGC\u56de\u6536\u7684Activity\n    removeWeaklyReachableReferences();\n\n    // \u5982\u679c\u8be5 reference \u8fd8\u5728 retainedKeys \u91cc\uff0c\u8868\u793a\u6cc4\u6f0f\n    if (!gone(reference)) {\n      long startDumpHeap = System.nanoTime();\n      long gcDurationMs = NANOSECONDS.toMillis(startDumpHeap - gcStartNanoTime);\n\n      // \u5229\u7528 heapDumper \u628a\u5185\u5b58\u60c5\u51b5 dump \u6210\u6587\u4ef6\n      // \u5185\u90e8\u5b9e\u73b0\u662f\u7528\u4e86JVM\u81ea\u5e26\u65b9\u6cd5\uff08Debug.dumpHprofData(filePath)\uff09\n      File heapDumpFile = heapDumper.dumpHeap();\n\n      if (heapDumpFile == RETRY_LATER) {\n        // Could not dump the heap.\n        return RETRY;\n      }\n\n      long heapDumpDurationMs = NANOSECONDS.toMillis(System.nanoTime() - startDumpHeap);\n\n      // \u8c03\u7528 heapdumpListener \u8fdb\u884c\u5185\u5b58\u5206\u6790\uff0c\u8fdb\u4e00\u6b65\u786e\u8ba4\u662f\u5426\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\u3002\u5982\u679c\u786e\u8ba4\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f\uff0c\u8c03\u7528 DisplayLeakService \u53d1\u9001\u901a\u77e5\u3002\n\n      heapdumpListener.analyze(\n          new HeapDump(heapDumpFile, reference.key, reference.name, excludedRefs, watchDurationMs,\n              gcDurationMs, heapDumpDurationMs));\n    }\n    return DONE;\n  }\n</code></pre> <p>\u89e3\u91ca\u4e0b\u5f15\u7528\u961f\u5217(ReferenceQueue)\u7684\u4f5c\u7528\uff1a</p> <p>\u5bf9Activity\u4f7f\u7528\u5f31\u5f15\u7528\uff0cWeakReference reference = new WeakReference(activity)\u3002\u5f53GC\u626b\u63cf\u5230\u8be5\u5f31\u5f15\u7528\u65f6\uff0c\u8be5Activity\u5c31\u4f1a\u88ab\u56de\u6536\uff0creference\u4f1a\u88ab\u653e\u5165\u5185\u90e8\u7684ReferenceQueue\u4e2d\u3002 <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u4eceReferenceQueue\u4e2d\u53d6\u51fa\u6765\u7684\u6240\u6709Reference\u90fd\u662f\u88ab\u56de\u6536\u7684\u3002</p> <p>\u56de\u5230\u4e0a\u9762\u4ee3\u7801\uff0c\u6240\u6709\u88ab\u76d1\u63a7\u7684Activity\u5bf9\u5e94\u7684Key\uff0c\u90fd\u88ab\u5b58\u50a8\u5230retainedKeys\u4e2d\u3002\u53ea\u8981\u628aReferenceQueue\u4e2d\u6240\u6709\u7684 reference \u53d6\u51fa\u6765\uff0c\u5e76\u628a\u5bf9\u5e94 retainedKeys \u91cc\u7684 key \u79fb\u9664\uff0c\u5269\u4e0b\u7684 key \u5bf9\u5e94\u7684\u5bf9\u8c61\u90fd\u6ca1\u6709\u88ab\u56de\u6536\u3002</p> <p>\u540e\u7eed\u6267\u884c\u6d41\u7a0b\u65b9\u6cd5\u6ce8\u91ca\u4e2d\u5df2\u5199\u51fa\u3002</p> <pre><code>ServiceHeapDumpListener.java\n\n@Override \npublic void analyze(HeapDump heapDump) {\n    checkNotNull(heapDump, \"heapDump\");\n\n    // \u5728\u76d1\u542c\u5668\u4e2d\u4f7f\u7528HeapAnalyzerService(\u72ec\u7acb\u7ebf\u7a0b\uff0c\u7ee7\u627fIntentService)\u5206\u6790\u5185\u5b58\u6cc4\u6f0f\u60c5\u51b5\n    HeapAnalyzerService.runAnalysis(context, heapDump, listenerServiceClass);\n  }\n</code></pre> <p>\u5f00\u542f\u72ec\u7acb\u8fdb\u7a0b\uff0c\u5206\u6790\u5185\u5b58\u6cc4\u6f0f\uff1a</p> <pre><code>/**\n * This service runs in a separate process to avoid slowing down the app process or  making it run out of memory.\n */\n\npublic final class HeapAnalyzerService extends IntentService {\n\n  private static final String LISTENER_CLASS_EXTRA = \"listener_class_extra\";\n  private static final String HEAPDUMP_EXTRA = \"heapdump_extra\";\n\n  public static void runAnalysis(Context context, HeapDump heapDump,\n      Class&lt;? extends AbstractAnalysisResultService&gt; listenerServiceClass) {\n    Intent intent = new Intent(context, HeapAnalyzerService.class);\n    intent.putExtra(LISTENER_CLASS_EXTRA, listenerServiceClass.getName());\n    intent.putExtra(HEAPDUMP_EXTRA, heapDump);\n    context.startService(intent);\n  }\n\n\n  @Override protected void onHandleIntent(Intent intent) {\n    if (intent == null) {\n      CanaryLog.d(\"HeapAnalyzerService received a null intent, ignoring.\");\n      return;\n    }\n\n    String listenerClassName = intent.getStringExtra(LISTENER_CLASS_EXTRA);\n    HeapDump heapDump = (HeapDump) intent.getSerializableExtra(HEAPDUMP_EXTRA);\n\n    HeapAnalyzer heapAnalyzer = new HeapAnalyzer(heapDump.excludedRefs);\n\n    // \u5185\u90e8\u4f7f\u7528 HaHa \u89e3\u6790hprof\u6587\u4ef6\n    AnalysisResult result = heapAnalyzer.checkForLeak(heapDump.heapDumpFile, heapDump.referenceKey);\n\n    // \u4f7f\u7528DisplayLeakService\u5c55\u793a\u5f15\u7528\u94fe\u3002\u4e0b\u9762\u4f1a\u8bb2\u5230\u53c2\u6570 listenerClassName \u7684\u4f5c\u7528\n    AbstractAnalysisResultService.sendResultToListener(this, listenerClassName, heapDump, result);\n  }\n}\n\nAndroidManifest.xml\n\n &lt;service\n        android:name=\".internal.HeapAnalyzerService\"\n        android:process=\":leakcanary\" // Service\u5904\u4e8e\u5e94\u7528\u79c1\u6709\u7684\u72ec\u7acb\u8fdb\u7a0b\u4e2d\n        android:enabled=\"false\"\n        /&gt;\n\n</code></pre> <p>\u5148\u4e86\u89e3\u4e0b\u5982\u4f55\u8ba9Service\u5904\u4e8e\u72ec\u7acb\u7684\u8fdb\u7a0b\uff1a</p> <pre><code>\u5728AndroidManifest\u4e2d\u58f0\u660eService\n1. \u5f53android:process=\".servicePublic\"\uff0c\u5c31\u662f\u4e3a\u6b64\u670d\u52a1\u5f00\u542f\u4e86\u4e00\u4e2a\u5168\u5c40\u7684\u72ec\u7acb\u8fdb\u7a0b\u3002\n2. \u5f53android:process=\":servicePrivate\"\uff0c\u5c31\u662f\u4e3a\u6b64\u5e94\u7528\u5f00\u542f\u4e86\u4e00\u4e2a\u79c1\u6709\u7684\u72ec\u7acb\u8fdb\u7a0b\u3002\n</code></pre> <p>\u6240\u4ee5\uff0c\u4eceHeapAnalyzerService\u7684\u6ce8\u518c\u65b9\u5f0f\uff0c\u5c31\u77e5\u9053\u5b83\u5904\u4e8e\u72ec\u7acb\u8fdb\u7a0b\u3002</p> <p>\u4f7f\u7528HeapAnalyzer\u8ba1\u7b97\u6cc4\u6f0f\u7684\u5bf9\u8c61\u5230GC roots \u7684\u6700\u77ed\u5f3a\u5f15\u7528\u8def\u5f84\u3002</p> <pre><code>HeapAnalyzer.java \n\n/**\n   * Searches the heap dump for a {@link KeyedWeakReference} instance with the corresponding key,\n   * and then computes the shortest strong reference path from that instance to the GC roots.\n   */\n\n  public AnalysisResult checkForLeak(File heapDumpFile, String referenceKey) {\n    long analysisStartNanoTime = System.nanoTime();\n\n    if (!heapDumpFile.exists()) {\n      Exception exception = new IllegalArgumentException(\"File does not exist: \" + heapDumpFile);\n      return failure(exception, since(analysisStartNanoTime));\n    }\n\n    try {\n      // \u4f7f\u7528 HAHA \u89e3\u6790dump\u6587\u4ef6\n      HprofBuffer buffer = new MemoryMappedFileBuffer(heapDumpFile);\n      HprofParser parser = new HprofParser(buffer);\n      Snapshot snapshot = parser.parse();\n      deduplicateGcRoots(snapshot);\n\n      Instance leakingRef = findLeakingReference(referenceKey, snapshot);\n\n      // False alarm, weak reference was cleared in between key check and heap dump.\n      if (leakingRef == null) {\n        return noLeak(since(analysisStartNanoTime));\n      }\n\n      // \u83b7\u53d6\u6cc4\u6f0f\u7684\u5bf9\u8c61\u5230GC Roots \u7684\u6700\u77ed\u5f3a\u5f15\u7528\u8def\u5f84\n      return findLeakTrace(analysisStartNanoTime, snapshot, leakingRef);\n    } catch (Throwable e) {\n      return failure(e, since(analysisStartNanoTime));\n    }\n  }\n\nprivate AnalysisResult findLeakTrace(long analysisStartNanoTime, Snapshot snapshot,\n      Instance leakingRef) {\n\n    ShortestPathFinder pathFinder = new ShortestPathFinder(excludedRefs);\n    ShortestPathFinder.Result result = pathFinder.findPath(snapshot, leakingRef);\n\n    // False alarm, no strong reference path to GC Roots.\n    if (result.leakingNode == null) {\n      return noLeak(since(analysisStartNanoTime));\n    }\n\n    LeakTrace leakTrace = buildLeakTrace(result.leakingNode);\n\n    String className = leakingRef.getClassObj().getClassName();\n\n    // Side effect: computes retained size.\n    snapshot.computeDominators();\n\n    Instance leakingInstance = result.leakingNode.instance;\n\n    long retainedSize = leakingInstance.getTotalRetainedSize();\n\n    // TODO: check O sources and see what happened to android.graphics.Bitmap.mBuffer\n    if (SDK_INT &lt;= N_MR1) {\n      retainedSize += computeIgnoredBitmapRetainedSize(snapshot, leakingInstance);\n    }\n\n    return leakDetected(result.excludingKnownLeaks, className, leakTrace, retainedSize,\n        since(analysisStartNanoTime));\n  }\n\n</code></pre> <p>\u5176\u4e2d\uff0cLeakTrace\u7684\u5b98\u65b9\u89e3\u91ca\uff1a\uff08\u6700\u77ed\u5f3a\u5f15\u7528\u8def\u5f84\u7684\u94fe\u5f0f\u7ed3\u6784\uff09</p> <p>A chain of references that constitute the shortest strong reference path from a leaking instance to the GC roots. Fixing the leak usually means breaking one of the references in that chain.</p> <p>\u4f7f\u7528DisplayLeakService\u5c55\u793a\u5f15\u7528\u94fe\uff1a</p> <pre><code>public abstract class AbstractAnalysisResultService extends IntentService {\n\n  public static void sendResultToListener(Context context, String listenerServiceClassName,\n      HeapDump heapDump, AnalysisResult result) {\n    Class&lt;?&gt; listenerServiceClass;\n    try {\n      listenerServiceClass = Class.forName(listenerServiceClassName);\n    } catch (ClassNotFoundException e) {\n      throw new RuntimeException(e);\n    }\n\n    // \u4e0a\u9762\u8bf4\u5230listenerClassName\uff0c\u5c31\u662f\u88ab\u542f\u52a8\u7684Service\u3002\u90a3listenerClassName\u503c\u662f\u4ec0\u4e48\u5462\uff1f\n\n    Intent intent = new Intent(context, listenerServiceClass);\n    intent.putExtra(HEAP_DUMP_EXTRA, heapDump);\n    intent.putExtra(RESULT_EXTRA, result);\n    context.startService(intent);\n  }\n\n}\n</code></pre> <p>listenerClassName \u662f\u5728 LeakCanary.install() \u4e2d\u5b9a\u4e49\u7684\uff0c\u5c31\u662fDisplayLeakService\uff1a</p> <pre><code>LeakCanary.java \n\npublic static RefWatcher install(Application application) {\n    return refWatcher(application).listenerServiceClass(DisplayLeakService.class)\n        .excludedRefs(AndroidExcludedRefs.createAppDefaults().build())\n        .buildAndInstall();\n  }\n</code></pre> <p>\u81f3\u6b64\uff0cLeakCanary\u5c31\u89e3\u91ca\u7684\u5dee\u4e0d\u591a\u4e86\u3002\u5de5\u4f5c\u5927\u6982\u6d41\u7a0b\u5728\u6587\u521d\u5df2\u7ecf\u7ed9\u51fa\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/","title":"OkHttp","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#okhttp_1","title":"\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528OkHttp","text":"<ul> <li>OkHttp \u63d0\u4f9b\u4e86\u5bf9\u6700\u65b0\u7684 HTTP \u534f\u8bae\u7248\u672c HTTP/2 \u548c SPDY \u7684\u652f\u6301\uff0c\u8fd9 \u4f7f\u5f97\u5bf9\u540c\u4e00\u4e2a\u4e3b\u673a\u53d1\u51fa\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u53ef\u4ee5\u5171\u4eab\u76f8\u540c\u7684\u5957\u63a5\u5b57\u8fde\u63a5\u3002</li> <li>\u5982\u679c HTTP/2 \u548c SPDY \u4e0d\u53ef\u7528\uff0cOkHttp \u4f1a\u4f7f\u7528\u8fde\u63a5\u6c60\u6765\u590d\u7528\u8fde\u63a5\u4ee5\u63d0\u9ad8\u6548\u7387\u3002</li> <li>OkHttp \u63d0\u4f9b\u4e86\u5bf9 GZIP \u7684\u9ed8\u8ba4\u652f\u6301\u6765\u964d\u4f4e\u4f20\u8f93\u5185\u5bb9\u7684\u5927\u5c0f\u3002</li> <li>OkHttp \u4e5f\u63d0\u4f9b\u4e86\u5bf9 HTTP \u54cd\u5e94\u7684\u7f13\u5b58\u673a\u5236\uff0c\u53ef\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u7f51\u7edc\u8bf7 \u6c42\u3002</li> <li>\u5f53\u7f51\u7edc\u51fa\u73b0\u95ee\u9898\u65f6\uff0cOkHttp \u4f1a\u81ea\u52a8\u91cd\u8bd5\u4e00\u4e2a\u4e3b\u673a\u7684\u591a\u4e2a IP \u5730\u5740\u3002</li> </ul>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#okhttp_2","title":"OkHttp\u6709\u54ea\u4e9b\u7528\u6cd5","text":"<p>GET\u3001POST \u8bf7\u6c42\u3001\u4e0a\u4f20\u6587\u4ef6\u3001\u4e0a\u4f20\u8868\u5355\u7b49\u7b49\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#okhttp_3","title":"OkHttp\u6838\u5fc3\u5b9e\u73b0\u539f\u7406\u662f\u4ec0\u4e48","text":"<p>OkHttp \u5185\u90e8\u7684\u8bf7\u6c42\u6d41\u7a0b:\u4f7f\u7528 OkHttp \u4f1a\u5728\u8bf7\u6c42\u7684\u65f6\u5019\u521d\u59cb\u5316\u4e00\u4e2a Call \u7684\u5b9e\u4f8b\uff0c \u7136\u540e\u6267\u884c\u5b83\u7684 execute()\u65b9\u6cd5\u6216 enqueue()\u65b9\u6cd5\uff0c\u5185\u90e8\u6700\u540e\u90fd\u4f1a\u6267\u884c\u5230 getResponseWithInterceptorChain()\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u91cc\u9762\u901a\u8fc7\u62e6\u622a\u5668\u7ec4\u6210\u7684\u8d23\u4efb\u94fe\uff0c\u4f9d\u6b21\u7ecf\u8fc7\u7528\u6237\u81ea\u5b9a\u4e49\u666e\u901a\u62e6\u622a\u5668\u3001\u91cd\u8bd5\u62e6\u622a\u5668\u3001\u6865\u63a5\u62e6\u622a\u5668\u3001\u7f13\u5b58\u62e6\u622a\u5668\u3001 \u8fde\u63a5\u62e6\u622a\u5668\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u7edc\u62e6\u622a\u5668\u4ee5\u53ca\u8bbf\u95ee\u670d\u52a1\u5668\u62e6\u622a\u5668\u7b49\u62e6\u622a\u5904\u7406\u8fc7\u7a0b\uff0c\u6765 \u83b7\u53d6\u5230\u4e00\u4e2a\u54cd\u5e94\u5e76\u4ea4\u7ed9\u7528\u6237\u3002\u5176\u4e2d\uff0c\u9664\u4e86 OKHttp \u7684\u5185\u90e8\u8bf7\u6c42\u6d41\u7a0b\u8fd9\u70b9\u4e4b\u5916\uff0c\u7f13\u5b58\u548c\u8fde\u63a5\u8fd9\u4e24\u90e8\u5206\u5185\u5bb9\u4e5f\u662f\u4e24\u4e2a\u5f88\u91cd\u8981\u7684\u70b9\u3002</p> <ul> <li>Interceptors:\u7528\u6237\u81ea\u5b9a\u4e49\u62e6\u622a\u5668</li> <li>retryAndFollowUpInterceptor:\u8d1f\u8d23\u5931\u8d25\u91cd\u8bd5\u4ee5\u53ca\u91cd\u5b9a\u5411</li> <li>BridgeInterceptor:\u8bf7\u6c42\u65f6\uff0c\u5bf9\u5fc5\u8981\u7684 Header \u8fdb\u884c\u4e00\u4e9b\u6dfb\u52a0\uff0c\u63a5\u6536\u54cd\u5e94 \u65f6\uff0c\u79fb\u9664\u5fc5\u8981\u7684 Header</li> <li>CacheInterceptor: \u8d1f\u8d23\u8bfb\u53d6\u7f13\u5b58\u76f4\u63a5\u8fd4\u56de(\u6839\u636e\u8bf7\u6c42\u7684\u4fe1\u606f\u548c\u7f13\u5b58\u7684\u54cd \u5e94\u7684\u4fe1\u606f\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728\u7f13\u5b58\u53ef\u7528)\u3001\u66f4\u65b0\u7f13\u5b58</li> <li>ConnectInterceptor:\u8d1f\u8d23\u548c\u670d\u52a1\u5668\u5efa\u7acb\u8fde\u63a5</li> <li>NetworkInterceptors:\u7528\u6237\u5b9a\u4e49\u7f51\u7edc\u62e6\u622a\u5668</li> <li>CallServerInterceptor:\u8d1f\u8d23\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u6570\u636e\u3001\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u54cd\u5e94\u6570\u636e</li> </ul>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#connectionpool","title":"ConnectionPool","text":"<ol> <li>\u5224\u65ad\u8fde\u63a5\u662f\u5426\u53ef\u7528\uff0c\u4e0d\u53ef\u7528\u5219\u4ece ConnectionPool \u83b7\u53d6\u8fde\u63a5\uff0cConnectionPool \u65e0\u8fde\u63a5\uff0c\u521b\u5efa\u65b0\u8fde\u63a5\uff0c\u63e1\u624b\uff0c\u653e\u5165 ConnectionPool\u3002</li> <li>\u5b83\u662f\u4e00\u4e2a Deque\uff0cadd \u6dfb\u52a0 Connection\uff0c\u4f7f\u7528\u7ebf\u7a0b\u6c60\u8d1f\u8d23\u5b9a\u65f6\u6e05\u7406\u7f13\u5b58\u3002 </li> <li>\u4f7f\u7528\u8fde\u63a5\u590d\u7528\u7701\u53bb\u4e86\u8fdb\u884c TCP \u548c TLS \u63e1\u624b\u7684\u4e00\u4e2a\u8fc7\u7a0b</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#_1","title":"\u4ece\u8fd9\u4e2a\u5e93\u4e2d\u5b66\u5230\u4ec0\u4e48\u6709\u4ef7\u503c\u7684\u6216\u8005\u8bf4\u53ef\u501f\u9274\u7684\u8bbe\u8ba1\u601d\u60f3","text":"<p>\u4f7f\u7528\u8d23\u4efb\u94fe\u6a21\u5f0f\u5b9e\u73b0\u62e6\u622a\u5668\u7684\u5206\u5c42\u8bbe\u8ba1\uff0c\u6bcf\u4e00\u4e2a\u62e6\u622a\u5668\u5bf9\u5e94\u4e00\u4e2a\u529f\u80fd\uff0c\u5145\u5206\u5b9e\u73b0 \u4e86\u529f\u80fd\u89e3\u8026\uff0c\u6613\u7ef4\u62a4\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#_2","title":"\u624b\u5199\u62e6\u622a\u5668","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#okhttp_4","title":"\u5982\u4f55\u7406\u89e3OkHttp","text":"<ol> <li> <p>\u5229\u7528 okhttp \u5b9e\u73b0\u57fa\u672c\u7684\u7f51\u7edc\u8bbf\u95ee\u529f\u80fd\uff0c\u5305\u62ec\u57fa\u672c\u7684\u6570\u636e\u8bf7\u6c42\uff0c\u8868\u5355\u63d0\u4ea4\uff0c\u6587\u4ef6\u4e0a\u4f20\uff0c\u6587\u4ef6\u65ad\u70b9\u4e0b\u8f7d\uff0chttps\u7684\u8bbe\u7f6e\u7b49\u7b49\u3002</p> </li> <li> <p>\u6df1\u5165\u7814\u7a76 okhttp \u6e90\u7801\uff0c\u719f\u6089 okhttp \u4e2d\u7684\u8c03\u7528\u8fc7\u7a0b\uff0c\u62e6\u622a\u5668\u539f\u7406\uff0c\u7f13\u5b58\u539f\u7406\u4ee5\u53ca\u5176\u4e2d\u6d89\u53ca\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5e76\u53ef\u4ee5\u81ea\u5b9a\u4e49\u62e6\u622a\u5668\u5b9e\u73b0\u7279\u6b8a\u7684\u529f\u80fd\uff0c\u5982\u65e5\u5fd7\u6253\u5370\u7b49\u7b49\u3002</p> </li> <li> <p>\u5728\u7814\u7a76 okhttp \u7f13\u5b58\u539f\u7406\u4e4b\u524d\uff0c\u5f97\u9996\u5148\u719f\u6089 http \u7f13\u5b58\u7684\u76f8\u5173\u5b57\u6bb5\u4ee5\u53ca\u5728\u8bbe\u7f6e https \u65f6\uff0c\u4e5f\u8981\u5168\u9762\u590d\u4e60 https \u7684\u76f8\u5173\u539f\u7406\u3002</p> </li> <li> <p>\u600e\u4e48\u5b9e\u73b0\u591a\u8def\u590d\u7528\u7684\uff08\u8fd9\u4e2a\u4e3b\u8981\u4ecehttps\u5b9e\u73b0\u591a\u8def\u590d\u7528\u7684\u539f\u7406\u4e0a\u8c08\uff0c\u7528\u4e86\u4e8c\u8fdb\u5236\u5206\u5e27\uff0c\u90a3OKHttp\u5176\u5b9e\u5c31\u662f\u6309\u7167\u5206\u5e27\u6765\u8bfb\u53d6\u7684\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u76f8\u5173\u6e90\u7801\u3002\uff09</p> </li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/OKHTTP/#_3","title":"\u95ee\u9898","text":"<ol> <li>\u7ebf\u7a0b\u6c60\u5982\u4f55\u4f18\u5316\u7684</li> <li> <p>\u7f13\u5b58\u600e\u4e48\u505a\u7684</p> </li> <li> <p>Interceptors</p> </li> <li>\u8d23\u4efb\u94fe\u8bbe\u8ba1\u6a21\u5f0f</li> </ol> <pre><code>RealCall.java\n\n\u4f7f\u7528\u8d23\u4efb\u94fe\u6a21\u5f0f\uff0c\u5904\u7406\u4e00\u7cfb\u5217\u62e6\u622a\u5668\n\nResponse getResponseWithInterceptorChain() throws IOException {\n    // Build a full stack of interceptors.\n    List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;();\n    interceptors.addAll(client.interceptors());\n    interceptors.add(retryAndFollowUpInterceptor);\n    interceptors.add(new BridgeInterceptor(client.cookieJar()));\n    interceptors.add(new CacheInterceptor(client.internalCache()));\n    interceptors.add(new ConnectInterceptor(client));\n    if (!forWebSocket) {\n      interceptors.addAll(client.networkInterceptors());\n    }\n    interceptors.add(new CallServerInterceptor(forWebSocket));\n\n    Interceptor.Chain chain = new RealInterceptorChain(\n        interceptors, null, null, null, 0, originalRequest);\n    return chain.proceed(originalRequest);\n  }\n\n\n\nRealInterceptorChain.java\n\n  public Response proceed(Request request, StreamAllocation streamAllocation, HttpCodec httpCodec,\n      Connection connection) throws IOException {\n    if (index &gt;= interceptors.size()) throw new AssertionError();\n\n    calls++;\n\n    ... //\u5b89\u5168\u68c0\u67e5\n\n    // Call the next interceptor in the chain.\n    RealInterceptorChain next = new RealInterceptorChain(\n        interceptors, streamAllocation, httpCodec, connection, index + 1, request);\n    Interceptor interceptor = interceptors.get(index);\n    Response response = interceptor.intercept(next);\n\n    ... //\u5b89\u5168\u68c0\u67e5\n\n    return response;\n  }\n</code></pre> <p>\u4f60\u731c\u4e00\u4e2aTCP\u8fde\u63a5\u4e0a\u9762\u80fd\u53d1\u591a\u5c11\u4e2aHTTP\u8bf7\u6c42 OkHttp\u76f8\u5173</p> <p>\u62c6OkHttp</p> <p>OkHttp\u91cc\u7684\u8bbe\u8ba1\u6a21\u5f0f OkHttp\u7684\u6e90\u7801\u8fc7\u7a0b OkHttp\u7684\u7cfb\u5217\u6587\u7ae0</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/Retrofit/","title":"Retrofit","text":"<p>\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\uff0c\u5c06@Get/@Post\u7b49IO\u76f8\u5173\u7684\u6ce8\u89e3\u65b9\u6cd5\uff0c\u4ee3\u7406\u6210OkHttpCall\uff0c\u5185\u90e8\u5b9e\u73b0\u7f51\u7edc\u8bf7\u6c42\u3002</p> <p>Retrofit CreateApi\u5b9e\u73b0\u539f\u7406</p> <p>Retrofit \u5982\u4f55\u5b9e\u73b0\u6587\u4ef6\uff08\u6216\u56fe\u7247\u4e0a\u4f20\uff09\u63a5\u53e3\u662f\u5982\u4f55\u5b9a\u4e49\u7684</p> <p>\u5927\u610f\u8981\u56de\u7b54multipart/form-data \u6587\u4ef6\u4e0a\u4f20\u8868\u5355\u4e2d \u5b83\u4f1a\u5c06\u8868\u5355\u7684\u6570\u636e\u5904\u7406\u4e3a\u4e00\u6761\u6d88\u606f\uff0c\u4ee5\u6807\u7b7e\u4e3a\u5355\u5143\uff0c\u7528\u5206\u9694\u7b26\u5206\u5f00\u3002\u65e2\u53ef\u4ee5\u4e0a\u4f20\u952e\u503c\u5bf9\uff0c\u4e5f\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6\u3002\u5f53\u4e0a\u4f20\u7684\u5b57\u6bb5\u662f\u6587\u4ef6\u65f6\uff0c\u4f1a\u6709Content-Type\u6765\u8868\u540d\u6587\u4ef6\u7c7b\u578b\uff1bcontent-disposition\uff0c\u7528\u6765\u8bf4\u660e\u5b57\u6bb5\u7684\u4e00\u4e9b\u4fe1\u606f\uff1b \u7531\u4e8e\u6709boundary\u9694\u79bb\uff0c\u6240\u4ee5multipart/form-data\u65e2\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u4e0a\u4f20\u952e\u503c\u5bf9\uff0c\u5b83\u91c7\u7528\u4e86\u952e\u503c\u5bf9\u7684\u65b9\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6\u3002</p> <p>Retrofit+Okhttp+Rxjava\u5728\u534e\u4e3a\u7684\u597d\u591a\u624b\u673a\u4f1aOOM\u662f\u7531\u7ebf\u7a0b\u6570\u6ea2\u51fa\u5f15\u8d77\u5982\u4f55\u89e3\u51b3</p> <p>\u5728Android7.0\u53ca\u4ee5\u4e0a\u7684\u534e\u4e3a\u624b\u673a\uff08EmotionUI_5.0\u53ca\u4ee5\u4e0a\uff09\u7684\u624b\u673a\u4ea7\u751fOOM\uff0c\u8fd9\u4e9b\u624b\u673a\u7684\u7ebf\u7a0b\u6570\u9650\u5236\u90fd\u5f88\u5c0f(\u5e94\u8be5\u662f\u534e\u4e3arom\u7279\u610f\u4fee\u6539\u7684limits)\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u53ea\u5141\u8bb8\u6700\u5927\u540c\u65f6\u5f00500\u4e2a\u7ebf\u7a0b\u3002\u89e3\u51b3\u65b9\u6cd5\u5c3d\u91cf\u4e0d\u8981\u91cd\u590d\u521b\u5efaretrofit \u548cOkhttp\u7684\u5b9e\u4f8b\uff0c\u624b\u52a8\u8bbe\u7f6eokhttp \u6700\u5927\u7a7a\u95f2\u8fde\u63a5\u6570\u91cf\uff0c\u5e76\u51cf\u5c11keep-alive\u65f6\u95f4 \u5982 ConnectionPool pool = new ConnectionPool(5, 10000, TimeUnit.MILLISECONDS);</p> <p>OkHttpClient client = new OkHttpClient.Builder() .connectionPool(pool) .build();</p> <p>RxJava+Retrofit\u8fdb\u884c\u7f51\u7edc\u8bf7\u6c42; Header\u91cc\u5982\u4f55\u6dfb\u52a0\u901a\u7528\u53c2\u6570\uff0c Response\u91cc\u5982\u4f55\u89e3\u6790\uff0c\u53ea\u8fd4\u56de\u4e1a\u52a1\u5c42result\uff0c\u4e0d\u9700\u8981\u6bcf\u4e2aBean\u90fd\u6709code ?</p> <p>\u95ee\u9898\u4e00\uff1a Header\u91cc\u5982\u4f55\u6dfb\u52a0\u901a\u7528\u53c2\u6570\uff0c\u5982\u679c\u662f\u81ea\u5df1\u5c01\u88c5\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u5728\u5c01\u88c5Request\u4e2d\u53ef\u4ee5\u89e3\u51b3\uff0c\u4e5f\u53ef\u4ee5\u589e\u52a0\u62e6\u622a\u5668\uff0c\u901a\u8fc7\u62e6\u622a\u5668\u53bb\u505a\u3002</p> <p>\u95ee\u9898\u4e8c\uff1a Retrofit\u4e2d\u901a\u8fc7addConverterFactory\u6765\u81ea\u5b9a\u4e49\u4e00\u4e2aConvert\u7c7b\uff0c\u5728convert\u65b9\u6cd5\u91cc\u9762\u505a\u8f6c\u6362\u3002</p> <p>\u62c6\u8f6e\u5b50\u7cfb\u5217\uff1a\u62c6 Retrofit</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/RxJava/","title":"RxJava","text":"<p>RxJava \u662f\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u5207\u6362\u7684\uff08\u4e0a\uff09</p> <p>RxJava \u662f\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u5207\u6362\u7684\uff08\u4e0b\uff09</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/RxJava/#rxjavamapflatmapconcatmapbuffer","title":"RxJava\u53d8\u6362\u64cd\u4f5c\u7b26map,flatMap,concatMap,buffer","text":"<ul> <li>map\uff1a\u3010\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u3011\u5c06\u88ab\u89c2\u5bdf\u8005\u53d1\u9001\u7684\u4e8b\u4ef6\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b\u7684\u4e8b\u4ef6</li> <li>flatMap\uff1a\u3010\u5316\u89e3\u5faa\u73af\u5d4c\u5957\u548c\u63a5\u53e3\u5d4c\u5957\u3011\u5c06\u88ab\u89c2\u5bdf\u8005\u53d1\u9001\u7684\u4e8b\u4ef6\u5e8f\u5217\u8fdb\u884c\u62c6\u5206 &amp; \u8f6c\u6362 \u540e\u5408\u5e76\u6210\u4e00\u4e2a\u65b0\u7684\u4e8b\u4ef6\u5e8f\u5217\uff0c\u6700\u540e\u518d\u8fdb\u884c\u53d1\u9001</li> <li>concatMap\uff1a\u3010\u6709\u5e8f\u3011\u4e0e flatMap \u7684 \u533a\u522b\u5728\u4e8e\uff0c\u62c6\u5206 &amp; \u91cd\u65b0\u5408\u5e76\u751f\u6210\u7684\u4e8b\u4ef6\u5e8f\u5217 \u7684\u987a\u5e8f\u4e0e\u88ab\u89c2\u5bdf\u8005\u65e7\u5e8f\u5217\u751f\u4ea7\u7684\u987a\u5e8f\u4e00\u81f4</li> <li>flatMapIterable\uff1a\u76f8\u5f53\u4e8e\u5bf9 flatMap \u7684\u6570\u636e\u8fdb\u884c\u4e86\u4e8c\u6b21\u6241\u5e73\u5316</li> <li>buffer\uff1a\u5b9a\u671f\u4ece\u88ab\u89c2\u5bdf\u8005\u53d1\u9001\u7684\u4e8b\u4ef6\u4e2d\u83b7\u53d6\u4e00\u5b9a\u6570\u91cf\u7684\u4e8b\u4ef6\u5e76\u653e\u5230\u7f13\u5b58\u533a\u4e2d\uff0c\u7136\u540e\u628a\u8fd9\u4e9b\u6570\u636e\u96c6\u5408\u6253\u5305\u53d1\u5c04</li> <li>flatMapMaybe</li> </ul> <p>The map operator creates a new Observable that emits items that have been converted from items emitted by the source Observable. The map operator would allow us, for example, to turn an Observable that emits Storys into an Observable that emits the titles of those Storys.</p> <p>link</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/RxJava%E7%9B%B8%E5%85%B3%E6%96%87%E7%AB%A0/","title":"RxJava\u76f8\u5173\u6587\u7ae0","text":"<p>\u4e4b\u524d\u5728\u9879\u76ee\u4e2d\u901a\u8fc7\u76d1\u542c RecyclerView \u7684scrollEvents\u6765\u5224\u65ad\u662f\u5426\u9700\u8981\u53bb\u52a0\u8f7d\u66f4\u591a\u3002</p> <p>\u56e0\u4e3a\u6211\u4eec\u5728RecyclerView\u6ed1\u52a8\u7684\u65f6\u5019\u6765\u5224\u65ad\u662f\u5426\u9700\u8981\u52a0\u8f7d\u66f4\u591a\u7684\uff0c\u8fd9\u4e2a\u65f6\u5019scrollEvents\u8fd9\u8fb9\u4f1a\u4e00\u76f4\u4f1a\u6709\u56de\u8c03\uff0c\u6240\u4ee5\u4e3a\u4e86\u9632\u6b62\u5728\u5f31\u7f51\u4e0b\u4f1a\u51fa\u73b0\u591a\u6b21\u8bf7\u6c42\u7684\u60c5\u51b5\uff0c\u9879\u76ee\u4e2d\u7279\u5730\u52a0\u4e86\u4e00\u4e2aisLoading\u7684flag\u6765\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\u7684\u53d1\u751f\u3002</p> <pre><code>fun loadMore(remainCount: Int = 6,loadFinish: () -&gt; Boolean):Observable&lt;PagingState&gt; {\n    scrollEvents()\n            .filter { loadFinish() }\n            .map {\n                var realRemainCount = 0\n                if (layoutManager is StaggeredGridLayoutManager) {\n                    (layoutManager as StaggeredGridLayoutManager).let {\n                        val last = IntArray(it.spanCount)\n                        it.findLastVisibleItemPositions(last)\n                        realRemainCount = it.itemCount - last.last()\n                    }\n                }\n                if (layoutManager is LinearLayoutManager) {\n                    (layoutManager as LinearLayoutManager).let {\n                        realRemainCount = it.itemCount - it.findLastVisibleItemPosition()\n                    }\n                }\n\n                when {\n                    realRemainCount == 1 -&gt; {\n                        PagingState.END\n                    }\n                    realRemainCount &lt;= remainCount -&gt; {\n                        PagingState.PAGING\n                    }\n                    else -&gt; PagingState.OTHERS\n                }\n            }\n}\n\nloadMore(){\n    isLoading\n}.subcribe({\n    //\u8fd9\u4e2a\u65f6\u5019\u662f\u7f51\u7edc\u8bf7\u6c42\uff0c\u5728doOnSubscribe\u7684\u65f6\u5019\u4f1aisLoading\u8bbe\u7f6e\u4e3atrue\uff0c\u5728doOnTerminal\u7684\u65f6\u5019\u4f1a\u518d\u5c06isLoading\u8bbe\u7f6e\u4e3afalse\u3002\n    loadMoreAction()\n},{})\n\n</code></pre> <p>\u4f46\u662f\u4e4b\u524d\u5728\u89e3\u5176\u4ed6bug\u7684\u65f6\u5019\u6211\u5728scrollEvents\u7684subscribe\u4e4b\u524d\u5207\u4e86\u4e2a\u7ebf\u7a0b\uff0c\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>loadMore(){\n    isLoading\n}.observeOn(AndroidSchedulers.mainThread())\n.subcribe({\n    loadMoreAction()\n},{})\n\n</code></pre> <p>\u4f46\u662f\u8fd9\u4e4b\u540e\u6709\u7528\u6237\u53cd\u9988feed\u91cc\u51fa\u73b0\u4e86\u91cd\u590d\u7684\u7b14\u8bb0\uff0c\u901a\u8fc7log\u53d1\u73b0\u662f\u7528\u6237\u5728\u5f53\u65f6\u89e6\u53d1\u4e86\u4e24\u6b21\u4e00\u6a21\u4e00\u6837\u7684\u52a0\u8f7d\u66f4\u591a\u7684\u8bf7\u6c42\u3002</p> <p>\u6240\u4ee5\u53c8\u56de\u5934\u68b3\u7406\u8fd9\u4e2a\u90e8\u5206\u7684\u903b\u8f91\uff0c\u4e8e\u662f\u5199\u4e86\u4e0b\u9762\u8fd9\u4e2ademo\u8bd5\u4e86\u4e00\u4e0b\u3002</p> <pre><code>\n    private var isLoading = false\n    var executor = Executors.newSingleThreadExecutor()\n\n    fun testObserveOn() {\n        Observable.fromArray(1,2)\n            .filter {\n                Log.d(\"gaohui\", \"filter\")\n                isLoading.not()\n            }\n            .observeOn(Schedulers.from(executor))\n            .subscribe({\n                isLoading = true\n                Log.d(\"gaohui\", \"subscribe\")\n                Observable.just(it)\n                    .subscribeOn(Schedulers.io())\n                    .observeOn(Schedulers.from(executor))\n                    .subscribe({\n                        Log.d(\"gaohui\", \"it $it\")\n                        isLoading = false\n                    },{})\n            },{})\n    }\n</code></pre> <p>\u5982\u4e0a\u4ee3\u7801\uff0c\u6253\u5370\u7ed3\u679c\u662f\u8fd9\u6837\u7684\uff1a</p> <pre><code>2020-04-03 14:08:40.101 14083-14153/? D/gaohui: filter\n2020-04-03 14:08:40.102 14083-14153/? D/gaohui: filter\n2020-04-03 14:08:40.102 14083-14153/? D/gaohui: subscribe\n2020-04-03 14:08:40.103 14083-14153/? D/gaohui: subscribe\n2020-04-03 14:08:40.103 14083-14153/? D/gaohui: it 1\n2020-04-03 14:08:40.105 14083-14153/? D/gaohui: it 2\n</code></pre> <p>\u5f53\u6211\u4eec\u628a\u5207\u6362\u7ebf\u7a0b\u7684observeOn\u4ee3\u7801\u6ce8\u91ca\u6389\u4e4b\u540e</p> <pre><code>    fun testObserveOn() {\n        Observable.fromArray(1,2)\n            .filter {\n                Log.d(\"gaohui\", \"filter\")\n                isLoading.not()\n            }\n            //.observeOn(Schedulers.from(executor))\n            .subscribe({\n                isLoading = true\n                Log.d(\"gaohui\", \"subscribe\")\n                Observable.just(it)\n                    .subscribeOn(Schedulers.io())\n                    .observeOn(Schedulers.from(executor))\n                    .subscribe({\n                        Log.d(\"gaohui\", \"it $it\")\n                        isLoading = false\n                    },{})\n            },{})\n    }\n\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u6253\u5370\u7ed3\u679c\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u3002</p> <pre><code>2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: filter\n2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: subscribe\n2020-04-03 14:10:51.057 14258-14258/com.gaohui.android.code.collection D/gaohui: filter\n2020-04-03 14:10:51.058 14258-14340/com.gaohui.android.code.collection D/gaohui: it 1\n</code></pre> <p>\u8fd9\u91cc\u6211\u53d1\u73b0\u628aobserveOn\u5207\u5230\u4e3b\u7ebf\u7a0b\u8fd8\u662f\u5207\u5230\u5f53\u524d\u7ebf\u7a0b\uff0c\u53ea\u8981\u6267\u884c\u4e86\u5207\u7ebf\u7a0b\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u7684isLoading\u8fd9\u4e2aflag\u7684\u63a7\u5236\u6548\u679c\u5c31\u5931\u6548\u4e86\u3002</p> <p>\u5176\u5b9e\u8fd9\u91cc\u7684observeOn \u548c Android \u91cc\u7684 post \u6548\u679c\u662f\u4e00\u6837\u7684\uff0cobserveOn \u8fd9\u4e2a\u8868\u793a\u628a\u8fd9\u4e2a\u4e4b\u540e\u7684\u64cd\u4f5c\u5305\u88c5\u6210\u4e00\u4e2aRunnable \u653e\u5230observeOn\u6307\u5b9a\u7684\u8fd9\u4e2aSchedulers\u4e2d\u53bb\u3002</p> <p>observeOn\u7684\u903b\u8f91\u57fa\u672c\u90fd\u5728ObservableObserveOn.java \u8fd9\u4e2a\u7c7b\u91cc\u9762\u3002</p> <p>\u5728ObservableObserveOn.java\u4e2dObserveOnObserver\u8fd9\u4e2a\u5185\u90e8\u7c7b\u4e2d\u7684OnNext\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>    @Override\n        public void onNext(T t) {\n            if (done) {\n                return;\n            }\n\n            if (sourceMode != QueueDisposable.ASYNC) {\n                queue.offer(t);\n            }\n            schedule();\n        }\n\n</code></pre> <p>\u8fd9\u91cc\u4f1a\u628a\u8fd9\u4e2a t \u653e\u5230queue \u8fd9\u4e2a\u961f\u5217\u4e2d\u3002\u8fd9\u4e2at \u662f\u6211\u4eecObservable\u4e0a\u6e38\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\u6e90\uff0c\u8fd9\u4e2aqueue \u662f\u5728ObserveOnObserver\u8fd9\u4e2a\u5185\u5b58\u7c7b\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u961f\u5217\u3002</p> <pre><code>    static final class ObserveOnObserver&lt;T&gt; extends BasicIntQueueDisposable&lt;T&gt;\n    implements Observer&lt;T&gt;, Runnable {\n\n        private static final long serialVersionUID = 6576896619930983584L;\n        final Observer&lt;? super T&gt; downstream;\n        final Scheduler.Worker worker;\n        final boolean delayError;\n        final int bufferSize;\n\n        SimpleQueue&lt;T&gt; queue;\n        ...\n    }\n</code></pre> <p>\u8fd9\u4e2aqueue\u662f\u7528\u6765\u5b58\u653e\u5f53\u524d\u7ebf\u7a0b\u9700\u8981\u6267\u884c\u7684\u4e00\u4e9b\u4efb\u52a1\u7684\u3002</p> <p>\u63a5\u7740\u5728onNext\u540e\u9762\u8c03\u7528\u4e86schedule\u65b9\u6cd5\u3002\u8fd9\u4e2aschedule\u5c31\u662f\u51c6\u5907\u6267\u884c\u8fd9\u4e2aRunnable\u3002</p> <pre><code> void schedule() {\n            if (getAndIncrement() == 0) {\n                worker.schedule(this);\n            }\n        }\n\n</code></pre> <p>\u8fd9\u4e2aRunnable\u91cc\u7684run\u65b9\u6cd5\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u3002</p> <pre><code>   @Override\n        public void run() {\n            if (outputFused) {\n                drainFused();\n            } else {\n                drainNormal();\n            }\n        }\n</code></pre> <p>\u6211\u4eec\u8fd9\u91cc\u6682\u4e14\u4e0d\u5173\u6ce8outputFused\u8fd9\u4e2aflag\u662f\u5565\u610f\u601d\uff0c\u8fd9\u91cc\u65e0\u8bba\u662fdrainFused\u65b9\u6cd5\u8fd8\u662fdrainNormal\u65b9\u6cd5\uff0c \u57fa\u672c\u90fd\u662f\u8f6e\u8be2queue\u91cc\u7684\u6d88\u606f\uff0c\u5982\u679cqueue\u91cc\u6709\u6d88\u606f\u9700\u8981\u5904\u7406,\u5c31\u53d6\u51fa\u6765\u6267\u884c\u3002\u8fd9\u91cc\u7684\u903b\u8f91\u548c\u4e3b\u7ebf\u7a0b\u7684MessageQueue\u5f88\u7c7b\u4f3c\uff0c\u90fd\u662f\u8f6e\u8be2\uff0c\u53d6\u6d88\u606f\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u770b\u5230\u8fd9\u91cc\u6211\u7a81\u7136\u6709\u70b9\u660e\u767d\u6211\u4eec\u4e0a\u9762\u90a3\u91cc\u8c03\u7528\u4e86observeOn\u4e4b\u540e\u4e3a\u5565\u6211\u4eec\u7684flag isLoading\u7684\u63a7\u5236\u6548\u679c\u5c31\u6ca1\u6709\u751f\u6548\u4e86\uff0cobserveOn\u4e4b\u540e\u7684\u64cd\u4f5c\u76f8\u5f53\u4e8e\u662f\u975e\u963b\u585e\u7684\uff0c\u6211\u4eec\u5207\u4e86\u4e00\u4e2a\u7ebf\u7a0b\uff0cobserveOn\u4e2d\u7684subscribe\u7684\u4ee3\u7801\u65f6\u4e0d\u4f1a\u9a6c\u4e0a\u6267\u884c\u7684\uff0c\u8fd9\u6837\u4ee3\u7801\u53c8\u56de\u5934\u53bb\u53d6\u65b0\u7684\u6570\u636e\u6d41\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019isLoading\u8fd9\u4e2aflag\u662f\u6ca1\u6709\u6539\u53d8\u7684\uff0c\u6240\u4ee5\u5bfc\u81f4\u89e6\u53d1\u4e86\u4e24\u6b21\u7f51\u7edc\u8bf7\u6c42\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/","title":"Tinker","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#_1","title":"\u65b9\u6848\u5bf9\u6bd4","text":"<p>\u5f53\u524d\u6bd4\u8f83\u6d41\u884c\u7684\u70ed\u8865\u4e01\u65b9\u6848\u6709\u5fae\u4fe1Tinker\u3001\u963f\u91ccAndFix\u3001\u7f8e\u56e2Robust\u3001QZone\u8d85\u7ea7\u8865\u4e01\u3002\u6bcf\u4e2a\u5e73\u53f0\u90fd\u6709\u81ea\u5df1\u7684\u5c40\u9650\uff0c\u5927\u5bb6\u5728\u6280\u672f\u9009\u578b\u65f6\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u9700\u8981\u505a\u9009\u62e9\u3002</p> \u7279\u6027 Tinker QZone AndFix Robust \u7c7b\u66ff\u6362 yes yes no no So\u66ff\u6362 yes no no no \u8d44\u6e90\u66ff\u6362 yes yes no no \u5168\u5e73\u53f0\u652f\u6301 yes yes yes yes \u5373\u65f6\u751f\u6548 no no yes yes \u6027\u80fd\u635f\u8017 \u8f83\u5c0f \u8f83\u5927 \u8f83\u5c0f \u8f83\u5c0f \u8865\u4e01\u5305\u5927\u5c0f \u8f83\u5c0f \u8f83\u5927 \u4e00\u822c \u4e00\u822c \u5f00\u53d1\u900f\u660e yes yes no no \u590d\u6742\u5ea6 \u8f83\u4f4e \u8f83\u4f4e \u590d\u6742 \u590d\u6742 gradle\u652f\u6301 yes no no no Rom\u4f53\u79ef \u8f83\u5927 \u8f83\u5c0f \u8f83\u5c0f \u8f83\u5c0f \u6210\u529f\u7387 \u8f83\u9ad8 \u8f83\u9ad8 \u4e00\u822c \u6700\u9ad8 <p>\u603b\u7684\u6765\u8bf4:</p> <ol> <li>AndFix\u4f5c\u4e3anative\u89e3\u51b3\u65b9\u6848\uff0c\u9996\u5148\u9762\u4e34\u7684\u662f\u7a33\u5b9a\u6027\u4e0e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u66f4\u91cd\u8981\u7684\u662f\u5b83\u65e0\u6cd5\u5b9e\u73b0\u7c7b\u66ff\u6362\uff0c\u5b83\u662f\u9700\u8981\u5927\u91cf\u989d\u5916\u7684\u5f00\u53d1\u6210\u672c\u7684\uff1b</li> <li>Robust\u517c\u5bb9\u6027\u4e0e\u6210\u529f\u7387\u8f83\u9ad8\uff0c\u4f46\u662f\u5b83\u4e0eAndFix\u4e00\u6837\uff0c\u65e0\u6cd5\u65b0\u589e\u53d8\u91cf\u4e0e\u7c7b\u53ea\u80fd\u7528\u505a\u7684bugFix\u65b9\u6848\uff1b</li> <li>Qzone\u65b9\u6848\u53ef\u4ee5\u505a\u5230\u53d1\u5e03\u4ea7\u54c1\u529f\u80fd\uff0c\u4f46\u662f\u5b83\u4e3b\u8981\u95ee\u9898\u662f\u63d2\u6869\u5e26\u6765Dalvik\u7684\u6027\u80fd\u95ee\u9898\uff0c\u4ee5\u53ca\u4e3a\u4e86\u89e3\u51b3Art\u4e0b\u5185\u5b58\u5730\u5740\u95ee\u9898\u800c\u5bfc\u81f4\u8865\u4e01\u5305\u6025\u901f\u589e\u5927\u7684\u3002</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#tinker","title":"Tinker\u5df2\u77e5\u95ee\u9898","text":"<p>\u7531\u4e8e\u539f\u7406\u4e0e\u7cfb\u7edf\u9650\u5236\uff0cTinker\u6709\u4ee5\u4e0b\u5df2\u77e5\u95ee\u9898\uff1a</p> <ol> <li>Tinker\u4e0d\u652f\u6301\u4fee\u6539AndroidManifest.xml\uff0cTinker\u4e0d\u652f\u6301\u65b0\u589e\u56db\u5927\u7ec4\u4ef6(1.9.0\u652f\u6301\u65b0\u589e\u975eexport\u7684Activity)\uff1b</li> <li>\u7531\u4e8eGoogle Play\u7684\u5f00\u53d1\u8005\u6761\u6b3e\u9650\u5236\uff0c\u4e0d\u5efa\u8bae\u5728GP\u6e20\u9053\u52a8\u6001\u66f4\u65b0\u4ee3\u7801\uff1b</li> <li>\u5728Android N\u4e0a\uff0c\u8865\u4e01\u5bf9\u5e94\u7528\u542f\u52a8\u65f6\u95f4\u6709\u8f7b\u5fae\u7684\u5f71\u54cd\uff1b \u4e0d\u652f\u6301\u90e8\u5206\u4e09\u661fandroid-21\u673a\u578b\uff0c\u52a0\u8f7d\u8865\u4e01\u65f6\u4f1a\u4e3b\u52a8\u629b\u51fa\"TinkerRuntimeException:checkDexInstall failed\"\uff1b \u5bf9\u4e8e\u8d44\u6e90\u66ff\u6362\uff0c\u4e0d\u652f\u6301\u4fee\u6539remoteView\u3002\u4f8b\u5982transition\u52a8\u753b\uff0cnotification icon\u4ee5\u53ca\u684c\u9762\u56fe\u6807\u3002</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#_2","title":"\u6280\u672f\u89e3\u6790","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#4","title":"4. \u5982\u4f55\u6253\u5dee\u5206\u5305\uff0c\u5373\u8865\u4e01\u6587\u4ef6","text":"<p>\u4f7f\u7528DexDiff\u7b97\u6cd5\uff0c\u53c2\u8003</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#5-api-level","title":"5. \u4e0d\u540cAPI level\uff0c\u54ea\u4e9b\u73af\u8282\u9700\u8981\u5206\u522b\u5904\u7406","text":"<p>\u52a0\u8f7ddex\u6587\u4ef6\u4f1a\u533a\u5206API level\u3002</p> <p>Level 24\u4e4b\u524d\uff1a \u91c7\u7528\u7c7b\u4f3c\u4e8eMultiDex\u52a0\u8f7ddex\u6587\u4ef6\u7684\u539f\u7406\uff0c\u5c06\u8865\u4e01dex\u5728dexElements\u4e2d\u524d\u7f6e\u3002\u56e0\u4e3a\u8c01\u5728\u524d\u9762\u7528\u8c01\uff0c\u6240\u4ee5\u7cfb\u7edf\u4f1a\u4f7f\u7528\u8865\u4e01\u4ee3\u7801\uff0c\u4ece\u800c\u8fbe\u5230\u70ed\u4fee\u590d\u529f\u80fd\u3002</p> <p>Level 24\u53ca\u5176\u4e4b\u540e\uff1a</p> <pre><code>\u8865\u5145\u77e5\u8bc6\uff1a\nAPI Level 26 : Android Oreo, 8.0\nAPI Level 24 : Android Nougat, 7.0\nAPI Level 23 : Android Marshmallow, 6.0\nAPI Level 21 : Android Lollipop, 5.0\nAPI Level 19 : Android Kitkat, 4.4\n</code></pre>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#6-multidextinkermultidex","title":"6. MultiDex\u539f\u7406\uff1fTinker\u53c2\u8003\u4e86MultiDex\u54ea\u4e9b\u6280\u672f\uff1f","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#7-instantruntinkerinstantrun","title":"7. InstantRun\u539f\u7406\uff1fTinker\u53c2\u8003\u4e86InstantRun\u54ea\u4e9b\u6280\u672f\uff1f","text":"<p>\u66f4\u65b0\u8d44\u6e90\u6587\u4ef6\u65f6\uff0c\u501f\u9274\u4e86InstantRun\u7684\u6280\u672f\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#_3","title":"\u91cd\u8981\u70b9","text":"<ol> <li>Tinker\u7684\u8865\u4e01\u65b9\u6848\uff0cTinker\u91c7\u7528\u7684\u662f\u4e0b\u53d1\u5dee\u5206\u5305\uff0c\u7136\u540e\u5728\u624b\u673a\u7aef\u5408\u6210\u5168\u91cf\u7684dex\u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d\u3002</li> </ol>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#dex","title":"\u52a0\u8f7d\u8865\u4e01dex\u6587\u4ef6","text":"<p>\u4f7f\u7528PathClassLoader\u52a0\u8f7d\u8865\u4e01dex\u3002\u5c06\u8865\u4e01dex\u548c\u539fdex\u5408\u5e76\u6210fix_class.dex\uff0c\u7528\u8fd9\u4e2a\u65b0\u7684dex\u66ff\u6362\u539f\u6709pathDexList\u4e2d\u7684\u5185\u5bb9\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#so","title":"\u52a0\u8f7d\u8865\u4e01so\u6587\u4ef6","text":""},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#_4","title":"\u52a0\u8f7d\u8865\u4e01\u8d44\u6e90\u6587\u4ef6","text":"<p>\u91c7\u7528InstantRun\u7684\u52a0\u8f7d\u8865\u4e01\u8d44\u6e90\u65b9\u5f0f\uff0c\u5168\u91cf\u66ff\u6362\u8d44\u6e90\u3002\u5b9e\u73b0\u65b9\u5f0f\u662fhook AssetManager.addAssetPath()\uff0c\u5c06\u8865\u4e01\u7684\u8d44\u6e90\u76ee\u5f55\u4f20\u8fdb\u53bb\uff0c\u4ee5\u6b64\u8fbe\u5230\u66ff\u6362\u8001\u8d44\u6e90\u7684\u65b9\u5f0f\u3002</p> <p>InstantRun\u7684\u8d44\u6e90\u66f4\u65b0\u65b9\u5f0f\u6700\u7b80\u4fbf\u800c\u4e14\u517c\u5bb9\u6027\u4e5f\u6700\u597d\uff0c\u5e02\u9762\u4e0a\u5927\u591a\u6570\u7684\u70ed\u8865\u4e01\u6846\u67b6\u90fd\u91c7\u7528\u8fd9\u5957\u65b9\u6848\u3002Tinker\u7684\u8fd9\u5957\u65b9\u6848\u867d\u7136\u4e5f\u91c7\u7528\u5168\u91cf\u7684\u66ff\u6362\uff0c\u4f46\u662f\u5728\u4e0b\u53d1patch\u4e2d\u4f9d\u7136\u91c7\u7528\u5dee\u91cf\u8d44\u6e90\u7684\u65b9\u5f0f\u83b7\u53d6\u5dee\u5206\u5305\uff0c\u4e0b\u53d1\u5230\u624b\u673a\u540e\u518d\u5408\u6210\u5168\u91cf\u7684\u8d44\u6e90\u6587\u4ef6\uff0c\u6709\u6548\u7684\u63a7\u5236\u4e86\u8865\u4e01\u6587\u4ef6\u7684\u5927\u5c0f\u3002</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/tinker/#_5","title":"\u7c7b\u52a0\u8f7d\u539f\u7406","text":"<p>Android\u4e2d\u7c7b\u7684\u52a0\u8f7d\u4e5f\u662f\u901a\u8fc7ClassLoader\u6765\u5b8c\u6210\uff0c\u5177\u4f53\u6765\u8bf4\u5c31\u662fPathClassLoader\u548cDexClassLoader \u8fd9\u4e24\u4e2aAndroid\u4e13\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\uff0c\u8fd9\u4e24\u4e2a\u7c7b\u7684\u533a\u522b\u5982\u4e0b\uff1a</p> <ul> <li>PathClassLoader\uff1a\u53ea\u80fd\u52a0\u8f7d\u5df2\u7ecf\u5b89\u88c5\u5230Android\u7cfb\u7edf\u4e2d\u7684apk\u6587\u4ef6\uff08/data/app\u76ee\u5f55\uff09\uff0c\u662fAndroid\u9ed8\u8ba4\u4f7f\u7528\u7684\u7c7b\u52a0\u8f7d\u5668\u3002</li> <li>DexClassLoader\uff1a\u53ef\u4ee5\u52a0\u8f7d\u4efb\u610f\u76ee\u5f55\u4e0b\u7684dex/jar/apk/zip\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4e00\u5f00\u59cb\u63d0\u5230\u7684\u8865\u4e01\u3002 \u8fd9\u4e24\u4e2a\u7c7b\u90fd\u662f\u7ee7\u627f\u81eaBaseDexClassLoader\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0bBaseDexClassLoader\u7684\u6784\u9020\u51fd\u6570\u3002</li> </ul> <pre><code>public BaseDexClassLoader(String dexPath, File optimizedDirectory,\n            String libraryPath, ClassLoader parent) {\n    super(parent);\n    this.pathList = new DexPathList(this, dexPath, libraryPath,optimizedDirectory);\n}\n</code></pre> <p>\u8fd9\u4e2a\u6784\u9020\u51fd\u6570\u53ea\u505a\u4e86\u4e00\u4ef6\u4e8b\uff0c\u5c31\u662f\u901a\u8fc7\u4f20\u9012\u8fdb\u6765\u7684\u76f8\u5173\u53c2\u6570\uff0c\u521d\u59cb\u5316\u4e86\u4e00\u4e2aDexPathList\u5bf9\u8c61\u3002DexPathList\u7684\u6784\u9020\u51fd\u6570\uff0c\u5c31\u662f\u5c06\u53c2\u6570\u4e2d\u4f20\u9012\u8fdb\u6765\u7684\u7a0b\u5e8f\u6587\u4ef6\uff08\u5c31\u662f\u8865\u4e01\u6587\u4ef6\uff09\u5c01\u88c5\u6210Element\u5bf9\u8c61\uff0c\u5e76\u5c06\u8fd9\u4e9b\u5bf9\u8c61\u6dfb\u52a0\u5230\u4e00\u4e2aElement\u7684\u6570\u7ec4\u96c6\u5408dexElements\u4e2d\u53bb\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u8981\u53bb\u67e5\u627e\u4e00\u4e2a\u540d\u4e3aname\u7684class\uff0c\u90a3\u4e48DexClassLoader\u5c06\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u5b9e\u73b0\uff1a</p> <ul> <li>\u5728DexClassLoader\u7684findClass \u65b9\u6cd5\u4e2d\u901a\u8fc7\u4e00\u4e2aDexPathList\u5bf9\u8c61findClass()\u65b9\u6cd5\u6765\u83b7\u53d6class</li> <li>\u5728DexPathList\u7684findClass \u65b9\u6cd5\u4e2d\uff0c\u5bf9\u4e4b\u524d\u6784\u9020\u597ddexElements\u6570\u7ec4\u96c6\u5408\u8fdb\u884c\u904d\u5386\uff0c\u4e00\u65e6\u627e\u5230\u7c7b\u540d\u4e0ename\u76f8\u540c\u7684\u7c7b\u65f6\uff0c\u5c31\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2aclass\uff0c\u627e\u4e0d\u5230\u5219\u8fd4\u56denull\u3002</li> </ul> <p>\u603b\u7684\u6765\u8bf4\uff0c\u901a\u8fc7DexClassLoader\u67e5\u627e\u4e00\u4e2a\u7c7b\uff0c\u6700\u7ec8\u5c31\u662f\u5c31\u662f\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\u67e5\u627e\u7279\u5b9a\u503c\u7684\u64cd\u4f5c\u3002</p> <p>\u53c2\u8003\u6587\u7ae0\uff1a</p> <p>Tinker Android\u70ed\u8865\u4e01\u4e4bTinker\u539f\u7406\u89e3\u6790</p>"},{"location":"Android/%E5%BC%80%E6%BA%90%E5%BA%93/%E5%BC%80%E6%BA%90%E5%BA%93%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/","title":"\u5f00\u6e90\u5e93\u6e90\u7801\u5206\u6790\u7cfb\u5217\u6587\u7ae0","text":"<p>Fresco </p> <p>Tinker </p> <p>ActivityRouter </p> <p>ARouter </p> <p>EventBus </p> <p>RxJava </p> <p>Retrofit </p> <p>OKHTTP </p> <p>LeakCanary </p> <p>BlockCanary</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/","title":"\u524d\u8a00","text":"<p>\u81ea\u5df1\u4e00\u76f4\u505aJava\u3001Android\u76f8\u5173\u7684\u77e5\u8bc6\u603b\u7ed3-&gt;KnowledgeSummary\u7cfb\u5217\u3002\u8fd9\u4e2aGitHub\u7684repo\u60f3\u4f5c\u4e3a\u81ea\u5df1\u5bf9\u4e8eAndroid\u6838\u5fc3\u77e5\u8bc6\u70b9\u4ee5\u53ca\u4e00\u4e9b\u9762\u8bd5\u9898\u7684\u603b\u7ed3\uff0c\u56e0\u4e3a\u5f88\u591a\u77e5\u8bc6\u70b9\u7406\u89e3\u7684\u4e0d\u591f\u6df1\u523b\uff0c\u6240\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u6765\u5f3a\u8feb\u81ea\u5df1\u505a\u603b\u7ed3\uff0c\u76ee\u524d\u5df2\u7ecf\u521d\u5177\u89c4\u6a21\uff0c\u6211\u57fa\u672c\u6bcf\u5929\u90fd\u4f1a\u66f4\u65b0\u8fd9\u4e2arepo\uff0c\u540e\u7eed\u8fd8\u4f1a\u6301\u7eed\u66f4\u65b0\u4e0b\u53bb\uff0c\u5927\u5bb6\u6709\u5174\u8da3\u53ef\u4ee5\u70b9\u4e2astar\u5173\u6ce8\u4e0b\uff0c\u611f\u8c22\u3002</p> <p>\u5728\u505a\u8fd9\u4e2a\u77e5\u8bc6\u603b\u7ed3\u7cfb\u5217\uff0c\u53d1\u73b0\u6709\u7684\u6bd4\u8f83\u96f6\u6563\u7684\u9762\u8bd5\u9898\u4e0d\u592a\u9002\u5408\u5f00\u4e2adoc\u6587\u6863\u6765\u5199\uff0c\u4e8e\u662f\u60f3\u7740\u628a\u8fd9\u4e9b\u96f6\u6563\u7684\u9762\u8bd5\u9898\u505a\u4e2a\u603b\u7ed3\uff0c\u6240\u4ee5\u60f3\u6536\u5f55\u5728\u8fd9\u7bc7\u6587\u7ae0\u91cc\u9762\uff0c\u5e76\u4e14\u6bcf\u4e2a\u9762\u8bd5\u9898\u5c3d\u91cf\u63d0\u4f9b\u4e00\u4e2a\u53c2\u8003\u7b54\u6848\uff0c\u56e0\u4e3a\u5982\u679c\u53ea\u662f\u628a\u9762\u8bd5\u9898\u5217\u51fa\u6765\uff0c\u6211\u4e3e\u5f97\u4e00\u70b9\u610f\u601d\u90fd\u6ca1\u6709\uff0c\u8fd9\u6837\u7684\u9762\u8bd5\u9898\u7f51\u4e0a\u4e00\u641c\u4e00\u5927\u628a\uff0c\u6240\u4ee5\u6211\u5e0c\u671b\u4e3a\u6bcf\u4e00\u4e2a\u9762\u8bd5\u9898\u63d0\u4f9b\u4e00\u4e2a\u53c2\u8003\uff0c\u4f46\u4e0d\u80fd\u4fdd\u8bc1\u8fd9\u4e9b\u7b54\u6848\u5b8c\u5168\u6b63\u786e\u3002</p> <p>\u6211\u7684\u76ee\u6807\u662f\u8fd9\u4efd\u9762\u8bd5\u9898\u80fd\u591f\u957f\u671f\u66f4\u65b0\uff0c\u56e0\u4e3a\u6bd4\u8f83\u591a\uff0c\u6682\u65f6\u5c31\u4e0d\u5206\u7c7b\u4e86\u3002</p> <p>\u539f\u6587\u94fe\u63a5</p> <p>\u5982\u4f55\u8ba1\u7b97\u4e00\u4e2aView\u7684\u5c42\u7ea7 Art\u548cDalvik\u533a\u522b socket\u5224\u65adhttp\u8bf7\u6c42\u6216http\u54cd\u5e94\u7684\u4f20\u8f93\u7ed3\u675f OnLowMemory\u548cOnTrimMemory\u7684\u6bd4\u8f83 BlockCanary\u6838\u5fc3\u539f\u7406\u5206\u6790 onRestart \u4ec0\u4e48\u65f6\u5019\u8c03\u7528 Handler \u5982\u4f55\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f TCP\u53ef\u9760\u6027\u7684\u4fdd\u8bc1\u673a\u5236\u603b\u7ed3 synchronized \u548c ReentrantLock \u7684\u533a\u522b\u548c\u4f7f\u7528\u9009\u62e9 synchronized\uff0cvolitale\u7684\u5f02\u540c SparseArray\u548cArrayMap\u4f7f\u7528\u573a\u666f Android \u4e2d getRawX()\u548c getX()\u533a\u522b Android\u4e2d\u7684MotionEvent\u624b\u52bf\u4e8b\u4ef6 onInterceptTouchEvent()\u51fd\u6570\u4e0e onTouchEvent()\u7684\u533a\u522b Http 1.0\u548cHttp 2.0\u7684\u533a\u522b View.getLocationInWindow\u548cView.getLocationOnScreen\u533a\u522b http\u548chttps\u7684\u533a\u522b \u4e3a\u4ec0\u4e48\u8981\u6709\u5185\u90e8\u7c7b,\u9759\u6001\u5185\u90e8\u7c7b\u548c\u666e\u901a\u5185\u90e8\u7c7b\u533a\u522b\u662f\u4ec0\u4e48 Java\u4e2d\u56db\u79cd\u7ebf\u7a0b\u6c60\u7684\u603b\u7ed3 Intent\u4f20\u9012\u6570\u636e\u7684\u9650\u5236\u5927\u5c0f onStartCommand \u7684\u51e0\u79cd\u6a21\u5f0f RelativeLayout\u7684onMeasure\u65b9\u6cd5\u662f\u600e\u4e48Measure\u7684 \u4e3b\u7ebf\u7a0b\u7684\u6b7b\u5faa\u73af\u662f\u5426\u4e00\u81f4\u8017\u8d39CPU\u8d44\u6e90 Service \u548c IntentService \u7684\u533a\u522b SQLite\u589e\u5220\u6539\u67e5\u4ee5\u53ca\u5347\u7ea7\u7684sql\u8bed\u53e5 Service\u7684\u751f\u547d\u5468\u671fActivity\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u5f0f SurfaceView\u548cTextureView\u7684\u533a\u522b onSaveInstanceState\u548conRestoreInstanceState\u8c03\u7528\u65f6\u673a LeakCanary\u539f\u7406 Android\u7cfb\u7edf\u4e3a\u4ec0\u4e48\u4f1a\u8bbe\u8ba1ContentProvider Service\u548cActivity\u901a\u4fe1 OOM \u662f\u5426\u53ef\u4ee5try catch AlertDialog\uff0cToast \u5bf9Activity\u751f\u547d\u5468\u671f\u7684\u5f71\u54cd HTTP\u4e0eTCP\u7684\u533a\u522b\u548c\u8054\u7cfb viewstub\u53ef\u4ee5\u591a\u6b21inflate\u4e48?\u591a\u6b21inflate\u4f1a\u600e\u6837? onWindowFocusChanged \u6267\u884c\u65f6\u673a</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#view","title":"\u5982\u4f55\u8ba1\u7b97\u4e00\u4e2aView\u7684\u5c42\u7ea7","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <pre><code>int i = 0;\nprivate void getParents(ViewParent view){\n    if (view.getParent() == null) { \n        Log.v(\"tag\", \"\u6700\u7ec8===\"+i); return;\n    }\n    i++;\n    ViewParent parent = view.getParent(); \n    Log.v(\"tag\", \"i====\"+i);\n    Log.v(\"tag\", \"parent====\"+parent.toString());\n    getParents(parent); \n}\n</code></pre> <p>\u56e0\u4e3a<code>public abstract class ViewGroup extends View implements ViewParent</code>\uff0c ViewGroup\u662fViewParent\u7684\u5b9e\u73b0\u7c7b\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u8f6c\uff0c LinearLayout\u662fViewGroup \u7684\u5b50\u7c7b\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#artdalvik","title":"Art\u548cDalvik\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> Android 4.4\u53d1\u5e03\u4e86\u4e00\u4e2aART\u8fd0\u884c\u65f6\uff0c\u51c6\u5907\u7528\u6765\u66ff\u6362\u6389\u4e4b\u524d\u4e00\u76f4\u4f7f\u7528\u7684Dalvik\u865a\u62df\u673a</p> <p>Art: Android Runtime\uff0c\u7f16\u8bd1\u673a\u5236\uff1aAOT\uff0c\u9884\u7f16\u8bd1\u673a\u5236 Dalvik\uff1a\u7f16\u8bd1\u673a\u5236\uff1aJIT\uff0c\u5373\u65f6\u7f16\u8bd1</p> <p>ART \u7684\u673a\u5236\u4e0e Dalvik \u4e0d\u540c\u3002\u5728Dalvik\u4e0b\uff0c\u5e94\u7528\u6bcf\u6b21\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u5b57\u8282\u7801\u90fd\u9700\u8981\u901a\u8fc7\u5373\u65f6\u7f16\u8bd1\u5668\uff08JIT\uff0cJust-In-Time\uff09\u8f6c\u6362\u4e3a\u673a\u5668\u7801\uff0c\u8fd9\u4f1a\u62d6\u6162\u5e94\u7528\u7684\u8fd0\u884c\u6548\u7387\uff0c\u800c\u5728ART \u73af\u5883\u4e2d\uff0c<code>\u5e94\u7528\u5728\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u5b57\u8282\u7801\u5c31\u4f1a\u9884\u5148\u7f16\u8bd1\u6210\u673a\u5668\u7801</code>\uff0c\u4f7f\u5176\u6210\u4e3a\u771f\u6b63\u7684\u672c\u5730\u5e94\u7528\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u9884\u7f16\u8bd1\uff08AOT,Ahead-Of-Time\uff09\u3002\u8fd9\u6837\u7684\u8bdd\uff0c\u5e94\u7528\u7684\u542f\u52a8(\u9996\u6b21)\u548c\u6267\u884c\u90fd\u4f1a\u53d8\u5f97\u66f4\u52a0\u5feb\u901f\u3002</p> <p>\u4ec0\u4e48\u662fDalvik</p> <p>Dalvik\u662fGoogle\u516c\u53f8\u81ea\u5df1\u8bbe\u8ba1\u7528\u4e8eAndroid\u5e73\u53f0\u7684Java\u865a\u62df\u673a\u3002Dalvik\u865a\u62df\u673a\u662fGoogle\u7b49\u5382\u5546\u5408\u4f5c\u5f00\u53d1\u7684Android\u79fb\u52a8\u8bbe\u5907\u5e73\u53f0\u7684\u6838\u5fc3\u7ec4\u6210\u90e8\u5206\u4e4b\u4e00\uff0c\u5b83\u53ef\u4ee5\u652f\u6301\u5df2\u8f6c\u6362\u4e3a.dex(\u5373Dalvik Executable)\u683c\u5f0f\u7684Java\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c.dex\u683c\u5f0f\u662f\u4e13\u4e3aDalvik\u5e94\u7528\u8bbe\u8ba1\u7684\u4e00\u79cd\u538b\u7f29\u683c\u5f0f\uff0c\u9002\u5408\u5185\u5b58\u548c\u5904\u7406\u5668\u901f\u5ea6\u6709\u9650\u7684\u7cfb\u7edf\u3002Dalvik\u7ecf\u8fc7\u4f18\u5316\uff0c\u5141\u8bb8\u5728\u6709\u9650\u7684\u5185\u5b58\u4e2d\u540c\u65f6\u8fd0\u884c\u591a\u4e2a\u865a\u62df\u673a\u7684\u5b9e\u4f8b\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2aDalvik\u5e94\u7528\u4f5c\u4e3a\u72ec\u7acb\u7684Linux\u8fdb\u7a0b\u6267\u884c\u3002\u72ec\u7acb\u7684\u8fdb\u7a0b\u53ef\u4ee5\u9632\u6b62\u5728\u865a\u62df\u673a\u5d29\u6e83\u7684\u65f6\u5019\u6240\u6709\u7a0b\u5e8f\u90fd\u88ab\u5173\u95ed\u3002</p> <p>\u4ec0\u4e48\u662fART</p> <p>Android\u64cd\u4f5c\u7cfb\u7edf\u5df2\u7ecf\u6210\u719f\uff0cGoogle\u7684Android\u56e2\u961f\u5f00\u59cb\u5c06\u6ce8\u610f\u529b\u8f6c\u5411\u4e00\u4e9b\u5e95\u5c42\u7ec4\u4ef6\uff0c\u5176\u4e2d\u4e4b\u4e00\u662f\u8d1f\u8d23\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u7684Dalvik\u8fd0\u884c\u65f6\u3002Google\u5f00\u53d1\u8005\u5df2\u7ecf\u82b1\u4e86\u4e24\u5e74\u65f6\u95f4\u5f00\u53d1\u66f4\u5feb\u6267\u884c\u6548\u7387\u66f4\u9ad8\u66f4\u7701\u7535\u7684\u66ff\u4ee3ART\u8fd0\u884c\u65f6\u3002ART\u4ee3\u8868Android Runtime,\u5176\u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u7684\u65b9\u5f0f\u5b8c\u5168\u4e0d\u540c\u4e8eDalvik\uff0cDalvik\u662f\u4f9d\u9760\u4e00\u4e2aJust-In-Time(JIT)\u7f16\u8bd1\u5668\u53bb\u89e3\u91ca\u5b57\u8282\u7801\u3002\u5f00\u53d1\u8005\u7f16\u8bd1\u540e\u7684\u5e94\u7528\u4ee3\u7801\u9700\u8981\u901a\u8fc7\u4e00\u4e2a\u89e3\u91ca\u5668\u5728\u7528\u6237\u7684\u8bbe\u5907\u4e0a\u8fd0\u884c\uff0c\u8fd9\u4e00\u673a\u5236\u5e76\u4e0d\u9ad8\u6548\uff0c\u4f46\u8ba9\u5e94\u7528\u80fd\u66f4\u5bb9\u6613\u5728\u4e0d\u540c\u786c\u4ef6\u548c\u67b6\u6784\u4e0a\u8fd0\u884c\u3002ART\u5219\u5b8c\u5168\u6539\u53d8\u4e86\u8fd9\u5957\u505a\u6cd5\uff0c\u5728\u5e94\u7528\u5b89\u88c5\u7684\u65f6\u5019\u5c31\u9884\u7f16\u8bd1\u5b57\u8282\u7801\u5230\u673a\u5668\u8bed\u8a00\uff0c\u8fd9\u4e00\u673a\u5236\u53ebAhead-Of-Time(AOT)\u7f16\u8bd1\u3002\u5728\u79fb\u9664\u89e3\u91ca\u4ee3\u7801\u8fd9\u4e00\u8fc7\u7a0b\u540e\uff0c\u5e94\u7528\u7a0b\u5e8f\u6267\u884c\u5c06\u66f4\u6709\u6548\u7387\uff0c\u542f\u52a8\u66f4\u5feb\u3002</p> <p>ART\u4f18\u70b9\uff1a * \u7cfb\u7edf\u6027\u80fd\u7684\u663e\u8457\u63d0\u5347 * \u5e94\u7528\u542f\u52a8\u66f4\u5feb\u3001\u8fd0\u884c\u66f4\u5feb\u3001\u4f53\u9a8c\u66f4\u6d41\u7545\u3001\u89e6\u611f\u53cd\u9988\u66f4\u53ca\u65f6 * \u66f4\u957f\u7684\u7535\u6c60\u7eed\u822a\u80fd\u529b * \u652f\u6301\u66f4\u4f4e\u7684\u786c\u4ef6</p> <p>ART\u7f3a\u70b9\uff1a * \u66f4\u5927\u7684\u5b58\u50a8\u7a7a\u95f4\u5360\u7528\uff0c\u53ef\u80fd\u4f1a\u589e\u52a010%-20% * \u66f4\u957f\u7684\u5e94\u7528\u5b89\u88c5\u65f6\u95f4</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#sockethttphttp","title":"socket\u5224\u65adhttp\u8bf7\u6c42\u6216http\u54cd\u5e94\u7684\u4f20\u8f93\u7ed3\u675f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code>\u5148\u628a header \u76f4\u5230\\r\\n\\r\\n \u6574\u4e2a\u5730\u5740\u8bb0\u5f55\u4e0b\u6765</p> <p>\u5982\u679c\u662f\u77ed\u8fde\u63a5\uff0c\u6ca1\u6709\u542f\u7528 keepalive\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u662f\u5426\u5173\u95ed\u4e86\u8fde\u63a5\u6765\u5224\u65ad\u662f\u5426\u4f20\u8f93\u7ed3\u675f\uff0c \u5373\u5728\u8bfb\u53d6\u65f6\u53ef\u5224\u65ad read() != -1\u3002\u4f20\u8f93\u5b8c\u6bd5\u5c31\u5173\u95ed connection\uff0c\u5373 recv \u6536\u5230 0 \u4e2a\u5b57\u8282\u3002 \u5982\u679c\u662f\u957f\u8fde\u63a5\uff0c\u90a3\u4e48\u4e00\u4e2a socket(tcp)\u53ef\u80fd\u53d1\u9001\u548c\u63a5\u6536\u591a\u6b21\u8bf7\u6c42\uff0c\u90a3\u4e48\u5982\u4f55\u5224\u65ad\u6bcf\u6b21\u7684 \u54cd\u5e94\u5df2\u7ecf\u63a5\u6536? 1. \u5148\u8bfb\u8bf7\u6c42\u5934\uff0c\u4e00\u76f4\u5230\\r\\n\\r\\n \u8bf4\u660e\u8bf7\u6c42\u5934\u7ed3\u675f\uff0c\u7136\u540e\u89e3\u6790 http \u5934\uff0c\u5982\u679c Content-Length=x \u5b58\u5728\uff0c\u5219\u77e5\u9053 http \u54cd\u5e94\u7684\u957f\u5ea6\u4e3a x\u3002\u4ece\u5934\u7684\u672b\u5c3e\u76f4\u63a5\u8bfb\u53d6 x \u5b57\u8282\u5c31\u662f\u54cd\u5e94\u5185\u5bb9\u3002 2. \u5982\u679c Content-Length=x \u4e0d\u5b58\u5728\uff0c\u90a3\u4e48\u5934\u7c7b\u578b\u4e3a Transfer-Encoding: chunked \u8bf4\u660e\u54cd\u5e94 \u7684\u957f\u5ea6\u4e0d\u56fa\u5b9a\uff0c\u5219\u5728\u54cd\u5e94\u5934\u7ed3\u675f\u540e\u6807\u8bb0\u7b2c\u4e00\u6bb5\u6d41\u7684\u957f\u5ea6\uff0c\u5373\u76f4\u5230\u6d41\u91cc\u6709\\r\\n0\\r\\n\\r\\n \u7ed3\u675f 3. \u5982\u679c recv \u8fd4\u56de SOCKET_ERROR \u65f6\uff0c\u8bf4\u660e\u5bf9\u65b9\u5df2\u7ecf\u65ad\u5f00\u8fde\u63a5\uff0c\u4f46\u662f\u53ef\u80fd\u662f\u975e\u6b63\u5e38\u65ad\u5f00 (\u65ad\u7f51\u6216\u8005\u5ba2\u6237\u7aef\u8fdb\u7a0b\u7ed3\u675f</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onlowmemoryontrimmemory","title":"OnLowMemory\u548cOnTrimMemory\u7684\u6bd4\u8f83","text":"<p><code>\u3010\u53c2\u8003\u3011:</code>OnLowMemory \u88ab\u56de\u8c03\u65f6\uff0c\u5df2\u7ecf\u6ca1\u6709\u540e\u53f0\u8fdb\u7a0b;\u800c onTrimMemory \u88ab\u56de\u8c03\u65f6\uff0c\u8fd8\u6709\u540e\u53f0\u8fdb\u7a0b\u3002 OnLowMemory \u662f\u5728\u6700\u540e\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\u88ab\u6740\u65f6\u8c03\u7528\uff0c\u4e00\u822c\u60c5\u51b5\u662f low memory killer \u6740\u8fdb\u7a0b \u540e\u89e6\u53d1;\u800c OnTrimMemory \u7684\u89e6\u53d1\u66f4\u9891\u7e41\uff0c\u6bcf\u6b21\u8ba1\u7b97\u8fdb\u7a0b\u4f18\u5148\u7ea7\u65f6\uff0c\u53ea\u8981\u6ee1\u8db3\u6761\u4ef6\uff0c\u90fd\u4f1a\u89e6\u53d1\u3002 \u901a\u8fc7\u4e00\u952e\u6e05\u7406\u540e\uff0cOnLowMemory \u4e0d\u4f1a\u88ab\u89e6\u53d1\uff0c\u800c OnTrimMemory \u4f1a\u88ab\u89e6\u53d1\u4e00\u6b21\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#blockcanary","title":"BlockCanary\u6838\u5fc3\u539f\u7406\u5206\u6790","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <pre><code>public static void loop() {\n        final Looper me = myLooper();\n        if (me == null) {\n            throw new RuntimeException(\"No Looper; Looper.prepare() wasn't called on this thread.\");\n        }\n        final MessageQueue queue = me.mQueue;\n\n        // Make sure the identity of this thread is that of the local process,\n        // and keep track of what that identity token actually is.\n        Binder.clearCallingIdentity();\n        final long ident = Binder.clearCallingIdentity();\n\n        for (;;) {\n            Message msg = queue.next(); // might block\n            if (msg == null) {\n                // No message indicates that the message queue is quitting.\n                return;\n            }\n\n            // This must be in a local variable, in case a UI event sets the logger\n            final Printer logging = me.mLogging;\n            if (logging != null) {\n                logging.println(\"&gt;&gt;&gt;&gt;&gt; Dispatching to \" + msg.target + \" \" +\n                        msg.callback + \": \" + msg.what);\n            }\n\n            final long slowDispatchThresholdMs = me.mSlowDispatchThresholdMs;\n\n            final long traceTag = me.mTraceTag;\n            if (traceTag != 0 &amp;&amp; Trace.isTagEnabled(traceTag)) {\n                Trace.traceBegin(traceTag, msg.target.getTraceName(msg));\n            }\n            final long start = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis();\n            final long end;\n            try {\n                msg.target.dispatchMessage(msg);\n                end = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis();\n            } finally {\n                if (traceTag != 0) {\n                    Trace.traceEnd(traceTag);\n                }\n            }\n            if (slowDispatchThresholdMs &gt; 0) {\n                final long time = end - start;\n                if (time &gt; slowDispatchThresholdMs) {\n                    Slog.w(TAG, \"Dispatch took \" + time + \"ms on \"\n                            + Thread.currentThread().getName() + \", h=\" +\n                            msg.target + \" cb=\" + msg.callback + \" msg=\" + msg.what);\n                }\n            }\n\n            if (logging != null) {\n                logging.println(\"&lt;&lt;&lt;&lt;&lt; Finished to \" + msg.target + \" \" + msg.callback);\n            }\n\n            // Make sure that during the course of dispatching the\n            // identity of the thread wasn't corrupted.\n            final long newIdent = Binder.clearCallingIdentity();\n            if (ident != newIdent) {\n                Log.wtf(TAG, \"Thread identity changed from 0x\"\n                        + Long.toHexString(ident) + \" to 0x\"\n                        + Long.toHexString(newIdent) + \" while dispatching to \"\n                        + msg.target.getClass().getName() + \" \"\n                        + msg.callback + \" what=\" + msg.what);\n            }\n\n            msg.recycleUnchecked();\n        }\n    }\n</code></pre> <p>\u539f\u7406:\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u6253\u5370\u8fd9\u4e24\u5929 log \u7684\u65f6\u95f4\u5dee\uff0c\u5c31\u80fd\u5f97\u5230 dispatchMessage \u7684\u8017\u65f6\uff0candroid \u63d0\u4f9b\u4e86 Looper.getMainLooper().setMessageLogging(Printer printer)\u6765\u8bbe\u7f6e\u8fd9\u4e2a logging \u5bf9 \u8c61\uff0c\u6240\u4ee5\u53ea\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a Printer\uff0c\u7136\u540e\u91cd\u5199 println(String x)\u65b9\u6cd5\u5373\u53ef\u5b9e\u73b0\u8017\u65f6\u7edf\u8ba1\u4e86\u3002 \u901a\u8fc7\u5728 DispatchMessage \u7684\u65b9\u6cd5\u7684\u6267\u884c\u65f6\u95f4\uff0c\u6765\u5224\u65ad\u5361\u987f\uff0c\u7ba1\u662f\u54ea\u79cd\u56de\u8c03\u65b9\u5f0f\uff0c\u56de\u8c03\u4e00\u5b9a\u53d1 \u751f\u5728 UI \u7ebf\u7a0b\u3002\u56e0\u6b64\u5982\u679c\u5e94\u7528\u53d1\u751f\u5361\u987f\uff0c\u4e00\u5b9a\u662f\u5728 dispatchMessage \u4e2d\u6267\u884c\u4e86\u8017\u65f6\u64cd\u4f5c\u3002\u6211 \u4eec\u901a\u8fc7\u7ed9\u4e3b\u7ebf\u7a0b\u7684 Looper \u8bbe\u7f6e\u4e00\u4e2a Printer\uff0c\u6253\u70b9\u7edf\u8ba1 dispatchMessage \u65b9\u6cd5\u6267\u884c\u7684\u65f6\u95f4\uff0c \u5982\u679c\u8d85\u51fa\u9600\u503c\uff0c\u8868\u793a\u53d1\u751f\u5361\u987f\uff0c\u5219 dump \u51fa\u5404\u79cd\u4fe1\u606f\uff0c\u63d0\u4f9b\u5f00\u53d1\u8005\u5206\u6790\u6027\u80fd\u74f6\u9888\u3002 mBlockListener.onBlockEvent\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onrestart","title":"onRestart \u4ec0\u4e48\u65f6\u5019\u8c03\u7528","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> * 1\u3001\u6309\u4e0b home \u952e\u6267\u884c\uff0c\u518d\u6b21\u6253\u5f00\u8fd9\u4e2a demo \u6267\u884c;onRestart()---&gt;onStart()---&gt;onResume() \u4e09\u4e2a\u65b9\u6cd5\u3002 * 2\u3001\u70b9\u51fb\u754c\u9762\u7684 btn\uff0c\u8df3\u8f6c\u5230\u53e6\u4e00\u4e2a Activity1\uff0c\u4ece Activity1 \u8fd4\u56de\uff0c\u4f1a\u6267\u884c\u5982\u4e0b\u56fe 2;onRestart()- --&gt;onStart()---&gt;onResume()\u4e09\u4e2a\u65b9\u6cd5 * 3\u3001\u5207\u6362\u5230\u5176\u4ed6\u7684\u5e94\u7528\uff0c\u4ece\u5176\u4ed6\u5e94\u7528\u5207\u6362\u56de\u6765\u3002onRestart()---&gt;onStart()---&gt;onResume()\u4e09\u4e2a \u65b9\u6cd5</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#handler","title":"Handler \u5982\u4f55\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u9664\u4e86\u5199\u5f31\u5f15\u7528\u8fd9\u4e2a\u65b9\u6cd5\u540e\uff0c\u8fd8\u6709\u4e00\u4e2a\u5c31\u662f handler.removeCallbacksAndMessages(null);\uff0c\u5c31 \u662f\u79fb\u9664\u6240\u6709\u7684\u6d88\u606f\u548c\u56de\u8c03\uff0c\u7b80\u5355\u4e00\u53e5\u8bdd\u5c31\u662f\u6e05\u7a7a\u4e86\u6d88\u606f\u961f\u5217\u3002\u6ce8\u610f\uff0c\u4e0d\u8981\u4ee5\u4e3a\u4f60 post \u7684\u662f \u4e2a Runnable \u6216\u8005\u53ea\u662f sendEmptyMessage\u3002\u4f60\u53ef\u4ee5\u770b\u4e00\u4e0b\u6e90\u7801\uff0c\u5728 handler \u91cc\u9762\u90fd\u662f\u4f1a\u628a \u8fd9\u4e9b\u8f6c\u6210\u6b63\u7edf\u7684 Message\uff0c\u653e\u5165\u6d88\u606f\u961f\u5217\u91cc\u9762\uff0c\u6240\u4ee5\u6e05\u7a7a\u961f\u5217\u5c31\u610f\u5473\u7740\u8fd9\u4e2a Handler \u76f4\u63a5\u88ab \u6253\u6210\u539f\u578b\u4e86\uff0c\u5f53\u7136\u4e5f\u5c31\u53ef\u4ee5\u56de\u6536\u4e86\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#tcp","title":"TCP\u53ef\u9760\u6027\u7684\u4fdd\u8bc1\u673a\u5236\u603b\u7ed3","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> 1. \u68c0\u9a8c\u548c 2. \u5e8f\u5217\u53f7  3. \u786e\u8ba4\u5e94\u7b54\u673a\u5236(ACK) 4. \u8d85\u65f6\u91cd\u4f20\u673a\u5236 5. \u8fde\u63a5\u7ba1\u7406\u673a\u5236  6. \u6d41\u91cf\u63a7\u5236  7. \u62e5\u585e\u63a7\u5236</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#synchronized-reentrantlock","title":"synchronized \u548c ReentrantLock \u7684\u533a\u522b\u548c\u4f7f\u7528\u9009\u62e9","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> 1. \u4f7f\u7528 synchronized \u83b7\u5f97\u7684\u9501\u5b58\u5728\u4e00\u5b9a\u7f3a\u9677</p> <ul> <li>\u4e0d\u80fd\u4e2d\u65ad\u4e00\u4e2a\u6b63\u5728\u8bd5\u56fe\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b</li> <li>\u8bd5\u56fe\u83b7\u5f97\u9501\u65f6\u4e0d\u80fd\u50cf ReentrantLock \u4e2d\u7684 trylock \u90a3\u6837\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4 \uff0c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u5f97\u4e86\u5bf9\u8c61\u9501\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u8bbf\u95ee\u8fd9\u4e2a\u540c\u6b65\u65b9\u6cd5\u65f6\uff0c\u5fc5\u987b\u7b49\u5f85\u6216\u963b\u585e\uff0c\u5982\u679c\u90a3\u4e2a\u7ebf\u7a0b\u53d1\u751f\u4e86\u6b7b\u5faa\u73af\uff0c \u5bf9\u8c61\u9501\u5c31\u6c38\u8fdc\u4e0d\u4f1a\u91ca\u653e</li> <li>\u6bcf\u4e2a\u9501\u53ea\u6709\u5355\u4e00\u7684\u6761\u4ef6\uff0c\u4e0d\u50cf condition \u90a3\u6837\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a</li> </ul> <ol> <li>\u5c3d\u7ba1 synchronized \u5b58\u5728\u4e0a\u8ff0\u7684\u4e00\u4e9b\u7f3a\u9677\uff0c\u5728\u9009\u62e9\u4e0a\u8fd8\u662f\u4ee5 synchronized \u4f18\u5148</li> </ol> <ul> <li>\u5982\u679c synchronized \u5173\u952e\u5b57\u9002\u5408\u7a0b\u5e8f\uff0c\u5c3d\u91cf\u4f7f\u7528\u5b83\uff0c\u53ef\u4ee5\u51cf\u5c11\u4ee3\u7801\u51fa\u9519\u7684\u51e0\u7387\u548c\u4ee3\u7801\u6570\u91cf; (\u51cf\u5c11\u51fa\u9519\u51e0\u7387\u662f\u56e0\u4e3a\u5728\u6267\u884c\u5b8c synchronized \u5305\u542b\u5b8c\u7684\u6700\u540e\u4e00\u53e5\u8bed\u53e5\u540e\uff0c\u9501\u4f1a\u81ea\u52a8\u91ca\u653e\uff0c \u4e0d\u9700\u8981\u50cf ReentrantLock \u4e00\u6837\u624b\u52a8\u5199 unlock \u65b9\u6cd5;)</li> <li>\u5982\u679c\u7279\u522b\u9700\u8981 Lock/Condition \u7ed3\u6784\u63d0\u4f9b\u7684\u72ec\u6709\u7279\u6027\u65f6\uff0c\u624d\u4f7f\u7528\u4ed6\u4eec;(\u6bd4\u5982\u8bbe\u5b9a\u4e00\u4e2a\u7ebf\u7a0b \u957f\u65f6\u95f4\u4e0d\u80fd\u83b7\u53d6\u9501\u65f6\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4\u6216\u81ea\u6211\u4e2d\u65ad\u7b49\u529f\u80fd\u3002)</li> <li>\u8bb8\u591a\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4f7f\u7528 java.util.concurrent \u5305\u4e2d\u7684\u4e00\u79cd\u673a\u5236\uff0c\u5b83\u4f1a\u4e3a\u4f60\u5904\u7406\u6240\u6709\u7684\u52a0\u9501\u60c5\u51b5; (\u6bd4\u5982\u5f53\u6211\u4eec\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u4f7f\u7528 HashMap \u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ConcurrentHashMap \u6765\u5904\u7406\u591a\u7ebf\u7a0b\u5e76\u53d1)</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#synchronizedvolitale","title":"synchronized\uff0cvolitale\u7684\u5f02\u540c","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> 1. volatile \u672c\u8d28\u662f\u5728\u544a\u8bc9 jvm \u5f53\u524d\u53d8\u91cf\u5728\u5bc4\u5b58\u5668\u4e2d\u7684\u503c\u662f\u4e0d\u786e\u5b9a\u7684,\u9700\u8981\u4ece\u4e3b\u5b58\u4e2d\u8bfb\u53d6,synchronized \u5219\u662f\u9501\u5b9a\u5f53\u524d\u53d8\u91cf,\u53ea\u6709\u5f53\u524d\u7ebf\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u8be5\u53d8\u91cf,\u5176\u4ed6\u7ebf\u7a0b\u88ab\u963b\u585e\u4f4f 2. volatile \u4ec5\u80fd\u4f7f\u7528\u5728\u53d8\u91cf\u7ea7\u522b,synchronized \u5219\u53ef\u4ee5\u4f7f\u7528\u5728\u53d8\u91cf,\u65b9\u6cd5 3. volatile \u4ec5\u80fd\u5b9e\u73b0\u53d8\u91cf\u7684\u4fee\u6539\u53ef\u89c1\u6027,\u4f46\u4e0d\u5177\u5907\u539f\u5b50\u7279\u6027,\u800c synchronized \u5219\u53ef\u4ee5\u4fdd\u8bc1\u53d8\u91cf \u7684\u4fee\u6539\u53ef\u89c1\u6027\u548c\u539f\u5b50\u6027 4. volatile \u4e0d\u4f1a\u9020\u6210\u7ebf\u7a0b\u7684\u963b\u585e,\u800c synchronized \u53ef\u80fd\u4f1a\u9020\u6210\u7ebf\u7a0b\u7684\u963b\u585e 6. volatile \u6807\u8bb0\u7684\u53d8\u91cf\u4e0d\u4f1a\u88ab\u7f16\u8bd1\u5668\u4f18\u5316,\u800c synchronized\u6807\u8bb0\u7684\u53d8\u91cf\u53ef\u4ee5\u88ab\u7f16\u8bd1\u5668\u4f18\u5316</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#sparsearrayarraymap","title":"SparseArray\u548cArrayMap\u4f7f\u7528\u573a\u666f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u5047\u8bbe\u6570\u636e\u91cf\u90fd\u5728\u5343\u7ea7\u4ee5\u5185\u7684\u60c5\u51b5\u4e0b: 1. \u5047\u8bbe key \u7684\u7c7b\u578b\u5df2\u7ecf\u786e\u5b9a\u4e3a int \u7c7b\u578b\u3002\u90a3\u4e48\u4f7f\u7528 SparseArray\uff0c\u7531\u4e8e\u5b83\u907f\u514d\u4e86\u81ea\u5df1\u4e3b\u52a8\u88c5\u7bb1\u7684\u8fc7\u7a0b\uff0c\u5047\u8bbekey\u4e3along\u7c7b\u578b\uff0c\u5b83\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a LongSparseArray \u6765\u786e\u4fddkey\u4e3a long\u7c7b\u578b\u65f6\u7684\u4f7f\u7528 2. \u5047\u8bbekey\u7c7b\u578b\u4e3a\u5176\u4ed6\u7684\u7c7b\u578b\uff0c\u5219\u4f7f\u7528ArrayMap SparseArray\u6bd4HashMap \u66f4\u7701\u5185\u5b58\uff0c\u5728\u67d0\u4e9b\u6761\u4ef6\u4e0b\u6027\u80fd\u66f4\u597d\uff0c\u4e3b\u8981\u662f\u7531\u4e8e\u5b83\u907f\u514d\u4e86\u5bf9 key \u7684\u81ea\u5df1\u4e3b\u52a8\u88c5\u7bb1(int\u8f6c\u4e3aInteger \u7c7b\u578b)\uff0c\u5b83\u5185\u90e8\u5219\u662f\u901a\u8fc7\u4e24\u4e2a\u6570\u7ec4\u6765\u8fdb\u884c\u6570\u636e\u5b58\u50a8\u7684\u3002\u4e00\u4e2a\u5b58\u50a8 key\uff0c\u53e6\u5916\u4e00\u4e2a\u5b58\u50a8value\uff0c\u4e3a\u4e86\u4f18\u5316\u6027\u80fd\uff0c\u5b83\u5185\u90e8\u5bf9\u6570\u636e\u8fd8\u63a1\u53d6\u4e86\u538b\u7f29\u7684\u65b9\u5f0f\u6765\u8868\u793a \u7a00\u758f\u6570\u7ec4\u7684\u6570\u636e\uff0c\u4ece\u800c\u8282\u7ea6\u5185\u5b58\u7a7a\u95f4\u3002\u6211\u4eec\u4ece\u6e90\u4ee3\u7801\u4e2d\u80fd\u591f\u770b\u5230key\u548cvalue\u5404\u81ea\u662f\u7528\u6570\u7ec4</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#android-getrawx-getx","title":"Android \u4e2d getRawX()\u548c getX()\u533a\u522b","text":"<ul> <li>getRawX( )\u5373\u8868\u793a\u7684\u662f\u70b9\u51fb\u7684\u4f4d\u7f6e\u8ddd\u79bb\u5c4f\u5e55\u7684\u5750\u6807</li> <li>getX( )\u5373\u8868\u793a\u7684\u70b9\u51fb\u7684\u4f4d\u7f6e\u76f8\u5bf9\u4e8e\u672c\u8eab\u7684\u5750\u6807</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#androidmotionevent","title":"Android\u4e2d\u7684MotionEvent\u624b\u52bf\u4e8b\u4ef6","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> * MotionEvent.ACTION_DOWN:\u5f53\u5c4f\u5e55\u68c0\u6d4b\u5230\u7b2c\u4e00\u4e2a\u89e6\u70b9\u6309\u4e0b\u4e4b\u540e\u5c31\u4f1a\u89e6\u53d1\u5230\u8fd9\u4e2a\u4e8b\u4ef6\u3002 * MotionEvent.ACTION_MOVE:\u5f53\u89e6\u70b9\u5728\u5c4f\u5e55\u4e0a\u79fb\u52a8\u65f6\u89e6\u53d1\uff0c\u89e6\u70b9\u5728\u5c4f\u5e55\u4e0a\u505c\u7559\u4e5f\u662f\u4f1a\u89e6\u53d1 \u7684\uff0c\u4e3b\u8981\u662f\u7531\u4e8e\u5b83\u7684\u7075\u654f\u5ea6\u5f88\u9ad8\uff0c\u800c\u6211\u4eec\u7684\u624b\u6307\u53c8\u4e0d\u53ef\u80fd\u5b8c\u5168\u9759\u6b62(\u5373\u4f7f\u6211\u4eec\u611f\u89c9\u4e0d\u5230\u79fb\u52a8\uff0c \u4f46\u5176\u5b9e\u6211\u4eec\u7684\u624b\u6307\u4e5f\u5728\u4e0d\u505c\u5730\u6296\u52a8)\u3002 * MotionEvent.ACTION_POINTER_DOWN:\u5f53\u5c4f\u5e55\u4e0a\u5df2\u7ecf\u6709\u89e6\u70b9\u5904\u4e8e\u6309\u4e0b\u7684\u72b6\u6001\u7684\u65f6\u5019\uff0c\u518d\u6709 \u65b0\u7684\u89e6\u70b9\u88ab\u6309\u4e0b\u65f6\u89e6\u53d1\u3002 * MotionEvent.ACTION_POINTER_UP:\u5f53\u5c4f\u5e55\u4e0a\u6709\u591a\u4e2a\u70b9\u88ab\u6309\u4f4f\uff0c\u677e\u5f00\u5176\u4e2d\u4e00\u4e2a\u70b9\u65f6\u89e6\u53d1(\u5373 \u975e\u6700\u540e\u4e00\u4e2a\u70b9\u88ab\u653e\u5f00\u65f6)\u89e6\u53d1\u3002 * MotionEvent.ACTION_UP:\u5f53\u6700\u540e\u4e00\u4e2a\u89e6\u70b9\u677e\u5f00\u65f6\u88ab\u89e6\u53d1\u3002 * MotionEvent.ACTION_SCROLL:\u975e\u89e6\u6478\u6eda\u52a8\uff0c\u4e3b\u8981\u662f\u7531\u9f20\u6807\u3001\u6eda\u8f6e\u3001\u8f68\u8ff9\u7403\u89e6\u53d1\u3002 * MotionEvent.ACTION_CANCEL:\u4e0d\u662f\u7531\u7528\u6237\u76f4\u63a5\u89e6\u53d1\uff0c\u6709\u7cfb\u7edf\u518d\u9700\u8981\u7684\u65f6\u5019\u89e6\u53d1\uff0c\u4f8b\u5982\u5f53\u7236view\u901a\u8fc7\u4f7f\u51fd\u6570 onInterceptTouchEvent()\u8fd4\u56de true,\u4ece\u5b50view\u62ff\u56de\u5904\u7406\u4e8b\u4ef6\u7684\u63a7\u5236\u6743\u662f\uff0c\u5c31 \u4f1a\u7ed9\u5b50 view \u53d1\u4e00\u4e2aACTION_CANCEL\u4e8b\u4ef6\uff0c\u8fd9\u91cc\u4e86 view \u5c31\u518d\u4e5f\u4e0d\u4f1a\u6536\u5230\u4e8b\u4ef6\u4e86\u3002\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3aACTION_UP\u4e8b\u4ef6\u5bf9\u5f85\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onintercepttouchevent-ontouchevent","title":"onInterceptTouchEvent()\u51fd\u6570\u4e0e onTouchEvent()\u7684\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> * onInterceptTouchEvent()\u662f\u7528\u4e8e\u5904\u7406\u4e8b\u4ef6(\u7c7b\u4f3c\u4e8e\u9884\u5904\u7406\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u4e0d\u5904\u7406)\u5e76\u6539\u53d8\u4e8b \u4ef6\u7684\u4f20\u9012\u65b9\u5411\uff0c\u4e5f\u5c31\u662f\u51b3\u5b9a\u662f\u5426\u5141\u8bb8 Touch \u4e8b\u4ef6\u7ee7\u7eed\u5411\u4e0b(\u5b50 view)\u4f20\u9012\uff0c\u4e00\u4f46\u8fd4\u56de True (\u4ee3\u8868\u4e8b\u4ef6\u5728\u5f53\u524d\u7684 viewGroup \u4e2d\u4f1a\u88ab\u5904\u7406)\uff0c\u5219\u5411\u4e0b\u4f20\u9012\u4e4b\u8def\u88ab\u622a\u65ad(\u6240\u6709\u5b50view\u5c06\u6ca1\u6709\u673a\u4f1a\u53c2\u4e0eTouch \u4e8b\u4ef6)\uff0c\u540c\u65f6\u628a\u4e8b\u4ef6\u4f20\u9012\u7ed9\u5f53\u524d\u7684view\u7684onTouchEvent()\u5904\u7406;\u8fd4\u56de false\uff0c \u5219\u628a\u4e8b\u4ef6\u4ea4\u7ed9\u5b50view\u7684onInterceptTouchEvent() * onTouchEvent()\u7528\u4e8e\u5904\u7406\u4e8b\u4ef6\uff0c\u8fd4\u56de\u503c\u51b3\u5b9a\u5f53\u524dview\u662f\u5426\u6d88\u8d39(consume)\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\uff0c \u4e5f\u5c31\u662f\u8bf4\u5728\u5f53\u524dview\u5728\u5904\u7406\u5b8cTouch\u4e8b\u4ef6\u540e\uff0c\u662f\u5426\u8fd8\u5141\u8bb8Touch\u4e8b\u4ef6\u7ee7\u7eed\u5411\u4e0a(\u7236 view) \u4f20\u9012\uff0c\u4e00\u4f46\u8fd4\u56de True\uff0c\u5219\u7236 view \u4e0d\u7528\u64cd\u5fc3\u81ea\u5df1\u6765\u5904\u7406 Touch \u4e8b\u4ef6\u3002\u8fd4\u56de true\uff0c\u5219\u5411\u4e0a\u4f20\u9012 \u7ed9\u7236 view(\u6ce8:\u53ef\u80fd\u4f60\u4f1a\u89c9\u5f97\u662f\u5426\u6d88\u8d39\u4e86\u6709\u5173\u7cfb\u5417\uff0c\u53cd\u6b63\u6211\u5df2\u7ecf\u9488\u5bf9\u4e8b\u4ef6\u7f16\u5199\u4e86\u5904\u7406\u4ee3\u7801? \u7b54\u6848\u662f\u6709\u533a\u522b!\u6bd4\u5982 ACTION_MOVE \u6216\u8005 ACTION_UP \u53d1\u751f\u7684\u524d\u63d0\u662f\u4e00\u5b9a\u66fe\u7ecf\u53d1\u751f\u4e86 ACTION_DOWN\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u6d88\u8d39 ACTION_DOWN\uff0c\u90a3\u4e48\u7cfb\u7edf\u4f1a\u8ba4\u4e3a ACTION_DOWN \u6ca1\u6709 \u53d1\u751f\u8fc7\uff0c\u6240\u4ee5 ACTION_MOVE \u6216\u8005 ACTION_UP \u5c31\u4e0d\u80fd\u88ab\u6355\u83b7\u3002)</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#http-10http-20","title":"Http 1.0\u548cHttp 2.0\u7684\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <p>HTTP1.0  \u65e0\u72b6\u6001\u3001\u65e0\u8fde\u63a5 HTTP1.1 \u6301\u4e45\u8fde\u63a5 \u8bf7\u6c42\u7ba1\u9053\u5316 \u589e\u52a0\u7f13\u5b58\u5904\u7406(\u65b0\u7684\u5b57\u6bb5\u5982 cache-control) \u589e\u52a0 Host \u5b57\u6bb5\u3001\u652f\u6301\u65ad\u70b9\u4f20\u8f93\u7b49(\u628a\u6587\u4ef6\u5206\u6210\u51e0\u90e8\u5206) HTTP2.0  \u4e8c\u8fdb\u5236\u5206\u5e27 \u591a\u8def\u590d\u7528(\u6216\u8fde\u63a5\u5171\u4eab) \u5934\u90e8\u538b\u7f29</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#viewgetlocationinwindowviewgetlocationonscreen","title":"View.getLocationInWindow\u548cView.getLocationOnScreen\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> * View.getLocationInWindow(int[] location)\u662f\u83b7\u5f97\u63a7\u4ef6\u5728\u5176\u7236\u7a97\u53e3\u4e2d\u7684\u5750\u6807\u4f4d\u7f6e * View.getLocationOnScreen(int[] location)\u662f\u83b7\u5f97\u63a7\u4ef6\u5728\u5176\u6574\u4e2a\u5c4f\u5e55\u4e0a\u7684\u5750\u6807\u4f4d\u7f6e</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#httphttps","title":"http\u548chttps\u7684\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> https \u901a\u4fe1\u8fc7\u7a0b 1. \u5728\u4f7f\u7528 HTTPS \u662f\u9700\u8981\u4fdd\u8bc1\u670d\u52a1\u7aef\u914d\u7f6e\u6b63\u786e\u4e86\u5bf9\u5e94\u7684\u5b89\u5168\u8bc1\u4e66 2. \u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230\u670d\u52a1\u7aef 3. \u670d\u52a1\u7aef\u8fd4\u56de\u516c\u94a5\u548c\u8bc1\u4e66\u5230\u5ba2\u6237\u7aef 4. \u5ba2\u6237\u7aef\u63a5\u6536\u540e\u4f1a\u9a8c\u8bc1\u8bc1\u4e66\u7684\u5b89\u5168\u6027,\u5982\u679c\u901a\u8fc7\u5219\u4f1a\u968f\u673a\u751f\u6210\u4e00\u4e2a\u968f\u673a\u6570,\u7528\u516c\u94a5\u5bf9\u5176\u52a0\u5bc6, \u53d1\u9001\u5230\u670d\u52a1\u7aef 5. \u670d\u52a1\u7aef\u63a5\u53d7\u5230\u8fd9\u4e2a\u52a0\u5bc6\u540e\u7684\u968f\u673a\u6570\u540e\u4f1a\u7528\u79c1\u94a5\u5bf9\u5176\u89e3\u5bc6\u5f97\u5230\u771f\u6b63\u7684\u968f\u673a\u6570,\u968f\u540e\u7528\u8fd9\u4e2a\u968f\u673a\u6570\u5f53\u505a\u79c1\u94a5\u5bf9\u9700\u8981\u53d1\u9001\u7684\u6570\u636e\u8fdb\u884c\u5bf9\u79f0\u52a0\u5bc6 6. \u5ba2\u6237\u7aef\u5728\u63a5\u6536\u5230\u52a0\u5bc6\u540e\u7684\u6570\u636e\u4f7f\u7528\u79c1\u94a5(\u5373\u751f\u6210\u7684\u968f\u673a\u503c)\u5bf9\u6570\u636e\u8fdb\u884c\u89e3\u5bc6\u5e76\u4e14\u89e3\u6790\u6570\u636e \u5448\u73b0\u7ed3\u679c\u7ed9\u5ba2\u6237 7. SSL \u52a0\u5bc6\u5efa\u7acb</p> <p>HTTPS \u548c HTTP \u7684\u533a\u522b\u4e3b\u8981\u5982\u4e0b: 1. https \u534f\u8bae\u9700\u8981\u5230 ca \u7533\u8bf7\u8bc1\u4e66\uff0c\u4e00\u822c\u514d\u8d39\u8bc1\u4e66\u8f83\u5c11\uff0c\u56e0\u800c\u9700\u8981\u4e00\u5b9a\u8d39\u7528\u3002 2. http \u662f\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff0c\u4fe1\u606f\u662f\u660e\u6587\u4f20\u8f93\uff0chttps \u5219\u662f\u5177\u6709\u5b89\u5168\u6027\u7684 ssl \u52a0\u5bc6\u4f20\u8f93\u534f\u8bae\u3002  3. http \u548c https \u4f7f\u7528\u7684\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u8fde\u63a5\u65b9\u5f0f\uff0c\u7528\u7684\u7aef\u53e3\u4e5f\u4e0d\u4e00\u6837\uff0c\u524d\u8005\u662f 80\uff0c\u540e\u8005\u662f 443\u3002  4. http \u7684\u8fde\u63a5\u5f88\u7b80\u5355\uff0c\u662f\u65e0\u72b6\u6001\u7684;HTTPS \u534f\u8bae\u662f\u7531 SSL+HTTP \u534f\u8bae\u6784\u5efa\u7684\u53ef\u8fdb\u884c\u52a0\u5bc6\u4f20 \u8f93\u3001\u8eab\u4efd\u8ba4\u8bc1\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u6bd4 http \u534f\u8bae\u5b89\u5168\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#_2","title":"\u4e3a\u4ec0\u4e48\u8981\u6709\u5185\u90e8\u7c7b,\u9759\u6001\u5185\u90e8\u7c7b\u548c\u666e\u901a\u5185\u90e8\u7c7b\u533a\u522b\u662f\u4ec0\u4e48","text":"<ol> <li>\u5185\u90e8\u7c7b\u4e00\u822c\u53ea\u4e3a\u5176\u5916\u90e8\u7c7b\u4f7f\u7528;</li> <li>\u5185\u90e8\u7c7b\u63d0\u4f9b\u4e86\u67d0\u79cd\u8fdb\u5165\u5916\u90e8\u7c7b\u7684\u7a97\u6237; </li> <li>\u4e5f\u662f\u6700\u5438\u5f15\u4eba\u7684\u539f\u56e0\uff0c\u6bcf\u4e2a\u5185\u90e8\u7c7b\u90fd\u80fd\u72ec\u7acb\u5730\u7ee7\u627f\u4e00\u4e2a\u63a5\u53e3\uff0c\u800c\u65e0\u8bba\u5916\u90e8\u7c7b\u662f\u5426\u5df2\u7ecf\u7ee7 \u627f\u4e86\u67d0\u4e2a\u63a5\u53e3\u3002\u56e0\u6b64\uff0c\u5185\u90e8\u7c7b\u4f7f\u591a\u91cd\u7ee7\u627f\u7684\u89e3\u51b3\u65b9\u6848\u53d8\u5f97\u66f4\u52a0\u5b8c\u6574\u3002</li> </ol> <p>\u5185\u90e8\u7c7b\u548c\u5916\u90e8\u7c7b\u533a\u522b 1. \u5185\u90e8\u7c7b\u662f\u4e00\u4e2a\u7f16\u8bd1\u65f6\u6982\u5ff5\uff0c\u7f16\u8bd1\u540e\u5916\u90e8\u7c7b\u53ca\u5176\u5185\u90e8\u7c7b\u4f1a\u751f\u6210\u4e24\u4e2a\u72ec\u7acb\u7684 class \u6587\u4ef6: OuterClass.class \u548c OuterClass$InnerClass.class  2. \u5185\u90e8\u7c7b\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5916\u90e8\u7c7b\u7684\u5143\u7d20\uff0c\u4f46\u662f\u5916\u90e8\u7c7b\u4e0d\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5185\u90e8\u7c7b\u7684\u5143\u7d20 3. \u5916\u90e8\u7c7b\u53ef\u4ee5\u901a\u8fc7\u5185\u90e8\u7c7b\u5f15\u7528\u95f4\u63a5\u8bbf\u95ee\u5185\u90e8\u7c7b\u5143\u7d20 4. \u5bf9\u4e8e\u9759\u6001\u5185\u90e8\u7c7b\u6765\u8bf4\uff0c\u9759\u6001\u5185\u90e8\u7c7b\u662f\u4e0d\u4f9d\u8d56\u4e8e\u5916\u90e8\u7c7b\u7684\uff0c\u4e5f\u5c31\u8bf4\u53ef\u4ee5\u5728\u4e0d\u521b\u5efa\u5916\u90e8\u7c7b\u5bf9 \u8c61\u7684\u60c5\u51b5\u4e0b\u521b\u5efa\u5185\u90e8\u7c7b\u7684\u5bf9\u8c61\u3002\u53e6\u5916\uff0c\u9759\u6001\u5185\u90e8\u7c7b\u662f\u4e0d\u6301\u6709\u6307\u5411\u5916\u90e8\u7c7b\u5bf9\u8c61\u7684\u5f15\u7528\u7684</p> <p>\u9759\u6001\u5185\u90e8\u7c7b\u548c\u666e\u901a\u5185\u90e8\u7c7b \u9759\u6001\u5185\u90e8\u7c7b\u4e0e\u975e\u9759\u6001\u5185\u90e8\u7c7b\u4e4b\u95f4\u5b58\u5728\u4e00\u4e2a\u6700\u5927\u7684\u533a\u522b\uff0c\u6211\u4eec\u77e5\u9053\u975e\u9759\u6001\u5185\u90e8\u7c7b\u5728\u7f16\u8bd1\u5b8c\u6210\u4e4b \u540e\u4f1a\u9690\u542b\u5730\u4fdd\u5b58\u7740\u4e00\u4e2a\u5f15\u7528\uff0c\u8be5\u5f15\u7528\u662f\u6307\u5411\u521b\u5efa\u5b83\u7684\u5916\u56f4\u5185\u3002 \u4f46\u662f\u9759\u6001\u5185\u90e8\u7c7b\u5374\u6ca1\u6709\u3002\u6ca1\u6709\u8fd9\u4e2a\u5f15\u7528\u5c31\u610f\u5473\u7740: \u9759\u6001\u5185\u90e8\u7c7b\u7684\u521b\u5efa\u662f\u4e0d\u9700\u8981\u4f9d\u8d56\u4e8e\u5916\u56f4\u7c7b\uff0c\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa \u9759\u6001\u5185\u90e8\u7c7b\u4e0d\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u5916\u56f4\u7c7b\u7684\u975e static \u6210\u5458\u53d8\u91cf\u548c\u65b9\u6cd5\uff0c\u800c\u5185\u90e8\u7c7b\u5219\u90fd\u53ef\u4ee5 \u6ce8\u610f: 1. \u975e\u9759\u6001\u5185\u90e8\u7c7b\u4e2d\u4e0d\u5141\u8bb8\u5b9a\u4e49\u9759\u6001\u6210\u5458  2. \u5916\u90e8\u7c7b\u7684\u9759\u6001\u6210\u5458\u4e0d\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u975e\u9759\u6001\u5185\u90e8\u7c7b  3. \u9759\u6001\u5185\u90e8\u7c7b\uff0c\u4e0d\u80fd\u8bbf\u95ee\u5916\u90e8\u7c7b\u7684\u5b9e\u4f8b\u6210\u5458\uff0c\u53ea\u80fd\u8bbf\u95ee\u5916\u90e8\u7c7b\u7684\u7c7b\u6210</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#java","title":"Java\u4e2d\u56db\u79cd\u7ebf\u7a0b\u6c60\u7684\u603b\u7ed3","text":"<p><code>\u3010\u53c2\u8003\u3011:</code>\u5177\u4f53\u7684 4 \u79cd\u5e38\u7528\u7684\u7ebf\u7a0b\u6c60\u5b9e\u73b0\u5982\u4e0b:(\u8fd4\u56de\u503c\u90fd\u662f ExecutorService)</p> <ol> <li>Executors.newCacheThreadPool() \u53ef\u7f13\u5b58\u7ebf\u7a0b\u6c60\uff0c\u5148\u67e5\u770b\u6c60\u4e2d\u6709\u6ca1\u6709\u4ee5\u524d\u5efa\u7acb\u7684\u7ebf\u7a0b\uff0c \u5982\u679c\u6709\uff0c\u5c31\u76f4\u63a5\u4f7f\u7528\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u5efa\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u52a0\u5165\u6c60\u4e2d\uff0c\u7f13\u5b58\u578b\u6c60\u5b50\u901a\u5e38\u7528\u4e8e\u6267\u884c\u4e00 \u4e9b\u751f\u5b58\u671f\u5f88\u77ed\u7684\u5f02\u6b65\u578b\u4efb\u52a1\u3002</li> </ol> <pre><code>ExecutorService cachedThreadPool = Executors.newCachedThreadPool();\n</code></pre> <ol> <li>Executors.newFixedThreadPool(int n) \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u4ee5\u5171\u4eab\u7684\u65e0\u754c\u961f\u5217\u65b9\u5f0f\u6765\u8fd0\u884c\u8fd9\u4e9b\u7ebf\u7a0b</li> </ol> <pre><code>ExecutorService fixedThreadPool = Executors.newFixedThreadPool(3);\n</code></pre> <ol> <li>Executors.newScheduledThreadPool(int n): \u521b\u5efa\u4e00\u4e2a\u5b9a\u957f\u7ebf\u7a0b\u6c60\uff0c\u652f\u6301\u5b9a\u65f6\u53ca\u5468\u671f\u6027\u4efb\u52a1\u6267\u884c</li> </ol> <pre><code>ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(5);\n</code></pre> <ol> <li>Executors.newSingleThreadExecutor():\u521b\u5efa\u4e00\u4e2a\u5355\u7ebf\u7a0b\u5316\u7684\u7ebf\u7a0b\u6c60\uff0c\u5b83\u53ea\u4f1a\u7528\u552f\u4e00\u7684\u5de5\u4f5c\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\uff0c\u4fdd\u8bc1\u6240\u6709\u4efb\u52a1\u6309\u7167\u6307\u5b9a\u987a\u5e8f(FIFO, LIFO, \u4f18\u5148\u7ea7)\u6267\u884c\u3002</li> </ol> <pre><code>ExecutorService singleThreadExecutor = Executors.newSingleThreadExecutor();\n</code></pre> <pre><code>public ThreadPoolExecutor(int corePoolSize,\nint maximumPoolSize,\nlong keepAliveTime,\nTimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue) {\n    this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), defaultHandler);\n}\n</code></pre> <ul> <li>corePoolSize:\u6838\u5fc3\u6c60\u5927\u5c0f\uff0c\u610f\u601d\u662f\u5f53\u8d85\u8fc7\u8fd9\u4e2a\u8303\u56f4\u7684\u65f6\u5019\uff0c\u5c31\u9700\u8981\u5c06\u65b0\u7684\u7ebf\u7a0b\u653e\u5230\u7b49\u5f85\u961f\u5217 \u4e2d\u4e86\u5373 workQueue;</li> <li>maximumPoolSize:\u7ebf\u7a0b\u6c60\u6700\u5927\u7ebf\u7a0b\u6570\u91cf\uff0c\u8868\u660e\u7ebf\u7a0b\u6c60\u80fd\u521b\u5efa\u7684\u6700\u5927\u7ebf\u7a0b\u6570 </li> <li>keepAlivertime:\u5f53\u6d3b\u8dc3\u7ebf\u7a0b\u6570\u5927\u4e8e\u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u7a7a\u95f2\u7684\u591a\u4f59\u7ebf\u7a0b\u6700\u5927\u5b58\u6d3b\u65f6\u95f4\u3002 </li> <li>unit:\u5b58\u6d3b\u65f6\u95f4\u7684\u5355\u4f4d</li> <li>workQueue:\u5b58\u653e\u4efb\u52a1\u7684\u961f\u5217---\u963b\u585e\u961f\u5217 </li> <li>handler:\u8d85\u51fa\u7ebf\u7a0b\u8303\u56f4(maximumPoolSize)\u548c\u961f\u5217\u5bb9\u91cf\u7684\u4efb\u52a1\u7684\u5904\u7406\u7a0b\u5e8f</li> </ul> <p>\u6211\u4eec\u6267\u884c\u7ebf\u7a0b\u65f6\u90fd\u4f1a\u8c03\u7528\u5230 ThreadPoolExecutor \u7684 execute()\u65b9\u6cd5\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u65b9\u6cd5\u7684\u6e90\u7801(\u5c31\u662f\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u4e86\uff0c\u8fd9\u91cc\u9762\u6709\u4e00\u4e9b\u6ce8\u91ca\u89e3\u6790)\uff0c\u6211\u76f4\u63a5\u6765\u89e3\u91ca\u4e00\u4e0b\u5427:\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u6211\u4eec\u81f3\u5c11\u8981\u770b\u61c2\u4e00\u4e2a\u903b\u8f91:\u5f53\u5f53\u524d\u7ebf\u7a0b\u6570\u5c0f\u4e8e\u6838\u5fc3\u6c60\u7ebf\u7a0b\u6570\u65f6\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u7ebf\u7a0b\u5e76\u4e14\u542f\u52a8\u5b83\uff0c\u5982\u679c\u7ebf\u7a0b\u6570\u6570\u76ee\u5927\u4e8e\u6838\u5fc3\u7ebf\u7a0b\u6c60\u6570\u76ee\uff0c\u6211\u4eec\u5c06\u4efb\u52a1\u653e\u5230 workQueue\u4e2d\uff0c\u5982\u679c\u8fdeWorkQueue\u6ee1\u4e86\uff0c\u90a3\u4e48\u5c31\u8981\u62d2\u7edd\u4efb\u52a1\u4e86\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#intent","title":"Intent\u4f20\u9012\u6570\u636e\u7684\u9650\u5236\u5927\u5c0f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u7528Intent\u4f20\u9012\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u8d70\u7684\u662f\u8de8\u8fdb\u7a0b\u901a\u4fe1\uff08IPC\uff09\uff0c\u8de8\u8fdb\u7a0b\u901a\u4fe1\u9700\u8981\u628a\u6570\u636e\u4ece\u5185\u6838copy\u5230\u8fdb\u7a0b\u4e2d\uff0c\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\u6709\u4e00\u4e2a\u63a5\u6536\u5185\u6838\u6570\u636e\u7684\u7f13\u51b2\u533a\uff0c\u9ed8\u8ba4\u662f1M\uff1b\u5982\u679c\u4e00\u6b21\u4f20\u9012\u7684\u6570\u636e\u8d85\u8fc7\u9650\u5236\uff0c\u5c31\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002</p> <p>\u4e0d\u540c\u5382\u5546\u8868\u73b0\u4e0d\u4e00\u6837\u6709\u53ef\u80fd\u662f\u5382\u5546\u4fee\u6539\u4e86\u6b64\u9650\u5236\u7684\u5927\u5c0f\uff0c\u4e5f\u53ef\u80fd\u540c\u6837\u7684\u5bf9\u8c61\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u5927\u5c0f\u4e0d\u4e00\u6837\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onstartcommand","title":"onStartCommand \u7684\u51e0\u79cd\u6a21\u5f0f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <p>START_NOT_STICKY \u5982\u679c\u8fd4\u56de START_NOT_STICKY\uff0c\u8868\u793a\u5f53 Service \u8fd0\u884c\u7684\u8fdb\u7a0b\u88ab Android \u7cfb\u7edf\u5f3a\u5236\u6740\u6389\u4e4b\u540e\uff0c \u4e0d\u4f1a\u91cd\u65b0\u521b\u5efa\u8be5Service\u3002\u5f53\u7136\u5982\u679c\u5728\u5176\u88ab\u6740\u6389\u4e4b\u540e\u4e00\u6bb5\u65f6\u95f4\u53c8\u8c03\u7528\u4e86startService\uff0c\u90a3\u4e48\u8be5 Service \u53c8\u5c06\u88ab\u5b9e\u4f8b\u5316\u3002\u90a3\u4ec0\u4e48\u60c5\u5883\u4e0b\u8fd4\u56de\u8be5\u503c\u6bd4\u8f83\u6070\u5f53\u5462? \u5982\u679c\u6211\u4eec\u67d0\u4e2a Service \u6267\u884c\u7684\u5de5\u4f5c\u88ab\u4e2d\u65ad\u51e0\u6b21\u65e0\u5173\u7d27\u8981\u6216\u8005\u5bf9 Android \u5185\u5b58\u7d27\u5f20\u7684\u60c5\u51b5\u4e0b\u9700 \u8981\u88ab\u6740\u6389\u4e14\u4e0d\u4f1a\u7acb\u5373\u91cd\u65b0\u521b\u5efa\u8fd9\u79cd\u884c\u4e3a\u4e5f\u53ef\u63a5\u53d7\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u5c06 onStartCommand \u7684\u8fd4 \u56de\u503c\u8bbe\u7f6e\u4e3a START_NOT_STICKY\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c\u67d0\u4e2a Service \u9700\u8981\u5b9a\u65f6\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6700\u65b0\u6570\u636e:\u901a\u8fc7\u4e00\u4e2a\u5b9a\u65f6\u5668\u6bcf\u9694\u6307\u5b9a\u7684 N \u5206 \u949f\u8ba9\u5b9a\u65f6\u5668\u542f\u52a8 Service \u53bb\u83b7\u53d6\u670d\u52a1\u7aef\u7684\u6700\u65b0\u6570\u636e\u3002\u5f53\u6267\u884c\u5230 Service \u7684 onStartCommand \u65f6\uff0c\u5728\u8be5\u65b9\u6cd5\u5185\u518d\u89c4\u5212\u4e00\u4e2a N \u5206\u949f\u540e\u7684\u5b9a\u65f6\u5668\u7528\u4e8e\u518d\u6b21\u542f\u52a8\u8be5 Service \u5e76\u5f00\u8f9f\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b \u53bb\u6267\u884c\u7f51\u7edc\u64cd\u4f5c\u3002\u5047\u8bbe Service \u5728\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u6700\u65b0\u6570\u636e\u7684\u8fc7\u7a0b\u4e2d\u88ab Android \u7cfb\u7edf\u5f3a\u5236\u6740\u6389\uff0c Service \u4e0d\u4f1a\u518d\u91cd\u65b0\u521b\u5efa\uff0c\u8fd9\u4e5f\u6ca1\u5173\u7cfb\uff0c\u56e0\u4e3a\u518d\u8fc7 N \u5206\u949f\u5b9a\u65f6\u5668\u5c31\u4f1a\u518d\u6b21\u542f\u52a8\u8be5 Service \u5e76\u91cd \u65b0\u83b7\u53d6\u6570\u636e\u3002 START_STICKY \u5982\u679c\u8fd4\u56de START_STICKY\uff0c\u8868\u793a Service \u8fd0\u884c\u7684\u8fdb\u7a0b\u88ab Android \u7cfb\u7edf\u5f3a\u5236\u6740\u6389\u4e4b\u540e\uff0cAndroid \u7cfb\u7edf\u4f1a\u5c06\u8be5 Service \u4f9d\u7136\u8bbe\u7f6e\u4e3a started \u72b6\u6001(\u5373\u8fd0\u884c\u72b6\u6001)\uff0c\u4f46\u662f\u4e0d\u518d\u4fdd\u5b58 onStartCommand \u65b9\u6cd5\u4f20\u5165\u7684 intent \u5bf9\u8c61\uff0c\u7136\u540e Android \u7cfb\u7edf\u4f1a\u5c1d\u8bd5\u518d\u6b21\u91cd\u65b0\u521b\u5efa\u8be5 Service\uff0c\u5e76\u6267\u884c onStartCommand \u56de\u8c03\u65b9\u6cd5\uff0c\u4f46\u662f onStartCommand \u56de\u8c03\u65b9\u6cd5\u7684 Intent \u53c2\u6570\u4e3a null\uff0c\u4e5f\u5c31\u662f onStartCommand \u65b9\u6cd5\u867d\u7136\u4f1a\u6267\u884c\u4f46\u662f\u83b7\u53d6\u4e0d\u5230 intent \u4fe1\u606f\u3002\u5982\u679c\u4f60\u7684 Service \u53ef\u4ee5\u5728\u4efb\u610f \u65f6\u523b\u8fd0\u884c\u6216\u7ed3\u675f\u90fd\u6ca1\u4ec0\u4e48\u95ee\u9898\uff0c\u800c\u4e14\u4e0d\u9700\u8981 intent \u4fe1\u606f\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728 onStartCommand \u65b9 \u6cd5\u4e2d\u8fd4\u56de START_STICKY\uff0c\u6bd4\u5982\u4e00\u4e2a\u7528\u6765\u64ad\u653e\u80cc\u666f\u97f3\u4e50\u529f\u80fd\u7684 Service \u5c31\u9002\u5408\u8fd4\u56de\u8be5\u503c\u3002 START_REDELIVER_INTENT \u5982\u679c\u8fd4\u56de START_REDELIVER_INTENT\uff0c\u8868\u793a Service \u8fd0\u884c\u7684\u8fdb\u7a0b\u88ab Android \u7cfb\u7edf\u5f3a\u5236\u6740\u6389\u4e4b\u540e\uff0c\u4e0e\u8fd4\u56deSTART_STICKY\u7684\u60c5\u51b5\u7c7b\u4f3c\uff0cAndroid \u7cfb\u7edf\u4f1a\u5c06\u518d\u6b21\u91cd\u65b0\u521b\u5efa\u8be5 Service\uff0c\u5e76\u6267\u884c onStartCommand \u56de\u8c03\u65b9\u6cd5\uff0c\u4f46\u662f\u4e0d\u540c\u7684\u662f\uff0cAndroid \u7cfb\u7edf\u4f1a\u518d\u6b21\u5c06 Service \u5728\u88ab\u6740\u6389\u4e4b\u524d \u6700\u540e\u4e00\u6b21\u4f20\u5165 onStartCommand \u65b9\u6cd5\u4e2d\u7684 Intent \u518d\u6b21\u4fdd\u7559\u4e0b\u6765\u5e76\u518d\u6b21\u4f20\u5165\u5230\u91cd\u65b0\u521b\u5efa\u540e\u7684 Service \u7684 onStartCommand \u65b9\u6cd5\u4e2d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u8bfb\u53d6\u5230 intent \u53c2\u6570\u3002\u53ea\u8981\u8fd4\u56de START_REDELIVER_INTENT\uff0c\u90a3\u4e48 onStartCommand \u91cd\u7684 intent \u4e00\u5b9a\u4e0d\u662f null\u3002\u5982\u679c\u6211\u4eec\u7684 Service \u9700\u8981\u4f9d\u8d56\u5177\u4f53\u7684 Intent \u624d\u80fd\u8fd0\u884c(\u9700\u8981\u4ece Intent \u4e2d\u8bfb\u53d6\u76f8\u5173\u6570\u636e\u4fe1\u606f\u7b49)\uff0c\u5e76\u4e14\u5728\u5f3a \u5236\u9500\u6bc1\u540e\u6709\u5fc5\u8981\u91cd\u65b0\u521b\u5efa\u8fd0\u884c\uff0c\u90a3\u4e48\u8fd9\u6837\u7684 Service \u5c31\u9002\u5408\u8fd4\u56de START_REDELIVER_INTENT</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#relativelayoutonmeasuremeasure","title":"RelativeLayout\u7684onMeasure\u65b9\u6cd5\u662f\u600e\u4e48Measure\u7684","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u53d1\u73b0 RelativeLayout \u4f1a\u6839\u636e 2\u6b21\u6392\u5217\u7684\u7ed3\u679c\u5bf9\u5b50View\u5404\u505a\u4e00\u6b21 measure\u3002 \u800c\u5728\u505a\u6a2a\u5411\u7684\u6d4b\u91cf\u65f6\uff0c\u7eb5\u5411\u7684\u6d4b\u91cf\u7ed3\u679c\u5c1a\u672a\u5b8c\u6210\uff0c\u53ea\u597d\u6682\u65f6\u4f7f\u7528 myHeight \u4f20\u5165\u5b50View\u7cfb\u7edf\u3002 \u8fd9\u6837\u5fc5\u7136\u4f1a\u5bfc\u81f4\u5b50View\u7684\u9ad8\u5ea6\u548c RelativeLayout \u7684\u9ad8\u5ea6\u4e0d\u540c\u65f6\uff0c\u7b2c 3 \u70b9\u4e2d\u6240\u8bf4\u7684\u4f18\u5316\u4f1a\u5931\u6548\uff0c\u5728View\u7cfb\u7edf\u8db3\u591f\u590d\u6742\u65f6\uff0c\u6548\u7387\u95ee\u9898\u5c31\u4f1a\u51fa\u73b0\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#cpu","title":"\u4e3b\u7ebf\u7a0b\u7684\u6b7b\u5faa\u73af\u662f\u5426\u4e00\u81f4\u8017\u8d39CPU\u8d44\u6e90","text":"<p><code>\u3010\u53c2\u8003\u3011:</code>  \u5728\u4e3b\u7ebf\u7a0b\u4f7f\u7528 Looper.loop \u53ef\u4ee5\u4fdd\u8bc1\u4e3b\u7ebf\u7a0b\u4e00\u76f4\u5728\u8fd0\u884c\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u5728 Looper.loop \u6b7b\u5faa\u73af\u4e4b \u524d\uff0c\u5df2\u7ecf\u521b\u5efa\u4e86\u4e00\u4e2a Binder \u7ebf\u7a0b: thread.attach \u4f1a\u5efa\u7acb Binder \u901a\u9053\uff0c\u521b\u5efa\u65b0\u7ebf\u7a0b\u3002attach(false)\u4f1a\u521b\u5efa\u4e00\u4e2a ApplicaitonThread \u7684 Binder \u7ebf\u7a0b\uff0c\u7528\u4e8e\u63a5\u53d7 AMS \u53d1\u6765\u7684\u6d88\u606f\uff0c\u8be5 Binder \u7ebf\u7a0b\u901a\u8fc7 ActivityThread \u7684 H \u7c7b\u578b Handler \u5c06\u6d88\u606f\u53d1\u9001\u7ed9\u4e3b\u7ebf\u7a0b\u3002ActivityThread \u5e76\u4e0d\u662f\u7ebf\u7a0b\u7c7b\uff0c\u53ea\u662f\u5b83\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u3002 Handler \u5e95\u5c42\u91c7\u7528 Linux \u7684 pipe/epoll \u673a\u5236\uff0cMessageQueue \u6ca1\u6709\u6d88\u606f\u7684\u65f6\u5019\uff0c\u4fbf\u963b\u585e\u5728 Looper.mQueue.next \u65b9\u6cd5\u4e2d\uff0c\u6b64\u65f6\u4e3b\u7ebf\u7a0b\u4f1a\u91ca\u653e CPU \u8d44\u6e90\u8fdb\u5165\u4f11\u7720\uff0c\u76f4\u5230\u4e0b\u4e2a\u4e8b\u4ef6\u5230\u8fbe\uff0c \u5f53\u6709\u65b0\u6d88\u606f\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u5f80 pipe \u7ba1\u9053\u5199\u6570\u636e\u6765\u5524\u9192\u4e3b\u7ebf\u7a0b\u5de5\u4f5c\u3002\u6240\u4ee5\u4e3b\u7ebf\u7a0b\u5927\u591a\u6570\u65f6\u5019\u5904 \u4e8e\u4f11\u7720\u72b6\u6001\uff0c\u4e0d\u4f1a\u963b\u585e\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#service-intentservice","title":"Service \u548c IntentService \u7684\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> 1. IntentService \u662f\u7ee7\u627f\u5e76\u5904\u7406\u5f02\u6b65\u8bf7\u6c42\u7684\u4e00\u4e2a\u7c7b\uff0c\u5728 IntentService \u5185\u6709\u4e00\u4e2a\u5de5\u4f5c \u7ebf\u7a0b\u6765\u5904\u7406\u8017\u65f6\u64cd\u4f5c\uff0c\u542f\u52a8 IntentService \u7684\u65b9\u5f0f\u548c\u542f\u52a8\u4f20\u7edf\u7684 Service \u4e00\u6837\uff0c\u540c\u65f6\uff0c\u5f53\u4efb\u52a1 \u6267\u884c\u5b8c\u540e\uff0cIntentService \u4f1a\u81ea\u52a8\u505c\u6b62\uff0c\u800c\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u53bb\u63a7\u5236\u6216 stopSelf()\u3002\u53e6\u5916\uff0c\u53ef\u4ee5\u542f \u52a8 IntentService \u591a\u6b21\uff0c\u800c\u6bcf\u4e00\u4e2a\u8017\u65f6\u64cd\u4f5c\u4f1a\u4ee5\u5de5\u4f5c\u961f\u5217\u7684\u65b9\u5f0f\u5728 IntentService \u7684 onHandleIntent \u56de\u8c03\u65b9\u6cd5\u4e2d\u6267\u884c\uff0c\u5e76\u4e14\uff0c\u6bcf\u6b21\u53ea\u4f1a\u6267\u884c\u4e00\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u6267\u884c\u5b8c\u7b2c\u4e00\u4e2a\u518d\u6267\u884c \u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002 2. \u5b50\u7c7b\u9700\u7ee7\u627f IntentService \u5e76\u4e14\u5b9e\u73b0\u91cc\u9762\u7684 onHandlerIntent \u62bd\u8c61\u65b9\u6cd5\u6765\u5904\u7406 intent \u7c7b\u578b \u7684\u4efb\u52a1\u8bf7\u6c42\u3002 3. \u5b50\u7c7b\u9700\u8981\u91cd\u5199\u9ed8\u8ba4\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u4e14\u5728\u6784\u9020\u65b9\u6cd5\u4e2d\u8c03\u7528\u7236\u7c7b\u5e26\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u3002 4. IntentService \u7c7b\u5185\u90e8\u5229\u7528 HandlerThread+Handler \u6784\u5efa\u4e86\u4e00\u4e2a\u5e26\u6709\u6d88\u606f\u5faa\u73af\u5904\u7406\u673a\u5236\u7684 \u540e\u53f0\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u5ba2\u6237\u7aef\u53ea\u9700\u8c03\u7528 Content#startService(Intent)\u5c06 Intent \u4efb\u52a1\u8bf7\u6c42\u653e\u5165\u540e\u53f0\u5de5 \u4f5c\u961f\u5217\u4e2d\uff0c\u4e14\u5ba2\u6237\u7aef\u65e0\u9700\u5173\u6ce8\u670d\u52a1\u662f\u5426\u7ed3\u675f\uff0c\u975e\u5e38\u9002\u5408\u4e00\u6b21\u6027\u7684\u540e\u53f0\u4efb\u52a1\u3002\u6bd4\u5982\u6d4f\u89c8\u5668\u4e0b\u8f7d \u6587\u4ef6\uff0c\u9000\u51fa\u5f53\u524d\u6d4f\u89c8\u5668\u4e4b\u540e\uff0c\u4e0b\u8f7d\u4efb\u52a1\u4f9d\u7136\u5b58\u5728\u540e\u53f0\uff0c\u76f4\u5230\u4e0b\u8f7d\u6587\u4ef6\u7ed3\u675f\uff0c\u670d\u52a1\u81ea\u52a8\u9500\u6bc1\u3002 \u53ea\u8981\u5f53\u524d IntentService \u670d\u52a1\u6ca1\u6709\u88ab\u9500\u6bc1\uff0c\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u540c\u65f6\u6295\u653e\u591a\u4e2a Intent \u5f02\u6b65\u4efb\u52a1\u8bf7\u6c42\uff0c IntentService \u670d\u52a1\u7aef\u8fd9\u8fb9\u662f\u987a\u5e8f\u6267\u884c\u5f53\u524d\u540e\u53f0\u5de5\u4f5c\u961f\u5217\u4e2d\u7684 Intent \u8bf7\u6c42\u7684\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u65f6\u523b \u53ea\u80fd\u6267\u884c\u4e00\u4e2a Intent \u8bf7\u6c42\uff0c\u76f4\u5230\u8be5 Intent \u5904\u7406\u7ed3\u675f\u624d\u5904\u7406\u4e0b\u4e00\u4e2a Intent\u3002\u56e0\u4e3a IntentService \u7c7b\u5185\u90e8\u5229\u7528 HandlerThread+Handler \u6784\u5efa\u7684\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\u6765\u5904\u7406\u5f02\u6b65\u4efb\u52a1\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#sqlitesql","title":"SQLite\u589e\u5220\u6539\u67e5\u4ee5\u53ca\u5347\u7ea7\u7684sql\u8bed\u53e5","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <pre><code>public SQLiteOpenHelper(Context context, String name, CursorFactory factory, int version) {\n        this(context, name, factory, version, null);\n    }\n\n    public SQLiteDatabase getWritableDatabase() {\n        synchronized (this) {\n            return getDatabaseLocked(true);\n        }\n    }\n\n  private SQLiteDatabase getDatabaseLocked(boolean writable) {\n      .......\n      db.beginTransaction();\n      try {\n              if (version == 0) {\n                   onCreate(db);\n              } else {\n                   if (version &gt; mNewVersion) {\n                         onDowngrade(db, version, mNewVersion);\n                   } else {\n                         onUpgrade(db, version, mNewVersion);\n                   }\n              }\n               db.setVersion(mNewVersion);\n                db.setTransactionSuccessful();\n              } finally {\n                 db.endTransaction();\n              }\n  }\n\n</code></pre> <p>onUpgrade()\u4f1a\u88ab\u89e6\u53d1\uff0c\u53ef\u4ee5\u5728\u8be5\u65b9\u6cd5\u4e2d\u7f16\u5199\u6570\u636e\u5e93\u5347\u7ea7\u903b\u8f91\u3002\u5177\u4f53\u7684\u6570\u636e\u5e93\u5347\u7ea7\u903b\u8f91\u793a\u4f8b\u53ef\u53c2\u8003\u8fd9\u91cc.</p> <p>\u5e38\u7528\u7684SQL\u589e\u5220\u6539\u67e5\uff1a - \u589e\uff1aINSERT INTO table_name (\u52171, \u52172,\u2026) VALUES (\u503c1, \u503c2,\u2026.) - \u5220\uff1a DELETE FROM \u8868\u540d\u79f0 WHERE \u5217\u540d\u79f0 = \u503c - \u6539\uff1aUPDATE \u8868\u540d\u79f0 SET \u5217\u540d\u79f0 = \u65b0\u503c WHERE \u5217\u540d\u79f0 = \u67d0\u503c - \u67e5\uff1aSELECT \u5217\u540d\u79f0\uff08\u901a\u914d\u662f*\u7b26\u53f7\uff09 FROM \u8868\u540d\u79f0 ps:\u64cd\u4f5c\u6570\u636e\u8868\u662f:ALTER TABLE\u3002\u8be5\u8bed\u53e5\u7528\u4e8e\u5728\u5df2\u6709\u7684\u8868\u4e2d\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u5217\u3002 - ALTER TABLE table_name ADD column_name datatype - ALTER TABLE table_name DROP COLUMN column_name - ALTER TABLE table_name_old RENAME TO table_name_new</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#service","title":"Service\u7684\u751f\u547d\u5468\u671f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> Service\u662f\u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u7684\uff0c\u5373\u4e3b\u7ebf\u7a0b\u3002 - startService() \u5f00\u542fService\uff0c\u8c03\u7528\u8005\u9000\u51fa\u540eService\u4ecd\u8ba9\u5b58\u5728\u3002 - bindService() \u5f00\u542fService\uff0c\u8c03\u7528\u8005\u9000\u51fa\u540eService\u4e5f\u968f\u5373\u9000\u51fa\u3002</p> <p>Service\u7684\u751f\u547d\u5468\u671f - \u53ea\u662fstartService\u7684\u60c5\u51b5\u4e0b\uff0conCreate() -&gt; onStartCommand() -&gt; onDestroy() - \u53ea\u662fbindService\u7684\u60c5\u51b5\u4e0b\uff0conCreate() -&gt; onBind() -&gt; onUnBind() -&gt; onDestroy()</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#activity","title":"Activity\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u5f0f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> - Intent  - \u501f\u52a9\u7c7b\u7684\u9759\u6001\u53d8\u91cf  - \u501f\u52a9\u5168\u5c40\u53d8\u91cf/Application  - \u501f\u52a9\u5916\u90e8\u5de5\u5177     * \u501f\u52a9 SharedPreference     * \u4f7f\u7528 Android \u6570\u636e\u5e93 SQLite \u2013 \u8d64\u88f8\u88f8\u7684\u4f7f\u7528File     * Android \u526a\u5207\u677f - \u501f\u52a9Service</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#surfaceviewtextureview","title":"SurfaceView\u548cTextureView\u7684\u533a\u522b","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u76f8\u540c\u70b9\uff1a\u90fd\u7ee7\u627f\u4e8eView\uff0c\u53ef\u5728\u72ec\u7acb\u7ebf\u7a0b\u7ed8\u5236\u548c\u6e32\u67d3\u3002</p> <p>\u4e0d\u540c\u70b9\uff1a * SurfaceView\uff1a\u5d4c\u5165\u89c6\u56fe\u5c42\u7ea7\u5185\u7684\u7ed8\u5236\u754c\u9762\uff0c\u662f\u4e00\u79cd\u72ec\u7acb\u7684View\uff0c\u66f4\u50cf\u662fWindow\uff0c\u4e0d\u80fd\u505a\u7f29\u653e\u3001\u5e73\u79fb\u3001\u753b\u5706\u89d2\u7b49\u4e00\u822cView\u5f62\u5f0f\u64cd\u4f5c\uff1b * TextureView\uff1a\u66f4\u50cf\u662f\u4e00\u822c\u7684View\uff0c\u53ef\u4ee5\u505a\u7f29\u653e\u3001\u5e73\u79fb\u7b49View\u5f62\u5f0f\u64cd\u4f5c\uff1b</p> <p>\u4ece\u6027\u80fd\u548c\u5b89\u5168\u6027\u89d2\u5ea6\u51fa\u53d1\uff0c\u4f7f\u7528\u64ad\u653e\u5668\u4f18\u5148\u9009SurfaceView\u3002 1.\u5728android 7.0\u4e0a\u7cfb\u7edfsurfaceview\u7684\u6027\u80fd\u6bd4TextureView\u66f4\u6709\u4f18\u52bf\uff0c\u652f\u6301\u5bf9\u8c61\u7684\u5185\u5bb9\u4f4d\u7f6e\u548c\u5305\u542b\u7684\u5e94\u7528\u5185\u5bb9\u540c\u6b65\u66f4\u65b0\uff0c\u5e73\u79fb\u3001\u7f29\u653e\u4e0d\u4f1a\u4ea7\u751f\u9ed1\u8fb9\u3002 \u57287.0\u4ee5\u4e0b\u7cfb\u7edf\u5982\u679c\u4f7f\u7528\u573a\u666f\u6709\u52a8\u753b\u6548\u679c\uff0c\u53ef\u4ee5\u9009\u62e9\u6027\u4f7f\u7528TextureView 2.SurfaceView\u4f18\u70b9\u53ca\u7f3a\u70b9\u4f18\u70b9\uff1a\u53ef\u4ee5\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d\u8fdb\u884c\u7ed8\u5236\uff0c\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u7ebf\u7a0b\uff0c\u4f7f\u7528\u53cc\u7f13\u51b2\u673a\u5236\uff0c\u64ad\u653e\u89c6\u9891\u65f6\u753b\u9762\u66f4\u6d41\u7545 \u7f3a\u70b9\uff1aSurface\u4e0d\u5728View hierachy\u4e2d\uff0c\u5b83\u7684\u663e\u793a\u4e5f\u4e0d\u53d7View\u7684\u5c5e\u6027\u63a7\u5236\uff0c\u6240\u4ee5\u4e0d\u80fd\u8fdb\u884c\u5e73\u79fb\uff0c\u7f29\u653e\u7b49\u53d8\u6362\uff0c\u4e5f\u4e0d\u80fd\u653e\u5728\u5176\u5b83ViewGroup\u4e2d\u3002SurfaceView \u4e0d\u80fd\u5d4c\u5957\u4f7f\u7528 TextureView\u4f18\u70b9\u53ca\u7f3a\u70b9 \u4f18\u70b9\uff1a\u652f\u6301\u79fb\u52a8\u3001\u65cb\u8f6c\u3001\u7f29\u653e\u7b49\u52a8\u753b\uff0c\u652f\u6301\u622a\u56fe \u7f3a\u70b9\uff1a\u5fc5\u987b\u5728\u786c\u4ef6\u52a0\u901f\u7684\u7a97\u53e3\u4e2d\u4f7f\u7528\uff0c\u5360\u7528\u5185\u5b58\u6bd4SurfaceView\u9ad8\uff0c\u57285.0\u4ee5\u524d\u5728\u4e3b\u7ebf\u7a0b\u6e32\u67d3\uff0c5.0\u4ee5\u540e\u6709\u5355\u72ec\u7684\u6e32\u67d3\u7ebf\u7a0b</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onsaveinstancestateonrestoreinstancestate","title":"onSaveInstanceState\u548conRestoreInstanceState\u8c03\u7528\u65f6\u673a","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <pre><code>03-09 12:14:32.529 2298-2298/com.example.myapplication I/MY_TEST: onPause \n03-09 12:14:32.556 2298-2298/com.example.myapplication I/MY_TEST: onCreate2\n03-09 12:14:32.557 2298-2298/com.example.myapplication I/MY_TEST: onStart2\n03-09 12:14:32.557 2298-2298/com.example.myapplication I/MY_TEST: onResume2\n03-09 12:14:32.981 2298-2298/com.example.myapplication I/MY_TEST: onSaveInstanceState \u4e00\u4e2a\u53c2\u6570\n03-09 12:14:32.981 2298-2298/com.example.myapplication I/MY_TEST: onStop\n\n\u5206\u5272\u7ebf-------------------------------------------------------------------------\n\n03-09 12:15:28.715 2298-2298/com.example.myapplication I/MY_TEST: onPause2\n03-09 12:15:28.763 2298-2298/com.example.myapplication I/MY_TEST: onCreate\n03-09 12:15:28.764 2298-2298/com.example.myapplication I/MY_TEST: onStart\n03-09 12:15:28.764 2298-2298/com.example.myapplication I/MY_TEST: onRestoreInstanceState\n03-09 12:15:28.767 2298-2298/com.example.myapplication I/MY_TEST: onActivityResult \n03-09 12:15:28.767 2298-2298/com.example.myapplication I/MY_TEST: onResume \n03-09 12:15:29.141 2298-2298/com.example.myapplication I/MY_TEST: onStop2\n03-09 12:15:29.141 2298-2298/com.example.myapplication I/MY_TEST: onDestroy2\n</code></pre> <ol> <li>\u8df3\u8f6c\u8fc7\u7a0b\u4e2d\uff0c\u5148\u6267\u884c1\u7684onpause\uff0c\u7b49\u7b49 onstop\uff0c\u7b49\u5f852\u7684onresume\u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u518d\u6267\u884c1\u7684onstop\u3001ondestory</li> <li>onSaveInstanceState\u6bcf\u6b21\u9690\u85cfactivity\u90fd\u4f1a\u5728onpause\u4e4b\u540e\u6267\u884c(\u5373\u4f7factivity\u6ca1\u6709\u9500\u6bc1\u4e5f\u4f1a\u6267\u884c)</li> <li>onRestoreInstance \u5728 onstart \u4e4b\u540e\uff0conActivityResult \u4e4b\u524d\u6267\u884c</li> </ol>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#leakcanary","title":"LeakCanary\u539f\u7406","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <p>\u5f31\u5f15\u7528WeakReference \u88ab\u5f3a\u5f15\u7528\u7684\u5bf9\u8c61\u5c31\u7b97\u53d1\u751f OOM \u4e5f\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u5783\u573e\u56de\u6536\u673a\u56de\u6536; \u88ab\u5f31\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u53ea\u8981\u88ab\u5783\u573e\u56de\u6536\u5668\u53d1\u73b0\u5c31\u4f1a\u7acb\u5373\u88ab\u56de\u6536; \u88ab\u8f6f\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u5177\u5907\u5185\u5b58\u654f\u611f\u6027\uff0c\u53ea\u6709\u5185\u5b58\u4e0d\u8db3\u65f6\u624d\u4f1a \u88ab\u56de\u6536\uff0c\u5e38\u7528\u6765\u505a\u5185\u5b58\u654f\u611f\u7f13\u5b58\u5668; \u865a\u5f15\u7528\u5219\u4efb\u610f\u65f6\u523b\u90fd\u53ef\u80fd\u88ab\u56de\u6536\uff0c\u4f7f\u7528\u8f83\u5c11\u3002</p> <p>\u5f15\u7528\u961f\u5217ReferenceQueue</p> <p>\u6211\u4eec\u5e38\u7528\u4e00\u4e2a WeakReference reference = new WeakReference(activity);\uff0c\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e86 \u4e00\u4e2a reference \u6765\u5f31\u5f15\u7528\u5230\u67d0\u4e2a activity\uff0c\u5f53\u8fd9\u4e2a activity \u88ab\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u540e\uff0c\u8fd9\u4e2a reference \u4f1a\u88ab\u653e\u5165\u5185\u90e8\u7684 ReferenceQueue \u4e2d\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u961f\u5217 ReferenceQueue \u53d6\u51fa \u6765\u7684\u6240\u6709 reference\uff0c\u5b83\u4eec\u6307\u5411\u7684\u771f\u5b9e\u5bf9\u8c61\u90fd\u5df2\u7ecf\u6210\u529f\u88ab\u56de\u6536\u4e86\u3002</p> <ol> <li>\u5229\u7528 application.registerActivityLifecycleCallbacks(lifecycleCallbacks) \u6765\u76d1\u542c\u6574\u4e2a\u751f\u547d\u5468\u671f\u5185\u7684 Activity onDestoryed \u4e8b\u4ef6;</li> <li>\u5f53\u67d0\u4e2a Activity \u88ab destory \u540e\uff0c\u5c06\u5b83\u4f20\u7ed9 RefWatcher \u53bb\u505a\u89c2\u6d4b\uff0c\u786e\u4fdd\u5176\u540e\u7eed\u4f1a\u88ab\u6b63\u5e38 \u56de\u6536;</li> <li>RefWatcher \u9996\u5148\u628a Activity \u4f7f\u7528 KeyedWeakReference \u5f15\u7528\u8d77\u6765\uff0c\u5e76\u4f7f\u7528\u4e00\u4e2a ReferenceQueue \u6765\u8bb0\u5f55\u8be5 KeyedWeakReference \u6307\u5411\u7684\u5bf9\u8c61\u662f\u5426\u5df2\u88ab\u56de\u6536;</li> <li>AndroidWatchExecutor \u4f1a\u5ef6\u8fdf 5 \u79d2\u540e\uff0c\u518d\u5f00\u59cb\u68c0\u67e5\u8fd9\u4e2a\u5f31\u5f15\u7528\u5185\u7684 Activity \u662f\u5426\u88ab\u6b63\u5e38 \u56de\u6536\u3002\u5224\u65ad\u6761\u4ef6\u662f:\u82e5 Activity \u88ab\u6b63\u5e38\u56de\u6536\uff0c\u90a3\u4e48\u5f15\u7528\u5b83\u7684 KeyedWeakReference \u4f1a\u88ab\u81ea \u52a8\u653e\u5165 ReferenceQueue \u4e2d\u3002</li> <li>\u5224\u65ad\u65b9\u5f0f\u662f:\u5148\u770b Activity \u5bf9\u5e94\u7684 KeyedWeakReference \u662f\u5426\u5df2\u7ecf\u653e\u5165 ReferenceQueue \u4e2d;\u5982\u679c\u6ca1\u6709\uff0c\u5219\u624b\u52a8 GC:gcTrigger.runGc();;\u7136\u540e\u518d\u4e00\u6b21\u5224\u65ad ReferenceQueue \u662f\u5426\u5df2\u7ecf\u542b\u6709\u5bf9\u5e94\u7684 KeyedWeakReference\u3002\u82e5\u8fd8\u672a\u88ab\u56de\u6536\uff0c\u5219\u8ba4\u4e3a\u53ef\u80fd\u53d1 \u751f\u5185\u5b58\u6cc4\u6f0f\u3002</li> <li>\u5229\u7528 HeapAnalyzer \u5bf9 dump \u7684\u5185\u5b58\u60c5\u51b5\u8fdb\u884c\u5206\u6790\u5e76\u8fdb\u4e00\u6b65\u786e\u8ba4\uff0c\u82e5\u786e\u5b9a\u53d1\u751f\u6cc4\u6f0f\uff0c\u5219 \u5229\u7528 HeapAnalyzerService\u53d1\u9001\u901a\u77e5\u3002</li> <li>\u5f31\u5f15\u7528\u4e0e ReferenceQueue \u8054\u5408\u4f7f\u7528\uff0c\u5982\u679c\u5f31\u5f15\u7528\u5173\u8054\u7684\u5bf9\u8c61\u88ab\u56de\u6536\uff0c\u5219\u4f1a\u628a\u8fd9\u4e2a\u5f31\u5f15\u7528 \u52a0\u5165\u5230 ReferenceQueue \u4e2d;\u901a\u8fc7\u8fd9\u4e2a\u539f\u7406\uff0c\u53ef\u4ee5\u770b\u51fa removeWeaklyReachableReferences() \u6267\u884c\u540e\uff0c\u4f1a\u5bf9\u5e94\u5220\u9664 KeyedWeakReference \u7684\u6570\u636e\u3002\u5982\u679c\u8fd9\u4e2a\u5f15\u7528\u7ee7\u7eed\u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u6ca1 \u6709\u88ab\u56de\u6536\u3002</li> <li>\u4e3a\u4e86\u786e\u4fdd\u6700\u5927\u4fdd\u9669\u7684\u5224\u5b9a\u662f\u5426\u88ab\u56de\u6536\uff0c\u4e00\u5171\u6267\u884c\u4e86\u4e24\u6b21\u56de\u6536\u5224\u5b9a\uff0c\u5305\u62ec\u4e00\u6b21\u624b\u52a8 GC \u540e \u7684\u56de\u6536\u5224\u5b9a\u3002\u4e24\u6b21\u90fd\u6ca1\u6709\u88ab\u56de\u6536\uff0c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u8bf4\u660e\u4e86\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5185\u5b58\u88ab\u6cc4\u6f0f\u4e86\uff0c\u4f46\u5e76\u4e0d\u80fd 100% \u4fdd\u8bc1;\u56e0\u6b64 LeakCanary\u662f\u5b58\u5728\u6781\u5c0f\u7a0b\u5ea6\u7684\u8bef\u5dee\u7684\u3002</li> </ol>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#androidcontentprovider","title":"Android\u7cfb\u7edf\u4e3a\u4ec0\u4e48\u4f1a\u8bbe\u8ba1ContentProvider","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <p>\u5728\u5f00\u53d1\u4e2d\uff0c\u5047\u5982\uff0cA\u3001B \u8fdb\u7a0b\u6709\u90e8\u5206\u4fe1\u606f\u9700\u8981\u540c\u6b65\uff0c\u8fd9\u4e2a\u65f6\u5019\u600e\u4e48\u5904\u7406\u5462?\u8bbe\u60f3\u8fd9\u4e48\u4e00\u4e2a\u573a \u666f\uff0c\u6709\u4e2a\u4e1a\u52a1\u590d\u6742\u7684 Activity \u975e\u5e38\u5360\u7528\u5185\u5b58\uff0c\u5e76\u5f15\u53d1 OOM\uff0c\u6240\u4ee5\uff0c\u60f3\u8981\u628a\u8fd9\u4e2a Activity \u653e\u5230 \u5355\u72ec\u8fdb\u7a0b\uff0c\u4ee5\u4fdd\u8bc1 OOM \u65f6\u4e3b\u8fdb\u7a0b\u4e0d\u5d29\u6e83\u3002\u4f46\u662f\uff0c\u4e24\u4e2a\u6574\u4e2a APP \u6709\u4e9b\u4fe1\u606f\u9700\u8981\u4fdd\u6301\u540c\u6b65\uff0c\u6bd4 \u5982\u767b\u9646\u4fe1\u606f\u7b49\uff0c\u65e0\u8bba\u54ea\u4e2a\u8fdb\u7a0b\u767b\u9646\u6216\u8005\u4fee\u6539\u4e86\u76f8\u5e94\u4fe1\u606f\uff0c\u90fd\u8981\u540c\u6b65\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u53bb\uff0c\u8fd9\u4e2a \u65f6\u5019\u600e\u4e48\u505a\u5462?</p> <p>\u7b2c\u4e00\u79cd:\u4e00\u4e2a\u8fdb\u7a0b\u91cc\u9762\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u91c7\u7528SharePreference \u6765\u505a\uff0c\u4f46\u662fSharePreference \u4e0d\u652f\u6301\u591a\u8fdb\u7a0b\uff0c\u5b83\u57fa\u4e8e\u5355\u4e2a\u6587\u4ef6\u7684\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u8003\u8651\u540c\u6b65\u4e92\u65a5\uff0c\u800c\u4e14\uff0cAPP\u5bf9SP\u5bf9\u8c61\u505a\u4e86\u7f13\u5b58\uff0c \u4e0d\u597d\u4e92\u65a5\u540c\u6b65\uff0c\u867d\u7136\u53ef\u4ee5\u901a\u8fc7 FileLock \u6765\u5b9e\u73b0\u4e92\u65a5\uff0c\u4f46\u540c\u6b65\u4ecd\u7136\u662f\u4e00\u4e2a\u95ee\u9898\u3002 \u7b2c\u4e8c\u79cd:\u57fa\u4e8e Binder \u901a\u4fe1\u5b9e\u73b0 Service \u5b8c\u6210\u8de8\u8fdb\u7a0b\u6570\u636e\u7684\u5171\u4eab\uff0c\u80fd\u591f\u4fdd\u8bc1\u5355\u8fdb\u7a0b\u8bbf\u95ee\u6570\u636e\uff0c \u4e0d\u4f1a\u6709\u4e92\u65a5\u95ee\u9898\uff0c\u53ef\u662f\u540c\u6b65\u7684\u4e8b\u60c5\u4ecd\u7136\u9700\u8981\u5f00\u53d1\u8005\u624b\u52a8\u5904\u7406\u3002 \u7b2c\u4e09\u79cd:\u57fa\u4e8eAndroid\u63d0\u4f9b\u7684ContentProvider\u6765\u5b9e\u73b0\uff0cContentProvider \u540c\u6837\u57fa\u4e8eBinder\uff0c \u4e0d\u5b58\u5728\u8fdb\u7a0b\u95f4\u4e92\u65a5\u95ee\u9898\uff0c\u5bf9\u4e8e\u540c\u6b65\uff0c\u4e5f\u505a\u4e86\u5f88\u597d\u7684\u5c01\u88c5\uff0c\u4e0d\u9700\u8981\u5f00\u53d1\u8005\u989d\u5916\u5b9e\u73b0\u3002</p> <p>ContentProvider \u53ea\u662f Android \u4e3a\u4e86\u8de8\u8fdb\u7a0b\u5171\u4eab\u6570\u636e\u63d0\u4f9b\u7684\u4e00\u79cd\u673a\u5236\uff0c \u672c\u8eab\u57fa\u4e8e Binder \u5b9e\u73b0\uff0c \u5728\u64cd\u4f5c\u6570\u636e\u4e0a\u53ea\u662f\u4e00\u79cd\u62bd\u8c61\uff0c\u5177\u4f53\u8981\u81ea\u5df1\u5b9e\u73b0 ContentProvider \u53ea\u80fd\u4fdd\u8bc1\u8fdb\u7a0b\u95f4\u7684\u4e92\u65a5\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u8fdb\u7a0b\u5185\uff0c\u9700\u8981\u81ea\u5df1\u5b9e\u73b0 ContentResolver \u63a5\u53e3\u7684 notifyChange \u51fd\u6570\u6765\u901a\u77e5\u90a3\u4e9b\u6ce8\u518c\u4e86\u76d1\u63a7\u7279\u5b9a URI \u7684 ContentObserver \u5bf9\u8c61\uff0c\u4f7f\u5f97\u5b83\u4eec\u53ef\u4ee5\u76f8\u5e94\u5730\u6267\u884c\u4e00\u4e9b\u5904\u7406\u3002ContentObserver \u53ef\u4ee5\u901a\u8fc7 registerContentObserver \u8fdb\u884c\u6ce8\u518c\u3002 \u65e2\u7136\u662f\u5bf9\u5916\u63d0\u4f9b\u6570\u636e\u5171\u4eab\uff0c\u90a3\u4e48\u5982\u4f55\u9650\u5236\u5bf9\u65b9\u7684\u4f7f\u7528\u5462? android:exported \u5c5e\u6027\u975e\u5e38\u91cd\u8981\u3002\u8fd9\u4e2a\u5c5e\u6027\u7528\u4e8e\u6307\u793a\u8be5\u670d\u52a1\u662f\u5426\u80fd\u591f\u88ab\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\u8c03 \u7528\u6216\u8ddf\u5b83\u4ea4\u4e92\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a true\uff0c\u5219\u80fd\u591f\u88ab\u8c03\u7528\u6216\u4ea4\u4e92\uff0c\u5426\u5219\u4e0d\u80fd\u3002\u8bbe\u7f6e\u4e3a false \u65f6\uff0c\u53ea\u6709 \u540c\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u7ec4\u4ef6\u6216\u5e26\u6709\u76f8\u540c\u7528\u6237 ID \u7684\u5e94\u7528\u7a0b\u5e8f\u624d\u80fd\u542f\u52a8\u6216\u7ed1\u5b9a\u8be5\u670d\u52a1\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#serviceactivity","title":"Service\u548cActivity\u901a\u4fe1","text":"<p><code>\u3010\u53c2\u8003\u3011:</code></p> <p>Activity \u8c03\u7528 bindService (Intent service, ServiceConnection conn, int flags)\u65b9\u6cd5\uff0c\u5f97\u5230 Service \u5bf9\u8c61\u7684\u4e00\u4e2a\u5f15\u7528\uff0c\u8fd9\u6837 Activity \u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u5230 Service \u4e2d\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u8981\u4e3b\u52a8\u901a\u77e5 Activity\uff0c \u6211\u4eec\u53ef\u4ee5\u5229\u7528\u56de\u8c03\u65b9\u6cd5 Service \u5411 Activity \u53d1\u9001\u6d88\u606f\uff0c\u53ef\u4ee5\u4f7f\u7528\u5e7f\u64ad\uff0c\u5f53\u7136 Activity\u8981\u6ce8\u518c\u76f8\u5e94\u7684\u63a5\u6536\u5668\u3002\u6bd4\u5982 Service \u8981\u5411\u591a\u4e2a Activity\u53d1\u9001\u540c\u6837\u7684\u6d88\u606f\u7684\u8bdd\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\u5c31\u66f4\u597d\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#oom-try-catch","title":"OOM \u662f\u5426\u53ef\u4ee5try catch","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u4e00\u822c\u4e0d\u9002\u5408\u8fd9\u4e48\u5904\u7406 Java \u4e2d\u7ba1\u7406\u5185\u5b58\u9664\u4e86\u663e\u5f0f\u5730 catch OOM \u4e4b\u5916\u8fd8\u6709\u66f4\u591a\u6709\u6548\u7684\u65b9\u6cd5:\u6bd4\u5982 SoftReference, WeakReference, \u786c\u76d8\u7f13\u5b58\u7b49\u3002 \u5728 JVM \u7528\u5149\u5185\u5b58\u4e4b\u524d\uff0c\u4f1a\u591a\u6b21\u89e6\u53d1 GC\uff0c\u8fd9\u4e9b GC \u4f1a\u964d\u4f4e\u7a0b\u5e8f\u8fd0\u884c\u7684\u6548\u7387\u3002 \u5982\u679c OOM \u7684\u539f\u56e0\u4e0d\u662f try \u8bed\u53e5\u4e2d\u7684\u5bf9\u8c61(\u6bd4\u5982\u5185\u5b58\u6cc4\u6f0f)\uff0c\u90a3\u4e48\u5728 catch \u8bed\u53e5\u4e2d\u4f1a\u7ee7\u7eed\u629b\u51fa OOM</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#alertdialogtoast-activity","title":"AlertDialog\uff0cToast \u5bf9Activity\u751f\u547d\u5468\u671f\u7684\u5f71\u54cd","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u65e0\u8bba Dialog \u5f39\u51fa\u8986\u76d6\u9875\u9762\uff0c\u5bf9 Activity \u751f\u547d\u5468\u671f\u6ca1\u6709\u5f71\u54cd\uff0c\u53ea\u6709\u518d\u542f\u52a8\u53e6\u5916\u4e00\u4e2a Activity \u7684\u65f6\u5019\u624d\u4f1a\u8fdb\u5165 onPause \u72b6\u6001\uff0c\u800c\u4e0d\u662f\u60f3\u8c61\u4e2d\u7684\u88ab\u8986\u76d6\u6216\u8005\u4e0d\u53ef\u89c1\uff0c\u540c\u65f6\u901a\u8fc7 AlertDialog \u6e90\u7801\u6216\u8005 Toast \u6e90\u7801\u6211\u4eec\u90fd\u53ef\u4ee5\u53d1\u73b0\u5b83\u4eec\u5b9e\u73b0\u7684\u539f\u7406\u90fd\u662f windowmanager.addView();\u6765\u6dfb\u52a0\u7684\uff0c \u5b83\u4eec\u90fd\u662f\u4e00\u4e2a\u4e2a view ,\u56e0\u6b64\u4e0d\u4f1a\u5bf9 activity \u7684\u751f\u547d\u5468 \u671f\u6709\u4efb\u4f55\u5f71\u54cd\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#httptcp","title":"HTTP\u4e0eTCP\u7684\u533a\u522b\u548c\u8054\u7cfb","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> TCP \u8fde\u63a5</p> <p>\u624b\u673a\u80fd\u591f\u4f7f\u7528\u8054\u7f51\u529f\u80fd\u662f\u56e0\u4e3a\u624b\u673a\u5e95\u5c42\u5b9e\u73b0\u4e86 TCP/IP \u534f\u8bae\uff0c\u53ef\u4ee5\u4f7f\u624b\u673a\u7ec8\u7aef\u901a\u8fc7\u65e0\u7ebf\u7f51\u7edc\uff0c\u5efa\u7acb TCP \u8fde\u63a5\u3002TCP \u534f\u8bae\u53ef\u4ee5\u5bf9\u4e0a\u5c42\u7f51\u7edc\u63d0\u4f9b\u63a5\u53e3\uff0c\u4f7f\u4e0a\u5c42\u7f51\u7edc\u6570\u636e\u7684\u4f20\u8f93\u5efa\u7acb\u5728\u201c\u65e0\u5dee\u522b\u201d \u7684\u7f51\u7edc\u4e4b\u4e0a\u3002</p> <p>\u5efa\u7acb\u8d77\u4e00\u4e2a TCP \u8fde\u63a5\u9700\u8981\u7ecf\u8fc7\u201c\u4e09\u6b21\u63e1\u624b\u201d: - \u7b2c\u4e00\u6b21\u63e1\u624b:\u5ba2\u6237\u7aef\u53d1\u9001 syn \u5305(syn=j)\u5230\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165 SYN_SEND \u72b6\u6001\uff0c\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4; - \u7b2c\u4e8c\u6b21\u63e1\u624b:\u670d\u52a1\u5668\u6536\u5230 syn \u5305\uff0c\u5fc5\u987b\u786e\u8ba4\u5ba2\u6237\u7684 SYN(ack=j+1)\uff0c\u540c\u65f6\u81ea\u5df1\u4e5f\u53d1\u9001\u4e00\u4e2aSYN \u5305(syn=k)\uff0c\u5373 SYN+ACK \u5305\uff0c\u6b64\u65f6\u670d\u52a1\u5668\u8fdb\u5165 SYN_RECV \u72b6\u6001; - \u7b2c\u4e09\u6b21\u63e1\u624b:\u5ba2\u6237\u7aef\u6536\u5230\u670d\u52a1\u5668\u7684 SYN+ACK \u5305\uff0c\u5411\u670d\u52a1\u5668\u53d1\u9001\u786e\u8ba4\u5305 ACK(ack=k+1)\uff0c\u6b64\u5305\u53d1\u9001\u5b8c\u6bd5\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u8fdb\u5165 ESTABLISHED \u72b6\u6001\uff0c\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\u3002</p> <p>\u63e1\u624b\u8fc7\u7a0b\u4e2d\u4f20\u9001\u7684\u5305\u91cc\u4e0d\u5305\u542b\u6570\u636e\uff0c\u4e09\u6b21\u63e1\u624b\u5b8c\u6bd5\u540e\uff0c\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u624d\u6b63\u5f0f\u5f00\u59cb\u4f20\u9012\u6570\u636e\u3002\u7406\u60f3\u72b6\u6001\u4e0b\uff0cTCP\u8fde\u63a5\u4e00\u65e6\u5efa\u7acb\uff0c\u5728\u901a\u4fe1\u53cc\u65b9\u4e2d\u7684\u4efb\u4f55\u4e00\u65b9\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5\u4e4b\u524d\uff0cTCP\u8fde\u63a5\u90fd\u5c06\u88ab\u4e00\u76f4\u4fdd\u6301\u4e0b\u53bb\u3002\u65ad\u5f00\u8fde\u63a5\u65f6\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5747\u53ef\u4ee5\u4e3b\u52a8\u53d1\u8d77\u65ad\u5f00TCP\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u65ad\u5f00\u8fc7\u7a0b\u9700\u8981\u7ecf\u8fc7\u201c\u56db\u6b21\u6325\u624b\u201d\u3002</p> <p>HTTP \u8fde\u63a5</p> <p>HTTP \u8fde\u63a5\u6700\u663e\u8457\u7684\u7279\u70b9\u662f\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6bcf\u6b21\u8bf7\u6c42\u90fd\u9700\u8981\u670d\u52a1\u5668\u56de\u9001\u54cd\u5e94\uff0c\u5728\u8bf7\u6c42\u7ed3\u675f\u540e\uff0c \u7406\u60f3\u72b6\u6001\u4e0b\uff0cTCP \u8fde\u63a5\u4e00\u65e6\u5efa\u7acb\uff0c\u5728\u901a\u4fe1\u53cc\u65b9\u4e2d\u7684\u4efb\u4f55\u4e00\u65b9\u4e3b\u52a8\u5173\u95ed\u8fde \u63a5\u4e4b\u524d\uff0cTCP \u8fde\u63a5 \u90fd\u5c06\u88ab\u4e00\u76f4\u4fdd\u6301\u4e0b\u53bb\u3002\u65ad\u5f00\u8fde\u63a5\u65f6\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u5747\u53ef\u4ee5\u4e3b\u52a8\u53d1\u8d77\u65ad\u5f00 TCP \u8fde\u63a5\u7684\u8bf7\u6c42\uff0c \u65ad\u5f00\u8fc7\u7a0b\u9700\u8981\u7ecf\u8fc7\u201c\u56db\u6b21\u63e1\u624b\u201d(\u8fc7\u7a0b\u5c31\u4e0d\u7ec6\u5199 \u4e86\uff0c\u5c31\u662f\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4ea4\u4e92\uff0c\u6700\u7ec8\u786e\u5b9a\u65ad \u5f00)  HTTP \u534f\u8bae\u5373\u8d85\u6587\u672c\u4f20\u9001\u534f\u8bae(Hypertext Transfer Protocol )\uff0c\u662f Web \u8054\u7f51\u7684\u57fa\u7840\uff0c\u4e5f\u662f\u624b  \u673a\u8054\u7f51\u5e38\u7528\u7684\u534f\u8bae\u4e4b\u4e00\uff0cHTTP \u534f\u8bae\u662f\u5efa\u7acb\u5728 TCP \u534f\u8bae\u4e4b\u4e0a\u7684\u4e00\u79cd\u5e94\u7528\u3002  \u4f1a\u4e3b\u52a8\u91ca\u653e\u8fde\u63a5\u3002\u4ece\u5efa\u7acb\u8fde\u63a5\u5230\u5173\u95ed\u8fde\u63a5\u7684\u8fc7\u7a0b\u79f0\u4e3a\u201c\u4e00\u6b21\u8fde\u63a5\u201d\u3002 - 1)\u5728 HTTP 1.0 \u4e2d\uff0c\u5ba2\u6237\u7aef\u7684\u6bcf\u6b21\u8bf7\u6c42\u90fd\u8981\u6c42\u5efa\u7acb\u4e00\u6b21\u5355\u72ec\u7684\u8fde\u63a5\uff0c\u5728\u5904\u7406\u5b8c\u672c\u6b21\u8bf7\u6c42\u540e\uff0c  \u5c31\u81ea\u52a8\u91ca\u653e\u8fde\u63a5\u3002 - 2)\u5728 HTTP 1.1 \u4e2d\u5219\u53ef\u4ee5\u5728\u4e00\u6b21\u8fde\u63a5\u4e2d\u5904\u7406\u591a\u4e2a\u8bf7\u6c42\uff0c\u5e76\u4e14\u591a\u4e2a\u8bf7\u6c42\u53ef\u4ee5\u91cd\u53e0\u8fdb\u884c\uff0c\u4e0d\u9700\u8981   \u7b49\u5f85\u4e00\u4e2a\u8bf7\u6c42\u7ed3\u675f\u540e\u518d\u53d1\u9001\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u3002 \u7531\u4e8e HTTP \u5728\u6bcf\u6b21\u8bf7\u6c42\u7ed3\u675f\u540e\u90fd\u4f1a\u4e3b\u52a8\u91ca\u653e\u8fde\u63a5\uff0c\u56e0\u6b64 HTTP \u8fde\u63a5\u662f\u4e00\u79cd\u201c\u77ed\u8fde\u63a5\u201d\uff0c\u8981\u4fdd\u6301\u5ba2\u6237\u7aef\u7a0b\u5e8f\u7684\u5728\u7ebf\u72b6\u6001\uff0c\u9700\u8981\u4e0d\u65ad\u5730\u5411\u670d\u52a1\u5668\u53d1\u8d77\u8fde\u63a5\u8bf7\u6c42\u3002\u901a\u5e38\u7684 \u505a\u6cd5\u662f\u5373\u65f6\u4e0d\u9700\u8981\u83b7 \u5f97\u4efb\u4f55\u6570\u636e\uff0c\u5ba2\u6237\u7aef\u4e5f\u4fdd\u6301\u6bcf\u9694\u4e00\u6bb5\u56fa\u5b9a\u7684\u65f6\u95f4\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u6b21\u201c\u4fdd\u6301\u8fde\u63a5\u201d\u7684\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u5728\u6536\u5230\u8be5\u8bf7\u6c42\u540e\u5bf9\u5ba2\u6237\u7aef\u8fdb\u884c\u56de\u590d\uff0c\u8868\u660e\u77e5\u9053\u5ba2 \u6237\u7aef\u201c\u5728\u7ebf\u201d\u3002\u82e5\u670d\u52a1\u5668\u957f\u65f6\u95f4\u65e0\u6cd5\u6536\u5230 \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5219\u8ba4\u4e3a\u5ba2\u6237\u7aef\u201c\u4e0b\u7ebf\u201d\uff0c\u82e5\u5ba2\u6237\u7aef\u957f\u65f6\u95f4\u65e0\u6cd5\u6536\u5230\u670d\u52a1\u5668\u7684\u56de\u590d\uff0c\u5219\u8ba4\u4e3a\u7f51\u7edc\u5df2\u7ecf\u65ad\u5f00\u3002</p> <p>TPC/IP \u534f\u8bae\u662f\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u4e3b\u8981\u89e3\u51b3\u6570\u636e\u5982\u4f55\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\uff0c\u800c HTTP \u662f\u5e94\u7528\u5c42\u534f\u8bae\uff0c\u4e3b\u8981 \u89e3\u51b3\u5982\u4f55\u5305\u88c5\u6570\u636e\u3002TCP \u534f\u8bae\u5bf9\u5e94\u4e8e\u4f20\u8f93\u5c42\uff0c\u800c HTTP \u534f\u8bae\u5bf9\u5e94\u4e8e\u5e94\u7528\u5c42\uff0c\u4ece\u672c\u8d28\u4e0a\u6765\u8bf4\uff0c \u4e8c\u8005\u6ca1\u6709\u53ef\u6bd4\u6027\u3002Http \u534f\u8bae\u662f\u5efa\u7acb\u5728 TCP \u534f\u8bae\u57fa\u7840\u4e4b\u4e0a\u7684\uff0c\u5f53\u6d4f\u89c8\u5668\u9700\u8981\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u7f51 \u9875\u6570\u636e\u7684\u65f6\u5019\uff0c\u4f1a\u53d1\u51fa\u4e00\u6b21 Http \u8bf7\u6c42\u3002Http \u4f1a\u901a\u8fc7 TCP \u5efa\u7acb\u8d77\u4e00\u4e2a\u5230\u670d\u52a1\u5668\u7684\u8fde\u63a5\u901a\u9053\u3002 \u7b80\u5355\u5730\u8bf4\uff0c\u5f53\u4e00\u4e2a\u7f51\u9875\u6253\u5f00\u5b8c\u6210\u540e\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7528\u4e8e\u4f20\u8f93 HTTP \u6570\u636e\u7684 TCP \u8fde\u63a5\u4e0d\u4f1a\u5173\u95ed\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u518d\u6b21\u8bbf\u95ee\u8fd9\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u7f51\u9875\uff0c\u4f1a\u7ee7\u7eed\u4f7f\u7528\u8fd9\u4e00\u6761\u5df2\u7ecf\u5efa\u7acb\u7684\u8fde\u63a5  Keep-Alive \u4e0d\u4f1a\u6c38\u4e45\u4fdd\u6301\u8fde\u63a5\uff0c\u5b83\u6709\u4e00\u4e2a\u4fdd\u6301\u65f6\u95f4\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u8f6f\u4ef6(\u5982 Apache)  \u4e2d\u8bbe\u5b9a\u8fd9\u4e2a\u65f6\u95f4\u3002Http \u662f\u65e0\u72b6\u6001\u7684\u77ed\u8fde\u63a5\uff0c\u800c TCP \u662f\u6709\u72b6\u6001\u7684\u957f\u8fde\u63a5\u3002</p> <p>## \u4e3a\u4ec0\u4e48\u8981\u7528\u591a\u8fdb\u7a0b?\u6709\u54ea\u4e9b\u65b9\u5f0f?\u600e\u4e48\u4f7f\u7528\u591a\u8fdb\u7a0b? <code>\u3010\u53c2\u8003\u3011:</code>  \u90a3\u4e48\u591a\u8fdb\u7a0b\u5e94\u8be5\u80fd\u4e3a\u6211\u4eec\u5e26\u6765\u4ec0\u4e48\u5462? \u6211\u4eec\u90fd\u77e5\u9053\uff0candroid \u5e73\u53f0\u5bf9\u5e94\u7528\u90fd\u6709\u5185\u5b58\u9650\u5236\uff0c\u5176\u5b9e\u8fd9\u4e2a\u7406\u89e3\u6709\u70b9\u95ee\u9898\uff0c\u5e94\u8be5\u662f\u8bf4 android \u5e73\u53f0\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u6709\u5185\u5b58\u9650\u5236\uff0c\u6bd4\u5982\u67d0\u673a\u578b\u5bf9\u5bf9\u8fdb\u7a0b\u9650\u5236\u662f 24m\uff0c\u5982\u679c\u5e94\u7528\u6709\u4e24\u4e2a\u8fdb\u7a0b\uff0c\u5219\u8be5\u5e94\u8be5\u7684\u603b\u5185\u5b58\u9650\u5236\u662f 2*24m\u3002\u4f7f\u7528\u591a\u8fdb\u7a0b\u5c31\u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u4e00\u4e2a apk \u6240\u4f7f\u7528\u7684\u5185\u5b58\u9650\u5236\u52a0\u5927\u51e0\u500d\u3002 \u6240\u4ee5\u53ef\u4ee5\u501f\u6b64\u56fe\u7247\u5e73\u53f0\u5bf9\u5e94\u7528\u7684\u5185\u5b58\u9650\u5236\uff0c\u6bd4\u5982\u4e00\u4e9b\u8981\u5bf9\u56fe\u7247\u3001\u89c6\u9891\u3001\u5927\u6587\u4ef6\u8fdb\u7a0b\u5904\u7406\u7684\u597d\u5185\u5b58\u7684\u5e94\u7528\u53ef\u4ee5\u8003\u8651\u7528\u591a\u8fdb\u7a0b\u6765\u89e3\u51b3\u5e94\u7528\u64cd\u4f5c\u4e0d\u6d41\u7545\u95ee\u9898\u3002</p> <p>\u5f00\u542f\u591a\u8fdb\u7a0b\u6a21\u5f0f: \u5728 Android \u4e2d\u4f7f\u7528\u591a\u8fdb\u7a0b\u53ea\u6709\u4e00\u79cd\u65b9\u6cd5,\u90a3\u5c31\u662f\u5728 AndroidManifest \u4e2d\u7ed9\u56db\u5927\u7ec4\u4ef6 (Activity,Service,Receiver,ContentProvider)\u6307\u5b9a android:process \u5c5e\u6027.\u9664\u6b64\u4e4b\u5916\u6ca1\u6709\u5176\u4ed6\u7684\u529e \u6cd5,\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u65e0\u6cd5\u7ed9\u4e00\u4e2a\u7ebf\u7a0b\u6d3b\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u6307\u5b9a\u5176\u8fd0\u884c\u65f6\u6240\u5728\u7684\u8fdb\u7a0b.\u5176\u5b9e\u8fd8\u6709\u53e6\u4e00\u79cd\u975e\u5e38\u89c4\u7684\u591a\u8fdb\u7a0b\u65b9\u6cd5,\u90a3\u5c31\u662f\u901a\u8fc7 JNI \u5728 native \u5c42\u53bb fork\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b,\u4f46\u8fd9\u79cd\u65b9\u6cd5\u5c5e\u4e8e\u7279\u6b8a\u60c5 \u51b5,\u5e76\u4e0d\u662f\u5e38\u7528\u7684\u521b\u5efa\u591a\u8fdb\u7a0b\u7684\u65b9\u5f0f,\u6240\u4ee5\u6211\u4eec\u4e5f\u6682\u4e0d\u8003\u8651\u8fd9\u79cd\u60c5\u51b5 \u8fdb\u7a0b\u540d\u4ee5\":\"\u5f00\u5934\u7684\u8fdb\u7a0b\u5c5e\u4e8e\u5f53\u524d\u5e94\u7528\u7684\u79c1\u6709\u8fdb\u7a0b,\u5176\u4ed6\u5e94\u7528\u7684\u7ec4\u4ef6\u4e0d\u53ef\u4ee5\u548c\u5b83\u8dd1\u5728\u540c\u4e00\u4e2a\u8fdb \u7a0b\u4e2d,\u800c\u8fdb\u7a0b\u540d\u4e0d\u4ee5\":\"\u5f00\u5934\u7684\u8fdb\u7a0b\u5c5e\u4e8e\u5168\u5c40\u8fdb\u7a0b,\u5176\u4ed6\u5e94\u7528\u901a\u8fc7 ShareUID \u65b9\u5f0f\u53ef\u4ee5\u548c\u5b83\u8dd1\u5728 \u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d.</p> <p>\u7528\u591a\u8fdb\u7a0b\u7684\u597d\u5904\u4e0e\u574f\u5904 \u597d\u5904: 1)\u5206\u62c5\u4e3b\u8fdb\u7a0b\u7684\u5185\u5b58\u538b\u529b\u3002 \u5f53\u5e94\u7528\u8d8a\u505a\u8d8a\u5927\uff0c\u5185\u5b58\u8d8a\u6765\u8d8a\u591a\uff0c\u5c06\u4e00\u4e9b\u72ec\u7acb\u7684\u7ec4\u4ef6\u653e\u5230\u4e0d\u540c\u7684\u8fdb\u7a0b\uff0c\u5b83\u5c31\u4e0d\u5360\u7528\u4e3b\u8fdb\u7a0b\u7684 \u5185\u5b58\u7a7a\u95f4\u4e86\u3002\u5f53\u7136\u8fd8\u6709\u5176\u4ed6\u597d\u5904\uff0c\u6709\u5fc3\u4eba\u4f1a\u53d1\u73b0 2)\u4f7f\u5e94\u7528\u5e38\u9a7b\u540e\u53f0\uff0c\u9632\u6b62\u4e3b\u8fdb\u7a0b\u88ab\u6740\u5b88\u62a4\u8fdb\u7a0b\uff0c\u5b88\u62a4\u8fdb\u7a0b\u548c\u4e3b\u8fdb\u7a0b\u4e4b\u95f4\u76f8\u4e92\u76d1\u89c6\uff0c\u6709\u4e00\u65b9 \u88ab\u6740\u5c31\u91cd\u65b0\u542f\u52a8\u5b83\u3002Android \u540e\u53f0\u8fdb\u7a0b\u91cc\u6709\u5f88\u591a\u5e94\u7528\u662f\u591a\u4e2a\u8fdb\u7a0b\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u8981\u5e38\u9a7b\u540e\u53f0\uff0c\u7279\u522b\u662f\u5373\u65f6\u901a\u8baf\u6216\u8005\u793e\u4ea4\u5e94\u7528\uff0c\u4e0d\u8fc7\u73b0\u5728\u591a\u8fdb\u7a0b\u5df2\u7ecf\u88ab\u7528\u70c2\u4e86\u3002 \u5178\u578b\u7528\u6cd5\u662f\u5728\u542f\u52a8\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684\u8f7b\u91cf\u7ea7\u79c1\u6709\u8fdb\u7a0b\uff0c\u5728\u540e\u53f0\u6536\u53d1\u6d88\u606f\uff0c\u6216\u8005\u505a\u4e00\u4e9b\u8017\u65f6\u7684\u4e8b\u60c5\uff0c \u6216\u8005\u5f00\u673a\u542f\u52a8\u8fd9\u4e2a\u8fdb\u7a0b\uff0c\u7136\u540e\u505a\u76d1\u542c\u7b49\u3002</p> <p>\u574f\u5904:\u6d88\u8017\u7528\u6237\u7684\u7535\u91cf\u3002 \u591a\u5360\u7528\u4e86\u7cfb\u7edf\u7684\u7a7a\u95f4\uff0c\u82e5\u6240\u6709\u5e94\u7528\u90fd\u8fd9\u6837\u5360\u7528\uff0c\u7cfb\u7edf\u5185\u5b58\u5f88\u5bb9\u6613\u5360\u6ee1\u800c\u5bfc\u81f4\u5361\u987f\u3002 \u5e94\u7528\u7a0b\u5e8f\u67b6\u6784\u4f1a\u53d8\u5f97\u590d\u6742\uff0c\u56e0\u4e3a\u8981\u5904\u7406\u591a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u8fd9\u91cc\u53c8\u662f\u53e6\u5916\u4e00\u4e2a\u95ee\u9898\u4e86\u3002 \u591a\u8fdb\u7a0b\u7684\u7f3a\u9677 \u8fdb\u7a0b\u95f4\u7684\u5185\u5b58\u7a7a\u95f4\u662f\u4e0d\u53ef\u89c1\u7684\u3002\u5f00\u542f\u591a\u8fdb\u7a0b\u540e\uff0c\u4f1a\u5f15\u53d1\u4ee5\u4e0b\u95ee\u9898: 1)Application \u7684\u591a\u6b21\u91cd\u5efa\u3002 2)\u9759\u6001\u6210\u5458\u7684\u5931\u6548\u3002 3)\u6587\u4ef6\u5171\u4eab\u95ee\u9898\u3002 4)\u65ad\u70b9\u8c03\u8bd5\u95ee\u9898\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#viewstubinflateinflate","title":"viewstub\u53ef\u4ee5\u591a\u6b21inflate\u4e48?\u591a\u6b21inflate\u4f1a\u600e\u6837?","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u5728\u4f7f\u7528 viewstub \u7684\u65f6\u5019\u8981\u6ce8\u610f\u4e00\u70b9\uff0cviewstub \u53ea\u80fd inflate \u4e00\u6b21\uff0c\u800c\u4e14 setVisibility \u4e5f\u4f1a\u95f4\u63a5\u7684\u8c03\u7528\u5230 inflate\uff0c\u91cd\u590d inflate \u4f1a\u629b\u51fa\u5f02\u5e38: java.lang.IllegalStateException:ViewStub must have a non-null ViewGroup viewParent\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5\u4e3a\u8bbe\u7f6e\u4e00\u4e2a Boolean \u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u6807\u8bb0 viewstub \u662f\u5426\u5df2\u7ecf inflate\uff0c\u5982\u679c viewstub \u8fd8\u672a inflate \u5219\u6267\u884c\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u53cd\u4e4b\u5219\u4e0d\u8fdb\u884c\u64cd\u4f5c\u3002\u5176\u4e2d\u8981\u4f7f\u7528 ViewStub \u4e2d\u7684 OnInflateListener()\u76d1\u542c\u4e8b\u4ef6\u6765\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u586b\u5145,\u4ece\u800c\u4fdd\u8bc1 viewstub \u4e0d\u91cd\u590d\u7684 inflate\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5: 1.\u5b9a\u4e49 boolean \u53d8\u91cf\u548c ViewStub boolean isInflate = false; ViewStub mViewStub;</p> <p>2.\u521d\u59cb\u5316 ViewStub\uff0c\u5e76\u4e3a ViewStub \u6dfb\u52a0 OnInflateListener()\u76d1\u542c\u4e8b\u4ef6</p> <pre><code>mViewStub = (ViewStub)findViewById(R.id.viewstub_match_single);\nmViewStub.setOnInflateListener(new OnInflateListener() { @Override\npublic void onInflate(ViewStub stub, View inflated) {\nisInflate = true; }\n});\n</code></pre> <p>3.\u586b\u5145 ViewStub  <code>java private void initViewStub(){//\u586b\u5145 ViewStub \u7684\u65b9\u6cd5     if(!isInflate){//\u5982\u679c\u6ca1\u6709\u586b\u5145\u5219\u6267\u884c inflate \u64cd\u4f5c         View view = stubMatchSingle.inflate();         //\u521d\u59cb\u5316 ViewStub \u7684 layout \u91cc\u9762\u7684\u63a7\u4ef6         TextView mTv = (TextView) view.findViewById(R.id.txt_url); mTv.setOnClickListener(this);     }  }</code></p> <p>## \u5982\u4f55\u83b7\u53d6\u4e00\u4e2a\u56fe\u7247\u7684\u5bbd\u9ad8  <code>\u3010\u53c2\u8003\u3011:</code>  android \u5728\u4e0d\u52a0\u8f7d\u56fe\u7247\u7684\u524d\u63d0\u4e0b\u83b7\u5f97\u56fe\u7247\u7684\u5bbd\u9ad8  <code>java public static int[] getImageWidthHeight(String path){ BitmapFactory.Options options = new BitmapFactory.Options();     /**     * \u6700\u5173\u952e\u5728\u6b64\uff0c\u628a options.inJustDecodeBounds = true;     * \u8fd9\u91cc\u518d decodeFile()\uff0c\u8fd4\u56de\u7684 bitmap \u4e3a\u7a7a\uff0c\u4f46\u6b64\u65f6\u8c03\u7528 options.outHeight \u65f6\uff0c\u5df2\u7ecf     \u5305\u542b\u4e86\u56fe\u7247\u7684\u9ad8\u4e86 */     options.inJustDecodeBounds = true;      Bitmapbitmap=BitmapFactory.decodeFile(path,options);// \u6b64\u65f6\u8fd4\u56de\u7684bitmap\u4e3anull /**     /*     *options.outHeight \u4e3a\u539f\u59cb\u56fe\u7247\u7684\u9ad8     */     return new int[]{options.outWidth,options.outHeight}; }</code></p> <p>\u901a\u8fc7 BitmapFactory \u4ece\u4e0d\u540c\u4f4d\u7f6e\u83b7\u53d6 Bitmap * 1.\u8d44\u6e90\u6587\u4ef6(drawable/mipmap/raw) BitmapFactory.decodeResource(getResources(), R.mipmap.slim_lose_weight_plan_copenhagen,options); * 2.\u8d44\u6e90\u6587\u4ef6(assets) InputStream is = getActivity().getAssets().open(\"bitmap.png\"); BitmapFactory.decodeStream(is); * 3.\u5185\u5b58\u5361\u6587\u4ef6 bitmap = BitmapFactory.decodeFile(\"/sdcard/bitmap.png\"); * 4.\u7f51\u7edc\u6587\u4ef6 bitmap = BitmapFactory.decodeStream(is); \u53ef\u6839\u636e BitmapFactory \u83b7\u53d6\u56fe\u7247\u65f6\u4f20\u5165 option\uff0c\u901a\u8fc7\u4e0a\u8ff0\u65b9\u6cd5\u83b7\u53d6\u56fe\u7247\u7684\u5bbd\u9ad8</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#onwindowfocuschanged","title":"onWindowFocusChanged \u6267\u884c\u65f6\u673a","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> \u771f\u6b63\u7684 visible \u65f6\u95f4\u70b9\u662f onWindowFocusChanged()\u51fd\u6570\u88ab\u6267\u884c\u65f6\uff0c\u5f53\u524d\u7a97\u4f53\u5f97\u5230  \u6216\u5931\u53bb\u7126\u70b9\u7684\u65f6\u5019\u7684\u65f6\u5019\u8c03\u7528\u3002\u8fd9\u662f\u8fd9\u4e2a\u6d3b\u52a8\u662f\u5426\u662f\u7528\u6237\u53ef\u89c1\u7684\u6700\u597d\u7684\u6307\u6807\u3002</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E4%B8%AD%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#launchmode","title":"LaunchMode \u7684\u5e94\u7528\u573a\u666f","text":"<p><code>\u3010\u53c2\u8003\u3011:</code> LaunchMode \u6709\u56db\u79cd\uff0c\u5206\u522b\u4e3a Standard\uff0cSingleTop\uff0cSingleTask \u548c SingleInstance\uff0c\u6bcf\u79cd\u6a21\u5f0f\u7684\u5b9e\u73b0\u539f\u7406\u4e00\u697c\u90fd\u505a\u4e86\u8f83\u8be6\u7ec6\u8bf4\u660e\uff0c\u4e0b\u9762\u8bf4\u4e00\u4e0b\u5177\u4f53\u4f7f\u7528\u573a\u666f\uff1a</p> <ul> <li>Standard\uff1a   Standard \u6a21\u5f0f\u662f\u7cfb\u7edf\u9ed8\u8ba4\u7684\u542f\u52a8\u6a21\u5f0f\uff0c\u4e00\u822c\u6211\u4eec app \u4e2d\u5927\u90e8\u5206\u9875\u9762\u90fd\u662f\u7531\u8be5\u6a21\u5f0f\u7684\u9875\u9762\u6784\u6210\u7684\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u573a\u666f\u662f\uff1a\u793e\u4ea4\u5e94\u7528\u4e2d\uff0c\u70b9\u51fb\u67e5\u770b\u7528\u6237A\u4fe1\u606f-&gt;\u67e5\u770b\u7528\u6237A\u7c89\u4e1d-&gt;\u5728\u7c89\u4e1d\u4e2d\u6311\u9009\u67e5\u770b\u7528\u6237B\u4fe1\u606f-&gt;\u67e5\u770b\u7528\u6237A\u7c89\u4e1d... \u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e00\u822c\u6211\u4eec\u9700\u8981\u4fdd\u7559\u7528\u6237\u64cd\u4f5c Activity \u6808\u7684\u9875\u9762\u6240\u6709\u6267\u884c\u987a\u5e8f\u3002</li> <li>SingleTop:   SingleTop \u6a21\u5f0f\u4e00\u822c\u5e38\u89c1\u4e8e\u793e\u4ea4\u5e94\u7528\u4e2d\u7684\u901a\u77e5\u680f\u884c\u4e3a\u529f\u80fd\uff0c\u4f8b\u5982\uff1aApp \u7528\u6237\u6536\u5230\u51e0\u6761\u597d\u53cb\u8bf7\u6c42\u7684\u63a8\u9001\u6d88\u606f\uff0c\u9700\u8981\u7528\u6237\u70b9\u51fb\u63a8\u9001\u901a\u77e5\u8fdb\u5165\u5230\u8bf7\u6c42\u8005\u4e2a\u4eba\u4fe1\u606f\u9875\uff0c\u5c06\u4fe1\u606f\u9875\u8bbe\u7f6e\u4e3a SingleTop \u6a21\u5f0f\u5c31\u53ef\u4ee5\u589e\u5f3a\u590d\u7528\u6027\u3002</li> <li>SingleTask\uff1a   SingleTask \u6a21\u5f0f\u4e00\u822c\u7528\u4f5c\u5e94\u7528\u7684\u9996\u9875\uff0c\u4f8b\u5982\u6d4f\u89c8\u5668\u4e3b\u9875\uff0c\u7528\u6237\u53ef\u80fd\u4ece\u591a\u4e2a\u5e94\u7528\u542f\u52a8\u6d4f\u89c8\u5668\uff0c\u4f46\u4e3b\u754c\u9762\u4ec5\u4ec5\u542f\u52a8\u4e00\u6b21\uff0c\u5176\u4f59\u60c5\u51b5\u90fd\u4f1a\u8d70onNewIntent\uff0c\u5e76\u4e14\u4f1a\u6e05\u7a7a\u4e3b\u754c\u9762\u4e0a\u9762\u7684\u5176\u4ed6\u9875\u9762\u3002</li> <li>SingleInstance\uff1a   SingleInstance \u6a21\u5f0f\u5e38\u5e94\u7528\u4e8e\u72ec\u7acb\u6808\u64cd\u4f5c\u7684\u5e94\u7528\uff0c\u5982\u95f9\u949f\u7684\u63d0\u9192\u9875\u9762\uff0c\u5f53\u4f60\u5728A\u5e94\u7528\u4e2d\u770b\u89c6\u9891\u65f6\uff0c\u95f9\u949f\u54cd\u4e86\uff0c\u4f60\u70b9\u51fb\u95f9\u949f\u63d0\u9192\u901a\u77e5\u540e\u8fdb\u5165\u63d0\u9192\u8be6\u60c5\u9875\u9762\uff0c\u7136\u540e\u70b9\u51fb\u8fd4\u56de\u5c31\u518d\u6b21\u56de\u5230A\u7684\u89c6\u9891\u9875\u9762\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u8fc7\u591a\u5e72\u6270\u5230\u7528\u6237\u5148\u524d\u7684\u64cd\u4f5c\u4e86\u3002</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Android%E9%9D%A2%E8%AF%95%E9%A2%98%E7%B3%BB%E5%88%97/","title":"Android\u9762\u8bd5\u9898\u7cfb\u5217","text":"<ul> <li>Android\u4e2d\u9762\u8bd5\u9898\u603b\u7ed3(\u9644\u7b54\u6848)</li> <li>\u9762\u8bd5\u9898\u96c61</li> <li>\u9762\u8bd5\u9898\u96c62</li> <li>\u5c0f\u4e13\u680fAndroid\u9762\u8bd5\u6574\u7406</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/","title":"InterView Backup","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#knowledgesummary","title":"KnowledgeSummary\u76ee\u5f55\uff1a","text":"<p>\u6b64\u6587\u4ef6\u4e3a\u5907\u4efd\u6587\u4ef6\uff0c\u540e\u7eed\u4f1a\u4ece\u4ee5\u4e0b\u8bb0\u5f55\u4e2d\u95ee\u9898\u4ee5\u53ca\u77e5\u8bc6\u70b9\u6765\u5206\u95e8\u522b\u7c7b\u7684\u6765\u603b\u7ed3\u3002</p> <ul> <li>Java</li> <li>Android</li> <li>\u5f00\u6e90\u5e93</li> <li>\u6027\u80fd\u4f18\u5316</li> <li>\u56fe\u7247\u76f8\u5173</li> <li>Android\u5176\u4ed6</li> <li>\u591a\u7ebf\u7a0b\u76f8\u5173</li> <li>\u7f51\u7edc</li> <li>\u8bbe\u8ba1\u6a21\u5f0f</li> <li>\u7b97\u6cd5</li> <li>\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#java","title":"Java","text":"<ul> <li>Java\u57fa\u7840</li> <li>Java\u57fa\u7840\u77e5\u8bc6\u603b\u7ed3</li> <li>Java\u4e2d\u7684\u96c6\u5408\u6846\u67b6</li> <li>\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790ArrayList\u548cVector\u7684\u533a\u522b</li> <li>\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790ArrayList\u548cLinkedList\u7684\u533a\u522b</li> <li>\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790HashMap\u7684\u539f\u7406\u4e0e\u5b9e\u73b0</li> <li>ConcurrentHashMap \uff08\u5f85\u6574\u7406\uff09</li> <li>LinkedHashMap \uff08\u5f85\u6574\u7406\uff09</li> <li> <p>TreeMap \uff08\u5f85\u6574\u7406\uff09</p> </li> <li> <p>Java\u8fdb\u9636</p> </li> <li>Java\u4e2d\u7684\u6ce8\u89e3</li> <li>Java\u4e2d\u7684ClassLoader\u673a\u5236</li> <li>JVM </li> <li>GC\u56de\u6536\u7b56\u7565</li> <li>GC\u7b97\u6cd5</li> <li>\u7c7b\u52a0\u8f7d\u8fc7\u7a0b</li> <li>\u5783\u573e\u6536\u96c6\u673a\u5236 \u5bf9\u8c61\u521b\u5efa\uff0c\u65b0\u751f\u4ee3\u4e0e\u8001\u5e74\u4ee3</li> <li>\u53ef\u5426\u7528try-catch\u6355\u83b7OOM\u4ee5\u907f\u514d\u5176\u53d1\u751f</li> <li>\u5185\u5b58\u6cc4\u6f0f\u573a\u666f,\u5982\u4f55\u5b9a\u4f4d\u53ca\u4fee\u590d\u5185\u5b58\u6cc4\u6f0f</li> <li>\u5783\u573e\u56de\u6536\u673a\u5236\u4e0e\u8c03\u7528System.gc()\u533a\u522b</li> <li>NIO</li> <li>Java\u56db\u79cd\u5f15\u7528</li> <li>JavaPoet\u7684\u4f7f\u7528\u6307\u5357</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#android","title":"Android","text":"<ul> <li> <p>UI</p> <ul> <li>SurfaceView VS TextureView</li> <li>ConstraintLayout</li> <li>\u5e38\u7528Drawable</li> <li>Drawable VS Bitmap</li> <li>CoordinateLayout\u7684\u539f\u7406\u5206\u6790</li> </ul> </li> <li> <p>Activity\u548cFragment</p> </li> <li>Activity\u7684\u751f\u547d\u5468\u671f\u548c\u542f\u52a8\u6a21\u5f0f</li> <li>\u7b80\u8ff0Activity\u542f\u52a8\u5168\u90e8\u8fc7\u7a0b</li> <li>launchMode</li> <li>Activity\u8c03\u7528\u65b9\u5f0f</li> <li>AlertDialog\uff0cToast\u5bf9Activity\u751f\u547d\u5468\u671f\u7684\u5f71\u54cd</li> <li>Dialog,PopupWindow,Activity\u533a\u522b</li> <li>Activity\u4e0eFragment\u4e4b\u95f4\u751f\u547d\u5468\u671f\u6bd4\u8f83</li> <li>\u591a\u5c42Fragment\u5d4c\u5957\u7684\u65f6\u5019setUserHint  </li> <li>\u4e0b\u62c9\u72b6\u6001\u680f\u662f\u4e0d\u662f\u5f71\u54cdactivity\u7684\u751f\u547d\u5468\u671f\uff0c\u5982\u679c\u5728onStop\u7684\u65f6\u5019\u505a\u4e86\u7f51\u7edc\u8bf7\u6c42\uff0conResume\u7684\u65f6\u5019\u600e\u4e48\u6062\u590d  </li> <li>Activity\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u5f0f</li> <li>Android\u91cc\u9762\u4e3a\u4ec0\u4e48\u8981\u8bbe\u8ba1\u51faBundle\u800c\u4e0d\u662f\u76f4\u63a5\u7528Map\u7ed3\u6784</li> <li>fragment \u5404\u79cd\u60c5\u51b5\u4e0b\u7684\u751f\u547d\u5468\u671f</li> <li>ViewPager\u4f7f\u7528\u7ec6\u8282\uff0c\u5982\u4f55\u8bbe\u7f6e\u6210\u6bcf\u6b21\u53ea\u521d\u59cb\u5316\u5f53\u524d\u7684Fragment\uff0c\u5176\u4ed6\u7684\u4e0d\u521d\u59cb\u5316</li> <li> <p>fragment\u4e4b\u95f4\u4f20\u9012\u6570\u636e\u7684\u65b9\u5f0f</p> </li> <li> <p>Service</p> </li> <li>Service\u7684\u751f\u547d\u5468\u671f</li> <li>\u600e\u4e48\u542f\u52a8service\uff0cservice\u548cactivity\u600e\u4e48\u8fdb\u884c\u6570\u636e\u4ea4\u4e92</li> <li> <p>\u5982\u4f55\u5728\u540e\u53f0\u4e0b\u8f7d\u4efb\u52a1, \u5e76\u5728\u901a\u77e5\u680f\u663e\u793a\u8fdb\u5ea6</p> </li> <li> <p>BroadcastReceiver</p> </li> <li>\u5e7f\u64ad\uff08\u52a8\u6001\u6ce8\u518c\u548c\u9759\u6001\u6ce8\u518c\u533a\u522b\uff0c\u6709\u5e8f\u5e7f\u64ad\u548c\u6807\u51c6\u5e7f\u64ad\uff09</li> <li>BroadcastReceiver\uff0cLocalBroadcastReceiver\u533a\u522b</li> <li> <p>\u5e7f\u64ad\u7684\u4f7f\u7528\u573a\u666f</p> </li> <li> <p>ContentProvider</p> </li> <li> <p>Android\u7cfb\u7edf\u4e3a\u4ec0\u4e48\u4f1a\u8bbe\u8ba1ContentProvider\uff0c\u8fdb\u7a0b\u5171\u4eab\u548c\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898</p> </li> <li> <p>View</p> </li> <li>WebView\u4f18\u5316\uff08\u5305\u62ec\u52a0\u8f7d\u52a0\u901f\uff09</li> <li>View\u4e8b\u4ef6\u4f20\u9012</li> <li>\u5c01\u88c5view\u7684\u65f6\u5019\u600e\u4e48\u77e5\u9053view\u7684\u5927\u5c0f</li> <li>\u5982\u4f55\u8ba1\u7b97\u4e00\u4e2aView\u7684\u5c42\u7ea7</li> <li>RecycleView\u7684\u4f7f\u7528\uff0c\u539f\u7406\uff0cRecycleView\u4f18\u5316 </li> <li>ListView\u7684\u4f18\u5316 </li> <li>LinearLayout\u3001RelativeLayout\u3001FrameLayout\u7684\u7279\u6027\u3001\u4f7f\u7528\u573a\u666f</li> <li>view\u6e32\u67d3  </li> <li>ListView\u91cd\u7528\u7684\u662f\u4ec0\u4e48</li> <li>\u81ea\u5b9a\u4e49View\u7684\u5c5e\u6027\u5f15\u7528attr\uff0cstyleable\u91cc\u5b9a\u4e49\u7684\u540d\u79f0\u53ef\u5426\u4e0e\u7cfb\u7edf\u5df2\u7ecf\u5b58\u5728\u7684name\u91cd\u590d\uff1f\u5f53\u7136\u662f\u4e0d\u53ef\u4ee5\u7684\uff0c\u7f16\u8bd1\u5668\u4f1a\u9884\u5148\u68c0\u67e5\u7cfb\u7edf\u5df2\u7ecf\u5b58\u5728\u6216\u8005\u4e4b\u524d\u5df2\u7ecf\u5b9a\u4e49\u91cd\u590d\u7684</li> <li>Android\u4e3a\u4ec0\u4e48\u5f15\u5165Parcelable</li> <li>\u6709\u6ca1\u6709\u5c1d\u8bd5\u7b80\u5316Parcelable\u7684\u4f7f\u7528</li> <li>\u5e8f\u5217\u5316\u7684\u4f5c\u7528\uff0c\u4ee5\u53ca Android \u4e24\u79cd\u5e8f\u5217\u5316\u7684\u533a\u522b</li> <li>TextView\u6027\u80fd\u74f6\u9888\uff0c\u6e32\u67d3\u4f18\u5316\uff0c\u4ee5\u53caStaticLayout\u7684\u4e00\u4e9b\u7528\u5904</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_1","title":"\u5f00\u6e90\u5e93","text":"<ul> <li>Fresco </li> <li>Tinker </li> <li>ActivityRouter </li> <li>ARouter </li> <li>ButterKnife</li> <li>EventBus </li> <li>RxJava </li> <li>RxJava</li> <li>RxJava\u7684\u529f\u80fd\u4e0e\u539f\u7406\u5b9e\u73b0</li> <li>RxJava\u7b80\u4ecb\u53ca\u5176\u6e90\u7801\u89e3\u8bfb\uff1f</li> <li>RxJava\u7684\u4f5c\u7528\uff0c\u4f18\u7f3a\u70b9</li> <li>RxJava\u53d8\u6362\u64cd\u4f5c\u7b26map,flatMap,concatMap,buffer</li> <li>Retrofit </li> <li>OKHTTP </li> <li>LeakCanary </li> <li>Atlas </li> <li>BlockCanary</li> <li>Glide     <ul> <li>glide \u4f7f\u7528\u4ec0\u4e48\u7f13\u5b58</li> <li>Glide \u5185\u5b58\u7f13\u5b58\u5982\u4f55\u63a7\u5236\u5927\u5c0f</li> </ul> </li> <li>UETool</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_2","title":"\u6027\u80fd\u4f18\u5316","text":"<ul> <li>\u7ed8\u5236\u4f18\u5316</li> <li>\u542f\u52a8\u4f18\u5316 </li> <li>\u5185\u5b58\u4f18\u5316</li> <li>\u7a33\u5b9a\u6027\u4f18\u5316</li> <li>ANR\u5206\u6790</li> <li>\u8017\u7535\u4f18\u5316</li> <li>\u5b89\u88c5\u5305\u4f18\u5316</li> </ul> <p>(\u5f85\u6574\u7406) * OOM\u5b9a\u4f4d\u53ca\u89e3\u51b3\u65b9\u6848 * \u5b89\u5168\u3001\u52a0\u56fa * \u5982\u4f55\u4fdd\u6301\u5e94\u7528\u7684\u7a33\u5b9a\u6027 * \u6027\u80fd\u4f18\u5316\u5982\u4f55\u5206\u6790systrace</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_3","title":"\u56fe\u7247\u76f8\u5173","text":"<ul> <li>LruCache</li> <li>DiskLruCache</li> <li>\u56fe\u7247\u52a0\u8f7d\u539f\u7406</li> <li>\u56fe\u7247\u88c1\u526a\u3001\u538b\u7f29\u3001\u65cb\u8f6c\u3001\u6ee4\u955c</li> <li>\u5982\u4f55\u505a\u56fe\u7247\u7f13\u5b58</li> <li>\u5982\u4f55\u9632\u6b62\u52a0\u8f7d\u5927\u56feOOM</li> <li>\u56fe\u50cf\u663e\u793a\u539f\u7406</li> <li>Bitmap\u548cDrawable  </li> <li>\u56fe\u7247\u52a0\u8f7d\u4f18\u5316</li> <li>Bitmap \u4f7f\u7528\u65f6\u5019\u6ce8\u610f\u4ec0\u4e48</li> <li>bitmap recycler \u76f8\u5173</li> <li>\u56fe\u7247\u52a0\u8f7d\u5e93\u76f8\u5173\uff0cbitmap\u5982\u4f55\u5904\u7406\u5927\u56fe\uff0c\u5982\u4e00\u5f2030M\u7684\u5927\u56fe\uff0c\u5982\u4f55\u9884\u9632OOM</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#android_1","title":"Android\u5176\u4ed6","text":"<ul> <li>Art\u548cDalvik\u533a\u522b</li> <li>\u8be6\u89e3\u6ce8\u89e3\u5904\u7406\u5668APT\u6280\u672f</li> <li>gradle</li> <li>APK\u6253\u5305\u53ca\u5b89\u88c5\u8fc7\u7a0b</li> <li>ActicityThread\u76f8\u5173</li> <li>IntentFilter\u5339\u914d\u89c4\u5219</li> <li>\u63d2\u4ef6\u5316</li> <li>\u7ec4\u4ef6\u5316</li> <li>\u70ed\u4fee\u590d\u65b9\u6848\u5bf9\u6bd4</li> <li>\u57cb\u70b9\u6846\u67b6</li> <li>\u753b\u51faAndroid\u7684\u5927\u4f53\u67b6\u6784\u56fe</li> <li>\u63cf\u8ff0\u6e05\u70b9\u51fbAndroidStudio\u7684build\u6309\u94ae\u540e\u53d1\u751f\u4e86\u4ec0\u4e48</li> <li>\u52a8\u6001\u6743\u9650\u9002\u914d\u65b9\u6848\uff0c\u6743\u9650\u7ec4\u7684\u6982\u5ff5</li> <li>\u8fdb\u7a0b\u4fdd\u6d3b</li> <li>Android\u8fdb\u7a0b\u5206\u7c7b</li> <li>\u662f\u5426\u719f\u6089Android jni\u5f00\u53d1\uff0cjni\u5982\u4f55\u8c03\u7528java\u5c42\u4ee3\u7801</li> <li>\u591a\u7ebf\u7a0b\u65ad\u70b9\u7eed\u4f20\u539f\u7406</li> <li>Appliction\u542f\u52a8\u8fc7\u7a0b\uff08App\u542f\u52a8\u8fc7\u7a0b\uff09</li> <li>App\u542f\u52a8\u6d41\u7a0b\uff0c\u4ece\u70b9\u51fb\u684c\u9762\u5f00\u59cb link</li> <li>\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u5728\u5b50\u7ebf\u7a0b\u66f4\u65b0UI</li> <li>App\u542f\u52a8\u5d29\u6e83\u5f02\u5e38\u6355\u6349</li> <li>\u6570\u636e\u5e93\u5982\u4f55\u8fdb\u884c\u5347\u7ea7,SQLite\u589e\u5220\u6539\u67e5\u7684\u57fa\u7840sql\u8bed\u53e5</li> <li>App\u4e2d\u5524\u9192\u5176\u4ed6\u8fdb\u7a0b\u7684\u5b9e\u73b0\u65b9\u5f0f</li> <li>AndroidManifest\u7684\u4f5c\u7528\u4e0e\u7406\u89e3</li> <li>Android\u4e2d\u5f00\u542f\u6444\u50cf\u5934\u7684\u4e3b\u8981\u6b65\u9aa4</li> <li>Application \u548c Activity \u7684 context \u5bf9\u8c61\u7684\u533a\u522b</li> <li>\u5dee\u503c\u5668&amp;\u4f30\u503c\u5668</li> <li>Android\u4e2d\u8fdb\u7a0b\u5185\u5b58\u7684\u5206\u914d\uff0c\u80fd\u4e0d\u80fd\u81ea\u5df1\u5206\u914d\u5b9a\u989d\u5185\u5b58</li> <li>\u89c6\u9891\u52a0\u5bc6\u4f20\u8f93</li> <li>\u6570\u636e\u600e\u4e48\u538b\u7f29\uff0c\u6570\u636e\u7684\u5b89\u5168</li> <li>\u63d2\u6869\uff08\u6253\u70b9\u7b49\u4f1a\u7528\u5230\uff09</li> <li>\u6a21\u5757\u5316\u5b9e\u73b0\uff08\u597d\u5904\uff0c\u539f\u56e0\uff09</li> <li>\u7edf\u8ba1\u542f\u52a8\u65f6\u957f,\u6807\u51c6</li> <li>\u52a8\u6001\u5e03\u5c40</li> <li>App\u662f\u5982\u4f55\u6c99\u7bb1\u5316\uff0c\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u505a\uff1b</li> <li>\u6743\u9650\u7ba1\u7406\u7cfb\u7edf(\u5e95\u5c42\u7684\u6743\u9650\u662f\u5982\u4f55\u8fdb\u884c grant \u7684)</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_4","title":"\u591a\u7ebf\u7a0b\u76f8\u5173","text":"<ul> <li>\u6b7b\u9501</li> <li>Android\u591a\u8fdb\u7a0b</li> <li>Android\u8fdb\u7a0b\u95f4\u901a\u4fe1--Binder </li> <li>\u591a\u7ebf\u7a0b\u95f4\u901a\u4fe1</li> <li>\u7ebf\u7a0b\u5b89\u5168</li> <li>Java\u7ebf\u7a0b\u6c60</li> <li>\u591a\u7ebf\u7a0b\u6c60\u7684\u4f18\u5316\uff08OKHTTP\u91cc\u9762\u6709\uff09</li> <li>ThreadLocal</li> <li>ReentrantLock</li> <li>\u540c\u6b65\u76f8\u5173\u77e5\u8bc6</li> <li>\u7ebf\u7a0b\u95f4 \u64cd\u4f5c List\uff08\u591a\u7ebf\u7a0b\uff09</li> <li>synchronized\u4e0eLock\u7684\u533a\u522b</li> <li>volatile</li> <li>JVM \u5185\u5b58\u533a\u57df \u5f00\u7ebf\u7a0b\u5f71\u54cd\u54ea\u5757\u5185\u5b58</li> <li>AIDL</li> <li>\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b</li> <li>\u5e76\u53d1\u96c6\u5408\u4e86\u89e3\u54ea\u4e9b</li> <li>CAS\u4ecb\u7ecd</li> <li>\u5f00\u542f\u7ebf\u7a0b\u7684\u4e09\u79cd\u65b9\u5f0f,run()\u548cstart()\u65b9\u6cd5\u533a\u522b</li> <li>\u591a\u7ebf\u7a0b\uff08\u5173\u4e8eAsyncTask\u7f3a\u9677\u5f15\u53d1\u7684\u601d\u8003\uff09</li> <li>\u624b\u5199\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u5f0f</li> <li>\u591a\u8fdb\u7a0b\u573a\u666f\u9047\u89c1\u8fc7\u4e48\uff1f</li> <li>\u5982\u4f55\u4fdd\u8bc1\u591a\u7ebf\u7a0b\u8bfb\u5199\u6587\u4ef6\u7684\u5b89\u5168\uff1f</li> <li>volatile\u7684\u539f\u7406</li> <li>synchronize\u7684\u539f\u7406</li> <li>lock\u539f\u7406</li> <li>\u7ebf\u7a0b\u5982\u4f55\u5173\u95ed\uff0c\u4ee5\u53ca\u5982\u4f55\u9632\u6b62\u7ebf\u7a0b\u7684\u5185\u5b58\u6cc4\u6f0f</li> <li>wait/notify</li> <li>\u591a\u7ebf\u7a0b\uff1a\u600e\u4e48\u7528\u3001\u6709\u4ec0\u4e48\u95ee\u9898\u8981\u6ce8\u610f\uff1bAndroid\u7ebf\u7a0b\u6709\u6ca1\u6709\u4e0a\u9650\uff0c\u7136\u540e\u63d0\u5230\u7ebf\u7a0b\u6c60\u7684\u4e0a\u9650</li> <li>\u7ebf\u7a0b\u95f4\u64cd\u4f5cList</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_5","title":"\u7f51\u7edc","text":"<ul> <li>TCP/UDP\u7684\u533a\u522b</li> <li>\u6570\u5b57\u8bc1\u4e66\u5305\u542b\u7684\u5185\u5bb9</li> <li>HTTPS</li> <li>Https\u8bf7\u6c42\u6162\u7684\u89e3\u51b3\u529e\u6cd5\uff0cDNS\uff0c\u643a\u5e26\u6570\u636e\uff0c\u76f4\u63a5\u8bbf\u95eeIP</li> <li>\u7f51\u7edc\u8bf7\u6c42\u7f13\u5b58\u5904\u7406\uff0cokhttp\u5982\u4f55\u5904\u7406\u7f51\u7edc\u7f13\u5b58\u7684</li> <li>https\u76f8\u5173\uff0c\u5982\u4f55\u9a8c\u8bc1\u8bc1\u4e66\u7684\u5408\u6cd5\u6027\uff0chttps\u4e2d\u54ea\u91cc\u7528\u4e86\u5bf9\u79f0\u52a0\u5bc6\uff0c\u54ea\u91cc\u7528\u4e86\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u5bf9\u52a0\u5bc6\u7b97\u6cd5\uff08\u5982RSA\uff09\u7b49\u662f\u5426\u6709\u4e86\u89e3</li> <li>TCP\u4e0eUDP\u533a\u522b\u4e0e\u5e94\u7528\uff08\u4e09\u6b21\u63e1\u624b\u548c\u56db\u6b21\u6325\u624b\uff09\u6d89\u53ca\u5230\u90e8\u5206\u7ec6\u8282\uff08\u5982client\u5982\u4f55\u786e\u5b9a\u81ea\u5df1\u53d1\u9001\u7684\u6d88\u606f\u88abserver\u6536\u5230\uff09 HTTP\u76f8\u5173 </li> <li>\u63d0\u5230\u8fc7Websocket \u95ee\u4e86WebSocket\u76f8\u5173\u4ee5\u53ca\u4e0esocket\u7684\u533a\u522b</li> <li>https\u63e1\u624b\u8fc7\u7a0b\uff0c\u5982\u4f55\u5b9e\u73b0\u6570\u636e\u52a0\u5bc6\uff1f\u5ba2\u6237\u7aef\u5982\u4f55\u4fdd\u8bc1\u5b89\u5168\u5b9e\u73b0\u53cc\u91cd\u8bc1\u4e66\u6821\u9a8c\uff1f\u8bf7\u4f60\u8bbe\u8ba1\u4e00\u4e2a\u767b\u5f55\u529f\u80fd\uff0c\u9700\u8981\u6ce8\u610f\u54ea\u4e9b\u5b89\u5168\u95ee\u9898</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_6","title":"\u8bbe\u8ba1\u6a21\u5f0f","text":"<ul> <li>\u4ee3\u7406</li> <li>\u8d23\u4efb\u94fe\uff08OKHTTP\u3001Android\u4e8b\u4ef6\u5206\u53d1\uff09</li> <li>\u89c2\u5bdf\u8005\uff08RxJava\uff09</li> <li>\u88c5\u9970\u8005\uff08Java I/O Stream\uff09</li> <li>\u751f\u4ea7\u8005\u6d88\u8d39\u8005</li> <li>\u5355\u4f8b</li> <li>\u9002\u914d\u5668\u6a21\u5f0f\uff0c\u88c5\u9970\u8005\u6a21\u5f0f\uff0c\u5916\u89c2\u6a21\u5f0f\u7684\u5f02\u540c\uff1f</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_7","title":"\u7b97\u6cd5","text":"<ul> <li>\u6392\u5e8f\uff0c\u5feb\u901f\u6392\u5e8f\uff0c\u5806\u6392\u5e8f\u7684\u5b9e\u73b0</li> <li>\u5e38\u7528\u6570\u636e\u7ed3\u6784\u7b80\u4ecb</li> <li>\u6811\uff1aB+\u6811\u7684\u4ecb\u7ecd,B+\u6811</li> <li>\u56fe\uff1a\u6709\u5411\u65e0\u73af\u56fe\u7684\u89e3\u91ca</li> <li>\u963b\u585e\u961f\u5217BlockQueue</li> <li>\u4e8c\u53c9\u6811 \u6df1\u5ea6\u904d\u5386\u4e0e\u5e7f\u5ea6\u904d\u5386</li> <li>\u4e8c\u53c9\u6811\uff0c\u7ed9\u51fa\u6839\u8282\u70b9\u548c\u76ee\u6807\u8282\u70b9\uff0c\u627e\u51fa\u4ece\u6839\u8282\u70b9\u5230\u76ee\u6807\u8282\u70b9\u7684\u8def\u5f84</li> <li>\u5224\u65ad\u73af\uff08\u731c\u6d4b\u5e94\u8be5\u662f\u94fe\u8868\u73af\uff09</li> <li>\u94fe\u8868\u53cd\u8f6c</li> <li>\u4e24\u4e2a\u6808\u7ec4\u6210\u4e00\u4e2a\u961f\u5217</li> <li>\u4e8c\u53c9\u6811\u76f8\u5173</li> <li>\u4e00\u4e2a\u65e0\u5e8f\uff0c\u4e0d\u91cd\u590d\u6570\u7ec4\uff0c\u8f93\u51faN\u4e2a\u5143\u7d20\uff0c\u4f7f\u5f97N\u4e2a\u5143\u7d20\u7684\u548c\u76f8\u52a0\u4e3aM\uff0c\u7ed9\u51fa\u65f6\u95f4\u590d\u6742\u5ea6\u3001\u7a7a\u95f4\u590d\u6742\u5ea6\u3002\u624b\u5199\u7b97\u6cd5</li> <li>\u5408\u5e76\u591a\u4e2a\u5355\u6709\u5e8f\u94fe\u8868\uff08\u5047\u8bbe\u90fd\u662f\u9012\u589e\u7684\uff09</li> <li>\u4e0a\u4e00\u95ee\u6269\u5c55\uff0c\u6d77\u91cf\u6570\u636e\uff0c\u5185\u5b58\u4e2d\u653e\u4e0d\u4e0b\uff0c\u600e\u4e48\u6c42\u51fa\u3002</li> <li>String to Integer</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Backup/#_8","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<ul> <li>\u8fdb\u7a0b\u8c03\u5ea6</li> <li>\u8fdb\u7a0b\u72b6\u6001</li> <li>\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u65b9\u5f0f</li> <li>\u903b\u8f91\u5730\u5740\u4e0e\u7269\u7406\u5730\u5740\uff0c\u4e3a\u4ec0\u4e48\u4f7f\u7528\u903b\u8f91\u5730\u5740</li> <li>\u4e3a\u4ec0\u4e48\u8981\u6709\u7ebf\u7a0b\uff0c\u800c\u4e0d\u662f\u4ec5\u4ec5\u7528\u8fdb\u7a0b</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/","title":"InterView Enhance","text":"<p>\u8282\u9009\u81ea\u5c0f\u4e13\u680f\u4e2d\u7684\u300aAndroid \u9762\u8bd5\u6307\u5357\u300b</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#oppo","title":"OPPO","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_1","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u804a\u804a\u7b80\u5386\u4e0a\u5199\u7684\u9879\u76ee</li> <li>MVC\u3001MVP\u7684\u533a\u522b</li> <li>RxJava\u7684\u7ebf\u7a0b\u5207\u6362\u539f\u7406</li> <li>ListView\u7684\u5361\u987f\u4f18\u5316\u3001\u8d44\u8baf\u6d41\u61d2\u52a0\u8f7d\u5982\u4f55\u5b9e\u73b0</li> <li>\u5e8f\u5217\u5316\u524d\u540e\u5bf9\u8c61\u6709\u4f55\u533a\u522b</li> <li>Binder\u901a\u4fe1\u539f\u7406</li> <li>\u63d2\u4ef6\u5316\u5f00\u53d1\u6d41\u7a0b\uff0c\u63d2\u4ef6\u5316\u4f18\u52bf\uff0c\u63d2\u4ef6\u5316\u5f00\u53d1\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4ee5\u53ca\u5982\u4f55\u89e3\u51b3\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_2","title":"\u4e8c\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u9879\u76ee\u4ecb\u7ecd</li> <li>Glide\u7684\u4f18\u52bf\uff0c\u5b83\u662f\u5982\u4f55\u7ed1\u5b9a\u751f\u547d\u5468\u671f\u7684</li> <li>ListView\u5982\u4f55\u4f18\u5316\uff0cListView\u548cRecyclerView\u7684\u533a\u522b\uff0c\u4e8c\u8005\u7684\u7f13\u5b58\u903b\u8f91</li> <li>\u63d0\u9ad8app\u5b89\u5168\u6027\u7684\u65b9\u6cd5</li> <li>View\u7684\u7ed8\u5236\u6d41\u7a0b</li> <li>\u63d2\u4ef6\u5316\u539f\u7406</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_3","title":"\u4e09\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u9879\u76ee\u4ecb\u7ecd</li> <li>\u4e3a\u4ec0\u4e48\u9009\u7528\u63d2\u4ef6\u5316\uff0c\u63d2\u4ef6\u5316\u6846\u67b6\u7684\u6bd4\u8f83\uff0c\u68b3\u7406\u63d2\u4ef6\u5316\u7684\u67b6\u6784</li> <li>App\u7684\u542f\u52a8\u6d41\u7a0b</li> <li>\u81ea\u5df1\u7684\u4f18\u52bf\u548c\u52a3\u52bf</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_4","title":"\u817e\u8baf\u89c6\u9891","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_5","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u9879\u76ee\u4ecb\u7ecd</li> <li>\u5982\u4f55\u5904\u7406App\u542f\u52a8\u6d41\u7a0b\u4f18\u5316</li> <li>View\u7684\u6027\u80fd\u4f18\u5316</li> <li>MVC\u5230MVP\u7684\u67b6\u6784\u91cd\u6784\u6d41\u7a0b</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_6","title":"\u4e8c\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u9879\u76ee\u4ecb\u7ecd</li> <li>\u4e3a\u4ec0\u4e48\u7528Glide\uff0c\u5b83\u7684\u4f18\u52bf</li> <li>HashMap\u7684\u539f\u7406\uff0cConCurrentHashMap\u7684\u539f\u7406</li> <li>View\u7684\u7ed8\u5236\u6d41\u7a0b</li> <li>Handler\u7684\u5de5\u4f5c\u539f\u7406</li> <li>LeakCanary\u539f\u7406\uff0c\u5185\u5b58\u6cc4\u9732\u7684\u5206\u6790\u6d41\u7a0b</li> <li>\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff0cBinder\u539f\u7406</li> <li>\u5783\u573e\u56de\u6536\u539f\u7406\u4ee5\u53ca\u56de\u6536\u7b56\u7565</li> <li>Java\u4e2d\u7684\u5f3a\u3001\u8f6f\u3001\u5f31\u3001\u865a\u5f15\u7528</li> <li>\u7b97\u6cd5\uff1a\u6392\u5e8f\uff0c\u8981\u6c42\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n)\uff0c\u4f8b\u59821\uff0c4\uff0c5\uff0c2\uff0c7\uff0c6\uff0c9\u3002\u5982\u679c\u6570\u5217\u662f10\uff0c102\uff0c99\uff0c10000\uff0c825\uff0c1003030\u5982\u4f55\u6392\u5e8f</li> <li>\u5bf9\u4e8e\u6570\u503c\u4e0d\u5927\u7684\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u6570\u7ec4\u6765\u5b9e\u73b0O(n)\u7684\u6392\u5e8f</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_7","title":"\u4e09\u9762","text":"<ul> <li>View\u7684\u6027\u80fd\u4f18\u5316\uff0c\u9875\u9762\u5361\u987f\u7684\u539f\u56e0</li> <li>TCP\u3001IP\u5404\u81ea\u6240\u5728\u7684\u7f51\u7edc\u5c42\u6b21\uff0cIP\u62a5\u6587\u4e2d\u7684\u5185\u5bb9</li> <li>https\u7684\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6</li> <li>\u6307\u9488\u5360\u51e0\u4e2a\u5b57\u8282</li> <li>\u81ea\u5df1\u7684\u4f18\u52bf\u548c\u52a3\u52bf</li> <li>\u5bf9\u5f00\u53d1\u6d41\u7a0b\u7684\u7406\u89e3</li> <li>\u5e73\u65f6\u5199\u535a\u5ba2\u5417\uff0c\u559c\u6b22\u770b\u54ea\u4e9b\u6280\u672f\u6587\u7ae0</li> <li>\u4e3a\u4ec0\u4e48\u79bb\u804c\u627e\u5de5\u4f5c</li> <li>\u5207\u997c\u95ee\u9898\uff1a1\u5200\u52072\u5757\uff0c2\u5200\u52074\u5757\uff0c10\u5200\u6700\u591a\u5207\u51e0\u5757\u3002</li> <li>\u89c4\u5f8b\u662f\u5728\u4e0a\u6b21\u5207\u5f97\u7684\u5757\u6570\u4e0a\u52a0\u4e0a\u5f53\u524d\u7684\u5200\u6570</li> <li>\u8ffd\u51fb\u95ee\u9898\uff1a2\u8f86\u706b\u8f66\u76f8\u5411\u540c\u65f6\u51fa\u53d1\uff0c\u4e00\u4e2a\u4eceA\u70b9\u51fa\u53d1\uff0c\u901f\u5ea6\u662f30km/h,\u4e00\u4e2a\u4eceB\u70b9\u51fa\u53d1\uff0c\u901f\u5ea6\u662f20km/h\uff0cA\u3001B\u4e4b\u95f4\u7684\u8ddd\u79bb\u662fS\uff0c\u540c\u65f6\u4e00\u53ea\u9e1f\u4e5f\u4eceA\u70b9\u51fa\u53d1\uff0c\u901f\u5ea6\u662f50km/h\uff0c\u9e1f\u5728\u4e24\u8f86\u706b\u8f66\u95f4\u6298\u8fd4\u98de\u884c\uff0c\u95ee\u4e09\u8005\u76f8\u9047\u65f6\uff0c\u9e1f\u98de\u7684\u603b\u8def\u7a0b\u3002</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_8","title":"\u56db\u9762","text":"<ul> <li>\u68b3\u7406\u4f60\u9047\u5230\u7684\u6700\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u4ee5\u53ca\u5982\u4f55\u89e3\u51b3\u7684</li> <li>\u5728\u767d\u677f\u4e0a\u5199\u51fa\u5bf9\u4e8eView\u7684\u7ed8\u5236\u548c\u4f18\u5316\u6d41\u7a0b</li> <li>\u7b97\u6cd5\uff1a\u7ed9\u5b9a\u4e00\u6bb5\u5df2\u6392\u597d\u5e8f\u7684\u6570\u5217\uff0c\u6570\u5217\u4e2d\u5143\u7d20\u6709\u53ef\u80fd\u662f\u91cd\u590d\u7684\uff0c\u627e\u51fa\u6570\u5217\u4e2d\u76ee\u6807\u503c\u7684\u6700\u5c0f\u7d22\u5f15\uff0c\u8981\u6c42\u4e0d\u80fd\u7528\u9012\u5f52\uff0c\u53ea\u80fd\u7528\u5faa\u73af\u3002</li> <li>\u4e8c\u5206\u67e5\u627e\u7684\u53d8\u79cd\u3002</li> <li>\u79f0\u91cd\u95ee\u9898\uff1a10\u4e2a\u7bb1\u5b50\uff0c\u6bcf\u4e2a\u7bb1\u5b50\u91cc\u90fd\u6709\u82e5\u5e72\u7816\u5934\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u7bb1\u5b50\u91cc\u6bcf\u4e2a\u7816\u5934\u91cd9\u514b\uff0c\u5176\u4ed6\u7684\u7bb1\u5b50\u91cc\u7684\u7816\u5934\u6bcf\u4e2a\u91cd10\u514b\uff0c\u7ed9\u4f60\u4e00\u4e2a\u79e4\uff0c\u8981\u6c42\u53ea\u80fd\u7528\u4e00\u6b21\u79f0\u91cd\u627e\u51fa\u7816\u5934\u91cd9\u514b\u7684\u7bb1\u5b50\u3002</li> <li>\u7b2c\u4e00\u4e2a\u7bb1\u5b50\u62ff\u4e00\u4e2a\u7816\u5934\uff0c\u7b2c\u4e8c\u4e2a\u90a3\u4e24\u4e2a\u7816\u5934\uff0c\u7b2c\u4e09\u4e2a\u62ff\u4e09\u4e2a\u7816\u5934\uff0c\u7136\u540e\u4e00\u8d77\u79f0\uff0c\u5dee\u51e0\u514b\u7b2c\u51e0\u4e2a\u7bb1\u5b50\u90fd\u662f9\u514b\u7684\u3002</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_9","title":"\u4eca\u65e5\u5934\u6761","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_10","title":"\u4e00\u9762","text":"<ul> <li>\u7b97\u6cd5\uff1a\u8fde\u7eed\u5b50\u6570\u7ec4\u7684\u6700\u5927\u548c</li> <li>\u4e86\u89e3\u54ea\u4e9b\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u624b\u5199\u5355\u4f8b\u8bbe\u8ba1\u6a21\u5f0f</li> <li>View\u7684\u4f4d\u7f6e\u53c2\u6570\u6709\u54ea\u4e9b\uff0cleft\uff0cx\uff0ctranslationX\u7684\u542b\u4e49\u4ee5\u53ca\u4e09\u8005\u7684\u5173\u7cfb</li> <li>View\u7684\u7ed8\u5236\u6d41\u7a0b\uff0conMeasure\uff0conLayout\u7684\u8ba1\u7b97\u6d41\u7a0b\uff0cMeasureSpec\u7684\u51e0\u79cd\u6a21\u5f0f</li> <li>\u5904\u7406\u6ed1\u52a8\u7684\u51e0\u79cd\u65b9\u5f0f\uff0cScroller\u6ed1\u52a8\u7684\u539f\u7406</li> <li>\u81ea\u5b9a\u4e49View\u7684\u6d41\u7a0b\uff0c\u81ea\u5b9a\u4e49View\u9700\u8981\u6ce8\u610f\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u81ea\u5b9a\u4e49View\u662f\u5426\u9700\u8981\u91cd\u5199onLayout\uff0conMeasure</li> <li>invalidate\u3001postInvalidate\u3001requestLayout\u7684\u533a\u522b</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_11","title":"\u4e8c\u9762","text":"<ul> <li>TCP\u3001UDP\u533a\u522b\uff0c\u62e5\u585e\u63a7\u5236\u539f\u7406\uff0c\u89c6\u9891\u4f20\u8f93\u4e3a\u4ec0\u4e48\u7528UDP\uff0cUDP\u4e22\u5305\u4f1a\u4ea7\u751f\u4ec0\u4e48\u95ee\u9898\uff0c\u5982\u4f55\u5904\u7406\u6570\u636e\u5305\u7684\u53d1\u9001\u901f\u5ea6\u548c\u5e26\u5bbd\u7684\u5173\u7cfb</li> <li>Touch\u4e8b\u4ef6\u7684\u5206\u53d1\u6d41\u7a0b</li> <li>\u7c7b\u7684\u52a0\u8f7d\u673a\u5236\uff0c\u4e3a\u4ec0\u4e48\u7528\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff0cjava\u662f\u5426\u652f\u6301\u591a\u6001</li> <li>\u63d2\u4ef6\u5316Activity\u751f\u547d\u5468\u671f\u7684\u7ba1\u7406\uff0c\u8d44\u6e90\u7684\u8bbf\u95ee\u539f\u7406</li> <li>\u7b97\u6cd5\uff1aGiven two words word1 and word2, find the minimum number of operations required to convert word1 to word2. You have the following 3 operations permitted on a word: 1\u3001Insert a character 2\u3001Delete a character 3\u3001Replace a character Input: word1 = \"horse\", word2 = \"ros\" Output: 3 Explanation: horse -&gt; rorse (replace 'h' with 'r') rorse -&gt; rose (remove 'r') rose -&gt; ros (remove 'e'</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_12","title":"\u4e09\u9762","text":"<ul> <li>\u7b97\u6cd5\uff1aint[] insert(int[] arr,int len,int cap,int pos,int value)\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u6570\u7ec4\uff0c\u4f8b\u5982{1\uff0c2\uff0c3\uff0c\u7a7a\uff0c\u7a7a},\u8be5\u6570\u7ec4\u7684len=3\uff0c\u5bb9\u79efcap=5\uff0c\u63d2\u5165\u4f4d\u7f6epos\u662f1\uff0c\u63d2\u5165\u7684\u503c\u662f5\uff0c\u7ed3\u679c\u662f{1\uff0c5\uff0c2\uff0c3\uff0c\u7a7a}\uff0c\u8fd4\u56de\u63d2\u5165\u540e\u7684\u6570\u7ec4\uff08\u8003\u8651\u6269\u5bb9\uff09\uff1b</li> <li>App\u7684\u542f\u52a8\u4f18\u5316\u6d41\u7a0b</li> <li>\u5b9e\u73b0\u4e00\u4e2a\u5e93\uff0c\u5b8c\u6210\u65e5\u5fd7\u7684\u5b9e\u65f6\u4e0a\u62a5\u548c\u5ef6\u8fdf\u4e0a\u62a5\u4e24\u79cd\u529f\u80fd\uff0c\u8be5\u4ece\u54ea\u4e9b\u65b9\u9762\u8003\u8651</li> <li>\u662f\u5426\u4f7f\u7528\u8fc7Flutter\u5f00\u6e90\u6846\u67b6</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_13","title":"\u963f\u91cc\u641c\u7d22\u4e8b\u4e1a\u90e8","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_14","title":"\u4e00\u9762","text":"<ul> <li>View\u7684\u6027\u80fd\u4f18\u5316\uff0clistView\u7684\u5361\u987f\u4f18\u5316\uff0c\u8d44\u8baf\u6d41\u61d2\u52a0\u8f7d\u5b9e\u73b0\u3002</li> <li>App\u7684\u542f\u52a8\u6d41\u7a0b\u4f18\u5316</li> <li>\u7ec4\u4ef6\u5316\u5f00\u53d1\u6d41\u7a0b\uff0cARouter\u8def\u7531\u534f\u8bae\u7684\u539f\u7406\u5206\u6790</li> <li>\u63d2\u4ef6\u5316\u4f18\u52bf\uff0c\u63d2\u4ef6\u5316\u52a0\u8f7dActivity\u539f\u7406\uff0c\u52a0\u8f7d\u8d44\u6e90\u539f\u7406</li> <li>\u63d2\u4ef6\u5316\u9996\u6b21\u542f\u52a8\u8017\u65f6\u957f\uff0c\u5982\u4f55\u4f18\u5316</li> <li>\u5982\u4f55\u5904\u7406\u51e0\u767e\u4eba\u7684\u56e2\u961f\u5206\u5de5</li> <li>\u4f60\u5bf9\u6dd8\u5b9dApp\u7684\u4f7f\u7528\u4f53\u9a8c\uff0c\u4ece\u54ea\u4e9b\u65b9\u9762\u4f18\u5316\u6dd8\u5b9dApp</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_15","title":"\u62db\u5546\u57fa\u91d1","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_16","title":"\u4e00\u9762","text":"<ul> <li>Handler\u5de5\u4f5c\u539f\u7406</li> <li>View\u7684\u7ed8\u5236\u539f\u7406</li> <li>\u81ea\u5b9a\u4e49View\u7684\u6d41\u7a0b</li> <li>\u5982\u4f55\u4f18\u5316WebView\uff0cWebView\u7684\u6cc4\u9732</li> <li>native\u548cjs\u4ea4\u4e92\u6d41\u7a0b</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_17","title":"\u9ad8\u9891\u8003\u70b9","text":"<ul> <li>\u591a\u7ebf\u7a0b\u77e5\u8bc6\uff08\u9501\u3001\u7ebf\u7a0b\u6c60\uff09</li> <li>\u5185\u5b58\u6a21\u578b</li> <li>HashMap</li> <li>\u7ebf\u7a0b\u95f4\u901a\u4fe1</li> <li>\u591a\u8fdb\u7a0b</li> <li>View\u7ed8\u5236</li> <li>\u89e6\u6478\u4e8b\u4ef6\u4f20\u9012</li> <li>\u94fe\u8868\u7ffb\u8f6c</li> <li>\u5feb\u901f\u6392\u5e8f</li> <li>\u4e8c\u5206\u67e5\u627e</li> <li>\u6808\u76f8\u5173</li> <li>int\u7ffb\u8f6c</li> <li>\u6570\u7ec4\u5408\u5e76</li> <li>LRUCache</li> <li>MVP</li> <li>\u5355\u4f8b</li> <li>HTTPS\u7b49\u7b49</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_18","title":"\u77e5\u8bc6\u70b9\u8be6\u7ec6\u6e05\u5355","text":"<ul> <li>Activity\u7684\u751f\u547d\u5468\u671f</li> <li>Activity\u7684\u4efb\u52a1\u6808</li> <li>Activity\u7684\u542f\u52a8\u6a21\u5f0f</li> <li>Fragment\u7684\u751f\u547d\u5468\u671f</li> <li>Fragment\u7684\u901a\u8baf\uff0cFragment\u4e4b\u95f4\uff0cFragment\u548cActivity</li> <li>\u4ec0\u4e48\u662fService\uff0c\u548cThread\u7684\u533a\u522b</li> <li>Broadcast\u7684\u4f5c\u7528\u548c\u6ce8\u518c\u65b9\u5f0f</li> <li>\u4ec0\u4e48\u662f\u672c\u5730\u5e7f\u64ad</li> <li>\u4ec0\u4e48\u662f\u6709\u5e8f\u5e7f\u64ad</li> <li>Android\u7684\u5f02\u6b65\u5904\u7406\u65b9\u5f0f\u6709\u54ea\u4e9b</li> <li>AsycnTask\u3001HandlerThread\u3001IntentService\u6e90\u7801</li> <li>Binder</li> <li>View\u7684\u7ed8\u5236\u6d41\u7a0b</li> <li>\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u81ea\u5b9a\u4e49View\u7684\u51e0\u79cd\u573a\u666f\u548c\u65b9\u5f0f</li> <li>ListView\u7684\u7f13\u5b58\u673a\u5236</li> <li>Handler\u3001Message\u3001MessageQueue\u3001Looper</li> <li>\u7b2c\u4e09\u65b9\u5f00\u6e90\u6846\u67b6\u8bbe\u8ba1\u548c\u539f\u7406</li> <li>ANR\u662f\u4ec0\u4e48\uff0c\u600e\u4e48\u907f\u514d\u548c\u6392\u67e5</li> <li>OOM\u662f\u4ec0\u4e48\uff0c\u4e00\u822c\u5982\u679c\u907f\u514d\u548c\u89e3\u51b3</li> <li>\u5185\u5b58\u6cc4\u9732\u662f\u4ec0\u4e48\uff0c\u5e38\u89c1\u7684\u5185\u5b58\u6cc4\u9732\u6709\u54ea\u4e9b</li> <li>\u7248\u672c\u7ba1\u7406\u5de5\u5177\u7684\u4f7f\u7528\uff0cGit\u3001SVN</li> <li>\u4ee3\u7801\u7f16\u8bd1\u5de5\u5177</li> <li>\u4ee3\u7801\u6df7\u6dc6</li> <li>Java IO</li> <li>\u591a\u7ebf\u7a0b</li> <li>\u7c7b\u52a0\u8f7d\u5668</li> <li>\u53cd\u5c04</li> <li>23\u79cd\u8bbe\u8ba1\u6a21\u5f0f</li> <li>HTTP\u3001TCP\u3001UDP\u534f\u8bae</li> <li>\u8ba1\u7b97\u673a\u7f51\u7edc</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u539f\u7406</li> <li>\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\uff1a\u6392\u5e8f\u3001\u4e8c\u53c9\u6811\u904d\u5386\u3001\u52a8\u6001\u89c4\u5212</li> <li>\u5e38\u89c1\u52a0\u5bc6\u65b9\u5f0f\u548c\u539f\u7406</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_19","title":"\u767e\u5ea6\uff08\u6821\u62db\uff09","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_20","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd\uff0c\u95ee\u4e86\u95ee\u5b9e\u4e60\u671f\u95f4\u505a\u4e86\u4ec0\u4e48\u5185\u5bb9\uff0c\u804a\u4e86\u804a\u7b80\u5386\u4e0a\u5199\u7684\u9879\u76ee</li> <li>\u4e86\u89e3Http\u5417\uff0c\u8bf4\u8bf4TCP\u4e09\u6b21\u63e1\u624b\u56db\u6b21\u6325\u624b</li> <li>\u4e3a\u4ec0\u4e48\u6709\u4e09\u6b21\u63e1\u624b\uff0c\u4e0d\u662f\u56db\u6b21\uff0c\u6216\u8005\u4e24\u6b21</li> <li>Http\u5934\u90e8\u6709\u54ea\u4e9b\uff0c\u7528\u8fc7\u54ea\u4e9b</li> <li>Java\u770b\u8fc7\u6e90\u7801\u5417\uff0c\u8bf4\u8bf4Collection\u7684\u5e38\u7528\u5b50\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\uff0c\u8bf4\u8bf4ArrayList\u548cLinkedList\u533a\u522b</li> <li>AysncTask\u7528\u8fc7\u5417\uff0c\u5404\u4e2a\u51fd\u6570\u5206\u522b\u5728\u4ec0\u4e48\u7ebf\u7a0b\u56de\u8c03\u7684</li> <li>\u5728\u5b50\u7ebf\u7a0b\u91cc\u600e\u4e48\u64cd\u4f5cUI\u66f4\u65b0</li> <li>\u4ecb\u7ecd\u4e00\u4e0bHandler\u5de5\u4f5c\u539f\u7406</li> <li>\u9664\u4e86\u4e3b\u7ebf\u7a0b\u4e4b\u5916\u5176\u4ed6\u7684\u90fd\u8981\u8c03\u7528Looper.perpare()\u5417</li> <li>\u7528\u8fc7Fragment\u5417\uff0c\u8bf4\u4e00\u4e0bFragment\u548cActivity\u7684\u751f\u547d\u5468\u671f\u4e4b\u95f4\u7684\u5173\u7cfb</li> <li>\u8bf4\u4e00\u4e0bService\u7684\u751f\u547d\u5468\u671f\uff0c\u7528\u8fc7IntentService\u5417\u6709\u4ec0\u4e48\u533a\u522b</li> <li>\u5982\u4f55\u5224\u65ad\u5355\u94fe\u8868\u6709\u73af\uff0c\u5982\u4f55\u5224\u65ad\u73af\u7684\u4f4d\u7f6e</li> <li>\u624b\u5199\u4e8c\u5206\u67e5\u627e</li> <li>\u624b\u5199\u4f2a\u4ee3\u7801\uff1a\u7ed9\u4e24\u4e2a\u6808\uff0c\u8981\u6c42\u5b9e\u73b0\u961f\u5217</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_21","title":"\u963f\u91cc\uff08\u6821\u62db\uff09","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_22","title":"\u4e00\u9762","text":"<ul> <li>\u804a\u7b80\u5386\uff0c\u95ee\u4e86\u5f88\u591a\u56f4\u7ed5\u7b80\u5386\u5c55\u5f00\u7684\u95ee\u9898</li> <li>\u5bf9Java\u7684\u5e38\u7528\u5bb9\u5668\u719f\u6089\u5417\uff1f\u77e5\u9053Vector\u5417\uff1f\u8bf4\u4e00\u4e0bHashmap\u548cHashTable\u7684\u533a\u522b</li> <li>\u89e3\u91ca\u4e00\u4e0b\u7ebf\u7a0b\u548c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u505a\u8fc7\u591a\u7ebf\u7a0b\u5417\uff1f\u5728\u4ec0\u4e48\u573a\u666f\u4e0b\u5e94\u7528</li> <li>\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u540c\u6b65</li> <li>Synchronize\u5173\u952e\u5b57\u7684\u4f5c\u7528\u8303\u56f4\uff0cvolatile\u5173\u952e\u5b57\u7684\u4f5c\u7528</li> <li>\u4e86\u89e3\u6b7b\u9501\u5417\uff1f</li> <li>\u56de\u5230HashTable\u4e0a\uff0cHashTable\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u540c\u6b65\uff0c\u6709\u6ca1\u6709\u66f4\u9ad8\u6548\u7684\u53ef\u4ee5\u4fdd\u8bc1\u7ebf\u7a0b\u540c\u6b65\u7684map\uff0c\u7528\u8fc7\u5417</li> <li>Hashmap\u770b\u8fc7\u6e90\u7801\u5417\uff1f\u4e86\u89e3\u5e95\u5c42\u5b9e\u73b0\u5417\uff1fHashmap\u600e\u4e48\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u7684\u95ee\u9898\uff1f\u5bf9Java8\u7684\u6539\u52a8\u6709\u5173\u6ce8\u5417\uff1f\u4e86\u89e3Java8\u4e2d\u5bf9Hashmap\u6709\u4ec0\u4e48\u4f18\u5316\u5417</li> <li>TCP\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b\uff1f\u662f\u54ea\u4e00\u5c42\u534f\u8bae\uff1f\u8bf4\u4e00\u4e0bOSI\u4e03\u5c42\u6a21\u578b</li> <li>\u8bf4\u4e00\u4e0bTCP\u548cUDP\u7684\u533a\u522b\uff0c\u77e5\u9053\u5206\u522b\u6709\u4ec0\u4e48\u5e94\u7528\u573a\u666f\u5417</li> <li>\u5728\u65e0\u5e8f\u6570\u7ec4\u4e2d\u627e\u5230\u4e24\u4e2a\u503cx\uff0cy\u4f7fx+y=z\uff08z\u662f\u5df2\u77e5\u503c\uff09\uff08\u6211\u7ed9\u51fa\u7684\u65b9\u6cd5\u662f\u57fa\u4e8e\u6392\u5e8f\u7684\uff09\u3002\u6709\u65b9\u6cd5\u53ef\u4ee5\u4e0d\u6392\u5e8f\u5417\uff1f</li> <li>Activity\u7684\u751f\u547d\u5468\u671f\u4e86\u89e3\u5417\uff1f</li> <li>\u5bf9Activity\u7684\u56db\u79cd\u542f\u52a8\u6a21\u5f0f\u4e86\u89e3\u5417\uff1f</li> <li>\u4e86\u89e3Android\u591a\u8fdb\u7a0b\u5f00\u53d1\u5417\uff1f\u6709\u4ec0\u4e48\u5e94\u7528\uff1f\u505a\u8fc7\u591a\u8fdb\u7a0b\u5f00\u53d1\u5417\uff1f</li> <li>\u8fdb\u7a0b\u4e4b\u95f4\u6709\u54ea\u4e9b\u901a\u8baf\u65b9\u5f0f</li> <li>\u8bf4\u4e00\u4e0bBinder</li> <li>ListView\u600e\u4e48\u505a\u4f18\u5316</li> <li>\u81ea\u5b9a\u4e49View\u6709\u54ea\u4e9b\u5173\u952e\u51fd\u6570\uff1f\u5206\u522b\u6709\u4ec0\u4e48\u7528\uff1f\u81ea\u5df1\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u7528\u8fc7\u81ea\u5b9a\u4e49View\u5417</li> <li>\u6709\u4ec0\u4e48\u60f3\u8981\u4e86\u89e3\u7684\u5417</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_23","title":"\u4e8c\u9762","text":"<ul> <li>\u770b\u8fc7Java\u4ec0\u4e48\u6e90\u7801</li> <li>\u8bf4\u4e00\u8bf4\u4f60\u770b\u8fc7\u7684\u5185\u5bb9</li> <li>\u4e86\u89e3JVM\u7684\u7c7b\u52a0\u8f7d\u5417</li> <li>\u5783\u573e\u56de\u6536\u7b97\u6cd5\u4e86\u89e3\u5417</li> <li>Java\u4e2d\u7684\u8f6f\u5f15\u7528\uff0c\u5f31\u5f15\u7528\u2026\u2026</li> <li>\u6700\u8fd1\u5728\u770b\u4ec0\u4e48\u4e66</li> <li>\u8bf4\u8bf4\u4f60\u4e86\u89e3\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff08\u5f00\u59cb\u75af\u72c2\u804a\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u4f46\u662f\u6211\u662f\u771f\u4e0d\u61c2\uff0c\u53ea\u80fd\u60f3\u5230\u4ec0\u4e48\u8bf4\u4ec0\u4e48\uff09</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_24","title":"\u4e09\u9762","text":"<ul> <li>Activity\u7684\u751f\u547d\u5468\u671f\uff0c\u9700\u8981\u4fdd\u5b58\u5f53\u524d\u89c6\u56fe\u7684\u72b6\u6001\u5e94\u8be5\u600e\u4e48\u505a</li> <li>Activity\u754c\u9762\u7ed8\u5236\u7684\u8fc7\u7a0b</li> <li>Looper\uff0cMessage\u548cMessageQueue\u5173\u7cfb</li> <li>Android\u56db\u5927\u7ec4\u4ef6\uff0c\u90fd\u7528\u8fc7\u5417\uff1f</li> <li>\u6570\u636e\u6301\u4e45\u5316\u600e\u4e48\u505a</li> <li>Touch\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u8bb2\u4e00\u8bb2AIDL</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_25","title":"\u7f8e\u56e2","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_26","title":"\u4e00\u9762","text":"<ul> <li>\u624b\u5199\u4ee3\u7801\uff1a\u5927\u6574\u6570\u52a0\u6cd5</li> <li>\u7b80\u5386\u4e0a\u63d0\u5230\u4f7f\u7528Butterknife\uff0cButterknife\u662f\u4ec0\u4e48\u9636\u6bb5\u6ce8\u89e3\uff1f\u6ce8\u89e3\u7684\u751f\u547d\u5468\u671f\u4e86\u89e3\u5417\uff1f</li> <li>\u7b80\u5386\u4e2d\u63d0\u5230\u4f7f\u7528Okhttp\u505a\u7f51\u7edc\u901a\u8baf\uff0c\u8bf4\u4e00\u4e0bOkhttp\u62e6\u622a\u5668</li> <li>Http\u548cHttps\u533a\u522b\uff0c\u6ca1\u6709CA\u8bc1\u4e66\u53ef\u4ee5\u4f7f\u7528Https\u8bbf\u95ee\u5417</li> <li>TCP\u5728\u662f\u54ea\u4e00\u5c42\u7684\u534f\u8bae\uff0c\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b</li> <li>\u4e86\u89e3\u4ec0\u4e48\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8bf4\u4e00\u8bf4\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6</li> <li>\u4e86\u89e3JVM\u5417\uff0c\u8bf4\u8bf4\u5783\u573e\u56de\u6536\u673a\u5236</li> <li>\u4e86\u89e3apk\u7684\u7f16\u8bd1\u8fc7\u7a0b\u5417\uff0c\u7b80\u5355\u8bf4\u4e86\u4e00\u4e0bdex</li> <li>Java\u4e2dCollection\u7684\u5e38\u7528\u5b9e\u73b0\u7c7b\uff0cmap\u7684\u5b9e\u73b0\u7c7b</li> <li>\u804a\u804aHashmap\u548cHashtable\u533a\u522b</li> <li>Hashmap\u7684\u5e95\u5c42\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5982\u4f55\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\uff0c\u9664\u4e86\u8fd9\u79cd\u89e3\u51b3\u65b9\u5f0f\u8fd8\u6709\u6ca1\u6709\u5176\u4ed6\u89e3\u51b3\u65b9\u5f0f</li> <li>\u5f88\u591a\u7f51\u7ad9\u50cf\u65b0\u6d6a\u5fae\u535a\u7f51\u5740\u90fd\u6709\u77ed\u5730\u5740\uff0c\u5982\u679c\u8ba9\u4f60\u5b9e\u73b0\u600e\u4e48\u505a</li> <li>\u5982\u4f55\u5224\u65ad\u4e24\u4e2a\u5355\u94fe\u8868\u76f8\u4ea4</li> <li>\u5982\u4f55\u4f7f\u7528\u4e24\u4e2a\u6216\u591a\u4e2a\u6808\u6a21\u62df\u961f\u5217</li> <li>\u667a\u529b\u9898\uff1a\u73b0\u5728\u6709\u4e00\u4e2a\u62bd\u5956\u6d3b\u52a8\uff0c\u4ece8\u70b9\u523010\u70b9\u8fd9\u6bb5\u65f6\u95f4\u4f1a\u6709\u82e5\u5e72\u4e2a\u7528\u6237\u53c2\u4e0e\u62bd\u5956\uff0c\u73b0\u5728\u670910\u4e2a\u83b7\u5956\u540d\u989d\uff0c\u4f46\u6ca1\u6709\u8db3\u591f\u5927\u7684\u7a7a\u95f4\u4fdd\u5b58\u6240\u6709\u7684\u6570\u636e\uff0c\u8981\u6c42\u6bcf\u4e2a\u7528\u6237\u7b49\u6982\u7387\u4e2d\u5956\uff0c\u4e1410\u70b9\u6d3b\u52a8\u622a\u6b62\u77ac\u95f4\u5f00\u5956\u3002</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_27","title":"\u4e8c\u9762","text":"<ul> <li>\u624b\u5199\u4ee3\u7801\uff1a\u5220\u9664\u5355\u94fe\u8868\u5012\u6570\u7b2cx\u4e2a\u7ed3\u70b9</li> <li>\u624b\u5199\u4ee3\u7801\uff1az\u5df2\u77e5\uff0c\u5728\u65e0\u5e8f\u6570\u7ec4\u4e2d\u627e\u5230\u4e24\u4e2a\u6570x\u548cy\uff0c\u4f7fx+y=z\uff08\u4f7f\u7528\u54c8\u5e0c\u8868\u4ee5\u7a7a\u95f4\u6362\u65f6\u95f4\uff09</li> <li>\u6709\u6ca1\u6709\u770b\u8fc7Handler\u7684\u6e90\u7801\uff0c\u5f53MessageQueue\u4e2d\u6ca1\u6709Message\u4f1a\u600e\u4e48\u5904\u7406</li> <li>\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u4e0e\u8fdb\u7a0b\uff0candroid\u8de8\u8fdb\u7a0b\u901a\u8baf\u7684\u65b9\u5f0f\uff0c\u81ea\u5df1\u6709\u6ca1\u6709\u7528\u8fc7</li> <li>\u8bb2\u4e00\u8bb2AIDL\u539f\u7406</li> <li>Service\u6709\u51e0\u79cd\u542f\u52a8\u65b9\u5f0f\uff0c\u6709\u4ec0\u4e48\u533a\u522b</li> <li>activity\u7684\u58f0\u660e\u5468\u671f\u548c\u542f\u52a8\u6a21\u5f0f\uff0c\u4e3e\u4e86\u4e00\u4e2a\u5b9e\u9645\u573a\u666f\u95ee\u70b9\u51fbback\u4e4b\u540e\u7684\u8df3\u8f6c</li> <li>activityA\u8df3\u8f6c\u5230B\u8fc7\u7a0b\u4e2dA\uff0cB\u7684\u751f\u547d\u5468\u671f\u51fd\u6570\u8c03\u7528\u987a\u5e8f</li> <li>\u81ea\u5b9a\u4e49View\u7684\u76f8\u5173\u77e5\u8bc6</li> <li>View\u7684\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u7b80\u5386\u4e2d\u63d0\u5230\u4e86\u7528Picasso\u505a\u56fe\u7247\u4e0b\u8f7d\u7f13\u5b58\uff0c\u4e3a\u4ec0\u7528Picasso\uff0c\u5982\u679c\u81ea\u5df1\u5b9e\u73b0\u9700\u8981\u6ce8\u610f\u4ec0\u4e48</li> <li>\u8bf4\u8bf4\u56fe\u7247\u4e09\u7ea7\u7f13\u5b58</li> <li>\u77e5\u9053gradle\uff0c\u5982\u679cmodule\u6ca1\u6709gradle\uff0c\u90a3\u80fd\u7f16\u8bd1\u51fa\u6765apk\u5417</li> <li>\u6709\u6ca1\u6709\u770b\u8fc7\u4ec0\u4e48\u5f00\u6e90\u5e93\u7684\u6e90\u7801\uff0c\u7b80\u5355\u4ecb\u7ecd\u4e0b</li> <li>git rebase\u547d\u4ee4\u662f\u505a\u4ec0\u4e48\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_28","title":"\u4e09\u9762","text":"<ul> <li>\u804a\u7b80\u5386\uff0c\u75af\u72c2\u804a\u7b80\u5386\uff0c\u4ece\u5934\u5230\u5c3e</li> <li>\u8bf4\u8bf4\u5728\u5b9e\u9a8c\u5ba4\u505a\u7684\u9879\u76ee\uff0c\u9879\u76ee\u4e2d\u6709\u4ec0\u4e48\u96be\u70b9</li> <li>\u5b9e\u4e60\u8fc7\u7a0b\u4e2d\u505a\u4e86\u4ec0\u4e48\u4e1c\u897f\uff0c\u96be\u70b9\u548c\u4eae\u70b9</li> <li>\u6211\u5728github\u4e0a\u6302\u4e86\u4e00\u4e2a\u8bbe\u5907\u4fe1\u606f\u91c7\u96c6\u7684\u4ee3\u7801\uff0c\u9762\u8bd5\u5b98\u770b\u4e86\u4ee3\u7801\u548c\u6211\u8ba8\u8bba\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u5199</li> <li>\u5e73\u65f6\u770b\u8fc7\u6e90\u7801\u5417</li> <li>\u5728\u5b66\u6821\u793e\u56e2\u5de5\u4f5c\u4e2d\u7684\u5de5\u4f5c\u5185\u5bb9</li> <li>\u5c06\u6765\u7684\u804c\u4e1a\u89c4\u5212\uff0c\u5e73\u65f6\u6709\u4ec0\u4e48\u7231\u597d\u554a</li> <li>\u804a\u4e86\u804a\u7ed9\u6211\u5185\u63a8\u7684\u5b66\u957f</li> <li>\u95ee\u6211\u6709\u6ca1\u6709\u4ec0\u4e48\u89c9\u5f97\u81ea\u5df1\u7279\u522b\u7a81\u51fa\u64c5\u957f\u7684\u5730\u65b9</li> <li>\u6709\u6ca1\u6709\u4ec0\u4e48\u60f3\u8981\u95ee\u7684\uff0c\u60f3\u4e86\u89e3\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_29","title":"\u4e1c\u65b9\u8d22\u5bcc","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_30","title":"\u4e00\u9762","text":"<ul> <li>Handler\u673a\u5236</li> <li>\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u4e50\u89c2\u9501\u4e0e\u60b2\u89c2\u9501</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_31","title":"\u4e8c\u9762","text":"<ul> <li>Android 7.0 8.0 p \u517c\u5bb9\u6027\u95ee\u9898</li> <li>\u5d4c\u5957\u6ed1\u52a8</li> <li>\u8425\u9500\u5de5\u5177\u6bd4\u5982\u5217\u8868\u7b2c\u4e09\u4f4d\u5c55\u793a\u5e7f\u544a\uff0c\u5982\u4f55\u8bbe\u8ba1\u63a5\u53e3</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_32","title":"\u8682\u8681\u91d1\u670d","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_33","title":"\u4e00\u9762","text":"<ul> <li>\u5185\u5b58\u6cc4\u6f0f</li> <li>\u5177\u4f53\u573a\u666f</li> <li>\u5927\u56fe\u52a0\u8f7d</li> <li>\u5927\u56fe\u52a0\u8f7d\u7684\u7f13\u5b58</li> <li>Bitmap\u4f18\u5316</li> <li>Handler\u673a\u5236</li> <li>\u5b50\u7ebf\u7a0b\u80fd\u4e0d\u80fd\u521b\u5efaHandler</li> <li>\u7ebf\u7a0b\u95f4\u901a\u4fe1\u5176\u4ed6\u65b9\u5f0f</li> <li>\u7ebf\u7a0b\u7684\u521b\u5efa\u4e0e\u9000\u51fa</li> <li>\u4e50\u89c2\u9501\u4e0e\u60b2\u89c2\u9501</li> <li>volatile\u539f\u7406</li> <li>\u8bfb\u5199\u9501\u7684\u5e94\u7528   PublishSubject</li> <li>RecyclerView\u4e0eListView\u7684\u533a\u522b</li> <li>RecyclerView\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bbe\u8ba1</li> <li>\u5e94\u7528</li> <li>\u81ea\u5b9a\u4e49\u63a7\u4ef6</li> <li>\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u52a8\u753b</li> <li>okhttp\u652f\u4e0d\u652f\u6301\u4f18\u5148\u7ea7</li> <li>ssl\u63e1\u624b\u8c01\u5b9e\u73b0\u7684</li> <li>websocket\u5e94\u7528</li> <li>\u7b80\u8ff0\u65e5\u5fd7\u7cfb\u7edf</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_34","title":"\u4e8c\u9762","text":"<ul> <li>\u4ecb\u7ecd\u9879\u76ee\u67b6\u6784\u7b49\uff0c\u56f4\u7ed5\u9879\u76ee\u8fdb\u884c\u63d0\u95ee</li> <li>\u5e8f\u5217\u5316\u7684\u4f5c\u7528</li> <li>\u5b50\u7ebf\u7a0b\u8f6e\u8be2\u963b\u585e\u961f\u5217\u5982\u4f55\u5b89\u5168\u56de\u6536\u7ebf\u7a0b</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#musically","title":"Musical.ly(\u5934\u6761)","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_35","title":"\u4e00\u9762","text":"<ul> <li>\u7b97\u6cd5\uff1a\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u524d\u534a\u90e8\u5206\u9012\u589e\uff0c\u540e\u534a\u90e8\u5206\u9012\u51cf\uff0c\u6392\u5e8f\u5e76\u53bb\u91cd</li> <li>Java\u865a\u62df\u673a</li> <li>\u865a\u62df\u673a\u5185\u5b58\u7ed3\u6784</li> <li>\u54ea\u4e9b\u662f\u7ebf\u7a0b\u79c1\u6709\uff0c\u54ea\u4e9b\u7ebf\u7a0b\u516c\u6709</li> <li>\u9759\u6001\u5e38\u91cf\u7684\u5b58\u50a8\u4f4d\u7f6e</li> <li>\u65e0\u7a77\u9012\u5f52\u65b9\u6cd5\u5f15\u53d1\u7684\u95ee\u9898</li> <li>GC\u673a\u5236</li> <li> <p>GC roots\u662f\u4ec0\u4e48</p> </li> <li> <p>Handler\u9020\u6210\u5185\u5b58\u6cc4\u6f0f\u7684\u6574\u4e2a\u5f15\u7528\u94fe   Message\u5bf9\u8c61\u6709\u4e2atarget\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u662fHandler\u7c7b\u578b\uff0c\u5f15\u7528\u4e86\u5f53\u524dHandler\u5bf9\u8c61\u3002\u4e00\u53e5\u8bdd\u5c31\u662f\uff1a\u4f60\u901a\u8fc7Handler\u53d1\u5f80\u6d88\u606f\u961f\u5217\u7684Message\u5bf9\u8c61\u6301\u6709\u4e86Handler\u5bf9\u8c61\u7684\u5f15\u7528\u3002\u5047\u5982Message\u5bf9\u8c61\u4e00\u76f4\u5728\u6d88\u606f\u961f\u5217\u4e2d\u672a\u88ab\u5904\u7406\u91ca\u653e\u6389\uff0c\u4f60\u7684Handler\u5bf9\u8c61\u5c31\u4e0d\u4f1a\u88ab\u91ca\u653e\uff0c\u8fdb\u800c\u4f60\u7684Activity\u4e5f\u4e0d\u4f1a\u88ab\u91ca\u653e\u3002   \u8fd9\u79cd\u73b0\u8c61\u5f88\u5e38\u89c1\uff0c\u5f53\u6d88\u606f\u961f\u5217\u4e2d\u542b\u6709\u5927\u91cf\u7684Message\u7b49\u5f85\u5904\u7406\uff0c\u4f60\u53d1\u7684Message\u9700\u8981\u7b49\u51e0\u79d2\u624d\u80fd\u88ab\u5904\u7406\uff0c\u800c\u6b64\u65f6\u4f60\u5173\u95edActivity\uff0c\u5c31\u4f1a\u5f15\u8d77\u5185\u5b58\u6cc4\u9732\u3002\u5982\u679c\u4f60\u7ecf\u5e38send\u4e00\u4e9bdelay\u7684\u6d88\u606f\uff0c\u5373\u4f7f\u6d88\u606f\u961f\u5217\u4e0d\u7e41\u5fd9\uff0c\u5728delay\u5230\u8fbe\u4e4b\u524d\u5173\u95edActivity\u4e5f\u4f1a\u9020\u6210\u5185\u5b58\u6cc4\u9732\u3002</p> </li> <li>\u4ec0\u4e48\u60c5\u51b5\u4f1a\u4ea7\u751fANR</li> <li>\u5e7f\u64ad</li> <li>onReceive\u65b9\u6cd5\u8c03\u7528\u7ebf\u7a0b</li> <li>\u9759\u6001\u5e7f\u64ad\u63a5\u6536\u6d41\u7a0b</li> <li>\u52a8\u6001\u5e7f\u64ad\u63a5\u6536\u6d41\u7a0b</li> <li>\u52a8\u6001\u5e7f\u64ad\u80fd\u4e0d\u80fd\u91cd\u590d\u6ce8\u518c</li> <li>SurfaceView\u539f\u7406\u53ca\u4f7f\u7528\u6ce8\u610f\u4e8b\u9879</li> <li>ButterKnife\u5de5\u4f5c\u539f\u7406</li> <li>\u4eff\u5fae\u4fe1\u670b\u53cb\u5708\u56fe\u7247\u5c55\u793a\u8bbe\u8ba1\u601d\u8def</li> <li>\u70ed\u4fee\u590d</li> <li>\u70ed\u4fee\u590d\u539f\u7406</li> <li>\u5047\u5982\u67d0\u4e2a\u7c7bA\u6709\u4e2abug\uff0c\u70ed\u4fee\u590d\u7684\u6574\u4e2a\u6d41\u7a0b</li> <li>\u8be5\u4fee\u590d\u65b9\u6848\u662f\u5426\u80fd\u907f\u514doat\u5bfc\u81f4\u7684\u4e00\u4e9b\u95ee\u9898</li> <li>LeakCanary\u539f\u7406</li> <li>Groovy\u63d2\u4ef6</li> <li>APK\u7626\u8eab\u5982\u4f55\u5b9e\u73b0\u7684</li> <li>\u81ea\u5b9a\u4e49\u4efb\u52a1\u5728\u67d0\u4e2a\u4efb\u52a1\u4e4b\u524d\u6216\u4e4b\u540e\u6267\u884c\u600e\u4e48\u5199</li> <li>Gradle\u6253\u5305\u7684\u6574\u4e2a\u8fc7\u7a0b</li> <li>\u770b\u8fc7\u54ea\u4e9bAndroid\u6e90\u7801</li> <li>\u62e6\u622aActivity\u8df3\u8f6c\u6709\u54ea\u4e9bHook\u70b9</li> <li>Groovy\u548cJava\u7684\u6bd4\u8f83</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_36","title":"\u4e8c\u9762","text":"<ul> <li>\u7c7b\u52a0\u8f7d\u8fc7\u7a0b</li> <li>\u89e6\u53d1\u7c7b\u521d\u59cb\u5316\u7684\u65f6\u673a</li> <li>\u88ab\u52a8\u5f15\u7528</li> <li>Activity\u542f\u52a8\u6a21\u5f0f\u53ca\u51e0\u4e2a\u6a21\u5f0f\u7684\u5e94\u7528\u573a\u666f</li> <li>onSavedInstanceState\u76f8\u5173</li> <li>\u706d\u5c4f\u4f1a\u4e0d\u4f1a\u89e6\u53d1onSavedInstance</li> <li>onRestoreInstanceState\u548conSavedInstanceState\u662f\u5426\u6210\u5bf9\u51fa\u73b0</li> <li>Service\u751f\u547d\u5468\u671f\u7684\u7406\u89e3</li> <li>bindService\u6574\u4e2a\u4ee3\u7801\u600e\u4e48\u5199</li> <li>\u4e0eservice\u901a\u4fe1\u662f\u5426\u4f1a\u963b\u585e\u5f53\u524d\u7ebf\u7a0b</li> <li>\u5982\u679c\u662f\u8017\u65f6\u65b9\u6cd5\uff0c\u4e3a\u4ec0\u4e48\u4f1a\u963b\u585e</li> <li>\u5982\u679c\u4e0d\u662f\u8017\u65f6\u65b9\u6cd5\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u4f1a\u963b\u585e</li> <li>\u5982\u679c\u8fdc\u7aef\u662f\u8017\u65f6\u64cd\u4f5c\uff0c\u600e\u4e48\u4e0d\u7b49\u5f85\u7ed3\u679c\u8ba9\u4e3b\u7ebf\u7a0b\u5148\u8fd0\u884c</li> <li>startService\u548cbindSerivce\u5bf9service\u751f\u547d\u5468\u671f\u7684\u5f71\u54cd</li> <li>aidl\u4f20\u9012Bitmap\u9700\u8981\u6ce8\u610f\u7684\u4e8b\u9879</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_37","title":"\u643a\u7a0b","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_38","title":"\u4e00\u9762","text":"<ul> <li>EventBus\u539f\u7406</li> <li>Java\u4e2d\u6709\u54ea\u51e0\u79cd\u6ce8\u89e3</li> <li>\u5177\u4f53\u6ce8\u89e3\u540d\u79f0</li> <li>\u5982\u4f55\u81ea\u5b9a\u4e49\u6ce8\u89e3</li> <li>EventBus\u662f\u4ec0\u4e48\u6ce8\u89e3</li> <li>\u80fd\u4e0d\u80fd\u7528\u7f16\u8bd1\u65f6\u6ce8\u89e3\u5b9e\u73b0EventBus</li> <li>\u6ce8\u89e3\u5904\u7406\u5668\u600e\u4e48\u5de5\u4f5c</li> <li>\u6ce8\u89e3\u5904\u7406\u5668\u6709\u54ea\u4e9bAPI</li> <li>Glide\u539f\u7406</li> <li>Lrucache\u539f\u7406</li> <li>LinkedHashpMap\u539f\u7406</li> <li>HashMap\u539f\u7406</li> <li>\u89e3\u51b3Hash\u51b2\u7a81\u7684\u65b9\u6cd5</li> <li>equals\u548chashcode\u4f5c\u7528</li> <li>hashcode\u5982\u4f55\u5b9e\u73b0</li> <li>Object\u7c7b\u4e0b\u6709\u4ec0\u4e48\u65b9\u6cd5</li> <li>\u4f7f\u7528\u8fc7\u54ea\u4e9b\u70ed\u4fee\u590d</li> <li>\u70ed\u542f\u52a8\u70ed\u4fee\u590d\u539f\u7406</li> <li>\u51b7\u542f\u52a8\u70ed\u4fee\u590d\u539f\u7406</li> <li>Android\u4e2d\u7684\u7c7b\u52a0\u8f7d\u5668</li> <li>\u7c7b\u52a0\u8f7d\u5668\u4e4b\u95f4\u7684\u533a\u522b</li> <li>Dex\u878d\u5408\u7528\u7684\u54ea\u79cd\u7c7b\u52a0\u8f7d\u5668</li> <li>\u7236\u7c7b\u662f\u4ec0\u4e48\u53ca\u4e09\u8005\u4e4b\u95f4\u7684\u5173\u7cfb</li> <li>\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b</li> <li>APK\u7626\u8eab</li> <li>Android\u4e2d\u7684\u52a8\u753b\u53ca\u533a\u522b</li> <li>Handler\u539f\u7406</li> <li>Android\u4e2d\u5e8f\u5217\u5316\u65b9\u5f0f</li> <li>\u4e24\u8005\u533a\u522b</li> <li>\u4e3a\u4ec0\u4e48Parcelable\u6027\u80fd\u66f4\u597d</li> <li>\u5e8f\u5217\u5316UID\u4f5c\u7528</li> <li>ThreadLocal\u539f\u7406</li> <li>Java\u4e2d\u6709\u54ea\u4e9b\u9501</li> <li>\u60b2\u89c2\u9501\u4e0e\u4e50\u89c2\u9501\u7684\u533a\u522b</li> <li>\u81ea\u65cb\u9501\u7684\u4f5c\u7528</li> <li>\u9501\u4e00\u822c\u662f\u600e\u4e48\u5b9e\u73b0\u7684</li> <li>\u8ba9\u4f60\u81ea\u5df1\u5b9e\u73b0\uff0c\u600e\u4e48\u5b9e\u73b0\u4e00\u4e2a\u9501</li> <li>\u5185\u5b58\u4f18\u5316\u6709\u54ea\u51e0\u79cd\u65b9\u5f0f</li> <li>\u5e03\u5c40\u4f18\u5316\u6709\u54ea\u51e0\u79cd\u65b9\u5f0f</li> <li>\u7ebf\u6027\u5e03\u5c40\u5728onLayout\u91cc\u9762\u505a\u4e86\u54ea\u4e9b\u5de5\u4f5c</li> <li>\u8c37\u6b4c\u4e3a\u4ec0\u4e48\u7ed9Activity\u8bbe\u8ba1\u8fd9\u4e48\u591a\u751f\u547d\u5468\u671f</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_39","title":"\u62db\u884c\u4fe1\u7528\u5361\u4e2d\u5fc3","text":"<ul> <li>\u5de5\u7a0b\u7ed3\u6784\u7eb5\u5411\u6a2a\u5411\u5982\u4f55\u62c6\u5206\uff08\u9879\u76ee\u67b6\u6784\uff09</li> <li>\u5982\u679c\u89e3\u51b3\u4ee3\u7801\u4f9d\u8d56</li> <li>\u4e24\u4e2a\u9694\u79bb\u6a21\u5757\u7684\u6570\u636e\u4ea4\u4e92</li> <li>\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898</li> <li>\u5185\u5b58\u6cc4\u6f0f</li> <li>\u9879\u76ee\u4e2d\u9996\u9875\u7684\u5b9e\u73b0</li> <li>VLayout\u5b9e\u73b0\u539f\u7406</li> <li>\u4e3a\u4ec0\u4e48\u4e0d\u7528RecyclerView\u5b9e\u73b0\u591aItem</li> <li>\u70ed\u4fee\u590d\u5dee\u5206\u6587\u4ef6\u7684\u9a8c\u8bc1(\u5b89\u5168\u6027)</li> <li>\u516c\u94a5\u79c1\u94a5\u4f53\u7cfb</li> <li>\u5e94\u7528\u573a\u666f</li> <li>HTTPS\u8fde\u63a5\u8fc7\u7a0b</li> <li>\u5e94\u7528\u6784\u5efa\u8fc7\u7a0b</li> <li>\u5e94\u7528\u7b7e\u540d\u6821\u9a8c\u8fc7\u7a0b</li> <li>V1\u7b7e\u540d\u548cV2\u7b7e\u540d\u533a\u522b</li> <li>Dex\u52a0\u56fa\u539f\u7406</li> <li> <p>APK\u7626\u8eab</p> </li> <li> <p>Android</p> </li> <li>\u56db\u5927\u7ec4\u4ef6\u3001Fragment\u3001Context<ul> <li>\u6982\u8ff0\u3001\u751f\u547d\u5468\u671f\u3001\u542f\u52a8</li> <li>\u901a\u4fe1\u65b9\u5f0f\u4ee5\u53ca\u4e00\u4e9b\u7ec6\u8282\uff0c\u6bd4\u5982 Fragment \u7684 commitAllowingStateLoss\u7b49</li> </ul> </li> <li>\u8fdb\u7a0b\u95f4\u901a\u4fe1<ul> <li>Binder</li> <li>Binder \u7ed3\u5408 AMS\u3001WMS \u7b49\u7cfb\u7edf\u670d\u52a1</li> <li>\u56db\u5927\u7ec4\u4ef6\u7684\u542f\u52a8\u8fc7\u7a0b</li> <li>Window \u7684\u7406\u89e3</li> </ul> </li> <li>View<ul> <li>\u4e8b\u4ef6\u4f53\u7cfb\u3001\u6ed1\u52a8\u51b2\u7a81</li> <li>\u6d4b\u91cf\u5e03\u5c40\u7ed8\u5236\u6d41\u7a0b</li> <li>ListView\u3001RecyclerView \u5bf9\u6bd4\u548c\u7f13\u5b58\u673a\u5236</li> <li>invalidate\u3001requestLayout \u7b49\u5237\u65b0\u65b9\u5f0f</li> <li>SurfaceView \u7684\u539f\u7406</li> </ul> </li> <li>\u56fe\u5f62\u663e\u793a\u539f\u7406</li> <li>Choreographer \u7ed3\u5408 View \u5237\u65b0</li> <li>VSYNC\u3001\u53cc\u7f13\u51b2\u3001\u4e09\u7f13\u51b2</li> <li>SurfaceFlinger</li> <li>\u6d88\u606f\u673a\u5236</li> <li>Handler\u3001Looper\u3001MessageQueue</li> <li>ThreadLocal</li> <li>\u7ebf\u7a0b\u5f62\u6001</li> <li>AsyncTask</li> <li>HandlerThread</li> <li>IntentService</li> <li>\u5185\u5b58\u6cc4\u6f0f</li> <li>\u60c5\u51b5</li> <li>\u5206\u6790</li> <li>\u6027\u80fd\u4f18\u5316</li> <li>\u5e38\u89c1\u7684\u4e00\u4e9b\u5957\u8def\uff0c\u6bd4\u5982\u5e03\u5c40\u4f18\u5316\u3001\u5185\u5b58\u6cc4\u6f0f\u4f18\u5316\u3001ListView/RecyclerView \u4f18\u5316\u3001LruCache \u7b49</li> <li>\u53ef\u4ee5\u7ed3\u5408\u56fe\u5f62\u663e\u793a\u539f\u7406\u548cHandler\u673a\u5236\u6269\u5c55</li> <li>\u5927\u56fe\u663e\u793a</li> <li>\u5f00\u6e90\u5e93\uff0c\u8fd9\u90e8\u5206\u901a\u5e38\u4f1a\u8003\u5bdf\u6e90\u7801\u7684\u8bbe\u8ba1\u548c\u5b9e\u73b0</li> <li>EventBus</li> <li>Retrofit</li> <li>OkHttp</li> <li>\u5176\u4ed6\u9879\u76ee\u4e2d\u7528\u5230\u7684\u6d41\u884c\u5f00\u6e90\u5e93</li> <li>\u5176\u4ed6</li> <li>Android \u7248\u672c\u53d8\u66f4</li> <li>APK \u6253\u5305\u3001\u5b89\u88c5\u8fc7\u7a0b</li> <li>Android \u7c7b\u52a0\u8f7d\uff0c\u7ed3\u5408 Java \u7c7b\u52a0\u8f7d</li> <li>Dalvik/ART\uff0c\u7ed3\u5408 Java \u865a\u62df\u673a</li> <li>\u8fdb\u7a0b\u4fdd\u6d3b\u3001\u8fdb\u7a0b\u4f18\u5148\u7ea7</li> <li>JNI\uff0c\u8fd9\u5757\u4e0d\u7528\u638c\u63e1\u5f88\u6df1\uff0c\u5927\u81f4\u539f\u7406\u77e5\u9053\u5c31\u884c</li> <li>SharePreferences \u7684\u539f\u7406\u548c\u6ce8\u610f\u70b9</li> <li>Parcelable \u4e0e Serializable</li> <li>WebView</li> <li>MultiDex</li> <li>Java</li> <li>\u8bed\u8a00<ul> <li>\u52a8\u6001\u4ee3\u7406</li> <li>\u7c7b\u578b\u4fe1\u606f\u3001\u53cd\u5c04</li> <li>\u6cdb\u578b</li> <li>\u5f02\u5e38</li> </ul> </li> <li>\u5bb9\u5668\uff0cHashMap\u4e00\u5b9a\u8981\u770b\uff0c\u5176\u4ed6\u7684\u5404\u79cd\u5e38\u89c1\u5bb9\u5668\u4e5f\u90fd\u5efa\u8bae\u4e86\u89e3\u4e00\u4e0b\u5b9e\u73b0</li> <li>\u5e38\u7528\u5bb9\u5668\uff1aHashMap\u3001LinkedHashMap\u3001ArrayList\u3001LinkedList\u7b49</li> <li>Android \u5bb9\u5668\uff1aSparseArray \u7b49</li> <li>\u5e76\u53d1\u5bb9\u5668\uff1aConcurrentHashMap\u3001CopyOnWriteArrayList\u3001\u963b\u585e\u961f\u5217</li> <li>\u5e76\u53d1</li> <li>\u7ebf\u7a0b\u72b6\u6001</li> <li>\u5185\u7f6e/\u663e\u5f0f\u7684\u9501\u3001\u6761\u4ef6\u961f\u5217</li> <li>\u6b7b\u9501</li> <li>\u7ebf\u7a0b\u6c60</li> <li>volatile\u3001\u539f\u5b50\u53d8\u91cf\u3001CAS\u3001ABA</li> <li>\u5185\u5b58\u6a21\u578b\u548c happens-before</li> <li>\u865a\u62df\u673a</li> <li>\u5185\u5b58\u533a\u57df</li> <li>\u5bf9\u8c61\u5185\u5b58\u5206\u914d</li> <li>\u5f15\u7528\u8ba1\u6570\u548c\u53ef\u8fbe\u6027\u5206\u6790</li> <li>\u5783\u573e\u6536\u96c6\u7b97\u6cd5\u548c\u5783\u573e\u6536\u96c6\u5668</li> <li>\u8bbe\u8ba1\u6a21\u5f0f</li> <li>\u5e38\u7528\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5e38\u8003\u5355\u4f8b\u3001\u6a21\u677f\u3001\u89c2\u5bdf\u8005</li> <li>\u6e90\u7801\u4e2d\u7684\u8bbe\u8ba1\u6a21\u5f0f</li> <li>MVC/MVP/MVVM</li> <li>\u8ba1\u7b97\u673a\u57fa\u7840</li> <li>\u8ba1\u7b97\u673a\u7f51\u7edc<ul> <li>HTTP\uff1a\u8bf7\u6c42\u3001\u54cd\u5e94\u3001\u7f13\u5b58\u3001\u7248\u672c\u53d8\u5316</li> <li>TCP/IP\uff1a\u63e1\u624b\u6325\u624b\u3001\u6d41\u91cf\u63a7\u5236\u3001\u62e5\u585e\u63a7\u5236\u3001\u5e7f\u64ad/\u7ec4\u64ad\u7b49\u3002</li> </ul> </li> <li>\u64cd\u4f5c\u7cfb\u7edf<ul> <li>\u8fdb\u7a0b\u548c\u7ebf\u7a0b</li> <li>\u865a\u62df\u5185\u5b58\u3001\u5206\u9875\u548c\u5206\u6bb5</li> </ul> </li> <li>\u6570\u636e\u5e93<ul> <li>\u7d22\u5f15</li> <li>\u4e8b\u52a1\u548cACID</li> <li>\u5173\u7cfb\u578b\u548c\u975e\u5173\u7cfb\u578b</li> <li>ORM\u548cSQL</li> </ul> </li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_40","title":"\u963f\u91cc","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_41","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd</li> <li>\u9879\u76ee\u6765\u5386</li> <li>MySQL \u548c MongoDB \u7684\u533a\u522b</li> <li>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u548c\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u533a\u522b\uff0c\u5404\u81ea\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4f7f\u7528</li> <li>\u4e3a\u4ec0\u4e48\u6d77\u91cf\u6570\u636e\u65f6\u9002\u5408\u7528\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93</li> <li>\u4e3a\u4ec0\u4e48\u7814\u7a76\u751f\u8bfb\u7684\u901a\u4fe1\uff0c\u800c\u4e0d\u662f\u8ba1\u7b97\u673a</li> <li>\u4e0a\u8fc7\u6216\u81ea\u5b66\u8fc7\u54ea\u4e9b\u8ba1\u7b97\u673a\u8bfe\u7a0b\uff0c\u5bf9\u8ba1\u7b97\u673a\u7f51\u7edc\u633a\u719f\u6089\u7684\u5427</li> <li>\u5bf9 HTTPS \u6709\u6ca1\u6709\u4e86\u89e3\uff0c\u6709\u6ca1\u6709\u5199\u8fc7\u76f8\u5173\u4ee3\u7801</li> <li>\u8001\u677f\u6709 2000 \u5143\u7ed9\u6211\u548c\u540c\u5b66\u5206\u94b1\uff0c\u9996\u5148\u7531\u6211\u63d0\u51fa\u5206\u94b1\u65b9\u6848\u3002\u5982\u679c\u540c\u5b66\u4e0d\u540c\u610f\uff0c\u5219\u603b\u989d\u53d8\u4e3a 1000 \u5143\uff0c\u5e76\u7531\u540c\u5b66\u63d0\u51fa\u5206\u94b1\u65b9\u6848\u3002\u5982\u679c\u8fd9\u65f6\u6211\u4e0d\u540c\u610f\uff0c\u5219\u4fe9\u4eba\u5404\u62ff 100 \u5143\u3002\u8bf7\u95ee\u4e00\u5f00\u59cb\u6211\u5e94\u8be5\u600e\u4e48\u7ed9\u51fa\u5206\u94b1\u65b9\u6848\uff1f</li> <li>\u5047\u8bbe\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u53d6\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u600e\u4e48\u505c\u6b62\u8fd9\u4e2a\u7ebf\u7a0b</li> <li>\u8bfb\u8fc7\u54ea\u4e9b\u6e90\u7801\uff0c\u5206\u522b\u8bf4\u4e00\u4e0b Android \u548c Java \u7684</li> <li>\u8bfb\u8fc7\u54ea\u4e9b Android \u5f00\u6e90\u5e93\u6e90\u7801</li> <li>\u9879\u76ee\u4e2d\u9047\u5230\u8fc7\u4ec0\u4e48\u96be\u9898</li> <li>\u5370\u8c61\u6df1\u523b\u7684\u51e0\u6b21\u5b66\u4e60\u7ecf\u5386</li> <li>\u770b\u4f60\u7528\u8fc7 Ubuntu\uff0c\u5e73\u65f6\u662f\u4e0d\u662f\u7528 Linux\uff0c\u719f\u6089Linux\u5417\uff0c\u90fd\u7528\u5b83\u5e72\u4ec0\u4e48</li> <li>\u6709\u4ec0\u4e48\u95ee\u9898\u60f3\u95ee\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_42","title":"\u4e8c\u9762","text":"<ul> <li>\u4ecb\u7ecd\u4e00\u4e0b\u9879\u76ee</li> <li>\u4e00\u8fde\u4e32\u95ee\u4e86\u591a\u4e2a\u95ee\u9898\u5173\u4e8e\u9879\u76ee\u4e2d\u7ed9\u8bbe\u5907\u914d\u7f6e\u5165\u7f51\u8fc7\u7a0b\u7684\u7ec6\u8282</li> <li>\u9879\u76ee\u4e2d\u4e0e\u8bbe\u5907\u901a\u4fe1\u7684\u6570\u636e\u683c\u5f0f\uff0c\u8fd8\u53ef\u4ee5\u7528\u54ea\u4e9b\u6570\u636e\u683c\u5f0f\uff0c\u505a\u8fc7\u4ec0\u4e48\u4f18\u5316</li> <li>\u8bbe\u8ba1\u4e00\u79cd\u53d8\u957f\u7684\u4f20\u8f93\u6570\u636e\u683c\u5f0f</li> <li>UDP \u548c TCP</li> <li>\u4ecb\u7ecd\u4e00\u4e0b MQTT \u534f\u8bae\uff08\u9879\u76ee\u4e2d\u7528\u5230\u7684\u4e00\u4e2a\u534f\u8bae\uff09</li> <li>\u9879\u76ee\u4e2d\u6709\u6ca1\u6709\u505a\u8fc7\u4e00\u4e9b\u76d1\u63a7\u65e5\u5fd7</li> <li>Elasticsearch\u662f\u4ec0\u4e48\uff08\u56e0\u4e3a\u6211\u8bf4\u5230\u624d\u95ee\u7684\uff09</li> <li>CrashHandler \u7684\u5b9e\u73b0</li> <li>\u8bbe\u8ba1\u4e00\u4e2a\u65e5\u5fd7\u76d1\u63a7\u548c\u4e0a\u4f20\u6a21\u5757\uff0c\u6df1\u5165\u95ee\u4e86\u5f88\u591a\u7ec6\u8282\u548c\u8003\u8651\u7684\u65b9\u9762</li> <li>Android \u5404\u4e2a\u7248\u672c\u7684\u53d8\u5316</li> <li>\u4ecb\u7ecd\u4e00\u4e0b Flutter \u6846\u67b6</li> <li>\u5e73\u65f6\u600e\u4e48\u4e86\u89e3\u548c\u5b66\u4e60\u65b0\u77e5\u8bc6\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_43","title":"\u4e09\u9762","text":"<ul> <li>\u95ee\u4e86\u5f88\u591a\u9879\u76ee\u7ec6\u8282\uff0c\u5173\u4e8e\u672c\u5730\u5b58\u50a8\u3001\u97f3\u4e50\u64ad\u653e\u7b49\u57fa\u7840\u6a21\u5757\u7684\u5c01\u88c5</li> <li>\u6709\u6ca1\u6709\u628a\u97f3\u4e50\u64ad\u653e\u6a21\u5757\u5f00\u6e90\u51fa\u53bb</li> <li>\u9879\u76ee\u4e2d\u89e3\u51b3\u8fc7\u4ec0\u4e48\u96be\u9898</li> <li>HTTP/2.0 \u6709\u4ec0\u4e48\u53d8\u5316</li> <li>\u5728\u4e00\u4e2a\u624b\u673a\u5c4f\u5e55\u4e0a\u6709\u4e24\u5217\uff08\u7c7b\u4f3c\u4e8e\u7011\u5e03\u6d41\uff09\uff0c\u7ed9\u4f60\u4e00\u4e9b\u9ad8\u5ea6\u4e0d\u540c\u7684 item\uff0c\u600e\u4e48\u6446\u653e\u624d\u80fd\u8ba9\u8fd9\u4e24\u5217\u7684\u6574\u4f53\u9ad8\u5ea6\u6700\u5c0f\uff1f</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_44","title":"\u5934\u6761","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_45","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd</li> <li>\u9879\u76ee\u6765\u5386</li> <li>\u9879\u76ee\u4e2d\u672c\u5730\u5b58\u50a8\u600e\u4e48\u505a\u7684</li> <li>\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7684\u7c7b\u5e94\u8be5\u600e\u4e48\u8bbe\u8ba1</li> <li>\u8bf4\u4e00\u4e0b\u5bf9 BInder \u7684\u7406\u89e3</li> <li>Binder \u7ea2\u9ed1\u6811\u7684\u8282\u70b9\u662f\u4ee5\u4ec0\u4e48\u533a\u5206\u7684</li> <li>SurfaceFlinger\u3001VSYNC</li> <li>SurfaceView \u539f\u7406</li> <li>HTTP \u54cd\u5e94\u5185\u5bb9</li> <li>Retrofit \u5185\u90e8\u5b9e\u73b0</li> <li>\u52a8\u6001\u4ee3\u7406\u7684\u539f\u7406</li> <li>EventBus \u5185\u90e8\u5b9e\u73b0</li> <li>\u624b\u5199\u4e8c\u5206\u67e5\u627e</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_46","title":"\u4e8c\u9762","text":"<ul> <li>\u770b\u8fc7\u54ea\u4e9b\u4e66</li> <li>\u8bf4\u4e00\u4e0b\u300aJava \u5e76\u53d1\u7f16\u7a0b\u5b9e\u6218\u300b\u7684\u4f5c\u8005\u6709\u54ea\u4e9b\u4eba\uff0c\u8fd8\u8ba4\u8bc6\u54ea\u4e9b\u5927\u725b\uff0c\u6bd4\u8f83\u559c\u6b22\u8c01\uff0c\u4f1a\u53bb\u5173\u6ce8\u5417</li> <li>HashMap \u7248\u672c\u53d8\u5316\u548c\u539f\u7406</li> <li>\u624b\u5199\u5feb\u901f\u6392\u5e8f\u5e76\u89e3\u91ca</li> <li>\u5404\u79cd\u6392\u5e8f\u7684\u590d\u6742\u5ea6\u548c\u7a33\u5b9a\u6027</li> <li>\u7c7b\u6210\u5458\u7684\u6743\u9650\u600e\u4e48\u5b9a</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_47","title":"\u4e09\u9762","text":"<ul> <li>JVM \u5185\u5b58\u533a\u57df</li> <li>volatile \u548c\u91cd\u6392\u5e8f</li> <li>Java \u5185\u5b58\u6a21\u578b</li> <li>\u5f15\u7528\u8ba1\u6570\u548c\u53ef\u8fbe\u6027\u5206\u6790</li> <li>finalize \u539f\u7406</li> <li>Android \u754c\u9762\u5237\u65b0\u539f\u7406</li> <li>Android \u6027\u80fd\u4f18\u5316\u6709\u54ea\u4e9b\u65b9\u6cd5</li> <li>\u89c2\u5bdf\u8005\u6a21\u5f0f\u3001\u8d23\u4efb\u94fe\u6a21\u5f0f</li> <li>OkHttp \u5185\u90e8\u5b9e\u73b0\u3001\u6709\u6ca1\u6709\u7f13\u5b58</li> <li>\u4ece\u8f93\u5165\u4e00\u4e2a URL \u5230\u770b\u5230\u4e00\u4e2a\u9875\u9762\u7684\u8fc7\u7a0b</li> <li>\u770b\u8fc7\u54ea\u4e9b\u4e66</li> <li>\u662f\u4e0d\u662f\u5b9e\u9a8c\u5ba4\u505a\u5f00\u53d1\u7684\u540c\u5b66\u4e2d\u6700\u5f3a\u7684</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_48","title":"\u817e\u8baf","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_49","title":"\u4e00\u9762","text":"<ul> <li>\u80fd\u4e0d\u80fd\u6765\u6df1\u5733</li> <li>\u4ecb\u7ecd\u9879\u76ee</li> <li>\u4e3a\u4ec0\u4e48\u7528 SharedPreferences\uff0c\u600e\u4e48\u5b58 JSON</li> <li>\u9879\u76ee\u4e2d\u9047\u5230\u4ec0\u4e48\u96be\u9898</li> <li>\u5e7f\u64ad\u548c\u7ec4\u64ad</li> <li>\u91cd\u7537\u8f7b\u5973\uff0c\u751f\u5973\u5b69\u4f1a\u751f\u5230\u7537\u5b69\u4e3a\u6b62\uff0c\u95ee\u7537\u5973\u6bd4\u4f8b</li> <li>Gson\u539f\u7406</li> <li>SQL\u8bed\u53e5\u3001\u6570\u636e\u5e93\u4f18\u5316</li> <li>ORM\u3001DAO\u3001DSL</li> <li>\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_50","title":"\u4e8c\u9762","text":"<ul> <li>\u4e0a\u8fc7\u54ea\u4e9b\u8ba1\u7b97\u673a\u8bfe\u7a0b</li> <li>Java \u7c7b\u52a0\u8f7d</li> <li>Android \u7c7b\u52a0\u8f7d\uff0cDexClassLoader\u6709\u4ec0\u4e48\u7528</li> <li>\u6563\u5217\u8868\u6709\u54ea\u4e9b\u89e3\u51b3\u51b2\u7a81\u7684\u65b9\u5f0f</li> <li>LinkedList \u548c ArrayList \u6bd4\u8f83</li> <li>TCP \u7684\u62e5\u585e\u63a7\u5236</li> <li>\u80fd\u4e0d\u80fd\u6765\u6df1\u5733</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_51","title":"\u7f8e\u56e2","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_52","title":"\u4e00\u9762","text":"<ul> <li>\u81ea\u6211\u4ecb\u7ecd</li> <li>\u9879\u76ee\u6765\u5386</li> <li>\u4e3a\u4ec0\u4e48\u559c\u6b22 Java\uff0c\u7136\u540e\u95ee\u4e86\u4e00\u4e9b Java \u7684\u7279\u6027</li> <li>\u7ebf\u7a0b\u548c\u534f\u7a0b\uff0c\u4e3a\u4ec0\u4e48\u534f\u7a0b\u6bd4\u7ebf\u7a0b\u6548\u7387\u9ad8</li> <li>RecyclerView \u56fe\u7247\u9519\u4f4d\u95ee\u9898</li> <li>Fragment \u7684 commitAllowStateLoss \u65b9\u6cd5</li> <li>Activity \u4e0e Fragment \u600e\u4e48\u901a\u4fe1</li> <li>Handler \u600e\u4e48\u89e3\u51b3\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898</li> <li>\u5176\u4ed6\u5185\u5b58\u6cc4\u6f0f\u60c5\u51b5</li> <li>\u5355\u51fb\u4e8b\u4ef6\u548c\u53cc\u51fb\u4e8b\u4ef6\u54ea\u4e2a\u5148\u89e6\u53d1</li> <li>selector \u4e3a\u4ec0\u4e48\u80fd\u591f\u5207\u6362\u80cc\u666f\uff0c\u539f\u7406\u662f\u4ec0\u4e48</li> <li>\u4e0d\u8003\u8651\u5177\u4f53\u9875\u9762\uff0c\u600e\u4e48\u4ece\u6839\u672c\u4e0a\u4f18\u5316\u754c\u9762\u5361\u987f</li> <li>SurfaceFlinger\u3001VSYNC</li> <li>\u63cf\u8ff0\u4e00\u4e0b Handler \u7684\u539f\u7406</li> <li>\u4f9d\u6b21\u6253\u5370\u4e8c\u53c9\u6811\u6bcf\u5c42\u6700\u5de6\u8fb9\u7684\u7ed3\u70b9</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_53","title":"\u4e8c\u9762","text":"<ul> <li>\u600e\u4e48\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u8981\u8fdb\u5165\u8001\u5e74\u4ee3</li> <li>Eden \u548c Survivor \u7684\u6bd4\u4f8b\u548c\u56de\u6536\u89c4\u5219</li> <li>\u65b0\u751f\u4ee3\u4e3a\u4ec0\u4e48\u7528\u590d\u5236\u7b97\u6cd5</li> <li>\u8bf4\u4e00\u4e0b\u5bf9 Binder \u7684\u7406\u89e3</li> <li>\u8bf4\u4e00\u4e0b ActivityManagerService\u3001ActivityManagerNative \u7b49\u51e0\u4e2a\u7c7b\u7684\u533a\u522b</li> <li>\u624b\u5199\u5404\u79cd\u5355\u4f8b\u6a21\u5f0f</li> <li>\u8df3\u53f0\u9636\u95ee\u9898</li> <li>\u6c42\u4e24\u4e2a\u94fe\u8868\u7684\u4ea4\u70b9</li> <li>\u5224\u65ad\u4e8c\u53c9\u6811\u662f\u5426\u5de6\u53f3\u5bf9\u79f0\uff08\u53ea\u8003\u8651\u7ed3\u6784\u5bf9\u79f0\uff0c\u4e0d\u8003\u8651\u503c\uff09</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/InterView_Enhance/#_54","title":"\u4e09\u9762","text":"<ul> <li>MVP \u53ca MVP \u600e\u4e48\u89e3\u51b3\u5185\u5b58\u6cc4\u6f0f</li> <li>\u9879\u76ee\u67b6\u6784</li> <li>\u8bf4\u4e00\u4e0b SharedPreferences</li> <li>\u7ed9\u4e00\u4e2a\u6570\u7ec4\uff0c\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e00\u5bf9\u76f8\u7b49\u7684\u524d\u7f00\u548c\u4e0e\u540e\u7f00\u548c</li> <li>\u5e73\u65f6\u600e\u4e48\u5b66\u4e60\u7684</li> <li>\u6709\u4ec0\u4e48\u60f3\u5b66\u7684\u65b0\u6280\u672f\u3001\u5b66\u4e60\u8ba1\u5212</li> </ul>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_1/","title":"Interview 1","text":"<p>\u57fa\u7840</p> <ol> <li>\u8bb2\u4e00\u4e0bAndroid\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u8fc7\u7a0b</li> <li>Android\u4e2d\u8fdb\u7a0b\u95f4\u7684\u901a\u4fe1\u6709\u54ea\u4e9b\u65b9\u6cd5</li> <li>view\u7684\u5de5\u4f5c\u539f\u7406\u53cameasure\u3001layout\u3001draw\u6d41\u7a0b\uff0c\u54ea\u4e00\u4e2a\u53ef\u4ee5\u653e\u5728\u5b50\u7ebf\u7a0b\u4e2d\u6267\u884c</li> <li>\u8bb2\u4e00\u4e0bAndroid View\u7684\u4e8b\u4ef6\u5206\u53d1\u673a\u5236</li> <li>\u5982\u679c\u63a7\u4ef6\u5185\u90e8\u5361\u987f\u4f60\u5982\u4f55\u53bb\u89e3\u51b3\u5e76\u4f18\u5316</li> <li>listview\u548crecycleview\u7f13\u5b58\u673a\u5236</li> <li>handler\u673a\u5236\u662f\u4ec0\u4e48</li> <li>\u8bb2\u4e00\u4e0bIntentService</li> <li>\u8bb2\u4e00\u4e0bBitmap\u52a0\u8f7d\uff0c\u4e09\u7ea7\u7f13\u5b58\u673a\u5236\uff0c\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2aLRUCache</li> <li>\u9879\u76ee\u4e2d\u505a\u8fc7\u54ea\u4e9bandroid\u6027\u80fd\u4f18\u5316\uff0c\u600e\u4e48\u505a\u7684\uff1f</li> <li>Java\u7684\u5185\u5b58\u6a21\u578b\uff0c\u6bcf\u4e2a\u90e8\u5206\u7684\u7279\u70b9\u548c\u4f5c\u7528</li> <li>\u8bb2\u4e00\u4e0b\u4f60\u7406\u89e3\u7684GC</li> <li>\u8bb2\u4e00\u4e0b\u5bf9\u5185\u5b58\u6cc4\u9732\u7684\u7406\u89e3\uff0c\u5e38\u89c1\u7684\u5185\u5b58\u6cc4\u6f0f\u6709\u54ea\u4e9b\uff0c\u600e\u4e48\u89e3\u51b3\u7684</li> <li>\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u591a\u7ebf\u7a0b\uff1f\u591a\u7ebf\u7a0b\u9700\u8981\u6ce8\u610f\u90a3\u4e9b\u95ee\u9898</li> <li>\u5bfc\u81f4\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u539f\u56e0\u6709\u54ea\u4e9b\uff0c\u600e\u4e48\u89e3\u51b3</li> <li>lock\u548csynchronize\u6709\u4ec0\u4e48\u533a\u522b</li> <li>\u8bb2\u4e00\u4e0b\u4e50\u89c2\u9501\u3001\u60b2\u89c2\u9501\u53ca\u4f7f\u7528\u573a\u666f</li> <li>\u8bb2\u4e00\u4e0bhashmap\u7684\u5b9e\u73b0\uff0chashtable\u548chashmap\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff0chashtable\u4e3a\u4ec0\u4e48\u4f1a\u88ab\u5f03\u7528\uff0cConcurrentHashmap\u7684\u5b9e\u73b0\uff0csegment\u7684\u6982\u5ff5\u3001concurrenthashmap\u9ad8\u6548\u7684\u539f\u56e0\u662f\u4ec0\u4e48</li> <li>\u4f7f\u7528\u8fc7\u90a3\u4e9b\u4e09\u65b9\u5e93\uff0c\u6709\u6ca1\u6709\u9605\u8bfb\u8fc7\u4e00\u4e9b\u6e90\u7801\uff0c\u627e\u4e00\u4e2a\u4f60\u8ba4\u4e3a\u7684\u6280\u672f\u4eae\u70b9\u4ecb\u7ecd\u4e00\u4e0b</li> <li>Broadcast\u7684\u5206\u7c7b\uff1f\u6709\u5e8f\uff0c\u65e0\u5e8f\uff1f\u7c98\u6027\uff0c\u975e\u7c98\u6027\uff1f\u672c\u5730\u5e7f\u64ad\uff1f <p>\u5e7f\u64ad\u53ef\u4ee5\u5206\u4e3a\u6709\u5e8f\u5e7f\u64ad\u3001\u65e0\u5e8f\u5e7f\u64ad\u3001\u672c\u5730\u5e7f\u64ad\u3001\u7c98\u6027\u5e7f\u64ad\u3002\u5176\u4e2d\u65e0\u5e8f\u5e7f\u64ad\u901a\u8fc7sendBroadcast(intent)\u53d1\u9001\uff0c\u6709\u5e8f\u5e7f\u64ad\u901a\u8fc7sendOrderedBroadcast(intent)\u53d1\u9001\u3002</p> </li> </ol> <p>\u6709\u5e8f\u5e7f\u64ad (1) \u6709\u5e8f\u5e7f\u64ad\u53ef\u4ee5\u7528priority\u6765\u8c03\u6574\u4f18\u5148\u7ea7   \u53d6\u503c\u8303\u56f4-1000~+1000\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u6570\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\u8d8a\u4f18\u5148\u83b7\u5f97\u5e7f\u64ad\u54cd\u5e94\u3002 (2) abortBroadcast()\u53ef\u6765\u7ec8\u6b62\u8be5\u5e7f\u64ad\u7684\u4f20\u64ad\uff0c\u5bf9\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u5c4f\u853d\uff0c\u6ce8\u610f\u53ea\u5bf9\u6709\u5e8f\u5e7f\u64ad\u751f\u6548\u3002 (3) \u6709\u5e8f\u5e7f\u64ad\u5728\u4f20\u64ad\u6570\u636e\u4e2d\u4f1a\u53d1\u751f\u6bd4\u5982setResultData()\uff0cgetResultData()\uff0c\u5728\u4f20\u64ad\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u4ece\u65b0\u8bbe\u7f6e\u6570\u636e</p> <p>\u5173\u4e8e\u672c\u5730\u5e7f\u64ad\uff0c\u53ef\u4ee5\u67e5\u770b\u8fd9\u7bc7\u6587\u7ae0\u3002\u603b\u7684\u6765\u8bf4\uff0c\u672c\u5730\u5e7f\u64ad\u662f\u901a\u8fc7LocalBroadcastManager\u5185\u7f6e\u7684Handler\u6765\u5b9e\u73b0\u7684\uff0c\u53ea\u662f\u5229\u7528\u4e86IntentFilter\u7684match\u529f\u80fd\uff0c\u81f3\u4e8eBroadcastReceiver \u6362\u6210\u5176\u4ed6\u63a5\u53e3\u4e5f\u65e0\u6240\u8c13\uff0c\u987a\u4fbf\u5229\u7528\u4e86\u73b0\u6210\u7684\u7c7b\u548c\u6982\u5ff5\u800c\u5df2\u3002\u5728register()\u7684\u65f6\u5019\u4fdd\u5b58BroadcastReceiver\u4ee5\u53ca\u5bf9\u5e94\u7684IntentFilter\uff0c\u5728sendBroadcast()\u7684\u65f6\u5019\u627e\u5230\u548cIntent\u5bf9\u5e94\u7684BroadcastReceiver\uff0c\u7136\u540e\u901a\u8fc7Handler\u53d1\u9001\u6d88\u606f\uff0c\u89e6\u53d1executePendingBroadcasts()\u51fd\u6570\uff0c\u518d\u5728\u540e\u8005\u4e2d\u8c03\u7528\u5bf9\u5e94BroadcastReceiver\u7684onReceive()\u65b9\u6cd5\u3002</p> <p>\u7c98\u6027\u6d88\u606f\uff1a\u7c98\u6027\u6d88\u606f\u5728\u53d1\u9001\u540e\u5c31\u4e00\u76f4\u5b58\u5728\u4e8e\u7cfb\u7edf\u7684\u6d88\u606f\u5bb9\u5668\u91cc\u9762\uff0c\u7b49\u5f85\u5bf9\u5e94\u7684\u5904\u7406\u5668\u53bb\u5904\u7406\uff0c\u5982\u679c\u6682\u65f6\u6ca1\u6709\u5904\u7406\u5668\u5904\u7406\u8fd9\u4e2a\u6d88\u606f\u5219\u4e00\u76f4\u5728\u6d88\u606f\u5bb9\u5668\u91cc\u9762\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff0c\u7c98\u6027\u5e7f\u64ad\u7684Receiver\u5982\u679c\u88ab\u9500\u6bc1\uff0c\u90a3\u4e48\u4e0b\u6b21\u91cd\u5efa\u65f6\u4f1a\u81ea\u52a8\u63a5\u6536\u5230\u6d88\u606f\u6570\u636e\u3002(\u5728 android 5.0/api 21\u4e2ddeprecated,\u4e0d\u518d\u63a8\u8350\u4f7f\u7528\uff0c\u76f8\u5e94\u7684\u8fd8\u6709\u7c98\u6027\u6709\u5e8f\u5e7f\u64ad\uff0c\u540c\u6837\u5df2\u7ecfdeprecated)</p> <p>\u8fdb\u9636</p> <ol> <li>\u8bb2\u4e00\u4e0bclassloader\u6709\u54ea\u4e9b\uff0c\u5982\u4f55\u81ea\u5b9a\u4e49\u4e00\u4e2aclassloader</li> <li>\u8bb2\u4e00\u4e0b\u53cc\u4eb2\u59d4\u6d3e\u673a\u5236</li> <li>Android\u4e2d\u70ed\u4fee\u590d\u5982\u4f55\u5b9e\u73b0</li> <li>Android\u4e2d\u63d2\u4ef6\u5316\u5982\u4f55\u5b9e\u73b0</li> <li>Bunder\u7684\u673a\u5236\u548c\u539f\u7406\u662f\u4ec0\u4e48</li> <li>JVM\u5185\u5b58\u5206\u914d\u7b56\u7565\uff0c\u5783\u573e\u56de\u6536\u6807\u8bb0\u7b97\u6cd5\uff0c\u5783\u573e\u56de\u6536\u7b56\u7565</li> <li>Minor GC\u3001Major GC\u548cFull GC\u4e4b\u95f4\u7684\u533a\u522b</li> <li>JsBridge\u7684\u5b9e\u73b0</li> <li>\u8bb2\u4e00\u4e0bMVC\uff0cMVP\uff0cMVVM\u7684\u7406\u89e3</li> </ol> <p>\u6269\u5c55</p> <ol> <li>\u662f\u5426\u4f7f\u7528\u8fc7kotlin\uff0c\u8bf4\u8bf4\u4f60\u7684\u611f\u53d7</li> <li>RN\u548cweex\u6709\u6ca1\u6709\u63a5\u89e6\u8fc7\uff0c\u5b9e\u73b0\u539f\u7406\u662f\u4ec0\u4e48</li> <li>\u524d\u7aef\u6709\u6ca1\u6709\u505a\u8fc7\uff0c\u505a\u8fc7\u4ec0\u4e48\u9879\u76ee\uff0c\u4f7f\u7528\u7684\u4ec0\u4e48\u6846\u67b6</li> <li>\u670d\u52a1\u7aef\u6709\u6ca1\u6709\u4e86\u89e3\u8fc7\uff0c\u4f7f\u7528\u8fc7\u4ec0\u4e48\u6846\u67b6</li> <li>\u5176\u4ed6\u8bed\u8a00\u662f\u5426\u63a5\u89e6\u8fc7\uff0c\u6709\u6ca1\u6709\u8fc7\u4e00\u4e9b\u9879\u76ee\u5f00\u53d1</li> </ol> <p>\u9879\u76ee</p> <ol> <li>\u4ecb\u7ecd\u4e00\u4e0b\u76ee\u524d\u9879\u76ee\u7684\u6574\u4f53\u67b6\u6784\uff0c\u4f60\u8ba4\u4e3a\u73b0\u5728\u7684\u67b6\u6784\u4e2d\u662f\u5426\u5b58\u5728\u95ee\u9898\uff0c\u4ec0\u4e48\u95ee\u9898\uff0c\u5982\u4f55\u89e3\u51b3</li> <li>\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u4e00\u4e9b\u4e09\u65b9\u5e93\uff0c\u6709\u6ca1\u6709\u6df1\u5165\u770b\u8fc7\u6e90\u7801\uff0c\u6311\u4e00\u4e2a\u4f60\u8ba4\u4e3a\u8bbe\u8ba1\u7684\u6bd4\u8f83\u597d\u7684\u8bb2\u4e00\u4e0b\uff0c\u4e3a\u4ec0\u4e48\u4f60\u8ba4\u4e3a\u8fd9\u4e2a\u5730\u65b9\u8bbe\u8ba1\u7684\u6bd4\u8f83\u597d</li> <li>\u4ece\u4e1a\u52a1\u548c\u6280\u672f\u5b9e\u73b0\u65b9\u6848\u4e24\u4e2a\u65b9\u9762\uff0c\u8bb2\u4e00\u4e2a\u4f60\u4e3b\u5bfc\u8fc7\u6216\u8005\u662f\u4f5c\u4e3a\u6838\u5fc3\u4eba\u5458\u53c2\u4e0e\u8fc7\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u8fd9\u4e2a\u9879\u76ee\u4e2d\u7684\u4eae\u70b9\u662f\u4ec0\u4e48\uff0c\u9488\u5bf9\u9879\u76ee\u8fdb\u884c\u4e00\u4e9b\u63d0\u95ee</li> <li>\u7b80\u5386\u4e2d\u6311\u9009\u51e0\u4e2a\u611f\u5174\u8da3\u70b9\u6216\u9879\u76ee\uff0c\u8be2\u95ee\u4e00\u4e0b\u9879\u76ee\u7684\u6280\u672f\u5b9e\u73b0</li> <li>\u8bb2\u4e00\u4e0b\u5de5\u4f5c\u4e2d\u9047\u5230\u8fc7\u7684\u56f0\u96be\uff0c\u600e\u4e48\u89e3\u51b3\u7684\uff0c\u8fd9\u4ef6\u4e8b\u5bf9\u4f60\u7684\u6210\u957f\u662f\u4ec0\u4e48</li> <li>\u4e3a\u4ec0\u4e48\u79bb\u804c\uff0c\u672a\u67651-2\u5e74\u7684\u804c\u4e1a\u89c4\u5212\u662f\u4ec0\u4e48\uff0c\u4f60\u671f\u5f85\u65b0\u7684\u5c97\u4f4d\u80fd\u7ed9\u4f60\u63d0\u4f9b\u4ec0\u4e48</li> </ol>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/","title":"Interview 2","text":"<p>RxJava+Retrofit\u8fdb\u884c\u7f51\u7edc\u8bf7\u6c42;  Header\u91cc\u5982\u4f55\u6dfb\u52a0\u901a\u7528\u53c2\u6570\uff0c Response\u91cc\u5982\u4f55\u89e3\u6790\uff0c\u53ea\u8fd4\u56de\u4e1a\u52a1\u5c42result\uff0c\u4e0d\u9700\u8981\u6bcf\u4e2aBean\u90fd\u6709code</p> <p>\u8bbe\u8ba1\u6a21\u5f0f\uff1a\u5de5\u5382  \u5efa\u9020\u8005  \u88c5\u9970\u8005</p> <p>mvp\u6a21\u5f0f\u7684\u4e86\u89e3\u548c\u4ecb\u7ecd</p> <p>\u5bf9RecyclerView\u7684\u4e86\u89e3\uff0c\u8e29\u8fc7\u54ea\u4e9b\u5751\uff1f</p> <p>margin \u548cpadding\u7684\u533a\u522b MeasureSpeac.EXACTLY/UN.../ATMOLST -&gt; wrap_content/match_parent \u7ed8\u5236\u6d41\u7a0b\uff1f\u63a7\u4ef6\u7684margin\uff0c\u662f\u5728measure\u8fd8\u662flayout\uff0c\u8fd8\u662fdraw\u8fc7\u7a0b\u4e2d\u5904\u7406\uff1f</p> <p>\u65b9\u6cd5\u6570\u8d85\u8fc765535\u600e\u4e48\u89e3\u51b3\uff1f</p> <p>\u5b50\u7ebf\u7a0b\u4e2d\u8fdb\u884cUI\u64cd\u4f5c\u65b9\u6cd5\u6709\u54ea\u4e9b\uff1f Handler\u7684post()\u65b9\u6cd5\uff1bView\u7684post()\u65b9\u6cd5\uff1bActivity\u7684runOnUiThread()\u65b9\u6cd5</p> <p>\u4e8b\u4ef6\u5206\u53d1 String, StringBuffer, StringBuilder\u7684\u533a\u522b\uff1b String: \u5b9a\u957f\uff0c\u5b57\u7b26\u4e32\u64cd\u4f5c\u4f1a\u4ea7\u751f\u65b0\u7684String\u5bf9\u8c61\uff1b StringBuffer\uff1a\u7ebf\u7a0b\u5b89\u5168\uff0c\u6709synchronized\u4fee\u9970\uff0c\u4e0d\u5b9a\u957f\uff0c\u9ed8\u8ba4\u5bb9\u91cf\u662f16\u4e2a\u5b57\u8282+\u4f20\u5165\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c\u53ef\u6269\u5c55\uff0c\u64cd\u4f5c\u4e0d\u4f1a\u4ea7\u751f\u65b0\u7684\u5bf9\u8c61\uff1b StringBuilder\uff1a\u7ebf\u7a0b\u4e0d\u5b89\u5168\uff0c\u5176\u4ed6\u540cStringBuffer\uff1b</p> <p>final \u4fee\u9970\u7b26\u7684\u4f5c\u7528</p> <p>final \u53ef\u4ee5\u4fee\u9970\u7c7b\u3001\u53d8\u91cf\u548c\u65b9\u6cd5\u3002\u4fee\u9970\u7c7b\u4ee3\u8868\u8fd9\u4e2a\u7c7b\u4e0d\u53ef\u88ab\u7ee7\u627f\u3002\u4fee\u9970\u53d8\u91cf\u4ee3\u8868\u6b64\u53d8\u91cf\u4e0d\u53ef\u88ab\u6539\u53d8\u3002\u4fee\u9970\u65b9\u6cd5\u8868\u793a\u6b64\u65b9\u6cd5\u4e0d\u53ef\u88ab\u91cd\u5199 (override)\u3002</p> <p>Java\uff1a * Object\u6709\u54ea\u4e9b\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u65b9\u6cd5\u7684\u7528\u5904\uff1fwait  notify  hashCode  finalize  getClass  toString clone  equals()\u5ef6\u4f38\uff1await\u548csleep\u533a\u522b * Java\u5185\u5b58\u6a21\u578b\uff0c\u6bcf\u5757\u5185\u5b58\u5b58\u653e\u54ea\u4e9b\u4e1c\u897f\uff1f String\u7684\u5e38\u91cf\u6c60\u5b58\u653e\u5728\u54ea\u91cc\uff1f * Java\u5783\u573e\u56de\u6536\u7684\u51e0\u4e2a\u7b97\u6cd5\uff1f\u6709\u54ea\u4e9b\u5783\u573e\u6536\u96c6\u5668\uff0c\u4f18\u7f3a\u70b9\u662f\u4ec0\u4e48\uff1f\u6bd4\u5982G1\u6536\u96c6\u5668\u76f8\u5bf9\u4e8eCMS\u6709\u54ea\u4e9b\u4f18\u7f3a\u70b9\uff1f * \u68c0\u6d4b\u5185\u5b58\u6cc4\u6f0f\u7528\u4ec0\u4e48\u5de5\u5177\uff1f\u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u76d1\u6d4b\u7684?LeakCanery\u7684\u539f\u7406\uff1f * \u5185\u5b58\u6cc4\u6f0f\u7684\u573a\u666f\uff1f     * \u5185\u90e8\u7c7b\u6301\u6709\u5916\u90e8\u7c7b\u7684\u5f15\u7528\u539f\u7406\uff1f     * \u56db\u79cd\u5f15\u7528\u65b9\u5f0f\uff1b * \u5173\u952e\u5b57volatile\u4f7f\u7528\u573a\u666f\uff1f\uff08\u4e0d\u4f1avolatile\uff0c\u53ef\u95ee\u5bf9Java\u5e76\u53d1\u76843\u4e2a\u91cd\u8981\u7279\u6027\uff1a\u539f\u5b50\u6027\u3001\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027\u7684\u7406\u89e3\uff1f\uff09</p> <p>http://www.cnblogs.com/dolphin0520/p/3920373.html</p> <p>7.\u600e\u4e48\u89e3\u51b3\u6b7b\u9501\u95ee\u9898\uff1f</p> <p>\u67d0\u4e2a\u4efb\u52a1\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u4efb\u52a1\uff0c\u800c\u540e\u8005\u53c8\u7b49\u5f85\u522b\u7684\u4efb\u52a1\uff0c\u8fd9\u6837\u4e00\u76f4\u4e0b\u53bb\uff0c\u76f4\u5230\u8fd9\u4e2a\u94fe\u6761\u4e0a\u7684\u4efb\u52a1\u53c8\u5728\u7b49\u5f85\u7b2c\u4e00\u4e2a\u4efb\u52a1\u91ca\u653e\u9501\u3002\u8fd9\u5f97\u5230\u4e86\u4e00\u4e2a\u4efb\u52a1\u4e4b\u95f4\u4e92\u76f8\u7b49\u5f85\u7684\u8fde\u7eed\u5faa\u73af\uff0c\u6ca1\u6709\u54ea\u4e2a\u7ebf\u7a0b\u80fd\u7ee7\u7eed\u3002\u8fd9\u88ab\u79f0\u4e4b\u4e3a\u6b7b\u9501\u3002\u5f53\u4ee5\u4e0b\u56db\u4e2a\u6761\u4ef6\u540c\u65f6\u6ee1\u8db3\u65f6\uff0c\u5c31\u4f1a\u4ea7\u751f\u6b7b\u9501\uff1a (1) \u4e92\u65a5\u6761\u4ef6\u3002\u4efb\u52a1\u6240\u4f7f\u7528\u7684\u8d44\u6e90\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u4e0d\u80fd\u5171\u4eab\u7684\u3002 (2) \u4efb\u52a1\u5fc5\u987b\u6301\u6709\u4e00\u4e2a\u8d44\u6e90\uff0c\u540c\u65f6\u7b49\u5f85\u83b7\u53d6\u53e6\u4e00\u4e2a\u88ab\u522b\u7684\u4efb\u52a1\u5360\u6709\u7684\u8d44\u6e90\u3002 (3) \u8d44\u6e90\u4e0d\u80fd\u88ab\u5f3a\u5360\u3002 (4) \u5fc5\u987b\u6709\u5faa\u73af\u7b49\u5f85\u3002\u4e00\u4e2a\u4efb\u52a1\u6b63\u5728\u7b49\u5f85\u53e6\u4e00\u4e2a\u4efb\u52a1\u6240\u6301\u6709\u7684\u8d44\u6e90\uff0c\u540e\u8005\u53c8\u5728\u7b49\u5f85\u522b\u7684\u4efb\u52a1\u6240\u6301\u6709\u7684\u8d44\u6e90\uff0c\u8fd9\u6837\u4e00\u76f4\u4e0b\u53bb\uff0c\u76f4\u5230\u6709\u4e00\u4e2a\u4efb\u52a1\u5728\u7b49\u5f85\u7b2c\u4e00\u4e2a\u4efb\u52a1\u6240\u6301\u6709\u7684\u8d44\u6e90\uff0c\u4f7f\u5f97\u5927\u5bb6\u90fd\u88ab\u9501\u4f4f\u3002 \u8981\u89e3\u51b3\u6b7b\u9501\u95ee\u9898\uff0c\u5fc5\u987b\u6253\u7834\u4e0a\u9762\u56db\u4e2a\u6761\u4ef6\u7684\u5176\u4e2d\u4e4b\u4e00\u3002\u5728\u7a0b\u5e8f\u4e2d\uff0c\u6700\u5bb9\u6613\u6253\u7834\u7684\u5f80\u5f80\u662f\u7b2c\u56db\u4e2a\u6761\u4ef6\u3002</p> <p>6.\u7c7b\u52a0\u8f7d\u673a\u5236\uff1f\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\u7684\u4f18\u70b9\uff1f 6.\u8bf4\u8bf4\u6cdb\u578b\uff0c\u6cdb\u578b\u539f\u7406\uff0c\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u7528T\uff1b 7.\u53cd\u5c04\u673a\u5236\uff0c\u53ca\u5176\u4f18\u52a3\u5904\uff1b 8.Override\u548cOverload\u7684\u542b\u4e49\u53bb\u533a\u522b\uff1f\uff08\u8fdb\u9636\uff1aJava\u9759\u6001\u5206\u6d3e\u548c\u52a8\u6001\u5206\u6d3e\uff1f\u8fd9\u4e24\u4e2a\u8c01\u662f\u5355\u5206\u6d3e\uff0c\u8c01\u662f\u591a\u5206\u6d3e\uff1f\uff09 9.\u8bf4\u8bf4\u5bf9\u6ce8\u89e3\u7684\u4e86\u89e3\uff0c\u5982\u4f55\u8bbe\u8ba1Butterknife\uff1f 9.\u7528\u5230\u4e86\u54ea\u4e9b\u8bbe\u8ba1\u6a21\u5f0f\uff1f\u77e5\u9053\u88c5\u9970\u8005\u3001\u89c2\u5bdf\u8005\u3001\u7ec4\u5408\u6a21\u5f0f\uff1f</p> <p>Android 1.Activity\u7684\u56db\u79cd\u542f\u52a8\u65b9\u5f0f 2.\u7ed8\u5236\u6d41\u7a0b\uff1f\u63a7\u4ef6\u7684margin\uff0c\u662f\u5728measure\u8fd8\u662flayout\uff0c\u8fd8\u662fdraw\u8fc7\u7a0b\u4e2d\u5904\u7406\uff1f 3.\u4e8b\u4ef6\u5206\u53d1\u673a\u5236\uff1fonTouch\u548conTouchEvent\u662f\u4ec0\u4e48\u533a\u522b\uff1f\u5982\u679c\u6211\u91cd\u5199\u4e86onTouch\u548conClick\uff0c\u5b83\u4eec\u7684\u8c03\u7528\u987a\u5e8f\u662f\u600e\u6837\u7684\uff1f\u4ec0\u4e48\u65f6\u5019\u4f1a\u4e0d\u8c03\u7528onClick\uff1f</p> <p>4.LocalBroadCast\u5b9e\u73b0\u539f\u7406</p> <p>\u672c\u5730\u5e7f\u64ad\u662f\u901a\u8fc7LocalBroadcastManager\u5185\u7f6e\u7684Handler\u6765\u5b9e\u73b0\u7684\uff0c\u53ea\u662f\u5229\u7528\u4e86IntentFilter\u7684match\u529f\u80fd\uff0c\u81f3\u4e8eBroadcastReceiver \u6362\u6210\u5176\u4ed6\u63a5\u53e3\u4e5f\u65e0\u6240\u8c13\uff0c\u987a\u4fbf\u5229\u7528\u4e86\u73b0\u6210\u7684\u7c7b\u548c\u6982\u5ff5\u800c\u5df2\u3002\u5728register()\u7684\u65f6\u5019\u4fdd\u5b58BroadcastReceiver\u4ee5\u53ca\u5bf9\u5e94\u7684IntentFilter\uff0c\u5728sendBroadcast()\u7684\u65f6\u5019\u627e\u5230\u548cIntent\u5bf9\u5e94\u7684BroadcastReceiver\uff0c\u7136\u540e\u901a\u8fc7Handler\u53d1\u9001\u6d88\u606f\uff0c\u89e6\u53d1executePendingBroadcasts()\u51fd\u6570\uff0c\u518d\u5728\u540e\u8005\u4e2d\u8c03\u7528\u5bf9\u5e94BroadcastReceiver\u7684onReceive()\u65b9\u6cd5\u3002</p> <p>6.SurfaceView\u7528\u8fc7\u4e48\uff1f\u53cc\u7f13\u51b2\u7684\u539f\u7406\u662f\u4ec0\u4e48\uff1f 6.apk\u5982\u4f55\u7626\u8eab\uff1f 7.\u65b9\u6cd5\u6570\u8d85\u8fc765535\u600e\u4e48\u89e3\u51b3\uff1fmultidex\u4f55\u65f6\u5c06\u5305\u5408\u5e76\uff1f</p> <p>1.\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5982string</p> <p>2.apk\u5982\u4f55\u7626\u8eab</p> <p>3.\u4e00\u5f20\u56fe\u7247\u5185\u5b58\u5927\u5c0f</p> <p>4.\u5982\u4f55\u68c0\u67e5\u6ca1\u6709\u4f7f\u7528\u7684\u8d44\u6e90</p> <p>5.multidex\u4f55\u65f6\u5c06\u5305\u5408\u5e76</p> <p>6.MVP\u76f8\u6bd4MVC\u7684\u4f18\u52bf</p> <p>7.\u6df7\u5408\u5f00\u53d1</p> <p>8.UI\u5c42\u4f18\u5316\uff1a\u5982\u4f55\u89e3\u51b3\u8fc7\u5ea6\u7ed8\u5236\u3001\u6ed1\u52a8\u5361\u987f\u7b49</p> <p>9.\u5185\u5b58\u4f18\u5316\uff1a</p> <p>10.\u63d2\u4ef6\u5316\u76f8\u5173</p> <p>11.\u5f02\u6b65\u52a0\u8f7d</p> <p>12.\u52a8\u6001\u52a0\u8f7d</p> <p>13.\u4e2a\u6027\u5316UI\u65f6\u6709\u54ea\u4e9b\u9700\u8981\u6ce8\u610f\u7684\uff0c\u6bd4\u8f83\u6027\u80fd\u65b9\u9762</p> <p>\u9762\u8bd5\u9898\uff1a 1\u3001JNI\uff1a 1\uff09NewStringUtf \u3001NewString\u3001GetStringUtfChars\u3001GetStringChars \u533a\u522b\uff1f \u4ece \u8fd4\u56de\u503c\uff0c\u91ca\u653e\u65b9\u5f0f\u65b9\u9762\u89e3\u7b54\u3002 NewString jstring NewString(JNIEnv env, const jchar unicodeChars, jsize len); Constructs a new java.lang.String object from an array of Unicode characters.</p> <p>NewStringUTF jstring NewStringUTF(JNIEnv env, const char bytes); Constructs a new java.lang.String object from an array of characters in modified UTF-8 encoding.</p> <p>GetStringChars const jchar * GetStringChars(JNIEnv env, jstring string, jboolean isCopy); Returns a pointer to the array of Unicode characters of the string. This pointer is valid until ReleaseStringchars() is called.</p> <p>GetStringUTFChars const char * GetStringUTFChars(JNIEnv env, jstring string, jboolean isCopy); Returns a pointer to an array of bytes representing the string in modified UTF-8 encoding. This array is valid until it is released by ReleaseStringUTFChars(). If isCopy is not NULL, then *isCopy is set to JNI_TRUE if a copy is made; or it is set to JNI_FALSE if no copy is made.</p> <p>2\uff09modified utf-8 encoding \u662f\u4ec0\u4e48\u610f\u601d\uff1f</p> <p>3\uff09\u5982\u679cJava\u5c42\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u662fUnicode\u7684\u6269\u5c55\u5b57\u7b26\uff0c\u6bd4\u5982emoji\u8868\u60c5\uff0c\u4e00\u4e2a\u5b57\u7b26\u53604\u4e2a\u5b57\u8282\u7684\uff0cJNI\u5c42\u5c06\u8fd9\u4e2ajstring\u8f6c\u6362\u6210char\u4f1a\u9047\u5230\u4ec0\u4e48\u95ee\u9898\uff1f\u600e\u4e48\u89e3\u51b3\u5462\uff1f \u5751\uff1a\u4e0d\u80fd\u7528JNI\u7684GetStringUTFChars\uff0c\u8981\u7528Java\u7684\u53cd\u5c04\uff0c\u5c06jstring\u8f6c\u6362\u6210char.</p> <p>3\uff09native\u7684\u4ee3\u7801\u4e2d\uff0c\u9047\u5230\u8fc7\u54ea\u4e9b\u5f02\u5e38\u4ee3\u7801\u4f1a\u4f7f\u7a0b\u5e8f\u5d29\u6e83\uff1f    \uff08\u6bd4\u5982CallObjectMethod() null\u7684\u53c2\u6570\u4f1a\u5d29\uff09</p> <p>4\uff09ndk-build\u7684\u53c2\u6570\u4e86\u89e3\u54ea\u4e9b\uff1f</p> <p>2\u3001Android</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#activity","title":"Activity\u7684\u56db\u79cd\u542f\u52a8\u65b9\u5f0f\uff1b","text":"<pre><code> standard, singleTop, singleTask,\n</code></pre>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#androidxml","title":"android\u4f7f\u7528xml\u6587\u4ef6\u7684\u4f18\u7f3a\u70b9\uff1b","text":"<p>\u4f18\u70b9\uff1a\u5728xml\u4e2d\u5199\u5e03\u5c40\uff0c\u5b9e\u73b0UI\u548c\u529f\u80fd\u5206\u5f00\uff0c\u65b9\u4fbf\u673a\u578b\u9002\u914d\u3001APP\u56fd\u9645\u5316\uff1b \u7f3a\u70b9\uff1a\u89e3\u6790xml\u6587\u4ef6\u8017\u65f6\uff1b</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#handler","title":"Handler\u673a\u5236","text":"<pre><code> Handler\u4f9d\u9644\u4e8e\u521b\u5efa\u7684\u7ebf\u7a0b\uff1bLooper\u3001Message\u3001Handler\u7684\u5173\u7cfb\uff1b\n</code></pre> <p>3\uff09\u5b50\u7ebf\u7a0b\u4e2d\u8fdb\u884cUI\u64cd\u4f5c\u65b9\u6cd5\u6709\u54ea\u4e9b\uff1f Handler\u7684post()\u65b9\u6cd5\uff1bView\u7684post()\u65b9\u6cd5\uff1bActivity\u7684runOnUiThread()\u65b9\u6cd5</p> <p>4\uff09\u56fe\u7247\u538b\u7f29\u6709\u54ea\u4e9b\u65b9\u6cd5\uff1f</p> <p>5\uff09ANR\uff1aService\u3001\u5e7f\u64ad\u9020\u6210\u7684ANR\u5982\u4f55\u89e3\u51b3\uff1b      5s UI\u7ebf\u7a0b\u6ca1\u6709\u54cd\u5e94\uff1b10s \u6ca1\u6709\u63a5\u6536\u5230\u5e7f\u64ad\uff1b</p> <pre><code> \u89e3\u51b3ANR\u65b9\u6cd5\uff1a\n 1\uff09\u4e0d\u8981\u5728UI\u7ebf\u7a0b\u6216\u5f71\u54cdUI\u6e32\u67d3\u7684\u5730\u65b9\u505a\u8017\u65f6\u64cd\u4f5c\uff1b\n 2\uff09\u53ef\u4ee5\u5728/data/anr/traces.txt\u4e2d\uff0c\u67e5\u770bANR\u65e5\u5fd7\uff1b\n</code></pre> <p>6\uff09IntentService\u548cService\u533a\u522b</p> <p>6\uff09OOM\uff1a\u5982\u4f55\u89e3\u51b3\uff1b http://www.cnblogs.com/xsmhero/p/3566890.html</p> <p>7\uff09\u56db\u79cd\u5f15\u7528\u65b9\u5f0f\uff1b</p>"},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#android","title":"Android\u5185\u5b58\u7ed3\u6784","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#jvm","title":"JVM\u5783\u573e\u56de\u6536\u673a\u5236","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#_1","title":"\u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u76d1\u6d4b\u7684?","text":""},{"location":"Android/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%94%B6%E9%9B%86/Interview_2/#android_1","title":"Android\u4e2d\u7684\u540c\u6b65\u65b9\u5f0f\u6709\u54ea\u4e9b\uff1f","text":"<p>\u540c\u6b65\u65b9\u6cd5\u3001\u540c\u6b65\u4ee3\u7801\u5757\u3001\u539f\u5b50\u64cd\u4f5c</p> <p>3\u3001\u7f51\u7edc</p> <p>4\u3001Java HashMap\u548cHashTable\u7684\u533a\u522b\uff1b 1\uff09\u7ebf\u7a0b\u5b89\u5168\uff1aHashMap\u4e0d\u5b89\u5168\uff0cHashTable\u5b89\u5168\uff0c\u56e0\u4e3aHashTable\u6709Synchronized\u4fee\u9970\uff1b 2\uff09\u901f\u5ea6\uff1aHashMap\u5feb\u4e00\u70b9\uff1b 3\uff09\u5141\u8bb8\u7a7a\u952e\uff1aHashMap\u5141\u8bb8\u7a7a\u952e\uff1b</p> <p>String, StringBuffer, StringBuilder\u7684\u533a\u522b\uff1b String: \u5b9a\u957f\uff0c\u5b57\u7b26\u4e32\u64cd\u4f5c\u4f1a\u4ea7\u751f\u65b0\u7684String\u5bf9\u8c61\uff1b StringBuffer\uff1a\u7ebf\u7a0b\u5b89\u5168\uff0c\u6709synchronized\u4fee\u9970\uff0c\u4e0d\u5b9a\u957f\uff0c\u9ed8\u8ba4\u5bb9\u91cf\u662f16\u4e2a\u5b57\u8282+\u4f20\u5165\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c\u53ef\u6269\u5c55\uff0c\u64cd\u4f5c\u4e0d\u4f1a\u4ea7\u751f\u65b0\u7684\u5bf9\u8c61\uff1b StringBuilder\uff1a\u7ebf\u7a0b\u4e0d\u5b89\u5168\uff0c\u5176\u4ed6\u540cStringBuffer\uff1b</p> <p>\u8bf4\u8bf4\u6cdb\u578b\uff0c\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u7528T\uff1b \u53cd\u5c04\u673a\u5236\uff0c\u53ca\u5176\u4f18\u52a3\u5904\uff1b \u8bbe\u8ba1\u6a21\u5f0f\uff1a\u4ee3\u7406\u6a21\u5f0f\uff1b \u4e86\u89e3\u5230\u7684\u52a0\u5bc6\u7b97\u6cd5\u6709\u54ea\u4e9b\uff1f\u6bd4\u5982SHA1\u548cMD5\u80fd\u89e3\u91ca\u4e0b\u539f\u7406\u4e48\uff1f \u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff1f</p>"},{"location":"DesignPattern/%E5%B0%BD%E9%87%8F%E4%B8%8D%E8%A6%81%E7%94%A8%E5%AE%9E%E7%8E%B0%E3%80%81%E7%BB%A7%E6%89%BF%EF%BC%8C%E8%AF%B7%E7%94%A8%E7%BB%84%E5%90%88%E3%80%81%E8%81%9A%E5%90%88/","title":"\u5c3d\u91cf\u4e0d\u8981\u7528\u5b9e\u73b0\u3001\u7ee7\u627f\uff0c\u8bf7\u7528\u7ec4\u5408\u3001\u805a\u5408","text":"<p>\u7ee7\u627f Extends(\u5b9e\u73b0 Implements)\u5e94\u8be5\u4ec5\u5f53 base is a super \u624d\u80fd\u4f7f\u7528\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u5e0c\u671b base \u8868\u73b0\u51fa\u6240 \u6709 super \u7684\u7279\u6027\u7684\u65f6\u5019\u624d\u4f7f\u7528\u7ee7\u627f\u3002\u5426\u5219\u5e94\u8be5\u4f7f\u7528\u7ec4\u5408\u3002</p> <p>\u5148\u7ed9\u4e2a\u7b80\u5355\u7684\u5217\u5b50:</p> <pre><code>public class MyView extends View implements View.OnClickListener { \n    public MyView() {\n            ...\n            setOnClickListener(this); \n    }\n    @Override\n    public void onClick(View v) {\n        ... \n    }\n}\n</code></pre> <p>\u53d1\u73b0\u4ec0\u4e48\u95ee\u9898\u4e86?</p> <p>MyView myView = new MyView();  myView.onClick(myView);  myView.onClick(null);</p> <p>\u4e0a\u8ff0\u7684\u4f7f\u7528\u771f\u7684\u5408\u6cd5\u5417?</p> <p>\u4f60\u9700\u8981\u8ba9\u6240\u6709\u4f7f\u7528 MyView \u7684\u4eba\u90fd\u77e5\u9053 MyView \u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a View.OnClickListener \u5417? \u4f60\u7684onClick(View)\u9700\u8981\u88ab\u522b\u4eba\u8c03\u7528\u5417? \u4f60\u5e0c\u671b\u522b\u4eba\u628a\u4f60\u7684 MyView \u5f53\u6210 View.OnClickListener \u6765\u4f7f\u7528\u5417?</p> <p>\u5982\u679c\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0c\u90a3\u4e48\u8bf7\u4e0d\u8981\u4f7f\u7528\u7ee7\u627f(\u5b9e\u73b0)\u3002</p> <p>\u6240\u4ee5\uff0c\u8bf7\u5199\u6210\u8fd9\u6837:</p> <pre><code>\npublic class MyView extends View { \n    public MyView() {\n        ...\n        setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View v) {\n                ... \n            }\n        });\n    } \n}\n</code></pre> <p>\u751a\u81f3\u53ef\u4ee5\u5199\u6210\u8fd9\u6837:</p> <pre><code>\npublic class MyView extends View {\n    private static final View.OnClickListener CLICK_LISTENER = new View.OnClickListene(){\n         @Override\n         public void onClick(View v) { \n             ...\n         } \n    });\n\n    public MyView() {\n        ...\n        setOnClickListener(CLICK_LISTENER); \n    }\n\n}\n</code></pre>"},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/","title":"\u8bbe\u8ba1\u6a21\u5f0f\u4e2d6\u5927\u8bbe\u8ba1\u539f\u5219","text":""},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/#_1","title":"\u91cc\u5f0f\u66ff\u6362\u539f\u5219","text":"<p>\u6240\u6709\u5f15\u7528\u57fa\u7c7b\u7684\u5730\u65b9\u5fc5\u987b\u80fd\u900f\u660e\u5730\u4f7f\u7528\u5176\u5b50\u7c7b\u7684\u5bf9\u8c61\u3002</p>"},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/#_2","title":"\u4f9d\u8d56\u5012\u7f6e\u539f\u5219","text":"<p>\u9ad8\u5c42\u4e0d\u5e94\u8be5\u4f9d\u8d56\u5e95\u5c42\u6a21\u5757\uff0c\u4e24\u8005\u90fd\u5e94\u8be5\u4f9d\u8d56\u5176\u62bd\u8c61 \u62bd\u8c61\u4e0d\u5e94\u8be5\u4f9d\u8d56\u7ec6\u8282 \u7ec6\u8282\u5e94\u8be5\u4f9d\u8d56\u62bd\u8c61</p> <p>\u672c\u8d28\u662f\uff1a\u901a\u8fc7\u62bd\u8c61\uff08\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\uff09\u4f7f\u5404\u4e2a\u7c7b\u6216\u6a21\u5757\u7684\u5b9e\u73b0\u5f7c\u6b64\u72ec\u7acb\uff0c\u4e0d\u4e92\u76f8\u5f71\u54cd\uff0c\u5b9e\u73b0\u6a21\u5757\u95f4\u7684\u677e\u8026\u5408\u3002</p>"},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/#_3","title":"\u63a5\u53e3\u9694\u79bb\u539f\u5219","text":"<p>\u5efa\u7acb\u5355\u4e00\u63a5\u53e3\uff0c\u4e0d\u8981\u5efa\u7acb\u81c3\u80bf\u5e9e\u5927\u7684\u63a5\u53e3\u3002\u901a\u4fd7\u4e00\u70b9\u6765\u8bf4\uff0c\u63a5\u53e3\u5c3d\u91cf\u7ec6\u5316\uff0c\u540c\u65f6\u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\u5c3d\u91cf\u5c11\u3002</p>"},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/#_4","title":"\u8fea\u7c73\u7279\u6cd5\u5219","text":"<p>\u6700\u5c11\u77e5\u8bc6\u539f\u5219</p> <p>\u4e00\u4e2a\u5bf9\u8c61\u5e94\u8be5\u5bf9\u5176\u4ed6\u5bf9\u8c61\u6709\u6700\u5c11\u7684\u4e86\u89e3\u3002\u901a\u4fd7\u5730\u8bb2\uff0c\u4e00\u4e2a\u7c7b\u5e94\u8be5\u5bf9\u81ea\u5df1\u9700\u8981\u8026\u5408\u6216\u8c03\u7528\u7684\u7c7b\u77e5\u9053\u7684\u6700\u5c11\u3002</p>"},{"location":"DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%AD6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/#_5","title":"\u5f00\u95ed\u539f\u5219","text":"<p>\u4e00\u4e2a\u8f6f\u4ef6\u5b9e\u4f53\u5e94\u8be5\u901a\u8fc7\u6269\u5c55\u6765\u5b9e\u73b0\u53d8\u5316\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u4fee\u6539\u5df2\u6709\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u53d8\u5316\u3002</p>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/","title":"1 Java\u7684\u5185\u5b58\u533a\u57df","text":""},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#_1","title":"\u6982\u8ff0","text":"<p>Java\u4e0eC++\u4e4b\u95f4\u6709\u4e00\u5835\u7531<code>\u5185\u5b58\u52a8\u6001\u5206\u914d</code>\u548c<code>\u5783\u573e\u56de\u6536\u673a\u5236</code>\u6240\u56f4\u6210\u7684\u9ad8\u5899\uff0c\u5899\u5916\u9762\u7684\u4eba\u60f3\u8fdb\u53bb\uff0c\u5899\u91cc\u9762\u7684\u4eba\u51fa\u4e0d\u6765\u3002</p>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#jvm","title":"JVM\u7684\u5185\u5b58\u5212\u5206","text":"<p>JVM\u6267\u884cJava\u7a0b\u5e8f\u7684\u8fc7\u7a0b\uff1aJava\u6e90\u4ee3\u7801\u6587\u4ef6(.java)\u4f1a\u88abJava\u7f16\u8bd1\u5668\u7f16\u8bd1\u4e3a\u5b57\u8282\u7801\u6587\u4ef6(.class)\uff0c\u7136\u540e\u7531JVM\u4e2d\u7684\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u5404\u4e2a\u7c7b\u7684\u5b57\u8282\u7801\u6587\u4ef6\uff0c\u52a0\u8f7d\u5b8c\u6bd5\u4e4b\u540e\uff0c\u4ea4\u7531JVM\u6267\u884c\u5f15\u64ce\u6267\u884c\u3002</p> <p>\u5728\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\uff0cJVM\u4f1a\u7528\u4e00\u6bb5\u7a7a\u95f4\u6765\u5b58\u50a8\u6267\u884c\u7a0b\u5e8f\u671f\u95f4\u9700\u8981\u7528\u5230\u7684\u6570\u636e\u548c\u76f8\u5173\u4fe1\u606f\uff0c\u8fd9\u6bb5\u7a7a\u95f4\u5c31\u662f<code>\u8fd0\u884c\u65f6\u6570\u636e\u533a\uff08Runtime Data Area\uff09</code>\uff0c\u4e5f\u5c31\u662f\u5e38\u8bf4\u7684JVM\u5185\u5b58\u3002JVM\u4f1a\u5c06\u5b83\u6240\u7ba1\u7406\u7684\u5185\u5b58\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u533a\u57df\uff0c\u5212\u5206\u7ed3\u679c\u5982\u56fe\uff1a</p> <p></p> <p>\u8fd0\u884c\u65f6\u6570\u636e\u533a\u88ab\u5206\u4e3a<code>\u7ebf\u7a0b\u79c1\u6709\u6570\u636e\u533a</code>\u548c<code>\u7ebf\u7a0b\u5171\u4eab\u6570\u636e\u533a</code>\u4e24\u5927\u7c7b:</p> <ul> <li>\u7ebf\u7a0b\u79c1\u6709\u6570\u636e\u533a\u5305\u542b\uff1a\u7a0b\u5e8f\u8ba1\u6570\u5668\u3001\u865a\u62df\u673a\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808</li> <li>\u7ebf\u7a0b\u5171\u4eab\u6570\u636e\u533a\u5305\u542b\uff1aJava\u5806\u3001\u65b9\u6cd5\u533a\uff08\u5185\u90e8\u5305\u542b\u5e38\u91cf\u6c60\uff09</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#1program-counter-register","title":"1.\u7a0b\u5e8f\u8ba1\u6570\u5668\uff08Program Counter Register\uff09","text":"<ul> <li>\u662f<code>\u5f53\u524d\u7ebf\u7a0b</code>\u6240\u6267\u884c\u7684\u5b57\u8282\u7801\u7684\u884c\u53f7\u8ba1\u6570\u5668\u3002</li> <li>\u5982\u679c\u7ebf\u7a0b\u6b63\u5728\u6267\u884c\u7684\u662f\u4e00\u4e2aJava\u65b9\u6cd5\uff0c\u90a3\u4e48\u8ba1\u6570\u5668\u8bb0\u5f55\u7684\u662f\u6b63\u5728\u6267\u884c\u7684\u865a\u62df\u673a\u5b57\u8282\u7801\u6307\u4ee4\u7684\u5730\u5740\u3002</li> <li>\u5982\u679c\u7ebf\u7a0b\u6b63\u5728\u6267\u884c\u7684\u662f\u4e00\u4e2aNative\u65b9\u6cd5\uff0c\u90a3\u4e48\u8ba1\u6570\u5668\u7684\u503c\u5219\u4e3a\u7a7a\u3002</li> </ul> <p>\u5b57\u8282\u7801\u89e3\u91ca\u5668\u5de5\u4f5c\u65f6\uff0c\u5c31\u662f\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u6761\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\uff0c\u5206\u652f\u3001\u5faa\u73af\u3001\u8df3\u8f6c\u3001\u5f02\u5e38\u5904\u7406\u3001\u7ebf\u7a0b\u6062\u590d\u7b49\u57fa\u7840\u529f\u80fd\u90fd\u9700\u8981\u4f9d\u8d56\u8fd9\u4e2a\u8ba1\u6570\u5668\u6765\u5b8c\u6210\u3002</p> <ul> <li>\u4e3a\u4e86\u7ebf\u7a0b\u5207\u6362\u540e\u80fd\u6062\u590d\u5230\u6b63\u786e\u7684\u6267\u884c\u4f4d\u7f6e\uff0c\u6bcf\u6761\u7ebf\u7a0b\u90fd\u9700\u8981\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u5404\u6761\u7ebf\u7a0b\u4e4b\u95f4\u8ba1\u6570\u5668\u4e92\u4e0d\u5f71\u54cd\uff0c\u72ec\u7acb\u5b58\u50a8\uff0c\u56e0\u6b64\u5b83\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\u5185\u5b58.</li> <li>\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u662f\u552f\u4e00\u4e00\u4e2a\u6ca1\u6709\u89c4\u5b9a\u4efb\u4f55OutOfMemoryError\u60c5\u51b5\u7684\u533a\u57df\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#2javajava-virtual-machine-stacks","title":"2.Java\u865a\u62df\u673a\u6808\uff08Java Virtual Machine Stacks\uff09","text":"<ul> <li>\u662f<code>Java\u65b9\u6cd5</code>\u6267\u884c\u7684\u5185\u5b58\u6a21\u578b\u3002</li> <li>\u6bcf\u4e2a\u65b9\u6cd5\u5728\u6267\u884c\u7684\u540c\u65f6\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u6808\u5e27\uff0c\u7528\u4e8e\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\u3001\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002</li> <li>\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u4ece\u8c03\u7528\u76f4\u81f3\u6267\u884c\u5b8c\u6210\u7684\u8fc7\u7a0b\uff0c\u5c31\u5bf9\u5e94\u7740\u4e00\u4e2a\u6808\u5e27\u5728\u865a\u62df\u673a\u6808\u4e2d\u5165\u6808\u9053\u51fa\u6808\u7684\u8fc7\u7a0b\u3002</li> </ul> <p>\u5c40\u90e8\u53d8\u91cf\u8868\u5b58\u653e\u4e86\u7f16\u8bd1\u671f\u53ef\u77e5\u7684\u5404\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\u5bf9\u8c61\u5f15\u7528\u7c7b\u578b\u548creturnAddress\u7c7b\u578b\uff0c\u5b83\u6240\u9700\u7684\u5185\u5b58\u7a7a\u95f4\u5728\u7f16\u8bd1\u671f\u95f4\u5b8c\u6210\u5206\u914d\u3002 * \u662f\u7ebf\u7a0b\u79c1\u6709\u7684\u5185\u5b58\uff0c\u4e0e\u7ebf\u7a0b\u751f\u547d\u5468\u671f\u76f8\u540c\u3002 * \u4e00\u822c\u628aJava\u5185\u5b58\u533a\u5206\u4e3a\u5806\u5185\u5b58\uff08Heap\uff09\u548c\u6808\u5185\u5b58\uff08Stack\uff09\uff0c\u5176\u4e2d\u300e\u6808\u300f\u6307\u7684\u662f\u865a\u62df\u673a\u6808\uff0c\u300e\u5806\u300f\u6307\u7684\u662fJava\u5806\u3002 * \u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u5bf9\u8fd9\u4e2a\u533a\u57df\u89c4\u5b9a\u4e86\u4e24\u79cd\u5f02\u5e38\u72b6\u51b5\uff1a   * \u5982\u679c\u7ebf\u7a0b\u8bf7\u6c42\u7684\u6808\u6df1\u5ea6\u5927\u4e8e\u865a\u62df\u673a\u6240\u5141\u8bb8\u7684\u6df1\u5ea6\uff0c\u5c06\u629b\u51faStackOverflowError\u5f02\u5e38\uff1b   * \u5982\u679c\u865a\u62df\u673a\u6808\u53ef\u52a8\u6001\u6269\u5c55\u4e14\u6269\u5c55\u65f6\u65e0\u6cd5\u7533\u8bf7\u5230\u8db3\u591f\u7684\u5185\u5b58\uff0c\u5c06\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002</p>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#3native-method-stack","title":"3.\u672c\u5730\u65b9\u6cd5\u6808\uff08Native Method Stack\uff09","text":"<ul> <li>\u662f\u865a\u62df\u673a\u4f7f\u7528\u5230\u7684Native\u65b9\u6cd5\u670d\u52a1\u3002</li> <li>\u5728\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u5bf9\u8fd9\u4e2a\u533a\u57df\u65e0\u5f3a\u5236\u89c4\u5b9a\uff0c\u7531\u5177\u4f53\u7684\u865a\u62df\u673a\u81ea\u7531\u5b9e\u73b0\u3002\u4e0e\u865a\u62df\u673a\u6808\u4e00\u6837\uff0c\u672c\u5730\u65b9\u6cd5\u6808\u533a\u57df\u4e5f\u4f1a\u629b\u51faStackOverflowError\u548cOutOfMemoryError\u5f02\u5e38\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#4javajava-heap","title":"4.Java\u5806\uff08Java Heap\uff09","text":"<ul> <li>\u7528\u4e8e\u5b58\u653e\u51e0\u4e4e\u6240\u6709\u7684\u5bf9\u8c61\u5b9e\u4f8b\u548c\u6570\u7ec4\u3002</li> <li>\u88ab\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u4e00\u5757\u5185\u5b58\u533a\u57df\uff0c\u5728\u865a\u62df\u673a\u542f\u52a8\u65f6\u521b\u5efa\u3002</li> </ul> <p>\u5728Java\u5806\u4e2d\uff0c\u53ef\u80fd\u5212\u5206\u51fa\u591a\u4e2a<code>\u7ebf\u7a0b\u79c1\u6709</code>\u7684\u5206\u914d\u7f13\u51b2\u533a\uff08Thread Local Allocation Buffer\uff0cTLAB\uff09\uff0c\u4f46\u65e0\u8bba\u54ea\u4e2a\u533a\u57df\uff0c\u5b58\u50a8\u7684\u90fd\u4ecd\u7136\u662f\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u8fdb\u4e00\u6b65\u5212\u5206\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u66f4\u597d\u5730\u56de\u6536\u5185\u5b58\uff0c\u6216\u8005\u66f4\u5feb\u5730\u5206\u914d\u5185\u5b58\u3002</p> <ul> <li>\u662f\u5783\u573e\u6536\u96c6\u5668\u7ba1\u7406\u7684\u91cd\u8981\u533a\u57df\uff0c\u4e5f\u88ab\u79f0\u4f5c\u201cGC\u5806\u201d\u3002</li> <li>\u662fJava\u865a\u62df\u673a\u6240\u7ba1\u7406\u5185\u5b58\u4e2d\u6700\u5927\u7684\u4e00\u5757\u3002</li> <li>\u53ef\u5904\u4e8e\u7269\u7406\u4e0a\u4e0d\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u53ea\u8981\u903b\u8f91\u4e0a\u8fde\u7eed\u5373\u53ef\u3002</li> <li>\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u5982\u679c\u5728\u5806\u4e2d\u6ca1\u6709\u5b8c\u6210\u5185\u5b58\u5206\u914d\uff0c\u4e14\u5806\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5c06\u4f1a\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#5method-area","title":"5.\u65b9\u6cd5\u533a\uff08Method Area\uff09","text":"<ul> <li>\u7528\u4e8e\u5b58\u50a8\u5df2\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u7c7b\u4fe1\u606f\u3001\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u7b49\u6570\u636e\u3002</li> <li>\u4e0eJava\u5806\u4e00\u6837\uff0c\u662f\u5404\u4e2a\u7ebf\u7a0b\u5171\u4eab\u7684\u5185\u5b58\u533a\u57df\u3002</li> <li>\u4eba\u4eec\u66f4\u613f\u610f\u628a\u8fd9\u4e2a\u533a\u57df\u79f0\u4e3a\u201c\u6c38\u4e45\u4ee3\u201d\uff08Permanent Generation\uff09\uff0c\u5728\u53d1\u5e03\u7684JDK1.7\u7684HotSpot\u4e2d\uff0c\u5df2\u7ecf\u628a\u539f\u672c\u653e\u5728\u6c38\u4e45\u4ee3\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u79fb\u51fa\u3002\u5b83\u8fd8\u6709\u4e2a\u522b\u540d\u53eb\u505aNon-Heap\uff08\u975e\u5806\uff09\u3002</li> <li>\u548cJava\u5806\u4e00\u6837\u4e0d\u9700\u8981\u8fde\u7eed\u7684\u5185\u5b58\u548c\u53ef\u4ee5\u9009\u62e9\u56fa\u5b9a\u5927\u5c0f\u6216\u53ef\u6269\u5c55\u5916\uff0c\u8fd8\u53ef\u9009\u62e9\u4e0d\u5b9e\u73b0GC\u3002</li> <li>\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u5f53\u65b9\u6cd5\u533a\u65e0\u6cd5\u6ee1\u8db3\u5185\u5b58\u5206\u914d\u9700\u6c42\u65f6\uff0c\u5c06\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#6runtime-constant-pool","title":"6.\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff08Runtime Constant Pool\uff09","text":"<p>Class\u6587\u4ef6\u4e2d\u9664\u4e86\u6709\u7c7b\u7684\u7248\u672c\u3001\u5b57\u6bb5\u3001\u65b9\u6cd5\u3001\u63a5\u53e3\u7b49\u63cf\u8ff0\u4fe1\u606f\u5916\uff0c\u8fd8\u6709\u4e00\u9879\u4fe1\u606f\u662f\u5e38\u91cf\u6c60\uff08Constant Pool Table\uff09\uff0c\u7528\u4e8e\u5b58\u653e\u7f16\u8bd1\u671f\u751f\u6210\u7684\u5404\u79cd\u5b57\u9762\u91cf\u548c\u7b26\u53f7\u5f15\u7528\uff0c\u8fd9\u90e8\u5206\u5185\u5bb9\u5c06\u5728\u7c7b\u52a0\u8f7d\u540e\u8fdb\u5165\u65b9\u6cd5\u533a\u7684\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\u4e2d\u5b58\u653e\u3002</p> <ul> <li>\u76f8\u5bf9\u4e8eClass\u6587\u4ef6\u5e38\u91cf\u6c60\u7684\u4e00\u4e2a\u91cd\u8981\u7279\u5f81\u662f\u5177\u5907\u52a8\u6001\u6027\uff0c\u4f53\u73b0\u5728\u5e76\u975e\u53ea\u6709\u9884\u7f6e\u5165Class\u6587\u4ef6\u4e2d\u5e38\u91cf\u6c60\u7684\u5185\u5bb9\u624d\u80fd\u8fdb\u5165\u65b9\u6cd5\u533a\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff0c\u8fd0\u884c\u671f\u95f4\u4e5f\u53ef\u80fd\u5c06\u65b0\u7684\u5e38\u91cf\u653e\u5165\u6c60\u4e2d\u3002</li> <li>\u662f\u65b9\u6cd5\u533a\u7684\u4e00\u90e8\u5206\uff0c\u4f1a\u53d7\u5230\u65b9\u6cd5\u533a\u5185\u5b58\u7684\u9650\u5236\u3002</li> <li>\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u5f53\u5e38\u91cf\u6c60\u65e0\u6cd5\u518d\u7533\u8bf7\u5230\u5185\u5b58\u65f6\u4f1a\u629b\u51faOutOfMemoryError\u5f02\u5e38\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#hotspot","title":"HotSpot\u865a\u62df\u673a\u5bf9\u8c61\u63a2\u79d8","text":"<p>\u5728\u5927\u81f4\u77e5\u9053\u4e86\u865a\u62df\u673a\u5185\u5b58\u7684\u6982\u51b5\u540e\uff0c\u8981\u60f3\u8fdb\u4e00\u6b65\u4e86\u89e3\u8fd9\u4e9b\u865a\u62df\u673a\u5185\u5b58\u4e2d\u7684\u6570\u636e\u7684\u5176\u4ed6\u7ec6\u8282\uff0c\u6211\u4eec\u9488\u5bf9\u5e38\u7528\u7684\u865a\u62df\u673aHotSpot\u548c\u5e38\u7528\u7684\u5185\u5b58\u533a\u57dfJava\u5806\u4e3a\u4f8b\uff0c\u63a2\u8ba8HotSpot\u5728Java\u5806\u4e2d\u5bf9\u8c61\u7684\u5206\u914d\u3001\u5e03\u5c40\u548c\u8bbf\u95ee\u7684\u5168\u8fc7\u7a0b\u3002</p>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#1","title":"1.\u5bf9\u8c61\u7684\u521b\u5efa","text":"<ul> <li>\u7c7b\u52a0\u8f7d\u68c0\u67e5 \u865a\u62df\u673a\u9047\u5230\u4e00\u6761new\u6307\u4ee4\u65f6\uff0c\u9996\u5148\u5c06\u53bb\u68c0\u67e5new\u6307\u4ee4\u7684\u53c2\u6570\u662f\u5426\u80fd\u5728\u5e38\u91cf\u6c60\u4e2d\u5b9a\u4f4d\u5230\u4e00\u4e2a\u7c7b\u7684\u7b26\u53f7\u5f15\u7528\u5e76\u4e14\u8be5\u7b26\u53f7\u5f15\u7528\u4ee3\u8868\u7684\u7c7b\u662f\u5426\u88ab\u52a0\u8f7d\u3001\u89e3\u6790\u548c\u521d\u59cb\u5316\u8fc7\uff0c\u82e5\u6ca1\u6709\uff0c\u5219\u9700\u8981\u6267\u884c\u76f8\u5e94\u7684\u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u3002</li> <li>\u5206\u914d\u5185\u5b58\uff1a\u7531Java\u5806\u4e2d\u7684\u5185\u5b58\u662f\u5426\u89c4\u6574\u51b3\u5b9a\u5982\u4f55\u7ed9\u65b0\u751f\u5bf9\u8c61\u5206\u914d\u5185\u5b58\u3002</li> <li>\u82e5\u89c4\u6574\uff0c\u91c7\u7528\u201c\u6307\u9488\u78b0\u649e\u201d\u5206\u914d\u65b9\u5f0f\uff1a<ul> <li>\u8fc7\u7a0b\uff1a\u5c06\u7528\u8fc7\u7684\u5185\u5b58\u653e\u5728\u4e00\u8fb9\uff0c\u7a7a\u95f2\u7684\u5185\u5b58\u653e\u5728\u53e6\u4e00\u8fb9\uff0c\u4e2d\u95f4\u653e\u7740\u6307\u9488\u4f5c\u4e3a\u5206\u754c\u70b9\u7684\u6307\u793a\u5668\uff0c\u5206\u914d\u5185\u5b58\u65f6\u628a\u6307\u9488\u5411\u7a7a\u95f2\u7a7a\u95f4\u632a\u8fc7\u4e00\u6bb5\u4e0e\u5bf9\u8c61\u5927\u5c0f\u76f8\u7b49\u7684\u8ddd\u79bb\u3002</li> <li>\u5e94\u7528\uff1a\u4f7f\u7528Serial\uff0cParNew\u7b49\u5e26Compact\u8fc7\u7a0b\u7684\u6536\u96c6\u5668\u662f\uff0c\u4f1a\u91c7\u7528\u6307\u9488\u78b0\u649e\u6765\u5206\u914d\u3002</li> </ul> </li> <li>\u82e5\u4e0d\u89c4\u6574\uff0c\u91c7\u7528\u201c\u7a7a\u95f2\u5217\u8868\u201d\u5206\u914d\u65b9\u5f0f\uff1a<ul> <li>\u8fc7\u7a0b\uff1a\u7ef4\u62a4\u4e00\u4e2a\u8bb0\u5f55\u53ef\u7528\u5185\u5b58\u7684\u5217\u8868\u3002\u5f53\u5206\u914d\u5185\u5b58\u65f6\uff0c\u627e\u5230\u4e00\u5757\u8db3\u591f\u5927\u7684\u7a7a\u95f4\u5212\u5206\u7ed9\u5bf9\u8c61\u5b9e\u4f8b\u5e76\u66f4\u65b0\u8868\u8bb0\u5f55\u3002</li> <li>\u5e94\u7528\uff1a\u4f7f\u7528CMS\u8fd9\u79cd\u57fa\u4e8eMark-Sweep\u7b97\u6cd5\u7684\u6536\u96c6\u5668\uff0c\u4f1a\u91c7\u7528\u7a7a\u95f2\u5217\u8868\u3002</li> </ul> </li> </ul> <p>\u4fdd\u8bc1\u5185\u5b58\u5206\u914d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u89e3\u51b3\u65b9\u6848\uff1a * \u5bf9\u5206\u914d\u5185\u5b58\u7a7a\u95f4\u7684\u52a8\u4f5c\u8fdb\u884c\u540c\u6b65\u5904\u7406(\u65b9\u6cd5\u662f\u91c7\u7528CAS\u548c\u5931\u8d25\u91cd\u8bd5\u6765\u4fdd\u8bc1\u66f4\u65b0\u64cd\u4f5c\u7684\u539f\u5b50\u6027) * \u628a\u5185\u5b58\u5206\u914d\u7684\u52a8\u4f5c\u6309\u7167\u7ebf\u7a0b\u5212\u5206\u5728\u4e0d\u540c\u7684\u7a7a\u95f4\u4e4b\u4e2d\u8fdb\u884c(\u6bcf\u4e2a\u7ebf\u7a0b\u5728Java\u5806\u4e2d\u9884\u5148\u5206\u914d\u4e00\u5c0f\u5757\u5185\u5b58\uff0c\u79f0\u4e3a\u672c\u5730\u7ebf\u7a0b\u5206\u914d\u7f13\u51b2(Thread Local Allocation Buffer,TLAB),\u5f53TLAB\u7528\u5b8c\u9700\u8981\u91cd\u65b0\u5206\u914d\u65b0\u7684TLAB\u518d\u540c\u6b65\u9501\u5b9a)\u3002</p> <ul> <li>\u8bbe\u7f6e\u5bf9\u8c61\u5934\uff1a\u5c06\u5bf9\u8c61\u7684\u6240\u5c5e\u7c7b\u3001\u627e\u5230\u7c7b\u7684\u5143\u6570\u636e\u4fe1\u606f\u7684\u65b9\u5f0f\u3001\u5bf9\u8c61\u7684\u54c8\u5e0c\u7801\u3001\u5bf9\u8c61\u7684GC\u5206\u4ee3\u5e74\u9f84\u7b49\u4fe1\u606f\u5b58\u653e\u5728\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u4e2d\u3002 <p>\u7ecf\u8fc7\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u4e00\u4e2a\u5bf9\u8c61\u5c31\u4ea7\u751f\u4e86\uff0c\u4f46\u6b64\u65f6\u6240\u6709\u7684\u5b57\u6bb5\u90fd\u8fd8\u4e3a\u96f6\uff0c\u8fd8\u9700\u8981\u6267\u884c<code>&lt;init&gt;</code>\u65b9\u6cd5\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u624d\u80fd\u6210\u4e3a\u771f\u6b63\u53ef\u7528\u7684\u5bf9\u8c61\u3002</p> </li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#2","title":"2.\u5bf9\u8c61\u7684\u5185\u5b58\u5e03\u5c40","text":"<p>\u5206\u4e3a3\u5757\u533a\u57df\uff1a\u5bf9\u8c61\u5934(Header),\u5b9e\u4f8b\u6570\u636e(Instance Data)\u548c\u5bf9\u9f50\u586b\u5145(Padding). * \u5bf9\u8c61\u5934\u5206\u4e3a\u4e24\u90e8\u5206\u4fe1\u606f   * Mark Word\uff1a\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u81ea\u8eab\u7684\u8fd0\u884c\u65f6\u6570\u636e\uff0c\u5982\u54c8\u5e0c\u5417\uff0cGC\u5206\u4ee3\u5e74\u9f84\u3001\u6240\u72b6\u6001\u6807\u5fd7\u3001\u7ebf\u7a0b\u6301\u6709\u7684\u9501\u3001\u504f\u5411\u7ebf\u7a0bID\u3001\u504f\u5411\u65f6\u95f4\u6233\u7b49\u3002   * \u7c7b\u578b\u6307\u9488\uff1a\u7528\u4e8e\u786e\u5b9a\u8fd9\u4e2a\u5bf9\u8c61\u662f\u90a3\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u3002</p> <ul> <li>\u5b9e\u4f8b\u6570\u636e\uff1a\u5b58\u50a8\u771f\u6b63\u7684\u6709\u6548\u4fe1\u606f\uff0c\u662f\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u5b9a\u4e49\u7684\u5404\u79cd\u7c7b\u578b\u7684\u5b57\u6bb5\u5185\u5bb9\u3002\u5b58\u50a8\u987a\u5e8f\u4f1a\u53d7\u865a\u62df\u673a\u5206\u914d\u7b56\u7565\u53c2\u6570\u548c\u5b57\u6bb5\u5728Java\u6e90\u7801\u4e2d\u5b9a\u4e49\u987a\u5e8f\u8fd9\u4e24\u4e2a\u56e0\u7d20\u5f71\u54cd\u3002</li> <li>\u5bf9\u9f50\u586b\u5145\uff1a\u5360\u4f4d\u7b26\uff0c\u5e2e\u52a9\u8865\u5168\u672a\u5bf9\u9f50\u7684\u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\u90e8\u5206\uff08\u4fdd\u8bc1\u662f8\u5b57\u8282\u7684\u500d\u6570\uff09\uff0c\u975e\u5fc5\u9700\u3002</li> </ul>"},{"location":"JVM/1_Java%E7%9A%84%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/#3","title":"3.\u5bf9\u8c61\u7684\u8bbf\u95ee\u5b9a\u4f4d:\u4e3b\u6d41\u6709\u4f7f\u7528\u53e5\u67c4\u548c\u76f4\u63a5\u6307\u9488\u4e24\u79cd\u65b9\u5f0f","text":"<ul> <li>\u4f7f\u7528\u53e5\u67c4\uff1a\uff1a\u5728Java\u5806\u4e2d\u5212\u5206\u51fa\u4e00\u5757\u5185\u5b58\u6765\u4f5c\u4e3a\u53e5\u67c4\u6c60\uff0creference\u5b58\u50a8\u7684\u662f\u5bf9\u8c61\u7684\u53e5\u67c4\u5730\u5740\uff0c\u5728\u53e5\u67c4\u4e2d\u5305\u542b\u4e86\u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\u4e0e\u7c7b\u578b\u6570\u636e\u5404\u81ea\u7684\u5177\u4f53\u5730\u5740\u4fe1\u606f\u3002\u597d\u5904\uff1areference\u4e2d\u5b58\u50a8\u7684\u662f\u7a33\u5b9a\u7684\u53e5\u67c4\u5730\u5740\uff0c\u5728\u5bf9\u8c61\u88ab\u79fb\u52a8\u65f6\u53ea\u4f1a\u6539\u53d8\u53e5\u67c4\u4e2d\u7684\u5b9e\u4f8b\u6570\u636e\u6307\u9488\uff0c\u800creference\u672c\u8eab\u4e0d\u9700\u8981\u4fee\u6539\u3002</li> </ul> <p> * \u901a\u8fc7\u76f4\u63a5\u6307\u9488\u8bbf\u95ee\u5bf9\u8c61\uff1a\u5728Java\u5806\u5bf9\u8c61\u7684\u5e03\u5c40\u4e2d\u8003\u8651\u5982\u4f55\u653e\u7f6e\u8bbf\u95ee\u7c7b\u578b\u6570\u636e\u7684\u76f8\u5173\u4fe1\u606f\uff0creference\u5b58\u50a8\u7684\u76f4\u63a5\u5c31\u662f\u5bf9\u8c61\u5730\u5740\u3002\u597d\u5904\uff1a\u901f\u5ea6\u66f4\u5feb\uff0c\u8282\u7701\u4e86\u4e00\u6b21\u6307\u9488\u5b9a\u4f4d\u7684\u65f6\u95f4\u5f00\u9500\u3002</p> <p></p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/","title":"2 JVM\u7684GC\u548c\u5185\u5b58\u5206\u914d","text":""},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_1","title":"\u54ea\u4e9b\u5185\u5b58\u9700\u8981\u56de\u6536","text":"<p>Java\u7684\u5185\u5b58\u533a\u57df\u4e2d\u4ecb\u7ecd\u4e86Java\u5185\u5b58\u8fd0\u884c\u65f6\u533a\u57df\u7684\u5404\u4e2a\u90e8\u5206\uff0c\u5176\u4e2d\u7a0b\u5e8f\u8ba1\u6570\u5668\u3001\u865a\u62df\u673a\u6808\u3001\u672c\u5730\u65b9\u6cd5\u68083\u4e2a\u533a\u57df\u968f\u7ebf\u7a0b\u800c\u751f\uff0c\u968f\u7ebf\u7a0b\u800c\u706d\u3002</p> <p>\u6808\u4e2d\u7684\u6808\u5e27\u968f\u7740\u65b9\u6cd5\u7684\u8fdb\u5165\u548c\u9000\u51fa\u800c\u6709\u6761\u4e0d\u7d0a\u5730\u6267\u884c\u503c\u51fa\u6808\u548c\u5165\u6808\u7684\u64cd\u4f5c\u3002\u6bcf\u4e00\u4e2a\u6808\u5e27\u4e2d\u5206\u914d\u591a\u5c11\u5185\u5b58\u57fa\u672c\u4e0a\u662f\u5728\u7c7b\u7ed3\u6784\u786e\u5b9a\u4e0b\u6765\u5c31\u5df2\u77e5\u7684\uff0c\u5927\u4f53\u4e0a\u8ba4\u4e3a\u8fd9\u90e8\u5206\u5185\u5b58\u65f6\u7f16\u8bd1\u5668\u53ef\u77e5\u7684\u3002\u8fd9\u90e8\u5206\u5185\u5b58\u5728\u65b9\u6cd5\u7ed3\u675f\u6216\u8005\u7ebf\u7a0b\u7ed3\u675f\u65f6\u5c31\u81ea\u52a8\u56de\u6536\u4e86\u3002</p> <p>\u800cJava\u5806\u548c\u65b9\u6cd5\u533a\u5219\u4e0d\u4e00\u6837\uff0c\u4e00\u4e2a\u63a5\u53e3\u4e2d\u7684\u591a\u4e2a\u5b9e\u73b0\u7c7b\u9700\u8981\u7684\u5185\u5b58\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u7684\u591a\u4e2a\u5206\u652f\u9700\u8981\u7684\u5185\u5b58\u4e5f\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u624d\u80fd\u77e5\u9053\u4f1a\u521b\u5efa\u54ea\u4e9b\u5bf9\u8c61\uff0c\u8fd9\u90e8\u5206\u5185\u5b58\u7684\u5206\u914d\u548c\u56de\u6536\u90fd\u662f\u52a8\u6001\u7684\uff0cJava\u4e2dGC\u5173\u6ce8\u7684\u5c31\u662f\u8fd9\u90e8\u5206\u5185\u5b58\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_2","title":"\u5185\u5b58\u4ec0\u4e48\u65f6\u5019\u56de\u6536","text":"<p>\u5206\u4e3aJava\u5806\u7684\u5185\u5b58\u56de\u6536\u548c\u65b9\u6cd5\u533a\u7684\u5185\u5b58\u56de\u6536</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#java","title":"Java\u5806\u7684\u5185\u5b58\u56de\u6536","text":"<p>Java\u5806\u4e2d\u5b58\u653e\u7684\u51e0\u4e4e\u662f\u6240\u6709\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff0cGC\u56de\u6536\u8fd9\u90e8\u5206\u5185\u5b58\u524d\uff0c\u9700\u8981\u5224\u65ad\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5b58\u6d3b\u72b6\u6001\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_3","title":"\u5bf9\u8c61\u5b58\u6d3b\u5224\u5b9a\u7b97\u6cd5","text":"<p>\u6982\u5ff5\uff1a\u5f15\u7528\u7684\u56db\u79cd\u7c7b\u578b * \u5f3a\u5f15\u7528\uff08StrongReference\uff09   * \u5177\u6709\u5f3a\u5f15\u7528\u7684\u5bf9\u8c61\u4e0d\u4f1a\u88abGC\uff1b   * \u5373\u4fbf\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\uff0cJVM\u5b81\u613f\u629b\u51faOutOfMemoryError\u4f7f\u7a0b\u5e8f\u5f02\u5e38\u7ec8\u6b62\uff0c\u4e5f\u4e0d\u4f1a\u968f\u610f\u56de\u6536\u5177\u6709\u5f3a\u5f15\u7528\u7684\u5bf9\u8c61\u3002 * \u8f6f\u5f15\u7528\uff08SoftReference\uff09   * \u53ea\u5177\u6709\u8f6f\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u4f1a\u5728\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\u7684\u65f6\u5019\u88abGC\uff0c\u5982\u679c\u56de\u6536\u4e4b\u540e\u5185\u5b58\u4ecd\u4e0d\u8db3\uff0c\u624d\u4f1a\u629b\u51faOOM\u5f02\u5e38\uff1b   * \u8f6f\u5f15\u7528\u5e38\u7528\u4e8e\u63cf\u8ff0\u6709\u7528\u4f46\u5e76\u975e\u5fc5\u9700\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982\u5b9e\u73b0\u5185\u5b58\u654f\u611f\u7684\u9ad8\u901f\u7f13\u5b58\u3002 * \u5f31\u5f15\u7528\uff08WeakReference\uff09   * \u53ea\u88ab\u5f31\u5f15\u7528\u5173\u8054\u7684\u5bf9\u8c61\uff0c\u65e0\u8bba\u5f53\u524d\u5185\u5b58\u662f\u5426\u8db3\u591f\u90fd\u4f1a\u88abGC\uff1b   * \u5f3a\u5ea6\u6bd4\u8f6f\u5f15\u7528\u66f4\u5f31\uff0c\u5e38\u7528\u4e8e\u63cf\u8ff0\u975e\u5fc5\u9700\u5bf9\u8c61\u3002 * \u865a\u5f15\u7528\uff08PhantomReference\uff09   * \u4ec5\u6301\u6709\u865a\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u53ef\u80fd\u88abGC   * \u5e38\u7528\u4e8e\u8ddf\u8e2a\u5bf9\u8c61\u88abGC\u56de\u6536\u7684\u6d3b\u52a8\uff1b   * \u5fc5\u987b\u548c\u5f15\u7528\u961f\u5217 \uff08ReferenceQueue\uff09\u8054\u5408\u4f7f\u7528\uff0c\u5f53\u5783\u573e\u56de\u6536\u5668\u51c6\u5907\u56de\u6536\u4e00\u4e2a\u5bf9\u8c61\u65f6\uff0c\u5982\u679c\u53d1\u73b0\u5b83\u8fd8\u6709\u865a\u5f15\u7528\uff0c\u5c31\u4f1a\u5728\u56de\u6536\u5bf9\u8c61\u7684\u5185\u5b58\u4e4b\u524d\uff0c\u628a\u8fd9\u4e2a\u865a\u5f15\u7528\u52a0\u5165\u5230\u4e0e\u4e4b\u5173\u8054\u7684\u5f15\u7528\u961f\u5217\u4e2d\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#a","title":"a. \u5f15\u7528\u8ba1\u6570\u6cd5","text":"<p>\u5b9a\u4e49\uff1a\u7ed9\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5f15\u7528\u8ba1\u6570\u5668\uff0c\u6bcf\u5f53\u6709\u4e00\u4e2a\u5730\u65b9\u5f15\u7528\u5b83\u65f6\uff0c\u8ba1\u6570\u5668\u503c\u5c31\u52a01\uff1b\u5f53\u5f15\u7528\u5931\u6548\u65f6\uff0c\u8ba1\u6570\u5668\u503c\u5c31\u51cf1\uff1b\u4efb\u4f55\u65f6\u523b\u8ba1\u6570\u5668\u4e3a0\u7684\u5bf9\u8c61\u5c31\u662f\u4e0d\u53ef\u80fd\u518d\u88ab\u4f7f\u7528\u7684\u3002</p> <p>\u7136\u800c\u5728\u4e3b\u6d41\u7684Java\u865a\u62df\u673a\u91cc\u672a\u9009\u7528\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5\u6765\u7ba1\u7406\u5185\u5b58\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u5b83\u96be\u4ee5\u89e3\u51b3\u5bf9\u8c61\u4e4b\u95f4\u76f8\u4e92\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u51fa\u73b0\u4e86\u53e6\u4e00\u79cd\u5bf9\u8c61\u5b58\u6d3b\u5224\u5b9a\u7b97\u6cd5\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#b","title":"b.\u53ef\u8fbe\u6027\u5206\u6790\u6cd5","text":"<p>\u5b9a\u4e49\uff1a\u901a\u8fc7\u4e00\u7cfb\u5217\u88ab\u79f0\u4e3a\u300eGC Roots\u300f\u7684\u5bf9\u8c61\u4f5c\u4e3a\u8d77\u59cb\u70b9\uff0c\u4ece\u8fd9\u4e9b\u8282\u70b9\u5f00\u59cb\u5411\u4e0b\u641c\u7d22\uff0c\u641c\u7d22\u6240\u8d70\u8fc7\u7684\u8def\u5f84\u79f0\u4e3a\u5f15\u7528\u94fe\uff0c\u5f53\u4e00\u4e2a\u5bf9\u8c61\u5230GC Roots\u6ca1\u6709\u4efb\u4f55\u5f15\u7528\u94fe\u76f8\u8fde\u65f6\uff0c\u5219\u8bc1\u660e\u6b64\u5bf9\u8c61\u662f\u4e0d\u53ef\u7528\u7684\u3002</p> <p>\u53ef\u4f5c\u4e3aGC Roots\u7684\u5bf9\u8c61 * \u865a\u62df\u673a\u6808\u4e2d\u5f15\u7528\u7684\u5bf9\u8c61\uff0c\u53ea\u8981\u662f\u6307\u6808\u4e2d\u7684<code>\u672c\u5730\u53d8\u91cf</code> * \u672c\u5730\u65b9\u6cd5\u6808\u4e2d\u7684<code>Native\u65b9\u6cd5</code>\u5f15\u7528\u7684\u5bf9\u8c61 * \u65b9\u6cd5\u533a\u4e2d<code>\u7c7b\u9759\u6001\u5c5e\u6027</code>\u5f15\u7528\u7684\u5bf9\u8c61 * \u65b9\u6cd5\u533a\u4e2d<code>\u5e38\u91cf</code>\u5f15\u7528\u7684\u5bf9\u8c61</p> <p></p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u4e2d\u88ab\u5224\u5b9a\u4e0d\u53ef\u8fbe\u7684\u5bf9\u8c61\u8fd8\u672a\u771f\u7684\u5224\u300e\u6b7b\u5211\u300f\uff0c\u81f3\u5c11\u8981\u7ecf\u5386\u4e24\u6b21\u6807\u8bb0\u8fc7\u7a0b\uff1a\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u6709\u5fc5\u8981\u6267\u884cfinalize()\u65b9\u6cd5\uff1b\u82e5\u88ab\u5224\u5b9a\u4e3a\u6709\u5fc5\u8981\u6267\u884cfinalize()\u65b9\u6cd5\uff0c\u4e4b\u540e\u8fd8\u4f1a\u5bf9\u5bf9\u8c61\u518d\u8fdb\u884c\u4e00\u6b21\u7b5b\u9009\uff0c\u5982\u679c\u5bf9\u8c61\u80fd\u5728finalize()\u4e2d\u91cd\u65b0\u4e0e\u5f15\u7528\u94fe\u4e0a\u7684\u4efb\u4f55\u4e00\u4e2a\u5bf9\u8c61\u5efa\u7acb\u5173\u8054\uff0c\u5c06\u88ab\u79fb\u9664\u51fa\u201c\u5373\u5c06\u56de\u6536\u201d\u7684\u96c6\u5408\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_4","title":"\u65b9\u6cd5\u533a\u7684\u56de\u6536","text":"<p>\u65b9\u6cd5\u533a\u5728HotSpot\u865a\u62df\u673a\u4e2d\u88ab\u79f0\u4e3a\u6c38\u4e45\u4ee3\u3002 \u6c38\u4e45\u4ee3\u7684\u5783\u573e\u6536\u96c6\u4e3b\u8981\u56de\u6536\u4e24\u90e8\u5206\u5185\u5b58\uff1a\u5e9f\u5f03\u5e38\u91cf\u548c\u65e0\u7528\u7684\u7c7b\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#a_1","title":"a.\u5e9f\u5f03\u5e38\u91cf\u7684\u56de\u6536","text":"<p>\u4e0e\u56de\u6536Java\u5806\u4e2d\u7684\u5bf9\u8c61\u7684GC\u5f88\u7c7b\u4f3c\uff0c\u5373\u5728\u4efb\u4f55\u5730\u65b9\u90fd\u672a\u88ab\u5f15\u7528\u7684\u5e38\u91cf\u4f1a\u88abGC\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#b_1","title":"b.\u65e0\u7528\u7684\u7c7b\u56de\u6536","text":"<p>\u65e0\u7528\u7684\u7c7b\u9700\u6ee1\u8db3\u4e00\u4e0b\u4e09\u4e2a\u6761\u4ef6\u624d\u4f1a\u88abGC\uff1a * \u8be5\u7c7b\u6240\u6709\u7684\u5b9e\u4f8b\u90fd\u5df2\u88ab\u56de\u6536\uff0c\u5373Java\u5806\u4e2d\u4e0d\u5b58\u5728\u8be5\u7c7b\u7684\u4efb\u4f55\u5b9e\u4f8b\uff1b * \u52a0\u8f7d\u8be5\u7c7b\u7684ClassLoader\u5df2\u7ecf\u88ab\u56de\u6536\uff1b * \u8be5\u7c7b\u5bf9\u5e94\u7684java.lang.Class\u5bf9\u8c61\u6ca1\u5728\u4efb\u4f55\u5730\u65b9\u88ab\u5f15\u7528\uff0c\u5373\u65e0\u6cd5\u5728\u4efb\u4f55\u5730\u65b9\u901a\u8fc7\u53cd\u5c04\u8bbf\u95ee\u8be5\u7c7b\u7684\u65b9\u6cd5\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_5","title":"\u5185\u5b58\u5982\u4f55\u56de\u6536","text":"<p>\u5982\u4f55\u56de\u6536\u4e5f\u5c31\u662f\u8c08\u5230\u5783\u573e\u56de\u6536\u7b97\u6cd5\uff1a</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_6","title":"\u5783\u573e\u6536\u96c6\u7b97\u6cd5","text":""},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_7","title":"\u5206\u4ee3\u6536\u96c6\u7b97\u6cd5","text":"<ul> <li>\u6839\u636e\u5bf9\u8c61\u5b58\u6d3b\u5468\u671f\u7684\u4e0d\u540c\uff0c\u5c06Java\u5806\u5212\u5206\u4e3a\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3\uff0c\u5e76\u6839\u636e\u5404\u4e2a\u5e74\u4ee3\u7684\u7279\u70b9\u91c7\u7528\u6700\u9002\u5f53\u7684\u6536\u96c6\u7b97\u6cd5\u3002</li> <li>\u65b0\u751f\u4ee3\uff1a\u5927\u6279\u5bf9\u8c61\u6b7b\u53bb\uff0c\u53ea\u6709\u5c11\u91cf\u5b58\u6d3b\u3002\u4f7f\u7528<code>\u590d\u5236\u7b97\u6cd5</code>,\u53ea\u9700\u8981\u590d\u5236\u5c11\u91cf\u5b58\u6d3b\u5bf9\u8c61\u5373\u53ef\u3002</li> <li> <p>\u8001\u5e74\u4ee3\uff1a\u5bf9\u8c61\u5b58\u6d3b\u7387\u9ad8\u3002\u4f7f\u7528<code>\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5</code>\u548c<code>\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5</code>\uff0c\u53ea\u9700\u8981\u6807\u8bb0\u8f83\u5c11\u7684\u56de\u6536\u5bf9\u8c61\u5373\u53ef\u3002</p> </li> <li> <p>\u662f\u5f53\u524d\u5546\u4e1a\u865a\u62df\u673a\u90fd\u91c7\u7528\u7684\u4e00\u79cd\u7b97\u6cd5\u3002</p> </li> </ul> <p>\u63a5\u4e0b\u6765\u4f9d\u6b21\u4ecb\u7ecd\u4ee5\u4e0a\u63d0\u53ca\u7684\u4e09\u79cd\u7b97\u6cd5\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_8","title":"\u590d\u5236\u7b97\u6cd5","text":"<ul> <li>\u628a\u53ef\u7528\u5185\u5b58\u5bb9\u91cf\u5212\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u7684\u4e24\u5757\uff0c\u6bcf\u6b21\u4f7f\u7528\u5176\u4e2d\u7684\u4e00\u5757\u3002\u5f53\u8fd9\u4e00\u5757\u7684\u5185\u5b58\u7528\u5c3d\u540e\uff0c\u628a\u8fd8\u5b58\u6d3b\u7740\u7684\u5bf9\u8c61<code>\u590d\u5236</code>\u5230\u53e6\u5916\u4e00\u5757\u4e0a\u9762\uff0c\u518d\u5c06\u8fd9\u4e00\u5757\u5185\u5b58\u7a7a\u95f4\u4e00\u6b21\u6e05\u7406\u6389\u3002</li> <li>\u4f18\u70b9\uff1a\u6bcf\u6b21\u90fd\u662f\u5bf9\u6574\u4e2a\u534a\u533a\u8fdb\u884c\u5185\u5b58\u56de\u6536\uff0c\u65e0\u9700\u8003\u8651\u5185\u5b58\u788e\u7247\u7b49\u590d\u6742\u60c5\u51b5\uff0c\u53ea\u8981\u79fb\u52a8\u5806\u9876\u6307\u9488\uff0c\u6309\u987a\u5e8f\u5206\u914d\u5185\u5b58\u5373\u53ef\uff0c\u5b9e\u73b0\u7b80\u5355\uff0c\u8fd0\u884c\u9ad8\u6548\u3002</li> <li>\u7f3a\u70b9\uff1a\u6bcf\u6b21\u53ef\u4f7f\u7528\u7684\u5185\u5b58\u7f29\u5c0f\u4e3a\u539f\u6765\u7684\u4e00\u534a\uff0c\u5185\u5b58\u4f7f\u7528\u7387\u4f4e\u3002</li> </ul> <p>\u6709\u7814\u7a76\u8868\u660e\u65b0\u751f\u4ee3\u4e2d\u7684\u5bf9\u8c6198%\u662f\u671d\u751f\u5915\u6b7b\u7684\uff0c\u56e0\u6b64\u6ca1\u5fc5\u8981\u6309\u71671:1\u6765\u5212\u5206\u5185\u5b58\u7a7a\u95f4\uff0c\u800c\u662f\u5206\u4e3a\u4e00\u5757\u8f83\u5927\u7684Eden\u7a7a\u95f4\u548c\u4e24\u5757\u8f83\u5c0f\u7684Survivor\u7a7a\u95f4\uff0c\u5728HotSpot\u865a\u62df\u673a\u4e2d\u9ed8\u8ba4\u6bd4\u4f8b\u4e3a8:1:1\u3002\u6bcf\u6b21\u4f7f\u7528Eden\u548c\u4e00\u5757Survivor\uff0c\u56de\u6536\u65f6\u5c06\u8fd9\u4e24\u5757\u4e2d\u5b58\u6d3b\u7740\u7684\u5bf9\u8c61\u4e00\u6b21\u6027\u5730\u590d\u5236\u5230\u53e6\u5916\u4e00\u5757Survivor\u4e0a\uff0c\u518d\u505a\u6e05\u7406\u3002\u53ef\u89c1\u53ea\u670910%\u7684\u5185\u5b58\u4f1a\u88ab\u201c\u6d6a\u8d39\u201d\uff0c\u5018\u82e5Survivor\u7a7a\u95f4\u4e0d\u8db3\u8fd8\u9700\u8981\u4f9d\u8d56\u5176\u4ed6\u5185\u5b58\uff08\u8001\u5e74\u4ee3\uff09\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\u3002</p> <p></p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#-","title":"\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5","text":"<ul> <li>\u9996\u5148\u662f<code>\u6807\u8bb0</code>\u51fa\u6240\u6709\u9700\u8981\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u7136\u540e\u7edf\u4e00<code>\u6e05\u9664</code>\u6240\u6709\u88ab\u6807\u8bb0\u7684\u5bf9\u8c61\u3002</li> <li>\u662f\u6700\u57fa\u7840\u7684\u6536\u96c6\u7b97\u6cd5\u3002</li> <li>\u7f3a\u70b9\uff1a<code>\u6807\u8bb0</code>\u548c<code>\u6e05\u9664</code>\u7684\u6548\u7387\u4e0d\u9ad8\uff1b\u7a7a\u95f4\u788e\u7247\u592a\u591a\uff0c<code>\u6807\u8bb0-\u6e05\u9664</code>\u4e4b\u540e\u4ea7\u751f\u5927\u91cf\u4e0d\u8fde\u7eed\u7684\u5185\u5b58\u788e\u7247\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u540e\u7eed\u9700\u8981\u5206\u914d\u8f83\u5927\u5bf9\u8c61\u65f6\uff0c\u56e0\u65e0\u6cd5\u627e\u5230\u8db3\u591f\u7684\u8fde\u7eed\u5185\u5b58\u800c\u63d0\u524d\u89e6\u53d1\u53e6\u4e00\u6b21GC\uff0c\u5f71\u54cd\u7cfb\u7edf\u6027\u80fd.</li> </ul>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#-_1","title":"\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5","text":"<ul> <li>\u9996\u5148<code>\u6807\u8bb0</code>\u51fa\u6240\u6709\u9700\u8981\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u7136\u540e\u8fdb\u884c<code>\u6574\u7406</code>\uff0c\u4f7f\u5f97\u5b58\u6d3b\u7684\u5bf9\u8c61\u90fd\u5411\u4e00\u7aef\u79fb\u52a8\uff0c\u6700\u540e\u76f4\u63a5\u6e05\u7406\u6389\u7aef\u8fb9\u8fb9\u754c\u4ee5\u5916\u7684\u5185\u5b58\u3002</li> <li>\u6709\u70b9\uff1a\u5373\u6ca1\u6709\u6d6a\u8d3950%\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u53c8\u4e0d\u5b58\u5728\u7a7a\u95f4\u788e\u7247\u95ee\u9898\uff0c\u6027\u4ef7\u6bd4\u8f83\u9ad8\u3002</li> <li>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8001\u5e74\u4ee3\u4f1a\u9009\u62e9\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5\u3002</li> </ul>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#hotspot","title":"HotSpot\u7b97\u6cd5\u5b9e\u73b0&amp;\u5783\u573e\u56de\u6536\u5668","text":"<p>\u63a5\u4e0b\u6765\u4ecb\u7ecd\u5982\u4f55\u5728HotSpot\u865a\u62df\u673a\u4e0a\u5b9e\u73b0\u5bf9\u8c61\u5b58\u6d3b\u5224\u5b9a\u7b97\u6cd5\u548c\u5783\u573e\u624b\u673a\u7b97\u6cd5\uff0c\u5e76\u4fdd\u8bc1\u865a\u62df\u673a\u9ad8\u6548\u6267\u884c\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_9","title":"\u679a\u4e3e\u6839\u8282\u70b9","text":"<p>\u4e3b\u6d41\u865a\u62df\u673a\u91c7\u7528\u7684\u90fd\u662f<code>\u51c6\u786e\u5f0fGC</code>,\u5728\u6267\u884c\u7cfb\u7edf\u505c\u987f\u4e4b\u540e\u65e0\u9700\u6267\u884c\u4e0a\u4e0b\u6587\u548c\u5168\u5c40\u7684\u5f15\u7528\u4f4d\u7f6e\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e9b\u529e\u6cd5\u76f4\u63a5\u83b7\u53d6\u5230\u5b58\u653e\u5bf9\u8c61\u7684\u5730\u65b9\uff0c\u5728HotSpot\u4e2d\u662f\u901a\u8fc7\u4e00\u7ec4\u79f0\u4e3a<code>OopMap</code>\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b9e\u73b0\u7684\uff0c\u5b8c\u6210\u7c7b\u52a0\u8f7d\u540e\u4f1a\u8ba1\u7b97\u51fa\u5bf9\u8c61\u5185\u4ec0\u4e48\u504f\u79fb\u91cf\u4e0a\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u6570\u636e\u8ba1\u7b97\u51fa\u6765\uff0c\u5728JIT\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u4e5f\u4f1a\u5728<code>\u7279\u5b9a\u7684\u4f4d\u7f6e</code>\u8bb0\u5f55\u4e0b\u6808\u548c\u5bc4\u5b58\u5668\u4e2d\u7684\u54ea\u4e9b\u4f4d\u7f6e\u662f\u5f15\u7528\u3002\u8fd9\u6837GC\u5728\u626b\u63cf\u65f6\u5c31\u53ef\u76f4\u63a5\u5f97\u77e5\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5e76\u5feb\u901f\u51c6\u786e\u5730\u5b8c\u6210GC Roots\u7684\u679a\u4e3e\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_10","title":"\u5b89\u5168\u70b9","text":"<p>\u4e0a\u8ff0\u201c\u7279\u5b9a\u7684\u4f4d\u7f6e\u201d\u88ab\u79f0\u4e3a\u5b89\u5168\u70b9\uff0c\u5373\u7a0b\u5e8f\u6267\u884c\u65f6\u5e76\u975e\u5728\u6240\u6709\u5730\u65b9\u90fd\u505c\u987f\u6267\u884cGC\uff0c\u53ea\u5728\u5230\u8fbe\u5b89\u5168\u70b9\u65f6\u624d\u6682\u505c\uff0c\u964d\u4f4eGC\u7684\u6210\u672c\u3002</p> <ul> <li>\u5b89\u5168\u70b9\u9009\u53d6\u7684\u6807\u51c6\uff1a\u53ef\u8ba9\u7a0b\u5e8f\u957f\u671f\u6267\u884c\u7684\u5730\u65b9\uff0c\u5982\u65b9\u6cd5\u8c03\u7528\uff0c\u5faa\u73af\u8df3\u8f6c\u3001\u5f02\u5e38\u8df3\u8f6c\u7b49\u5177\u6709\u6307\u4ee4\u5e8f\u5217\u590d\u7528\u7684\u7279\u5f81\u3002</li> <li>\u4f7f\u6240\u6709\u7ebf\u7a0b\u5728\u6700\u8fd1\u7684\u5b89\u5168\u70b9\u4e0a\u518d\u505c\u987f\u7684\u65b9\u6848\uff1a</li> <li>\u62a2\u5148\u5f0f\u4e2d\u65ad\uff1a\u65e0\u9700\u4ee3\u7801\u4e3b\u52a8\u914d\u5408\uff0c\u5728\u53d1\u751fGC\u65f6\u628a\u6240\u6709\u7684\u7ebf\u7a0b\u5168\u90e8\u4e2d\u65ad\uff0c\u82e5\u7ebf\u7a0b\u4e2d\u65ad\u5904\u4e0d\u5728\u5b89\u5168\u70b9\u4e0a\u5c31\u6062\u590d\u7ebf\u7a0b\uff0c\u8ba9\u5b83\u201c\u8dd1\u201d\u5230\u5b89\u5168\u70b9\u4e0a\u3002\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709\u865a\u62df\u673a\u91c7\u7528\u62a2\u5148\u5f0f\u4e2d\u65ad\u6765\u6682\u505c\u7ebf\u7a0b\u4ece\u800c\u54cd\u5e94GC\u4e8b\u4ef6\u3002</li> <li>\u4e3b\u52a8\u5f0f\u4e2d\u65ad\uff1a\u5728GC\u8981\u4e2d\u65ad\u7ebf\u7a0b\u65f6\u4e0d\u76f4\u63a5\u5bf9\u7ebf\u7a0b\u64cd\u4f5c\uff0c\u800c\u662f\u8bbe\u7f6e\u4e00\u4e2a\u4e2d\u65ad\u6807\u5fd7\uff0c\u8ba9\u5404\u4e2a\u7ebf\u7a0b\u5728\u6267\u884c\u65f6\u4e3b\u52a8\u8f6e\u8be2\u5b83\uff0c\u5f53\u4e2d\u65ad\u6807\u5fd7\u4e3a\u771f\u65f6\u5c31\u81ea\u5df1\u4e3b\u52a8\u4e2d\u65ad\u6302\u8d77\u3002</li> </ul>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_11","title":"\u5b89\u5168\u533a\u57df","text":"<p>\u5b89\u5168\u70b9\u673a\u5236\u53ea\u80fd\u4fdd\u8bc1\u7a0b\u5e8f\u6267\u884c\u65f6\uff0c\u5728\u4e0d\u592a\u957f\u7684\u65f6\u95f4\u5185\u9047\u5230\u53ef\u8fdb\u5165GC\u7684\u5b89\u5168\u70b9\uff0c\u4f46\u5728\u7a0b\u5e8f\u4e0d\u6267\u884c\u65f6\uff08\u5982\u7ebf\u7a0b\u5904\u4e8eSleep\u6216Blocked\u72b6\u6001\uff09\u7ebf\u7a0b\u65e0\u6cd5\u54cd\u5e94JVM\u7684\u4e2d\u65ad\u8bf7\u6c42\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u5b89\u5168\u533a\u57df\u6765\u89e3\u51b3\u3002</p> <ul> <li>\u5b89\u5168\u533a\u57df\uff1a\u5f15\u7528\u5173\u7cfb\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u7684\u4e00\u6bb5\u4ee3\u7801\u7247\u6bb5\uff0c\u5728\u5b89\u5168\u533a\u57df\u4e2d\u7684\u4efb\u610f\u5730\u65b9\u5f00\u59cbGC\u90fd\u662f\u5b89\u5168\u7684\uff0c\u53ef\u770b\u505a\u662f\u6269\u5c55\u7684\u5b89\u5168\u70b9\u3002</li> <li>\u6267\u884c\u8fc7\u7a0b\uff1a\u5f53\u7ebf\u7a0b\u6267\u884c\u5230\u5b89\u5168\u533a\u57df\u4e2d\u7684\u4ee3\u7801\u65f6\u5c31\u6807\u8bc6\u4e00\u4e0b\uff0c\u5982\u679c\u8fd9\u65f6JVM\u8981\u53d1\u8d77GC\u5c31\u4e0d\u7528\u7ba1\u88ab\u6807\u8bc6\u7684\u7ebf\u7a0b\uff1b\u5728\u7ebf\u7a0b\u8981\u79bb\u5f00\u5b89\u5168\u533a\u57df\u65f6\u68c0\u67e5\u7cfb\u7edf\u662f\u5426\u5df2\u7ecf\u5b8c\u6210\u4e86\u6839\u8282\u70b9\u679a\u4e3e\uff0c\u82e5\u5b8c\u6210\u5219\u7ebf\u7a0b\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\uff0c\u5426\u5219\u7b49\u5f85\u76f4\u5230\u6536\u5230\u53ef\u4ee5\u5b89\u5168\u79bb\u5f00\u5b89\u5168\u533a\u57df\u7684\u4fe1\u53f7\u4e3a\u6b62\u3002</li> </ul> <p>\u5230\u6b64\u53ea\u662f\u7b80\u5355\u4ecb\u7ecd\u4e86HotSpot\u5982\u4f55\u53d1\u8d77\u5185\u5b58\u56de\u6536\uff0c\u800c\u5177\u4f53\u7684\u56de\u6536\u52a8\u4f5c\u662f\u7531\u865a\u62df\u673a\u6240\u91c7\u7528\u7684GC\u6536\u96c6\u5668\u51b3\u5b9a\u7684\uff0c\u901a\u5e38\u865a\u62df\u673a\u4e2d\u5f80\u5f80\u4e0d\u6b62\u6709\u4e00\u79cdGC\u6536\u96c6\u5668\uff0c\u4e0b\u56fe\u5c55\u793a\u7684\u662fHotSpot\u865a\u62df\u673a\u4e2d\u5b58\u5728\u7684\u4e03\u79cd\u4f5c\u7528\u4e8e\u4e0d\u540c\u5206\u4ee3\uff08\u65b0\u751f\u4ee3\u3001\u8001\u5e74\u4ee3\uff09\u7684\u6536\u96c6\u5668\uff0c\u5176\u4e2d\u88ab\u8fde\u7ebf\u7684\u4e24\u4e2a\u6536\u96c6\u5668\u8868\u793a\u53ef\u4ee5\u642d\u914d\u4f7f\u7528\u3002</p> <p></p> <p></p> <p>\u5e76\u884c(Parallel)\uff1a\u591a\u6761\u5783\u573e\u6536\u96c6\u7ebf\u7a0b\u5e76\u884c\u5de5\u4f5c\uff0c\u800c\u7528\u6237\u7ebf\u7a0b\u4ecd\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\u3002</p> <p>\u5e76\u53d1(Concurrent)\uff1a\u5783\u573e\u6536\u96c6\u7ebf\u7a0b\u4e0e\u7528\u6237\u7ebf\u7a0b\u4e00\u6bb5\u65f6\u95f4\u5185\u540c\u65f6\u5de5\u4f5c\uff0c\u7528\u6237\u7a0b\u5e8f\u5728\u7ee7\u7eed\u8fd0\u884c\uff0c\u800c\u5783\u573e\u6536\u96c6\u7a0b\u5e8f\u8fd0\u884c\u4e8e\u53e6\u4e00\u4e2aCPU\u4e0a\u3002</p>"},{"location":"JVM/2_JVM%E7%9A%84GC%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/#_12","title":"\u5185\u5b58\u5206\u914d\u548c\u56de\u6536\u7b56\u7565","text":"<p>\u5bf9\u8c61\u7684\u5185\u5b58\u5206\u914d\u5e7f\u4e49\u4e0a\u662f\u6307\u5728\u5806\u4e0a\u5206\u914d\uff0c\u4e3b\u8981\u662f\u5728\u65b0\u751f\u4ee3\u7684Eden\u533a\u4e0a\uff0c\u5982\u679c\u542f\u52a8\u4e86TLAB\uff0c\u5c06\u6309\u7ebf\u7a0b\u4f18\u5148\u5728TLAB\u4e0a\u5206\u914d\uff0c\u5c11\u6570\u60c5\u51b5\u4e0b\u4e5f\u53ef\u80fd\u4f1a\u5206\u914d\u5728\u8001\u5e74\u4ee3\u4e2d\u3002\u5206\u914d\u7ec6\u8282\u8fd8\u662f\u53d6\u51b3\u4e8e\u6240\u4f7f\u7528\u7684GC\u6536\u96c6\u5668\u7ec4\u5408\u4ee5\u53ca\u865a\u62df\u673a\u4e2d\u4e0e\u5185\u5b58\u76f8\u5173\u7684\u53c2\u6570\u7684\u8bbe\u7f6e\u3002\u4ee5\u4e0b\u4ecb\u7ecd\u51e0\u6761\u666e\u904d\u7684\u5185\u5b58\u5206\u914d\u89c4\u5219\u3002</p> <ul> <li><code>\u5bf9\u8c61\u6709\u7ebf\u5728Eden\u5206\u914d</code>\uff1a\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5bf9\u8c61\u5728\u65b0\u751f\u4ee3Eden\u533a\u4e2d\u5206\u914d\uff0c\u5f53Eden\u533a\u6ca1\u6709\u8db3\u591f\u7a7a\u95f4\u8fdb\u884c\u5206\u914d\u65f6\u865a\u62df\u673a\u5c06\u53d1\u8d77\u4e00\u6b21Minor GC\u3002</li> </ul> <p>\u65b0\u751f\u4ee3GC\uff08Minor GC\uff09\uff1a\u53d1\u751f\u5728\u65b0\u751f\u4ee3\u7684\u5783\u573e\u6536\u96c6\u52a8\u4f5c\u3002\u8f83\u9891\u7e41\u3001\u56de\u6536\u901f\u5ea6\u4e5f\u8f83\u5feb\u3002</p> <p>\u8001\u5e74\u4ee3GC\uff08Major GC/Full GC\uff09\uff1a\u53d1\u751f\u5728\u8001\u5e74\u4ee3\u7684\u5783\u573e\u6536\u96c6\u52a8\u4f5c\u3002\u51fa\u73b0Major GC\u7ecf\u5e38\u4f1a\u4f34\u968f\u81f3\u5c11\u4e00\u6b21\u7684Minor GC\u3002\u901f\u5ea6\u4e00\u822c\u6bd4Minor GC\u616210\u500d\u4ee5\u4e0a\u3002</p> <ul> <li> <p><code>\u5927\u5bf9\u8c61\u76f4\u63a5\u8fdb\u5165\u8001\u5e74\u4ee3</code>\uff1a\u5bf9\u4e8e\u9700\u8981\u5927\u91cf\u8fde\u7eed\u5185\u5b58\u7a7a\u95f4\u7684Java\u5bf9\u8c61\uff08\u5982\u5f88\u957f\u7684\u5b57\u7b26\u4e32\u4ee5\u53ca\u6570\u7ec4\uff09\uff0c\u5982\u679c\u5927\u4e8e\u865a\u62df\u673a\u8bbe\u5b9a\u7684-XX\uff1aPretenureSizeThreshold\u53c2\u6570\u503c\u5c06\u76f4\u63a5\u5728\u8001\u5e74\u4ee3\u5206\u914d\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u907f\u514d\u5728Eden\u533a\u53ca\u4e24\u4e2aSurvivor\u533a\u4e4b\u95f4\u53d1\u751f\u5927\u91cf\u7684\u5185\u5b58\u590d\u5236\u3002</p> </li> <li> <p><code>\u957f\u671f\u5b58\u6d3b\u7684\u5bf9\u8c61\u5c06\u8fdb\u5165\u8001\u5e74\u4ee3</code>\uff1a\u865a\u62df\u673a\u4f1a\u7ed9\u6bcf\u4e2a\u5bf9\u8c61\u5b9a\u4e49\u4e00\u4e2a\u5e74\u9f84\u8ba1\u6570\u5668\uff0c\u5f53\u5bf9\u8c61\u5728Eden\u51fa\u751f\u5e76\u7ecf\u8fc7\u7b2c\u4e00\u6b21Minor GC\u540e\u4ecd\u5b58\u6d3b\u4e14\u80fd\u88abSurvivor\u5bb9\u7eb3\u7684\u8bdd\uff0c\u5c06\u88ab\u79fb\u52a8\u5230Survivor\u7a7a\u95f4\u4e2d\u5e76\u5c06\u5bf9\u8c61\u5e74\u9f84\u8bbe\u4e3a1\uff1b\u5f53\u5bf9\u8c61\u5728Survivor\u533a\u4e2d\u6bcf\u201c\u71ac\u8fc7\u201d\u4e00\u6b21Minor GC\u5e74\u9f84\u5c31+1\uff0c\u76f4\u81f3\u589e\u52a0\u5230\u4e00\u5b9a\u7a0b\u5ea6\uff08\u9ed8\u8ba4\u4e3a15\u5c81\uff0c\u53ef\u901a\u8fc7-XX\uff1a MaxTenuringThreshold\u8bbe\u7f6e\uff09\u5c31\u4f1a\u88ab\u664b\u5347\u5230\u8001\u5e74\u4ee3\u4e2d\u3002</p> </li> <li> <p><code>\u52a8\u6001\u5bf9\u8c61\u5e74\u9f84\u5224\u5b9a</code>\uff1a\u4e3a\u4e86\u80fd\u66f4\u597d\u5730\u9002\u5e94\u4e0d\u540c\u7a0b\u5e8f\u7684\u5185\u5b58\u72b6\u51b5\uff0c\u865a\u62df\u673a\u5e76\u4e0d\u8981\u6c42\u4e00\u5b9a\u8981\u8fbe\u5230-XX\uff1a MaxTenuringThreshold\u8bbe\u7f6e\u503c\u624d\u80fd\u664b\u5347\u5230\u8001\u5e74\u4ee3\uff0c\u5f53Survivor\u7a7a\u95f4\u4e2d\u76f8\u540c\u5e74\u9f84\u6240\u6709\u5bf9\u8c61\u5927\u5c0f\u7684\u603b\u548c\u5927\u4e8eSurvivor\u7a7a\u95f4\u7684\u4e00\u534a\uff0c\u90a3\u4e48\u5e74\u9f84\u5927\u4e8e\u6216\u7b49\u4e8e\u8be5\u5e74\u9f84\u7684\u5bf9\u8c61\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u8001\u5e74\u4ee3\u3002</p> </li> <li> <p><code>\u7a7a\u95f4\u5206\u914d\u62c5\u4fdd</code>\uff1a\u5728\u53d1\u751fMinor GC\u4e4b\u524d\u865a\u62df\u673a\u4f1a\u5148\u68c0\u67e5\u8001\u5e74\u4ee3\u6700\u5927\u53ef\u7528\u7684\u8fde\u7eed\u7a7a\u95f4\u662f\u5426\u5927\u4e8e\u65b0\u751f\u4ee3\u6240\u6709\u5bf9\u8c61\u603b\u7a7a\u95f4\uff0c\u82e5\u662f\uff0c\u8bf4\u660e\u53ef\u786e\u4fddMinor GC\u662f\u5b89\u5168\u7684\uff0c\u53cd\u4e4b\u865a\u62df\u673a\u4f1a\u67e5\u770b-XX\uff1aHandlePromotionFailure\u8bbe\u7f6e\u503c\u662f\u5426\u5141\u8bb8\u62c5\u4fdd\u5931\u8d25\uff1b\u82e5\u5141\u8bb8\uff0c\u4f1a\u7ee7\u7eed\u68c0\u67e5\u8001\u5e74\u4ee3\u6700\u5927\u53ef\u7528\u7684\u8fde\u7eed\u7a7a\u95f4\u662f\u5426\u5927\u4e8e\u5386\u6b21\u664b\u5347\u5230\u8001\u5e74\u4ee3\u5bf9\u8c61\u7684\u5e73\u5747\u5927\u5c0f\uff1b\u82e5\u5927\u4e8e\uff0c\u5c06\u5c1d\u8bd5\u8fdb\u884c\u4e00\u6b21Minor GC\uff0c\u82e5\u5c0f\u4e8e\u6216\u8005\u4e0d\u5141\u8bb8\u62c5\u4fdd\u5931\u8d25\uff0c\u5c06\u6539\u4e3a\u8fdb\u884c\u4e00\u6b21Full GC\u3002</p> </li> </ul> <p>\u89e3\u91ca\uff1a\u5f53\u5927\u91cf\u5bf9\u8c61\u5728MinorGC\u540e\u4ecd\u7136\u5b58\u6d3b\u7684\u60c5\u51b5\u65f6\uff0c\u9700\u8981\u501f\u52a9\u8001\u5e74\u4ee3\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\uff0c\u628aSurvivor\u65e0\u6cd5\u5bb9\u7eb3\u7684\u5bf9\u8c61\u76f4\u63a5\u8fdb\u5165\u8001\u5e74\u4ee3\uff0c\u4f46\u524d\u63d0\u662f\u8001\u5e74\u4ee3\u672c\u8eab\u8fd8\u6709\u5bb9\u7eb3\u8fd9\u4e9b\u5bf9\u8c61\u7684\u5269\u4f59\u7a7a\u95f4\uff0c\u7531\u4e8e\u5728\u5b8c\u6210\u5185\u5b58\u56de\u6536\u4e4b\u524d\u65e0\u6cd5\u9884\u77e5\u5b9e\u9645\u5b58\u6d3b\u5bf9\u8c61\uff0c\u53ea\u597d\u53d6\u4e4b\u524d\u6bcf\u6b21\u56de\u6536\u664b\u5347\u5230\u8001\u5e74\u4ee3\u5bf9\u8c61\u5bb9\u91cf\u7684\u5e73\u5747\u5927\u5c0f\u503c\u4f5c\u4e3a\u7ecf\u9a8c\u503c\uff0c\u4e0e\u8001\u5e74\u4ee3\u7684\u5269\u4f59\u7a7a\u95f4\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ece\u800c\u51b3\u5b9a\u662f\u5426\u8fdb\u884cFull GC\u6765\u8ba9\u8001\u5e74\u4ee3\u817e\u51fa\u66f4\u591a\u7a7a\u95f4\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/","title":"3 JVM\u7c7b\u52a0\u8f7d\u673a\u5236","text":""},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_1","title":"\u7c7b\u7684\u52a0\u8f7d\u8fc7\u7a0b","text":"<p><code>JVM\u7c7b\u52a0\u8f7d\u673a\u5236</code>\uff1a\u865a\u62df\u673a\u628a\u63cf\u8ff0\u7c7b\u7684\u6570\u636e\u4eceClass\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u6821\u9a8c\u3001\u8f6c\u6362\u89e3\u6790\u548c\u521d\u59cb\u5316\uff0c\u6700\u7ec8\u5f62\u6210\u53ef\u4ee5\u88ab\u865a\u62df\u673a\u76f4\u63a5\u8fd0\u8425\u7684Java\u7c7b\u578b\uff0c\u8fd9\u5c31\u662f\u865a\u62df\u673a\u7684\u7c7b\u52a0\u8f7d\u673a\u5236\u3002</p> <p><code>\u52a8\u6001\u6269\u5c55\u7684\u7279\u6027</code>\uff1a\u5728Java\u8bed\u8a00\u91cc\u9762\uff0c\u7c7b\u578b\u7684\u52a0\u8f7d\u3001\u94fe\u63a5\u548c\u521d\u59cb\u5316\u8fc7\u7a0b\u90fd\u662f\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u5b8c\u6210\u7684\uff0c\u8fd9\u79cd\u7b56\u7565\u867d\u7136\u4f1a\u96f6\u7c7b\u52a0\u8f7d\u65f6\u7a0d\u5fae\u589e\u52a0\u4e00\u4e9b\u6027\u80fd\u5f00\u9500\uff0c\u4f46\u662f\u56de\u5473Java\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u9ad8\u5ea6\u7684\u7075\u6d3b\u6027\uff0cJava\u91cc\u5929\u751f\u53ef\u4ee5\u52a8\u6001\u6269\u5c55\u7684\u8bed\u8a00\u7279\u6027\u5c31\u662f\u4f9d\u8d56\u8fd0\u884c\u671f\u52a8\u6001\u52a0\u8f7d\u548c\u52a8\u6001\u94fe\u63a5\u8fd9\u4e2a\u7279\u70b9\u5b8c\u6210\u7684\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_2","title":"\u7c7b\u52a0\u8f7d\u7684\u65f6\u673a","text":"<p>\u7c7b\u4ece\u88ab\u52a0\u8f7d\u5230\u865a\u62df\u673a\u5185\u5b58\u4e2d\u5f00\u59cb\uff0c\u5230\u5378\u8f7d\u51fa\u5185\u5b58\u4e3a\u6b62\uff0c\u5b83\u7684\u6574\u4e2a\u751f\u547d\u5468\u671f\u5982\u4e0b\uff1a * \u52a0\u8f7d\uff08Loading\uff09 * \u9a8c\u8bc1\uff08Verification\uff09 * \u51c6\u5907\uff08Preparation\uff09 * \u89e3\u6790\uff08Resolution\uff09 * \u521d\u59cb\u5316\uff08Initialization\uff09 * \u4f7f\u7528\uff08Using\uff09 * \u5378\u8f7d\uff08Unloading\uff09</p> <p>\u5176\u4e2d\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u89e3\u6790\u8fd93\u4e2a\u90e8\u5206\u79f0\u4e3a\u8fde\u63a5\uff08Linking\uff09\u3002</p> <p></p> <p>\u6ce8\u610f\uff1a \u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u51c6\u5907\u3001\u521d\u59cb\u5316\u548c\u5378\u8f7d\u8fd95\u4e2a\u9636\u6bb5\u7684\u987a\u5e8f\u662f\u56fa\u5b9a\u7684\uff0c\u7d2f\u5f97\u52a0\u8f7d\u8fc7\u7a0b\u5fc5\u987b\u6309\u7167\u627e\u5404\u79cd\u987a\u5e8f\u6765\u6267\u884c\uff0c\u800c\u89e3\u6790\u9636\u6bb5\u5219\u4e0d\u4e00\u5b9a\uff1b \u4e3a\u4e86\u652f\u6301Java\u8bed\u8a00\u7684\u8fd0\u884c\u65f6\u7ed1\u5b9a\uff0c\u89e3\u6790\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u521d\u59cb\u5316\u9636\u6bb5\u4e4b\u540e\u518d\u5f00\u59cb\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_3","title":"\u52a0\u8f7d","text":"<p>\u201c\u52a0\u8f7d\u201d\u662f\u201d\u7c7b\u52a0\u8f7d\u201c\uff08Class Loading\uff09\u8fc7\u7a0b\u7684\u4e00\u4e2a\u9636\u6bb5\u3002 1. \u901a\u8fc7\u4e00\u4e2a\u7d2f\u5f97\u5168\u9650\u5b9a\u540d\u6765\u83b7\u53d6\u5b9a\u4e49\u6b64\u7c7b\u7684<code>\u4e8c\u8fdb\u5236\u5b57\u8282\u6d41</code>\u3002 2. \u5c06\u8fd9\u4e2a\u5b57\u8282\u6d41\u6240\u4ee3\u8868\u7684<code>\u9759\u6001\u5b58\u50a8\u7ed3\u6784</code>\u8f6c\u5316\u4e3a\u65b9\u6cd5\u533a\u7684<code>\u8fd0\u884c\u65f6\u6570\u636e\u7ed3\u6784</code>\u3002 3. \u5728\u5185\u5b58\u4e2d\u751f\u6210\u4e00\u4e2a\u4ee3\u8868\u8fd9\u4e2a\u7c7b\u7684<code>java.lang.Class</code>\u5bf9\u8c61\uff0c\u4f5c\u4e3a\u65b9\u6cd5\u533a\u8fd9\u4e2a\u7c7b\u7684\u5404\u79cd\u7684\u6570\u636e\u8bbf\u95ee\u63a5\u53e3\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_4","title":"\u9a8c\u8bc1","text":"<ul> <li>\u9a8c\u8bc1\u662f\u8fde\u63a5\u9636\u6bb5\u7684\u7b2c\u4e00\u6b65\uff0c\u4e14\u5de5\u4f5c\u91cf\u5728\u865a\u62df\u673a\u7684\u7c7b\u52a0\u8f7d\u5b50\u7cfb\u7edf\u4e2d\u6218\u7565\u76f8\u5f53\u5927\u7684\u4e00\u90e8\u5206\u3002</li> <li>\u76ee\u7684\uff1a\u4e3a\u4e86\u786e\u4fddClass\u6587\u4ef6\u7684\u5b57\u8282\u6d41\u4e2d\u5305\u542b\u7684\u4fe1\u606f\u7b26\u5408\u5f53\u524d\u865a\u62df\u673a\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5371\u5bb3\u865a\u62df\u673a\u81ea\u8eab\u7684\u5b89\u5168\u3002</li> </ul> <p>\u7531\u6b64\u53ef\u89c1\uff0c\u5b83\u80fd\u76f4\u63a5\u51b3\u5b9aJVM\u80fd\u5426\u627f\u53d7\u6076\u610f\u4ee3\u7801\u7684\u653b\u51fb\uff0c\u56e0\u6b64\u9a8c\u8bc1\u9636\u6bb5\u5f88\u6709\u5fc5\u8981\uff0c\u4f46\u7531\u4e8e\u5b83\u5bf9\u7a0b\u5e8f\u8fd0\u884c\u671f\u6ca1\u6709\u5f71\u54cd\uff0c\u5e76\u4e0d\u4e00\u5b9a\u5fc5\u8981\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528-Xverify\uff1anone\u53c2\u6570\u6765\u5173\u95ed\u5927\u90e8\u5206\u7684\u7c7b\u9a8c\u8bc1\u63aa\u65bd\uff0c\u4ee5\u7f29\u77ed\u865a\u62df\u673a\u7c7b\u52a0\u8f7d\u7684\u65f6\u95f4\u3002</p> <p>\u9a8c\u8bc1\u8fc7\u7a0b\u5927\u81f4\u4e0a\u53ef\u4ee5\u5206\u4e3a4\u4e2a\u68c0\u9a8c\u52a8\u4f5c\uff1a * \u6587\u4ef6\u683c\u5f0f\u9a8c\u8bc1   * \u5185\u5bb9\uff1a\u9a8c\u8bc1\u5b57\u8282\u6d41\u662f\u5426\u7b26\u5408Class\u6587\u4ef6\u683c\u5f0f\u7684\u89c4\u8303\u3001\u4ee5\u53ca\u662f\u5426\u80fd\u88ab\u5f53\u524d\u7248\u672c\u7684\u865a\u62df\u673a\u5904\u7406\u3002   * \u76ee\u7684\uff1a\u4fdd\u8bc1\u8f93\u5165\u7684\u5b57\u8282\u6d41\u80fd\u6b63\u786e\u5730\u89e3\u6790\u5e76\u5b58\u50a8\u4e8e\u65b9\u6cd5\u533a\u4e4b\u5185\uff0c\u4e14\u683c\u5f0f\u4e0a\u7b26\u5408\u63cf\u8ff0\u4e00\u4e2aJava\u7c7b\u578b\u4fe1\u606f\u7684\u8981\u6c42\u3002\u53ea\u6709\u4fdd\u8bc1\u4e8c\u8fdb\u5236\u5b57\u8282\u6d41\u901a\u8fc7\u4e86\u8be5\u9a8c\u8bc1\u540e\uff0c\u5b83\u624d\u4f1a\u8fdb\u5165\u5185\u5b58\u7684\u65b9\u6cd5\u533a\u4e2d\u8fdb\u884c\u5b58\u50a8\uff0c\u6240\u4ee5\u540e\u7eed3\u4e2a\u9a8c\u8bc1\u9636\u6bb5\u5168\u90e8\u662f\u57fa\u4e8e\u65b9\u6cd5\u533a\u800c\u4e0d\u662f\u5b57\u8282\u6d41\u4e86\u3002</p> <ul> <li>\u5143\u6570\u636e\u9a8c\u8bc1</li> <li>\u5185\u5bb9\uff1a\u5bf9\u5b57\u8282\u7801\u63cf\u8ff0\u7684\u4fe1\u606f\u8fdb\u884c\u8bed\u4e49\u5206\u6790\uff0c\u4ee5\u4fdd\u8bc1\u5176\u63cf\u8ff0\u7684\u4fe1\u606f\u7b26\u5408Java\u8bed\u8a00\u89c4\u8303\u7684\u8981\u6c42\u3002</li> <li> <p>\u76ee\u7684\uff1a\u5bf9\u7c7b\u7684\u5143\u6570\u636e\u4fe1\u606f\u8fdb\u884c\u8bed\u4e49\u6821\u9a8c\uff0c\u4fdd\u8bc1\u4e0d\u5b58\u5728\u4e0d\u7b26\u5408Java\u8bed\u8a00\u89c4\u8303\u7684\u5143\u6570\u636e\u4fe1\u606f\u3002</p> </li> <li> <p>\u5b57\u8282\u7801\u9a8c\u8bc1\uff1a\u662f\u9a8c\u8bc1\u8fc7\u7a0b\u4e2d\u6700\u590d\u6742\u7684\u4e00\u4e2a\u9636\u6bb5\u3002</p> </li> <li>\u5185\u5bb9\uff1a\u5bf9\u7c7b\u7684\u65b9\u6cd5\u4f53\u8fdb\u884c\u6821\u9a8c\u5206\u6790\uff0c\u4fdd\u8bc1\u88ab\u6821\u9a8c\u7c7b\u7684\u65b9\u6cd5\u5728\u8fd0\u884c\u65f6\u4e0d\u4f1a\u505a\u51fa\u5371\u5bb3\u865a\u62df\u673a\u5b89\u5168\u7684\u4e8b\u4ef6\u3002</li> <li> <p>\u76ee\u7684\uff1a\u901a\u8fc7\u6570\u636e\u6d41\u548c\u63a7\u5236\u6d41\u5206\u6790\uff0c\u786e\u5b9a\u7a0b\u5e8f\u8bed\u4e49\u662f\u5408\u6cd5\u7684\u3001\u7b26\u5408\u903b\u8f91\u7684\u3002</p> </li> <li> <p>\u7b26\u53f7\u5f15\u7528\u9a8c\u8bc1\uff1a</p> </li> <li>\u5185\u5bb9\uff1a\u5bf9\u7c7b\u81ea\u8eab\u4ee5\u5916\uff08\u5982\u5e38\u91cf\u6c60\u4e2d\u7684\u5404\u79cd\u7b26\u53f7\u5f15\u7528\uff09\u7684\u4fe1\u606f\u8fdb\u884c\u5339\u914d\u6027\u6821\u9a8c\u3002</li> <li>\u76ee\u7684\u662f\u786e\u4fdd\u89e3\u6790\u52a8\u4f5c\u80fd\u6b63\u5e38\u6267\u884c\uff0c\u5982\u679c\u65e0\u6cd5\u901a\u8fc7\u7b26\u53f7\u5f15\u7528\u9a8c\u8bc1\uff0c\u90a3\u4e48\u5c06\u4f1a\u629b\u51fa\u4e00\u4e2ajava.lang.IncompatibleClassChangeError\u5f02\u5e38\u7684\u5b50\u7c7b\u3002</li> <li>\u6ce8\u610f\uff1a\u8be5\u9a8c\u8bc1\u53d1\u751f\u5728\u865a\u62df\u673a\u5c06\u7b26\u53f7\u5f15\u7528\u8f6c\u5316\u4e3a\u76f4\u63a5\u5f15\u7528\u7684\u65f6\u5019\uff0c\u5373\u300e\u89e3\u6790\u300f\u9636\u6bb5\u3002</li> </ul>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_5","title":"\u51c6\u5907","text":"<ul> <li>\u4e3a\u7c7b\u53d8\u91cf<code>\u5206\u914d\u5185\u5b58</code>\uff1a\u56e0\u4e3a\u8fd9\u91cc\u7684\u53d8\u91cf\u662f\u7531\u65b9\u6cd5\u533a\u5206\u914d\u5185\u5b58\u7684\uff0c\u6240\u4ee5\u4ec5\u5305\u62ec\u7c7b\u53d8\u91cf\u800c\u4e0d\u5305\u62ec\u5b9e\u4f8b\u53d8\u91cf\uff0c\u540e\u8005\u5c06\u5728\u5bf9\u8c61\u5b9e\u4f8b\u5316\u65f6\u968f\u7740\u5bf9\u8c61\u4e00\u8d77\u5728\u5806\u4e0a\u5206\u914d\u3002</li> <li>\u8bbe\u7f6e\u7c7b\u53d8\u91cf<code>\u521d\u59cb\u503c</code>\uff1a\u901a\u5e38\u60c5\u51b5\u4e0b\u96f6\u503c\uff0c\u4f46\u662f\u5982\u679c\u8fd9\u4e2a\u7c7b\u53d8\u91cf\u88abfinal\u4fee\u9970\uff0c\u7f16\u8bd1\u65f6Javac\u5c06\u4f1a\u4e3a\u8be5\u53d8\u91cf\u751f\u6210ConstantValue\u5c5e\u6027\uff0c\u5728\u51c6\u5907\u9636\u6bb5\u865a\u62df\u673a\u5c31\u4f1a\u6839\u636eConstantValue\u7684\u8bbe\u7f6e\u5c06\u8be5\u53d8\u91cf\u8d4b\u503c\u4e3a\u7b49\u4e8e\u53f7\u540e\u9762\u7684\u503c\u3002</li> </ul>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_6","title":"\u89e3\u6790","text":"<p>\u89e3\u6790\u9636\u6bb5\u662f\u865a\u62df\u673a\u5c06<code>\u5e38\u91cf\u6c60</code>\u5185\u7684\u7b26\u53f7\u5f15\u7528\u66ff\u6362\u4e3a\u76f4\u63a5\u5f15\u7528\u7684\u8fc7\u7a0b\u3002 * \u7b26\u53f7\u5f15\u7528\uff1a\u4ee5\u4e00\u7ec4\u7b26\u53f7\u6765\u63cf\u8ff0\u6240\u5f15\u7528\u7684\u76ee\u6807\u3002   * \u53ef\u4ee5\u662f\u4efb\u4f55\u5f62\u5f0f\u7684\u5b57\u9762\u91cf\uff0c\u53ea\u8981\u4f7f\u7528\u65f6\u80fd\u65e0\u6b67\u4e49\u5730\u5b9a\u4f4d\u5230\u76ee\u6807\u5373\u53ef\u3002   * \u4e0e\u865a\u62df\u673a\u7684\u5185\u5b58\u5e03\u5c40\u65e0\u5173\uff0c\u56e0\u4e3a\u7b26\u53f7\u5f15\u7528\u7684\u5b57\u9762\u91cf\u5f62\u5f0f\u660e\u786e\u5b9a\u4e49\u5728Java\u865a\u62df\u673a\u89c4\u8303\u7684Class\u6587\u4ef6\u683c\u5f0f\u4e2d\uff0c\u6240\u6709\u5373\u4f7f\u5404\u79cd\u865a\u62df\u673a\u7684\u5b9e\u73b0\u7684\u5185\u5b58\u5e03\u5c40\u4e0d\u540c\uff0c\u4f46\u662f\u80fd\u63a5\u53d7\u7b26\u53f7\u5f15\u7528\u90fd\u662f\u4e00\u81f4\u7684\u3002 * \u76f4\u63a5\u5f15\u7528\uff1a   * \u53ef\u4ee5\u662f\u76f4\u63a5\u6307\u5411\u76ee\u6807\u7684\u6307\u9488\u3001\u76f8\u5bf9\u504f\u79fb\u91cf\u6216\u662f\u4e00\u4e2a\u80fd\u95f4\u63a5\u5b9a\u4f4d\u5230\u76ee\u6807\u7684\u53e5\u67c4\u3002   * \u4e0e\u865a\u62df\u673a\u5b9e\u73b0\u7684\u5185\u5b58\u5e03\u5c40\u6709\u5173\uff0c\u540c\u4e00\u4e2a\u7b26\u53f7\u5f15\u7528\u5728\u4e0d\u540c\u7684\u865a\u62df\u673a\u5b9e\u4f8b\u4e0a\u7ffb\u8bd1\u51fa\u6765\u7684\u76f4\u63a5\u5f15\u7528\u4e00\u822c\u4e0d\u540c\u3002</p> <ul> <li> <p><code>\u53d1\u751f\u65f6\u95f4</code>\uff1aJVM\u4f1a\u6839\u636e\u9700\u8981\u6765\u5224\u65ad\uff0c\u662f\u5728\u7c7b\u88ab\u52a0\u8f7d\u5668<code>\u52a0\u8f7d\u65f6</code>\u5c31\u5bf9\u5e38\u91cf\u6c60\u4e2d\u7684\u7b26\u53f7\u5f15\u7528\u8fdb\u884c\u89e3\u6790\uff0c\u8fd8\u662f\u7b49\u5230\u4e00\u4e2a\u7b26\u53f7\u5f15\u7528\u5c06\u8981\u88ab<code>\u4f7f\u7528\u524d</code>\u624d\u53bb\u89e3\u6790\u3002</p> </li> <li> <p>\u89e3\u6790\u52a8\u4f5c\uff1a\u67097\u7c7b\u7b26\u53f7\u53ca\u5176\u5bf9\u5e94\u5728\u5e38\u91cf\u6c60\u76847\u79cd\u5e38\u91cf\u7c7b\u578b</p> </li> <li>\u7c7b\u6216\u63a5\u53e3(CONSTANT_Class_info)</li> <li>\u5b57\u6bb5(CONSTANT_Fieldref_info)</li> <li>\u7c7b\u65b9\u6cd5(CONSTANT_Methodref_info)</li> <li>\u63a5\u53e3\u65b9\u6cd5(CONSTANT_InterfaceMethodref_info)</li> <li>\u65b9\u6cd5\u7c7b\u578b(CONSTANT_MethodType_info)</li> <li>\u65b9\u6cd5\u53e5\u67c4(CONSTANT_MethodHandle_info)</li> <li>\u8c03\u7528\u70b9\u9650\u5b9a\u7b26(CONSTANT_InvokeDynamic_info)</li> </ul> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8bbe\u5f53\u524d\u4ee3\u7801\u6240\u5904\u7684\u4e3a\u7c7bD\uff0c\u628a\u4e00\u4e2a\u4ece\u672a\u89e3\u6790\u8fc7\u7684\u7b26\u53f7\u5f15\u7528N\u89e3\u6790\u4e3a\u4e00\u4e2a\u7c7b\u6216\u63a5\u53e3C\u7684\u76f4\u63a5\u5f15\u7528\uff0c\u89e3\u6790\u8fc7\u7a0b\u5206\u4e09\u6b65\uff1a</p> <ul> <li>\u82e5C\u4e0d\u662f\u6570\u7ec4\u7c7b\u578b\uff1aJVM\u5c06\u4f1a\u628a\u4ee3\u8868N\u7684\u5168\u9650\u5b9a\u540d\u4f20\u9012\u7ed9D\u7c7b\u52a0\u8f7d\u5668\u53bb\u52a0\u8f7d\u8fd9\u4e2a\u7c7bC\u3002\u5728\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\uff0c\u7531\u4e8e\u5143\u6570\u636e\u9a8c\u8bc1\u3001\u5b57\u8282\u7801\u9a8c\u8bc1\u7684\u9700\u8981\uff0c\u53c8\u53ef\u80fd\u89e6\u53d1\u5176\u4ed6\u76f8\u5173\u7c7b\u7684\u52a0\u8f7d\u52a8\u4f5c\u3002\u4e00\u65e6\u8fd9\u4e2a\u52a0\u8f7d\u8fc7\u7a0b\u51fa\u73b0\u4e86\u4efb\u4f55\u5f02\u5e38\uff0c\u89e3\u6790\u8fc7\u7a0b\u5c31\u5ba3\u544a\u5931\u8d25\u3002</li> <li>\u82e5C\u662f\u6570\u7ec4\u7c7b\u578b\u4e14\u6570\u7ec4\u5143\u7d20\u7c7b\u578b\u4e3a\u5bf9\u8c61\uff1aJVM\u4e5f\u4f1a\u6309\u7167\u4e0a\u8ff0\u89c4\u5219\u52a0\u8f7d\u6570\u7ec4\u5143\u7d20\u7c7b\u578b\u3002</li> <li>\u82e5\u4e0a\u8ff0\u6b65\u9aa4\u65e0\u4efb\u4f55\u5f02\u5e38\uff1a\u6b64\u65f6C\u5728JVM\u4e2d\u5df2\u6210\u4e3a\u4e00\u4e2a\u6709\u6548\u7684\u7c7b\u6216\u63a5\u53e3\uff0c\u4f46\u5728\u89e3\u6790\u5b8c\u6210\u524d\u8fd8\u9700\u8fdb\u884c\u7b26\u53f7\u5f15\u7528\u9a8c\u8bc1\uff0c\u6765\u786e\u8ba4D\u662f\u5426\u5177\u5907\u5bf9C\u7684\u8bbf\u95ee\u6743\u9650\u3002\u5982\u679c\u53d1\u73b0\u4e0d\u5177\u5907\u8bbf\u95ee\u6743\u9650\uff0c\u5c06\u629b\u51fajava.lang.IllegalAccessError\u5f02\u5e38\u3002</li> </ul>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_7","title":"\u521d\u59cb\u5316","text":"<ul> <li>\u7c7b\u521d\u59cb\u5316\u662f\u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u7684\u6700\u540e\u4e00\u6b65\uff0c\u4f1a\u771f\u6b63\u5f00\u59cb\u6267\u884c\u7c7b\u4e2d\u5b9a\u4e49\u7684Java\u7a0b\u5e8f\u4ee3\u7801\uff08\u6216\u8005\u8bf4\u662f\u5b57\u8282\u7801\uff09\u3002\u800c\u4e4b\u524d\u7684\u7c7b\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\uff0c\u9664\u4e86\u5728\u300e\u52a0\u8f7d\u300f\u9636\u6bb5\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u53ef\u901a\u8fc7\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u53c2\u4e0e\u4e4b\u5916\uff0c\u5176\u4f59\u9636\u6bb5\u5747\u7531\u865a\u62df\u673a\u4e3b\u5bfc\u548c\u63a7\u5236\u3002</li> <li>\u4e0e\u51c6\u5907\u9636\u6bb5\u7684\u533a\u5206\uff1a</li> <li>\u51c6\u5907\u9636\u6bb5\uff1a\u53d8\u91cf\u8d4b\u521d\u59cb\u96f6\u503c\u3002</li> <li>\u521d\u59cb\u5316\u9636\u6bb5\uff1a\u6839\u636eJava\u7a0b\u5e8f\u7684\u8bbe\u5b9a\u53bb\u521d\u59cb\u5316\u7c7b\u53d8\u91cf\u548c\u5176\u4ed6\u8d44\u6e90\uff0c\u6216\u8005\u8bf4\u662f\u6267\u884c<code>&lt;cinit&gt;()</code>\u8fc7\u7a0b\u3002</li> </ul> <p><code>&lt;clinit&gt;()</code>\uff1a\u7531\u7f16\u8bd1\u5668\u81ea\u52a8\u6536\u96c6\u7c7b\u4e2d\u7684\u6240\u6709\u7c7b\u53d8\u91cf\u7684\u8d4b\u503c\u52a8\u4f5c\u548c\u9759\u6001\u8bed\u53e5\u5757static{}\u4e2d\u7684\u8bed\u53e5\u5408\u5e76\u4ea7\u751f\u3002 * \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e2d\u4f1a\u88ab\u6b63\u786e\u5730\u52a0\u9501\u3001\u540c\u6b65\u3002 * \u5bf9\u4e8e\u7c7b\u548c\u63a5\u53e3\u662f\u975e\u5fc5\u9700\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u6ca1\u6709\u9759\u6001\u8bed\u53e5\u5757\uff0c\u4e5f\u6ca1\u6709\u5bf9\u53d8\u91cf\u7684\u8d4b\u503c\u64cd\u4f5c\uff0c\u90a3\u4e48\u7f16\u8bd1\u5668\u53ef\u4ee5\u4e0d\u4e3a\u8fd9\u4e2a\u7c7b\u751f\u6210 <code>&lt;clinit&gt;()</code>\u3002 * \u63a5\u53e3\u4e0e\u7c7b\u4e0d\u540c\u7684\u662f\uff0c\u6267\u884c\u63a5\u53e3\u7684<code>&lt;clinit&gt;()</code>\u4e0d\u9700\u8981\u5148\u6267\u884c\u7236\u63a5\u53e3\u7684 <code>&lt;clinit&gt;()</code>\uff0c\u53ea\u6709\u5f53\u7236\u63a5\u53e3\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u4f7f\u7528\u65f6\uff0c\u7236\u63a5\u53e3\u624d\u4f1a\u521d\u59cb\u5316\u3002\u53e6\u5916\uff0c\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u5728\u521d\u59cb\u5316\u65f6\u4e5f\u4e00\u6837\u4e0d\u4f1a\u6267\u884c\u63a5\u53e3\u7684<code>&lt;clinit&gt;()</code>\u3002</p> <p>\u5728\u865a\u62df\u673a\u89c4\u8303\u4e2d\uff0c\u89c4\u5b9a\u4e86\u6709\u4e14\u53ea\u67095\u4e2d\u60c5\u51b5\u5fc5\u987b\u7acb\u5373\u5bf9\u7c7b\u8fdb\u884c\u521d\u59cb\u5316\uff1a * \u9047\u5230new\u3001getstatic\u3001putstatic\u6216invokestatic\u8fd94\u6761\u5b57\u8282\u7801\u6307\u4ee4\u65f6\uff1b * \u4f7f\u7528java.lang.reflect\u5305\u7684\u65b9\u6cd5\u5bf9\u7c7b\u8fdb\u884c\u53cd\u5c04\u8c03\u7528\u7684\u65f6\u5019\uff1b * \u5f53\u521d\u59cb\u5316\u4e00\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u82e5\u53d1\u73b0\u5176\u7236\u7c7b\u8fd8\u672a\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u9700\u5148\u89e6\u53d1\u5176\u7236\u7c7b\u7684\u521d\u59cb\u5316\uff1b * \u5728\u865a\u62df\u673a\u542f\u52a8\u65f6\uff0c\u9700\u6307\u5b9a\u4e00\u4e2a\u8981\u6267\u884c\u7684\u4e3b\u7c7b\uff0c\u865a\u62df\u673a\u4f1a\u5148\u521d\u59cb\u5316\u5b83\uff1b * \u5f53\u4f7f\u7528JDK1.7\u7684\u52a8\u6001\u8bed\u8a00\u652f\u6301\u65f6\uff0c\u82e5\u4e00\u4e2ajava.lang.invoke.MethodHandle\u5b9e\u4f8b\u6700\u540e\u7684\u89e3\u6790\u7ed3\u679c\u4e3aREF_getStatic\u3001REF_putStatic\u3001REF_invokeStatic\u7684\u65b9\u6cd5\u53e5\u67c4\uff0c\u4e14\u8fd9\u4e2a\u65b9\u6cd5\u53e5\u67c4\u6240\u5bf9\u5e94\u7684\u7c7b\u672a\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u9700\u5148\u89e6\u53d1\u5176\u521d\u59cb\u5316\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#_8","title":"\u7c7b\u52a0\u8f7d\u5668\u548c\u53cc\u4eb2\u59d4\u6258\u6a21\u578b","text":"<p>\u6bcf\u4e2a\u7c7b\u52a0\u8f7d\u5668\u90fd\u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u7c7b\u540d\u79f0\u7a7a\u95f4\uff0c\u5b83\u4e0d\u4ec5\u7528\u4e8e\u52a0\u8f7d\u7c7b\uff0c\u8fd8\u548c\u8fd9\u4e2a\u7c7b\u672c\u8eab\u4e00\u8d77\u4f5c\u4e3a\u5728JVM\u4e2d\u7684\u552f\u4e00\u6807\u8bc6\u3002\u6240\u4ee5\u6bd4\u8f83\u4e24\u4e2a\u7c7b\u662f\u5426\u76f8\u7b49\uff0c\u53ea\u8981\u770b\u5b83\u4eec\u662f\u5426\u7531\u540c\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\uff0c\u5373\u4f7f\u5b83\u4eec\u6765\u6e90\u4e8e\u540c\u4e00\u4e2aClass\u6587\u4ef6\u4e14\u88ab\u540c\u4e00\u4e2aJVM\u52a0\u8f7d\uff0c\u53ea\u8981\u52a0\u8f7d\u5b83\u4eec\u7684\u7c7b\u52a0\u8f7d\u5668\u4e0d\u540c\uff0c\u8fd9\u4e24\u4e2a\u7c7b\u5c31\u5fc5\u5b9a\u4e0d\u76f8\u7b49\u3002</p> <p>\u4eceJVM\u7684\u89d2\u5ea6\u6765\u8bb2\uff0c\u53ea\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u7c7b\u52a0\u8f7d\u5668\uff1a * \u4e00\u79cd\u662f\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\uff08Bootstrap ClassLoader\uff09   * \u7531C++\u8bed\u8a00\u7f16\u5199\uff0c\u662f\u865a\u62df\u673a\u81ea\u8eab\u7684\u4e00\u90e8\u5206\u3002   * \u8d1f\u8d23\u52a0\u8f7d\\lib\u76ee\u5f55\u4e0b\uff0c\u6216\u8005\u88ab-Xbootclasspath\u53c2\u6570\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u7684\u4e14\u53ef\u88ab\u865a\u62df\u673a\u8bc6\u522b\u7684\u7c7b\u5e93\u3002   * \u65e0\u6cd5\u88abJava\u7a0b\u5e8f\u76f4\u63a5\u5f15\u7528\uff0c\u5982\u679c\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u60f3\u8981\u628a\u52a0\u8f7d\u8bf7\u6c42\u59d4\u6d3e\u7ed9\u5f15\u5bfc\u7c7b\u52a0\u8f7d\u5668\u7684\u8bdd\uff0c\u53ef\u76f4\u63a5\u7528null\u4ee3\u66ff\u3002 * \u53e6\u4e00\u79cd\u662f\u5176\u4ed6\u7c7b\u52a0\u8f7d\u5668\uff1a\u7531Java\u8bed\u8a00\u5b9e\u73b0\uff0c\u72ec\u7acb\u4e8e\u865a\u62df\u673a\u5916\u90e8\uff0c\u5e76\u4e14\u5168\u90e8\u90fd\u7ee7\u627f\u81ea\u62bd\u8c61\u7c7bjava.lang.ClassLoader,\u53ef\u88abJava\u7a0b\u5e8f\u76f4\u63a5\u5f15\u7528\u3002   * \u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\uff08Extension ClassLoader\uff09     * \u7531sun.misc.Launcher$ExtClassLoader\u5b9e\u73b0\u3002     * \u8d1f\u8d23\u52a0\u8f7d\uff1cJAVA_HOME\uff1e\\lib\\ext\u76ee\u5f55\u4e2d\u7684\u3001\u6216\u8005\u88abjava.ext.dirs\u7cfb\u7edf\u53d8\u91cf\u6240\u6307\u5b9a\u7684\u8def\u5f84\u4e2d\u7684\u6240\u6709\u7c7b\u5e93\u3002   * \u5e94\u7528\u7a0b\u5e8f\u7c7b\u52a0\u8f7d\u5668\uff08Application ClassLoader\uff09     * \u662f\u9ed8\u8ba4\u7684\u7c7b\u52a0\u8f7d\u5668\uff0c\u662fClassLoader#getSystemClassLoader()\u7684\u8fd4\u56de\u503c\uff0c\u6545\u53c8\u79f0\u4e3a\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\u3002     * \u7531sun.misc.Launcher$App-ClassLoader\u5b9e\u73b0\u3002     * \u8d1f\u8d23\u52a0\u8f7d\u7528\u6237\u7c7b\u8def\u5f84\u4e0a\u6240\u6307\u5b9a\u7684\u7c7b\u5e93\u3002   * \u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\uff08User ClassLoader\uff09\uff1a\u5982\u679c\u4ee5\u4e0a\u7c7b\u52a0\u8f7d\u8d77\u4e0d\u80fd\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u81ea\u5b9a\u4e49\u3002 <p>\u5173\u7cfb\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u867d\u7136\u6570\u7ec4\u7c7b\u4e0d\u901a\u8fc7\u7c7b\u52a0\u8f7d\u5668\u521b\u5efa\u800c\u662f\u7531JVM\u76f4\u63a5\u521b\u5efa\u7684\uff0c\u4f46\u4ecd\u4e0e\u7c7b\u52a0\u8f7d\u5668\u6709\u5bc6\u5207\u5173\u7cfb\uff0c\u56e0\u4e3a\u6570\u7ec4\u7c7b\u7684\u5143\u7d20\u7c7b\u578b\u6700\u7ec8\u8fd8\u8981\u9760\u7c7b\u52a0\u8f7d\u5668\u53bb\u521b\u5efa\u3002</p>"},{"location":"JVM/3_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6/#parents-delegation-model","title":"\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff08Parents Delegation Model\uff09","text":"<ul> <li>\u8868\u793a\u7c7b\u52a0\u8f7d\u5668\u4e4b\u95f4\u7684\u5c42\u6b21\u5173\u7cfb\u3002</li> <li>\u524d\u63d0\uff1a\u9664\u4e86\u9876\u5c42\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u5916\uff0c\u5176\u4f59\u7c7b\u52a0\u8f7d\u5668\u90fd\u5e94\u5f53\u6709\u81ea\u5df1\u7684\u7236\u7c7b\u52a0\u8f7d\u5668\uff0c\u4e14\u5b83\u4eec\u4e4b\u95f4\u5173\u7cfb\u4e00\u822c\u4e0d\u4f1a\u4ee5\u7ee7\u627f\uff08Inheritance\uff09\u5173\u7cfb\u6765\u5b9e\u73b0\uff0c\u800c\u662f\u901a\u8fc7\u7ec4\u5408\uff08Composition\uff09\u5173\u7cfb\u6765\u590d\u7528\u7236\u52a0\u8f7d\u5668\u7684\u4ee3\u7801\u3002</li> <li>\u5de5\u4f5c\u8fc7\u7a0b\uff1a\u82e5\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u6536\u5230\u4e86\u7c7b\u52a0\u8f7d\u7684\u8bf7\u6c42\uff0c\u5b83\u5148\u4f1a\u628a\u8fd9\u4e2a\u8bf7\u6c42\u59d4\u6d3e\u7ed9\u7236\u7c7b\u52a0\u8f7d\u5668\uff0c\u5e76\u5411\u4e0a\u4f20\u9012\uff0c\u6700\u7ec8\u8bf7\u6c42\u90fd\u4f20\u9001\u5230\u9876\u5c42\u7684\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u4e2d\u3002\u53ea\u6709\u5f53\u7236\u52a0\u8f7d\u5668\u53cd\u9988\u81ea\u5df1\u65e0\u6cd5\u5b8c\u6210\u8fd9\u4e2a\u52a0\u8f7d\u8bf7\u6c42\u65f6\uff0c\u5b50\u52a0\u8f7d\u5668\u624d\u4f1a\u5c1d\u8bd5\u81ea\u5df1\u53bb\u52a0\u8f7d\u3002</li> <li>\u6ce8\u610f\uff1a\u4e0d\u662f\u4e00\u4e2a\u5f3a\u5236\u6027\u7684\u7ea6\u675f\u6a21\u578b\uff0c\u800c\u662fJava\u8bbe\u8ba1\u8005\u63a8\u8350\u7ed9\u5f00\u53d1\u8005\u7684\u4e00\u79cd\u7c7b\u52a0\u8f7d\u5668\u5b9e\u73b0\u65b9\u5f0f\u3002</li> <li>\u4f18\u70b9\uff1a\u7c7b\u4f1a\u968f\u7740\u5b83\u7684\u7c7b\u52a0\u8f7d\u5668\u4e00\u8d77\u5177\u5907\u5e26\u6709\u4f18\u5148\u7ea7\u7684\u5c42\u6b21\u5173\u7cfb\uff0c\u53ef\u4fdd\u8bc1Java\u7a0b\u5e8f\u7684\u7a33\u5b9a\u8fd0\u4f5c\uff1b\u5b9e\u73b0\u7b80\u5355\uff0c\u6240\u6709\u5b9e\u73b0\u4ee3\u7801\u90fd\u96c6\u4e2d\u5728java.lang.ClassLoader\u7684loadClass()\u4e2d\u3002</li> </ul> <p>\u6bd4\u5982\uff0c\u67d0\u4e9b\u7c7b\u52a0\u8f7d\u5668\u8981\u52a0\u8f7djava.lang.Object\u7c7b\uff0c\u6700\u7ec8\u90fd\u4f1a\u59d4\u6d3e\u7ed9\u6700\u9876\u7aef\u7684\u542f\u52a8\u7c7b\u52a0\u8f7d\u5668\u53bb\u52a0\u8f7d\uff0c\u8fd9\u6837Object\u7c7b\u5728\u7a0b\u5e8f\u7684\u5404\u79cd\u7c7b\u52a0\u8f7d\u5668\u73af\u5883\u4e2d\u90fd\u662f\u540c\u4e00\u4e2a\u7c7b\u3002\u76f8\u53cd\uff0c\u7cfb\u7edf\u4e2d\u5c06\u4f1a\u51fa\u73b0\u591a\u4e2a\u4e0d\u540c\u7684Object\u7c7b\uff0cJava\u7c7b\u578b\u4f53\u7cfb\u4e2d\u6700\u57fa\u7840\u7684\u884c\u4e3a\u4e5f\u5c31\u65e0\u6cd5\u4fdd\u8bc1\uff0c\u5e94\u7528\u7a0b\u5e8f\u4e5f\u5c06\u4f1a\u53d8\u5f97\u4e00\u7247\u6df7\u4e71\u3002</p>"},{"location":"JVM/4_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/","title":"4 Java\u5185\u5b58\u6a21\u578b\u4e0e\u7ebf\u7a0b","text":""},{"location":"JVM/4_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/#_1","title":"\u6982\u8ff0","text":"<p>\u591a\u4efb\u52a1\u5904\u7406\u5728\u73b0\u4ee3\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5fc5\u8981\u6027\u3002 \u9996\u5148\u8981\u5145\u5206\u5229\u7528\u8ba1\u7b97\u673a\u5904\u7406\u5668\u7684\u8fd0\u7b97\u80fd\u529b\uff0c\u7531\u4e8e\u8ba1\u7b97\u673a\u7684\u8fd0\u7b97\u901f\u5ea6\u4e0e\u5b83\u7684\u5b58\u50a8\u548c\u901a\u4fe1\u5b50\u7cfb\u7edf\u901f\u5ea6\u5dee\u8ddd\u592a\u5927\uff0c\u4e0d\u80fd\u8ba9\u5927\u91cf\u7684\u65f6\u95f4\u88ab\u6d6a\u8d39\u5728\u78c1\u76d8I/O\u3001\u7f51\u7edc\u901a\u4fe1\u6216\u8005\u6570\u636e\u5e93\u8bbf\u95ee\u4e0a\u3002 \u53e6\u5916\uff0c\u5e76\u53d1\u80fd\u591f\u8ba9\u4e00\u4e2a\u670d\u52a1\u7aef\u540c\u65f6\u5bf9\u591a\u4e2a\u5ba2\u6237\u7aef\u63d0\u4f9b\u670d\u52a1\u3002\u8861\u91cf\u4e00\u4e2a\u670d\u52a1\u6027\u80fd\u7684\u9ad8\u4f4e\u597d\u574f\uff0c\u6bcf\u79d2\u4e8b\u52a1\u5904\u7406\u6570(Transactions Per Second,TPS)\u662f\u6700\u91cd\u8981\u7684\u6307\u6807\u4e4b\u4e00\uff0c\u5b83\u4ee3\u8868\u7740\u4e00\u79d2\u5185\u670d\u52a1\u7aef\u5e73\u5747\u80fd\u54cd\u5e94\u7684\u8bf7\u6c42\u603b\u6570\u3002</p>"},{"location":"JVM/4_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/#_2","title":"\u786c\u4ef6\u6548\u7387\u548c\u4e00\u81f4\u6027","text":"<p>\u5728\u7406\u89e3Java\u865a\u62df\u673a\u5e76\u53d1\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3\u7269\u7406\u8ba1\u7b97\u673a\u4e2d\u7684\u5e76\u53d1\u95ee\u9898\u3002</p> <p>\u7531\u4e8e\u8ba1\u7b97\u673a\u7684\u5b58\u50a8\u8bbe\u5907\u4e0e\u5904\u7406\u5668\u7684\u8fd0\u7b97\u901f\u5ea6\u6709\u51e0\u4e2a\u6570\u91cf\u7ea7\u7684\u5dee\u8ddd\uff0c\u6240\u6709\u73b0\u4ee3\u8ba1\u7b97\u673a\u7cfb\u7edf\u90fd\u4e0d\u5f97\u4e0d\u52a0\u5165\u4e00\u5c42\u8bfb\u5199\u901f\u5ea6\u5c3d\u53ef\u80fd\u89e3\u51b3\u5904\u7406\u5668\u8fd0\u7b97\u901f\u5ea6\u7684\u9ad8\u901f\u7f13\u5b58\uff08Cache\uff09\u6765\u4f5c\u4e3a\u5185\u5b58\u4e0e\u5904\u7406\u5668\u4e4b\u95f4\u7684\u7f13\u51b2\uff1a\u5c06\u8fd0\u7b97\u9700\u8981\u4f7f\u7528\u5230\u7684\u6570\u636e\u590d\u5236\u5230\u7f13\u5b58\u4e2d\uff0c\u8ba9\u8fd0\u7b97\u80fd\u5feb\u901f\u8fd0\u884c\uff0c\u5f53\u8fd0\u7b97\u7ed3\u675f\u540e\u518d\u4ece\u7f13\u5b58\u540c\u6b65\u56de\u5185\u5b58\u5185\u5b58\u4e4b\u4e2d\uff0c\u8fd9\u6837\u5904\u7406\u5668\u5c31\u65e0\u987b\u7b49\u5f85\u7f13\u6162\u7684\u5185\u5b58\u8bfb\u5199\u4e86\u3002</p> <p>\u57fa\u4e8e\u9ad8\u901f\u7f13\u5b58\u7684\u5b58\u50a8\u4ea4\u4e92\u5f88\u597d\u5730\u89e3\u51b3\u4e86\u5904\u7406\u5668\u4e0e\u5185\u5b58\u7684\u901f\u5ea6\u77db\u76fe\uff0c\u4f46\u662f\u4e5f\u4e3a\u8ba1\u7b97\u673a\u7cfb\u7edf\u5e26\u6765\u66f4\u9ad8\u7684\u590d\u6742\u5ea6\uff0c\u5b83\u5f15\u5165\u4e86\u4e00\u4e2a\u65b0\u7684\u95ee\u9898\uff1a\u7f13\u5b58\u4e00\u81f4\u6027\u3002\u5f53\u591a\u4e2a\u5904\u7406\u5668\u7684\u8fd0\u7b97\u4efb\u52a1\u90fd\u6d89\u53ca\u5230\u540c\u4e00\u4e3b\u5185\u5b58\u533a\u57df\u662f\uff0c\u5c06\u53ef\u80fd\u5bfc\u81f4\u5404\u81ea\u7684\u7f13\u5b58\u6570\u636e\u4e0d\u4e00\u81f4\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u7f13\u5b58\u4e00\u81f4\u6027\uff0c\u9700\u8981\u5404\u4e2a\u5904\u7406\u5668\u8bbf\u95ee\u7f13\u5b58\u65f6\u90fd\u9075\u5faa\u4e00\u4e9b\u534f\u8bae\uff0c\u5728\u8bfb\u5199\u65f6\u6839\u636e\u534f\u8bae\u6765\u64cd\u4f5c\u3002</p> <p></p> <p>\u672c\u7ae0\u4e2d\u8bf4\u5230\u7684\u201c\u5185\u5b58\u6a21\u578b\u201d\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5728\u7279\u5b9a\u7684\u64cd\u4f5c\u534f\u8bae\u4e0b\uff0c\u5bf9\u7279\u5b9a\u7684\u5185\u5b58\u6216\u9ad8\u901f\u7f13\u5b58\u8fdb\u884c\u8bfb\u5199\u8bbf\u95ee\u7684\u8fc7\u7a0b\u62bd\u8c61\u3002</p>"},{"location":"JVM/4_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/#java","title":"Java\u5185\u5b58\u6a21\u578b","text":"<p>Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u8bd5\u56fe\u5b9a\u4e49\u4e00\u79cdJava\u5185\u5b58\u6a21\u578b\uff08Java Memory Model\uff0cJMM\uff09\u6765\u5c4f\u853d\u6389\u5404\u79cd\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u8bbf\u95ee\u5dee\u5f02\uff0c\u4ee5\u5b9e\u73b0\u8ba9Java\u7a0b\u5e8f\u5728\u5404\u79cd\u5e73\u53f0\u4e0b\u90fd\u80fd\u8fbe\u5230\u4e00\u81f4\u7684\u5185\u5b58\u8bbf\u95ee\u6548\u679c\u3002</p> <p>\u76ee\u6807 Java\u5185\u5b58\u6a21\u578b\u7684\u4e3b\u8981\u76ee\u6807\u662f\u5b9a\u4e49\u7a0b\u5e8f\u4e2d\u5404\u4e2a\u53d8\u91cf\u7684\u8bbf\u95ee\u89c4\u5219\uff0c\u5373\u5728\u865a\u62df\u673a\u4e2d\u5c06\u53d8\u91cf\u5b58\u50a8\u5230\u5185\u5b58\u548c\u4ece\u5185\u5b58\u4e2d\u53d6\u51fa\u53d8\u91cf\u8fd9\u6837\u7684\u7684\u5e95\u5c42\u7ec6\u8282\u3002</p> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u53d8\u91cf\u4e0eJava\u7f16\u7a0b\u4e2d\u6240\u8bf4\u7684\u53d8\u91cf\u6709\u6240\u533a\u522b\uff0c\u5b83\u5305\u62ec\u4e86\u5b9e\u4f8b\u5b57\u6bb5\u3001\u9759\u6001\u5b57\u6bb5\u548c\u6784\u6210\u6570\u7ec4\u5bf9\u8c61\u7684\u5143\u7d20\uff0c\u4f46\u4e0d\u5305\u62ec\u5c40\u90e8\u53d8\u91cf\u4e0e\u65b9\u6cd5\u53c2\u6570\uff0c\u56e0\u4e3a\u540e\u8005\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff0c\u4e0d\u4f1a\u88ab\u72ec\u4eab\uff0c\u81ea\u7136\u5c31\u4e0d\u4f1a\u5b58\u5728\u7ade\u4e89\u95ee\u9898\u3002</p> <p>Java\u5185\u5b58\u6a21\u578b\u89c4\u5b9a\u4e86\u6240\u6709\u7684\u53d8\u91cf\u90fd\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff08\u6b64\u5904\u7684\u4e3b\u5185\u5b58\u4e0e\u4ecb\u7ecd\u7269\u7406\u786c\u4ef6\u65f6\u7684\u4e3b\u5185\u5b58\u540d\u5b57\u4e00\u6837\uff0c\u4e24\u8005\u4e5f\u53ef\u4ee5\u76f8\u4e92\u7c7b\u6bd4\uff0c\u4f46\u6b64\u5904\u4ec5\u4ec5\u662f\u865a\u62df\u673a\u5185\u5b58\u7684\u4e00\u90e8\u5206\uff09\u3002\u6bcf\u6761\u7ebf\u7a0b\u8fd8\u6709\u81ea\u5df1\u7684\u5de5\u4f5c\u5185\u5b58\uff0c\u53ef\u4e0e\u5904\u7406\u5668\u9ad8\u901f\u7f13\u5b58\u7c7b\u4f3c\uff0c\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u4e2d\u4fdd\u5b58\u4e86\u88ab\u8be5\u7ebf\u7a0b\u4f7f\u7528\u5230\u7684\u53d8\u91cf\u7684\u4e3b\u5185\u5b58\u526f\u672c\u62f7\u8d1d\uff0c\u7ebf\u7a0b\u5bf9\u53d8\u91cf\u7684\u6240\u6709\u64cd\u4f5c\uff08\u8bfb\u53d6\u3001\u8d4b\u503c\u7b49\uff09\u90fd\u5fc5\u987b\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u8fdb\u884c\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u8bfb\u5199\u4e3b\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u7ebf\u7a0b\u95f4\u53d8\u91cf\u503c\u5f97\u4f20\u9012\u5747\u9700\u8981\u901a\u8fc7\u4e3b\u5185\u5b58\u6765\u5b8c\u6210\u3002</p> <p></p> <p>JMM\u4e2d\u6240\u8bf4\u7684\u4e3b\u5185\u5b58\u3001\u5de5\u4f5c\u5185\u5b58\u4e0eJava\u5185\u5b58\u533a\u57df\u4e2d\u7684Java\u5806\u3001\u6808\u3001\u65b9\u6cd5\u533a\u7b49\u5e76\u4e0d\u662f\u540c\u4e00\u4e2a\u5c42\u6b21\u7684\u5212\u5206\uff0c\u8fd9\u4e24\u8005\u57fa\u672c\u4e0a\u662f\u6ca1\u6709\u5173\u7cfb\u7684\uff0c\u5982\u679c\u4e24\u8005\u4e00\u5b9a\u8981\u52c9\u5f3a\u5bf9\u5e94\u8d77\u6765\uff0c\u90a3\u4ece\u53d8\u91cf\u3001\u4e3b\u5185\u5b58\u3001\u5de5\u4f5c\u5185\u5b58\u7684\u5b9a\u4e49\u6765\u770b\uff0c\u4e3b\u5185\u5b58\u4e3b\u8981\u5bf9\u5e94\u4e8eJava\u5806\u4e2d\u7684\u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\u90e8\u5206\uff0c\u800c\u5de5\u4f5c\u5185\u5b58\u5219\u5bf9\u5e94\u4e8e\u865a\u62df\u673a\u6808\u4e2d\u7684\u90e8\u5206\u533a\u57df\u3002\u4ece\u66f4\u4f4e\u5c42\u6b21\u4e0a\u8bf4\uff0c\u4e3b\u5185\u5b58\u5c31\u76f4\u63a5\u5bf9\u5e94\u4e8e\u7269\u7406\u786c\u4ef6\u7684\u5185\u5b58\uff0c\u800c\u4e3a\u4e86\u83b7\u53d6\u66f4\u597d\u7684\u8fd0\u884c\u901f\u5ea6\uff0c\u865a\u62df\u673a\u53ef\u80fd\u4f1a\u8ba9\u5de5\u4f5c\u5185\u5b58\u4f18\u5148\u5b58\u50a8\u4e8e\u5bc4\u5b58\u5668\u548c\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u56e0\u4e3a\u7a0b\u5e8f\u8fd0\u884c\u65f6\u4e3b\u8981\u8bbf\u95ee\u7684\u662f\u5de5\u4f5c\u5185\u5b58\u3002</p>"},{"location":"JVM/4_Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/#_3","title":"\u5185\u5b58\u95f4\u4ea4\u4e92\u64cd\u4f5c","text":"<p>\u5173\u4e8e\u4e3b\u5185\u5b58\u4e0e\u5de5\u4f5c\u5185\u5b58\u4e4b\u95f4\u5177\u4f53\u7684\u4ea4\u4e92\u534f\u8bae\uff0c\u5373\u4e00\u4e2a\u53d8\u91cf\u5982\u4f55\u4ece\u4e3b\u5185\u5b58\u62f7\u8d1d\u5230\u5de5\u4f5c\u5185\u5b58\u3001\u5982\u4f55\u4ece\u5de5\u4f5c\u5185\u5b58\u540c\u6b65\u56de\u4e3b\u5185\u5b58\u4e4b\u7c7b\u7684\u5b9e\u73b0\u7ec6\u8282\uff0cJava\u5185\u5b58\u6a21\u578b\u4e2d\u5b9a\u4e49\u4e86\u4ee5\u4e0b8\u79cd\u64cd\u4f5c\u6765\u5b8c\u6210\u3002</p> <p>\u865a\u62df\u673a\u5fc5\u987b\u4fdd\u8bc1\u8fd98\u79cd\u64cd\u4f5c\u6bcf\u4e00\u79cd\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u7684\uff0c\u4e0d\u53ef\u518d\u5206\u7684\u3002</p> <ul> <li>lock(\u9501\u5b9a)\uff1a \u4f5c\u7528\u57df\u4e3b\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u4e00\u4e2a\u53d8\u91cf\u6807\u8bc6\u4e3a\u4e00\u6761\u7ebf\u7a0b\u72ec\u5360\u7684\u88c5\u586b\u3002</li> <li>unlock(\u89e3\u9501)\uff1a\u4f5c\u7528\u4e8e\u4e3b\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u4e00\u4e2a\u5904\u4e8e\u9501\u5b9a\u72b6\u6001\u7684\u53d8\u91cf\u91ca\u653e\u51fa\u6765\uff0c\u91ca\u653e\u540e\u7684\u53d8\u91cf\u624d\u53ef\u4ee5\u88ab\u5176\u4ed6\u7ebf\u7a0b\u9501\u5b9a\u3002</li> <li>read(\u8bfb\u53d6)\uff1a\u4f5c\u7528\u4e8e\u4e3b\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4ece\u4e3b\u5185\u5b58\u4f20\u8f93\u5230\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u968f\u540e\u7684load\u52a8\u4f5c\u4f7f\u7528\u3002</li> <li>load(\u8f7d\u5165)\uff1a\u4f5c\u7528\u4e8e\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628aread\u64cd\u4f5c\u4ece\u4e3b\u5185\u5b58\u4e2d\u5f97\u5230\u7684\u53d8\u91cf\u503c\u653e\u5165\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\u526f\u672c\u4e2d\u3002</li> <li>use(\u4f7f\u7528)\uff1a\u4f5c\u7528\u4e8e\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u5de5\u4f5c\u5185\u5b58\u4e2d\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4f20\u9012\u7ed9\u6267\u884c\u5f15\u64ce\uff0c\u6bcf\u5f53\u865a\u62df\u673a\u9047\u5230\u4e00\u4e2a\u9700\u8981\u4f7f\u7528\u5230\u53d8\u91cf\u7684\u503c\u5f97\u5b57\u8282\u7801\u6307\u4ee4\u65f6\u5c06\u4f1a\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u3002</li> <li>assign(\u8d4b\u503c)\uff1a\u4f5c\u7528\u4e8e\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u4e00\u4e2a\u4ece\u6267\u884c\u5f15\u64ce\u63a5\u6536\u5230\u7684\u503c\u8d4b\u503c\u7ed9\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u6bcf\u5f53\u865a\u62df\u673a\u9047\u5230\u4e00\u4e2a\u7ed9\u53d8\u91cf\u8d4b\u503c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u65f6\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u3002</li> <li>store(\u5b58\u50a8)\uff1a\u4f5c\u7528\u4e8e\u5de5\u4f5c\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628a\u5de5\u4f5c\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4f20\u9001\u5230\u4e3b\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u968f\u540e\u7684write\u64cd\u4f5c\u4f7f\u7528\u3002</li> <li>write(\u5199\u5165)\uff1a\u4f5c\u7528\u4e8e\u4e3b\u5185\u5b58\u7684\u53d8\u91cf\uff0c\u5b83\u628astore\u64cd\u4f5c\u4ece\u5de5\u4f5c\u5185\u5b58\u4e2d\u5f97\u5230\u7684\u53d8\u91cf\u7684\u503c\u653e\u5165\u4e3b\u5185\u5b58\u7684\u53d8\u91cf\u4e2d\u3002</li> </ul> <p>\u5982\u679c\u8981\u628a\u4e00\u4e2a\u53d8\u91cf\u4ece\u4e3b\u5185\u5b58\u590d\u5236\u5230\u5de5\u4f5c\u5185\u5b58\uff0c\u90a3\u5c31\u8981\u987a\u5e8f\u5730\u6267\u884cread\u548cload\u64cd\u4f5c\uff0c\u5982\u679c\u8981\u628a\u53d8\u91cf\u4ece\u5de5\u4f5c\u5185\u5b58\u540c\u6b65\u5230\u4e3b\u5185\u5b58\uff0c\u5c31\u8981\u987a\u5e8f\u5730\u6267\u884cstore\u548cwrite\u64cd\u4f5c\u3002\u6ce8\u610f\uff0cJava\u5185\u5b58\u6a21\u578b\u8981\u6c42\u4e0a\u8ff0\u4e24\u4e2a\u64cd\u4f5c\u5fc5\u987b\u6309\u987a\u5e8f\u6267\u884c\uff0c\u800c\u6ca1\u6709\u4fdd\u8bc1\u662f\u8fde\u7eed\u6267\u884c\u3002</p> <p>Java\u5185\u5b58\u8fd8\u89c4\u5b9a\u4e86\u5728\u6267\u884c\u4e0a\u8ff08\u79cd\u64cd\u4f5c\u65f6\u5fc5\u987b\u6ee1\u8db3\u5982\u4e0b\u89c4\u5219\uff1a * \u4e0d\u5141\u8bb8read\u548cload\u3001store\u548cwrite\u64cd\u4f5c\u4e4b\u4e00\u5355\u72ec\u51fa\u73b0\uff0c\u5373\u4e0d\u5141\u8bb8\u4e00\u4e2a\u53d8\u91cf\u4ece\u4e3b\u5185\u5b58\u8bfb\u53d6\u4e86\u4f46\u5de5\u4f5c\u5185\u5b58\u4e0d\u63a5\u6536\uff0c\u6216\u8005\u4ece\u5de5\u4f5c\u5185\u5b58\u53d1\u8d77\u56de\u5199\u4e86\u4f46\u4e3b\u5185\u5b58\u4e0d\u63a5\u53d7\u7684\u60c5\u51b5\u51fa\u73b0\u3002 * \u4e0d\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u4e22\u5f03\u5b83\u7684assign\u64cd\u4f5c\uff0c\u5373\u53d8\u91cf\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u6539\u53d8\u4e86\u4e4b\u540e\u5fc5\u987b\u628a\u8be5\u53d8\u5316\u540c\u6b65\u56de\u4e3b\u5185\u5b58\u3002 * \u4e0d\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u65e0\u539f\u56e0\u5730\uff08\u6ca1\u6709\u53d1\u751f\u8fc7\u4efb\u4f55assign\u64cd\u4f5c\uff09\u628a\u6570\u636e\u4ece\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u540c\u6b65\u4f1a\u4e3b\u5185\u5b58\u4e2d\u3002 * \u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u53ea\u80fd\u5728\u4e3b\u5185\u5b58\u4e2d\u201d\u8bde\u751f\u201c\uff0c\u4e0d\u5141\u8bb8\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u76f4\u63a5\u4f7f\u7528\u4e00\u4e2a\u672a\u88ab\u521d\u59cb\u5316\uff08load\u6216assign\uff09\u7684\u53d8\u91cf\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u5bf9\u4e00\u4e2a\u53d8\u91cf\u5b9e\u65bduse\u3001store\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u6267\u884c\u8fc7\u4e86assign\u548cload\u64cd\u4f5c\u3002 * \u4e00\u4e2a\u53d8\u91cf\u5728\u540c\u4e00\u4e2a\u65f6\u523b\u53ea\u5141\u8bb8\u4e00\u6761\u7ebf\u7a0b\u5bf9\u5176\u8fdb\u884clock\u64cd\u4f5c\uff0c\u4f46lock\u64cd\u4f5c\u53ef\u4ee5\u88ab\u540c\u4e00\u6761\u7ebf\u7a0b\u91cd\u590d\u6267\u884c\u591a\u6b21\uff0c\u591a\u6b21\u6267\u884clock\u540e\uff0c\u53ea\u6709\u6267\u884c\u76f8\u540c\u6b21\u6570\u7684unlock\uff0c\u53d8\u91cf\u624d\u4f1a\u88ab\u89e3\u9501\u3002 * \u5410\u8fc7\u5bf9\u4e00\u4e2a\u53d8\u91cf\u6267\u884clock\u64cd\u4f5c\uff0c\u90a3\u5c06\u4f1a\u6e05\u7a7a\u5de5\u4f5c\u5185\u5b58\u4e2d\u6b64\u53d8\u91cf\u7684\u503c\uff0c\u5728\u6267\u884c\u5f15\u64ce\u4f7f\u7528\u8fd9\u4e2a\u53d8\u91cf\u524d\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cload\u6216assign\u64cd\u4f5c\u521d\u59cb\u5316\u53d8\u91cf\u7684\u503c\u3002 * \u5bf9\u4e00\u4e2a\u53d8\u91cf\u6267\u884cunlock\u64cd\u4f5c\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u628a\u6b64\u53d8\u91cf\u540c\u6b65\u56de\u4e3b\u5185\u5b58\u4e2d\uff08\u6267\u884cstore\u3001write\u64cd\u4f5c\uff09\u3002</p> <p>https://www.jianshu.com/p/90a036212cb4</p>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/","title":"7 JVM\u7c7b\u52a0\u8f7d\u5668","text":""},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#jvm","title":"JVM\u7c7b\u52a0\u8f7d\u5668","text":"<p>\u987e\u540d\u601d\u4e49\uff0c\u7c7b\u7684\u52a0\u8f7d\u5668\u5c31\u662f\u8d1f\u8d23\u7c7b\u7684\u52a0\u8f7d\u804c\u8d23\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2aclass\uff0c\u90fd\u9700\u8981\u7531\u52a0\u8f7d\u4ed6\u7684\u7c7b\u52a0\u8f7d\u5668\u548c\u8fd9\u4e2a\u7c7b\u672c\u8eab\u786e\u7acb\u5176\u5728JVM\u4e2d\u7684\u552f\u4e00\u6027\u3002</p> <p>\u5728\u6df1\u5165\u7406\u89e3Java\u865a\u62df\u673a\u4e2d\u6709\u4ecb\u7ecd\uff0c\u7c7b\u7684\u52a0\u8f7d\u5206\u4e3a\u597d\u51e0\u4e2a\u6b65\u9aa4\uff0c\u865a\u62df\u673a\u628a\u63cf\u8ff0\u7c7b\u7684\u6570\u636e\u4eceClass\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u6821\u9a8c\u3001\u8f6c\u6362\u89e3\u6790\u548c\u521d\u59cb\u5316\uff0c\u6700\u7ec8\u5f62\u6210\u53ef\u4ee5\u88ab\u865a\u62df\u673a\u76f4\u63a5\u8fd0\u8425\u7684Java\u7c7b\uff0c\u8fd9\u4e2a\u79f0\u4e3a\u7c7b\u7684\u52a0\u8f7d\uff0c\u5177\u4f53\u53ef\u4ee5\u67e5\u770bJVM\u7c7b\u52a0\u8f7d\u673a\u5236\u8fd9\u7bc7\u7684\u603b\u7ed3\uff0c\u672c\u7bc7\u8981\u8bb2\u7684\u7c7b\u52a0\u8f7d\u5668\u5219\u662f\u7c7b\u7684\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\u52a0\u8f7d\u8fd9\u4e2a\u52a8\u4f5c\u5177\u4f53\u7684\u624b\u6bb5\u3002</p>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#jvm_1","title":"JVM\u5185\u7f6e\u4e09\u5927\u7c7b\u52a0\u8f7d\u5668","text":"<p>JVM\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e09\u5927\u5185\u7f6e\u7684\u7c7b\u52a0\u8f7d\u5668\uff0c\u4e0d\u540c\u7684\u7c7b\u52a0\u8f7d\u5668\u8d1f\u8d23\u5c06\u4e0d\u540c\u7684\u7c7b\u52a0\u8f7d\u5230JVM\u5185\u5b58\u4e4b\u4e2d\uff0c\u5e76\u4e14\u5b83\u4eec\u4e25\u683c\u9075\u5b88\u7740\u7236\u59d4\u6258\u7684\u673a\u5236\u3002</p> <p></p>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#bootstrap-classloader","title":"BootStrap ClassLoader(\u6839\u7c7b\u52a0\u8f7d\u5668)","text":"<p>BootStrap ClassLoader\u662f\u6700\u4e3a\u9876\u5c42\u7684\u52a0\u8f7d\u5668\uff0c\u5176\u6ca1\u6709\u4efb\u4f55\u7236\u52a0\u8f7d\u5668\uff0c\u5b83\u662f\u7531C++\u7f16\u5199\u7684\uff0c\u4e3b\u8981\u8d1f\u8d23\u865a\u62df\u673a\u6838\u5fc3\u7c7b\u5e93\u7684\u52a0\u8f7d\uff0c\u6bd4\u5982\u6574\u4e2ajava.lang\u5305\u90fd\u662f\u7531BootStrap ClassLoader\u6765\u52a0\u8f7d\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7-Xbootclasspath\u6765\u6307\u5b9aBootStrap ClassLoader\u7684\u52a0\u8f7d\u8def\u5f84\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5c5e\u6027\u6765\u5f97\u77e5\u5f53\u524dJVM\u7684BootStrap ClassLoader\u90fd\u52a0\u8f7d\u4e86\u54ea\u4e9b\u8d44\u6e90\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>\npublic class TestClassLoader {\n\n    public static void main(String[] args) {\n        System.out.println(\"BootStrap: \" + String.class.getClassLoader());\n\n        System.out.println(System.getProperty(\"sun.boot.class.path\"));\n    }\n\n}\n\n</code></pre> <p>\u7a0b\u5e8f\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff0c\u5176\u4e2dString.class\u7684\u7c7b\u52a0\u8f7d\u5668\u662fBootStrap ClassLoader\uff0c\u5b83\u662f\u83b7\u53d6\u4e0d\u5230\u5f15\u7528\u7684\uff0c\u6240\u4ee5\u4e3anull\uff0c\u800cBootStrap ClassLoader\u6240\u5728\u7684\u52a0\u8f7d\u8def\u5f84\u662f\u53ef\u4ee5\u901a\u8fc7sun.boot.class.path\u8fd9\u4e2a\u7cfb\u7edf\u5c5e\u6027\u6765\u83b7\u53d6\u5230\u7684\u3002</p> <p>\u6ce8\u610f\uff1a\u8fd9\u91cc\u591a\u4e2apath\u662f\u7528:\u6765\u9694\u5f00\u7684\uff0c\u56e0\u4e3a\u6211\u662f\u5728Mac\u4e0a\u8dd1\u7684\u7a0b\u5e8f\uff0c\u5982\u679cWindows\u4e0a\u5e94\u8be5\u662f\u4ee5;\u6765\u5206\u9694\u591a\u4e2apath</p> <pre><code>BootStrap: null\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/resources.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/rt.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/sunrsasign.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jsse.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jce.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/charsets.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/jfr.jar:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/classes\n</code></pre>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#ext-classloader","title":"Ext ClassLoader(\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668)","text":"<p>Ext ClassLoader\u7684\u7236\u52a0\u8f7d\u5668\u662fBootStrap ClassLoader\uff0c\u5b83\u4e3b\u8981\u7528\u4e8e\u52a0\u8f7dJAVA_HOME\u4e0b\u7684jre\\lb\\ext\u7684\u5b50\u76ee\u5f55\u91cc\u9762\u7684\u7c7b\u5e93\u3002Ext ClassLoader\u662f\u7531\u7eafJava\u8bed\u8a00\u5b9e\u73b0\u7684\uff0c\u5b83\u662fjava.lang.URLClassLoader\u7684\u5b50\u7c7b\uff0c\u5b83\u7684\u5b8c\u6574\u7c7b\u540d\u662fsun.misc.Launcher$ExtCladdLoader\u3002Ext ClassLoader\u6240\u52a0\u8f7d\u7684\u7c7b\u5e93\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5c5e\u6027java.ext.dirs\u83b7\u5f97\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>public class ExtCladdLoader {\n    public static void main(String[] args) {\n        System.out.println(System.getProperty(\"java.ext.dirs\"));\n    }\n}\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>/Users/gaohui/Library/Java/Extensions:\n/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/ext:\n/Library/Java/Extensions:\n/Network/Library/Java/Extensions:\n/System/Library/Java/Extensions:/usr/lib/java\n</code></pre>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#application-classloader","title":"Application ClassLoader\uff08\u5e94\u7528\u7c7b\u52a0\u8f7d\u5668\uff09","text":"<p>\u5e94\u7528\u7c7b\u52a0\u8f7d\u5668\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u7c7b\u52a0\u8f7d\u5668\uff0c\u5176\u8d1f\u8d23\u52a0\u8f7dclasspath\u4e0b\u7684\u7c7b\u5e93\u8d44\u6e90\u3002 \u5e94\u7528\u7c7b\u52a0\u8f7d\u5668\u7684\u7236\u52a0\u8f7d\u5668\u662f\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\uff0c\u540c\u65f6\u5b83\u4e5f\u662f\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u7684\u9ed8\u8ba4\u7236\u52a0\u8f7d\u5668\uff0c\u5e94\u7528\u7c7b\u52a0\u8f7d\u5668\u7684\u52a0\u8f7d\u8def\u5f84\u4e00\u822c\u901a\u8fc7-classpath\u6216\u8005-cp\u6307\u5b9a\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u5c5e\u6027java.class.path\u8fdb\u884c\u83b7\u53d6\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a</p> <p>```java public class ApplicationClassLoader {     public static void main(String[] args) {         System.out.println(System.getProperty(\"java.class.path\"));         System.out.println(ApplicationClassLoader.class.getClassLoader());     }</p> <p>}  ```</p> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a  <code>/Users/gaohui/Documents/workspace1/Test/bin sun.misc.Launcher$AppClassLoader@2a139a55</code></p> <p>### \u81ea\u5b9a\u4e49ClassLoader  \u6240\u6709\u7684\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u90fd\u662fClassLoader\u7684\u76f4\u63a5\u5b50\u7c7b\u6216\u95f4\u63a5\u5b50\u7c7b\uff0cjava.lang.ClassLoader\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u5b83\u91cc\u9762\u5e76\u6ca1\u6709\u62bd\u8c61\u65b9\u6cd5\uff0c\u4f46\u662f\u6709findClass\u65b9\u6cd5\uff0c\u52a1\u5fc5\u5b9e\u73b0\u8be5\u65b9\u6cd5\uff0c\u5426\u5219\u5c06\u4f1a\u629b\u51faClass\u627e\u4e0d\u5230\u7684\u5f02\u5e38\u3002  <code>java    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {         throw new ClassNotFoundException(name);     }</code></p> <p>```java package main;</p> <p>import java.io.ByteArrayOutputStream; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths;</p> <p>public class MyClassLoader extends ClassLoader {</p> <pre><code>private final static Path DEFAULT_CLASS_DIR = Paths.get(\"/Users/gaohui\");\n\nprivate final Path classDir;\n\npublic MyClassLoader() {\n    super();\n    this.classDir = DEFAULT_CLASS_DIR;\n}\n//\u5141\u8bb8\u4f20\u5165\u6307\u5b9a\u8def\u5f84\u7684class \u8def\u5f84\npublic MyClassLoader(String classDir) {\n    super();\n    this.classDir = Paths.get(classDir);\n}\n\npublic MyClassLoader(String classDir,ClassLoader parent) {\n    super(parent);\n    this.classDir = Paths.get(classDir);\n}\n@Override\nprotected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {\n    //\u8bfb\u53d6class\u7684\u4e8c\u8fdb\u5236\u6570\u636e\n    byte[] classBytes = this.readClassBytes(name);\n    if(classBytes == null || classBytes.length ==0) {\n        throw new ClassNotFoundException(\"Can not load the class \" + name);\n    }\n    //\u8c03\u7528defineClass\u65b9\u6cd5\u5b9a\u4e49class\n    return this.defineClass(name, classBytes, 0,classBytes.length);\n}\n\n//\u5c06class\u6587\u4ef6\u8bfb\u5165\u5185\u5b58\nprivate byte[] readClassBytes(String name) throws ClassNotFoundException {\n    //\u5c06\u5305\u540d\u5206\u9694\u7b26\u8f6c\u6362\u4e3a\u6587\u4ef6\u8def\u5f84\u5206\u9694\u7b26\n    String classPath = name.replace(\".\", \"/\");\n    Path classFullPath = classDir.resolve(Paths.get(classPath + \".class\"));\n    System.out.println(classFullPath.toFile().exists());\n    System.out.println(classFullPath.toAbsolutePath().toString());\n    if(!classFullPath.toFile().exists()) {\n        throw new ClassNotFoundException(\"The class \" + name + \" not found\");\n    }\n\n    try {\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        Files.copy(classFullPath, baos);\n        return baos.toByteArray();\n    } catch (IOException e) {\n        throw new ClassNotFoundException(\"load the class \" + name + \" occur error\");\n    }\n}\n</code></pre> <p>}</p> <p>```  \u6211\u4eec\u5b8c\u6210\u4e86\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u57fa\u4e8e\u78c1\u76d8\u7684ClassLoader\u7684\u5b9a\u4e49\uff0c\uff0c\u51e0\u4e2a\u5173\u952e\u7684\u5730\u65b9\u90fd\u5df2\u7ecf\u505a\u4e86\u6807\u6ce8\uff0c\u7b2c\u4e00\u4e2a\u6784\u9020\u51fd\u6570\u4f7f\u7528\u9ed8\u8ba4\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u7b2c\u4e8c\u4e2a\u6784\u9020\u51fd\u6570\u5141\u8bb8\u5916\u90e8\u6307\u5b9a\u4e00\u4e2a\u7279\u5b9a\u7684\u78c1\u76d8\u76ee\u5f55\uff0c\u7b2c\u4e09\u4e2a\u6784\u9020\u51fd\u6570\u51fa\u6765\u53ef\u4ee5\u6307\u5b9a\u78c1\u76d8\u76ee\u5f55\u4ee5\u5916\u8fd8\u53ef\u4ee5\u6307\u5b9a\u8be5\u7c7b\u52a0\u8f7d\u5668\u7684\u7236\u52a0\u8f7d\u5668\u3002</p> <p>\u5728\u6211\u4eec\u5b9a\u4e49\u7684\u7c7b\u52a0\u8f7d\u5668\u4e2d\uff0c\u901a\u8fc7\u5c06\u7c7b\u7684\u5168\u540d\u79f0\u8f6c\u6362\u6210\u6587\u4ef6\u7684\u5168\u8def\u5f84\u91cd\u5199findClass\u65b9\u6cd5\uff0c\u7136\u540e\u8bfb\u53d6class\u6587\u4ef6\u7684\u5b57\u8282\u6d41\u6570\u636e\uff0c\u6700\u540e\u4f7f\u7528ClassLoader\u7684defineClass\u65b9\u6cd5\u5bf9class\u5b8c\u6210\u4e86\u5b9a\u4e49\u3002</p> <p>\u8fd9\u91cc\u6709\u6709\u4e24\u4e2a\u5730\u65b9\u9700\u8981\u6ce8\u610f\uff1a \u7b2c\u4e00\uff0c\u5173\u4e8e\u7c7b\u7684\u5168\u8def\u5f84\u683c\u5f0f\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6211\u4eec\u7684\u7c7b\u90fd\u662f\u7c7b\u4f3c\u4e8ejava.lang.String\u8fd9\u6837\u7684\u683c\u5f0f\uff0c\u4f46\u662f\u6709\u65f6\u4e0d\u6392\u9664\u5185\u90e8\u7c7b\uff0c\u533f\u540d\u5185\u90e8\u7c7b\u7b49\uff1b\u5168\u8def\u5f84\u683c\u5f0f\u6709\u5982\u4e0b\u51e0\u79cd\u60c5\u51b5\u3002  - java.lang.String: \u5305\u540d.\u7c7b\u540d  - javax.swing.JSpinner$DefaultEditor:\u5305\u540d.\u7c7b\u540d$\u5185\u90e8\u7c7b  - javax.security.KeyStore$Builder$FileBuilder$1:\u5305\u540d.\u7c7b\u540d$\u5185\u90e8\u7c7b$\u5185\u90e8\u7c7b$\u533f\u540d\u5185\u90e8\u7c7b</p> <p>\u53e6\u5916\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u4e2a\u5305\u540d\u5bf9\u5e94\u5176\u5b9e\u662f\u4e00\u4e2a\u76ee\u5f55\uff0c\u5982\u679c\u53ea\u662f\u5728java\u4ee3\u7801\u6700\u4e0a\u9762\u52a0\u5165package xxx;\u8fd9\u6837\u7684\u5305\u540d\u662f\u65e0\u6548\u7684\uff0c\u76f8\u5f53\u4e8e\u6ca1\u6709\u5b9a\u4e49\u5305\u540d\u3002 \u7b2c\u4e8c\uff0c\u9700\u8981\u5f3a\u8c03\u7684\u662fdefineClass\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7684\u5b8c\u6574\u65b9\u6cd5\u63cf\u8ff0\u662fdefineClass(String name, byte[] b, int off, int len)\uff0c\u5176\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u662f\u8981\u5b9a\u4e49\u7c7b\u7684\u540d\u5b57\uff0c\u4e00\u822c\u4e0efindClass\u65b9\u6cd5\u4e2d\u7684\u7c7b\u540d\u4fdd\u6301\u4e00\u81f4\u5373\u53ef\uff1b\u7b2c\u4e8c\u4e2a\u662fclass\u6587\u4ef6\u7684\u4e8c\u8fdb\u5236\u5b57\u8282\u6570\u7ec4\uff0c\u8fd9\u4e2a\u4e5f\u4e0d\u96be\u7406\u89e3\uff0c\u4f46\u4e09\u4e2a\u5b57\u8282\u6570\u7ec4\u7684\u504f\u79fb\u91cf\uff1b\u7b2c\u56db\u4e2a\u662f\u4ece\u504f\u79fb\u91cf\u5f00\u59cb\u8bfb\u53d6\u591a\u957f\u7684byte\u6570\u636e\u3002\u5728\u7c7b\u7684\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u9636\u6bb5\u7684\u52a0\u8f7d\u4e3b\u8981\u662f\u83b7\u53d6class\u7684\u5b57\u8282\u6d41\u4fe1\u606f\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u6574\u4e2a\u5b57\u8282\u6d41\u4fe1\u606f\u4ea4\u7ed9defineClass\u65b9\u6cd5\u4e0d\u4e45\u884c\u4e86\u5417\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u753b\u86c7\u6dfb\u8db3\u5730\u6307\u5b9a\u504f\u79fb\u91cf\u548c\u8bfb\u53d6\u957f\u5ea6\u5462\uff1f\u539f\u56e0\u662f\u56e0\u4e3aclass\u5b57\u8282\u6570\u7ec4\u4e0d\u4e00\u5b9a\u662f\u4ece\u4e00\u4e2aclass\u6587\u4ef6\u4e2d\u83b7\u5f97\u7684\uff0c\u6709\u53ef\u80fd\u662f\u6765\u81ea\u7f51\u7edc\u7684\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u7f16\u7a0b\u7684\u65b9\u6cd5\u5199\u5165\u7684\uff0c\u7531\u6b64\u53ef\u89c1\uff0c\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u53ef\u80fd\u4f1a\u6709\u591a\u4e2aclass\u5b57\u8282\u4fe1\u606f\u3002</p> <p>\u6211\u4eec\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7c7b\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u81ea\u5b9a\u4e49ClassLoader\u6765\u52a0\u8f7d\u5b83\u3002</p> <pre><code>package com.gaohui;\n\npublic class HelloWorld {\n    static {\n        System.out.println(\"Hello Wolrd class is Initialized\");\n    }\n\n    public String welcome() {\n        return \"Hello Wolrd\";\n    }\n}\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u7b80\u5355\u7684\u6d4b\u8bd5\u3002</p> <pre><code>public class MyClassLoaderTest {\n    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {\n        MyClassLoader classLoader = new MyClassLoader();\n        Class&lt;?&gt; aClass = classLoader.loadClass(\"main.HelloWorld\");\n        System.out.println(aClass.getClassLoader());\n        //\u8fd9\u4e2a\u65f6\u5019\u4f1a\u6253\u5370\u51fastatic\u4ee3\u7801\u5757\u7684\u8f93\u51fa\n        Object helloWorld = aClass.newInstance();\n        System.out.println(helloWorld);\n    }\n}\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>sun.misc.Launcher$AppClassLoader@2a139a55\nHello Wolrd class is Initialized\nmain.HelloWorld@4e25154f\n</code></pre> <p>\u6211\u4eec\u4f1a\u53d1\u73b0\u6253\u5370\u51fa\u7684classLoader\u662fAppClassLoader\uff0c\u6211\u4eec\u81ea\u5b9a\u4e49\u7684ClassLoader\u5e76\u6ca1\u6709\u771f\u6b63\u751f\u6548\uff0c\u90a3\u4e48\u600e\u4e48\u8ba9\u6211\u4eec\u7684\u81ea\u5b9a\u4e49ClassLoader\u751f\u6548\u5462\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4e0d\u4f7f\u7528IDE\u6765\u5f00\u53d1\u8fd9\u4e2aHelloWorld\u7c7b\uff0c\u6211\u8fd9\u91cc\u91c7\u7528\u7684\u662feclipse\u6765\u5199\u7684\uff0ceclipse\u80fd\u81ea\u52a8\u6ce8\u5165CLASSPATH\uff0ceclipse\u53c8\u6709\u81ea\u52a8\u4fdd\u5b58\uff0c\u81ea\u52a8\u7f16\u8bd1\u7684\u529f\u80fd\u3002\u5982\u679c\u81ea\u52a8\u7f16\u8bd1\u4e86\uff0c\u7531\u4e8e\u53cc\u4eb2\u59d4\u6d3e\uff0c\u5982\u679c\u4f60\u7684CustomLoader\u8bbe\u7f6e\u4e86\u7236\u52a0\u8f7d\u5668\u662f Application ClassLoader \u7684\u8bdd\uff0c\u5c31\u4f1a\u81ea\u52a8\u4f18\u5148\u4f7f\u7528Application ClassLoader\u52a0\u8f7d\u5668\uff0c\u800c\u4e0d\u662f\u81ea\u5b9a\u4e49\u7684\u3002</p> <p>\u6211\u5c1d\u8bd5\u7528\u6587\u672c\u7f16\u8f91\u5668\u91cd\u65b0\u5199\u4e86\u4e2a\u65b0\u7684HelloWord\u7c7b\uff0c\u201ccom.gaohui.HelloWorld\u201d\uff0c\u7136\u540e\u8c03\u7528javac\u547d\u4ee4\u5bf9\u5176\u8fdb\u884c\u7f16\u8bd1\uff0c\u7136\u540e\u628a\u6211\u4eec\u7684\u8fd9\u4e2aHelloWorld.class\u62f7\u8d1d\u5230/Users/gaohui\u76ee\u5f55\u4e0b\uff0c\u5e76\u4e14\u52a0\u4e0a\u4e24\u5c42\u76ee\u5f55\uff0c\u56e0\u4e3ajava\u4e2d\u7684\u5305\u540d\u5bf9\u5e94\u5c31\u662f\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\u3002</p> <pre><code>package main;\n\npublic class MyClassLoaderTest {\n\n    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {\n        MyClassLoader classLoader = new MyClassLoader();\n        Class&lt;?&gt; aClass = classLoader.loadClass(\"com.gaohui.HelloWorld\");\n        System.out.println(aClass.getClassLoader());\n        //\u8fd9\u4e2a\u65f6\u5019\u4f1a\u6253\u5370\u51fastatic\u4ee3\u7801\u5757\u7684\u8f93\u51fa\n        Object helloWorld = aClass.newInstance();\n        System.out.println(helloWorld);\n    }\n\n}\n</code></pre> <pre><code>main.MyClassLoader@5c647e05\nHello Wolrd class is Initialized\ncom.gaohui.HelloWorld@55f96302\n</code></pre> <p>\u8f93\u51fa\u5982\u679c\u5982\u4e0a\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u65b0\u7684HelloWorld\u7c7b\u7684\u786e\u662f\u80fd\u591f\u88ab\u6211\u4eec\u81ea\u5b9a\u4e49\u7684ClassLoader\u52a0\u8f7d\u51fa\u6765\u4e86\u3002</p> <p>\u8fd9\u91cc\u8f93\u51fa\u7ed3\u679c\u8868\u660e\u201ccom.gaohui.HelloWorld\u201d\u88ab\u6210\u529f\u52a0\u8f7d\u4e86\u5e76\u4e14\u5904\u5904\u4e86\u7c7b\u52a0\u8f7d\u5668\u4fe1\u606f\uff0c\u4f46\u662fHelloWorld\u7684\u9759\u6001\u4ee3\u7801\u5757\u5e76\u6ca1\u6709\u5f97\u5230\u6267\u884c\uff0c\u90a3\u662f\u56e0\u4e3a\u4f7f\u7528\u7c7b\u52a0\u8f7d\u5668loadClass\u5e76\u4e0d\u4f1a\u5bfc\u81f4\u7c7b\u7684\u4e3b\u52a8\u521d\u59cb\u5316\u5316\uff0c\u5b83\u53ea\u662f\u6307\u5b9a\u4e86\u52a0\u8f7d\u8fc7\u7a0b\u4e2d\u7684\u52a0\u8f7d\u9636\u6bb5\u800c\u5df2\u3002</p> <p>\u8fd9\u91cc\u4e0d\u4f7f\u7528ide\u6765\u7f16\u5199\u8fd9\u4e2a\u7c7b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u7c7b\u7684\u5305\u540d\uff0c\u7c7b\u7684\u5305\u540d\u5176\u5b9e\u5bf9\u5e94\u7684\u662f\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\uff0c\u6307\u5b9acom.gaohui\u8868\u793a\u8fd9\u4e2a\u7c7b\u5728com/gaohui\u7684\u76ee\u5f55\u4e0b\uff0c\u800c\u4e0d\u662f\u7b80\u5355\u6307\u5b9a\u5305\u540d\u5373\u53ef\uff0c\u9700\u8981\u65b0\u5efa\u76f8\u5e94\u7684\u76ee\u5f55\uff0c\u7136\u540e\u518d\u7f16\u5199\u8fd9\u4e2a\u7c7b\u5177\u4f53\u4ee3\u7801\u3002</p>"},{"location":"JVM/7_JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/#_1","title":"\u53cc\u4eb2\u59d4\u6258\u673a\u5236\u7684\u8be6\u7ec6\u4ecb\u7ecd","text":"<p>\u5f53\u4e00\u4e2a\u7c7b\u52a0\u8f7d\u5668\u88ab\u8c03\u7528\u4e86loadClass\u4e4b\u540e\uff0c\u5b83\u5e76\u4e0d\u4f1a\u76f4\u63a5\u5c06\u5176\u52a0\u8f7d\uff0c\u800c\u662f\u5148\u4ea4\u7ed9\u5f53\u524d\u7c7b\u52a0\u8f7d\u5668\u7684\u7236\u52a0\u8f7d\u5668\u5c1d\u8bd5\u52a0\u8f7d\u76f4\u5230\u6700\u9876\u5c42\u7684\u7236\u52a0\u8f7d\u5668\uff0c\u7136\u540e\u518d\u4f9d\u6b21\u5411\u4e0b\u8fdb\u884c\u52a0\u8f7d\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u4e0a\u9762\u6211\u4eec\u81ea\u5b9a\u4e49\u52a0\u8f7d\u5668\u7684\u65f6\u5019\u6ca1\u6709\u5728ide\u91cc\u9762\u5199\u8fd9\u4e2aHelloWorld\u7c7b\u7684\u539f\u56e0\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u80fd\u4e0d\u80fd\u53ef\u4ee5\u4e0d\u8fd9\u6837\u505a\u8fd8\u80fd\u8ba9\u6211\u4eec\u7684\u81ea\u5b9a\u4e49ClassLoader\u52a0\u8f7d\u8fd9\u4e2a\u7c7b\u5462\uff1f</p> <p>\u9996\u5148\u6765\u770b\u4e0bClassLoader\u7684\u6e90\u7801\uff1a</p> <pre><code> public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException {\n        return loadClass(name, false);\n}\n\nprotected Class&lt;?&gt; loadClass(String name, boolean resolve)\n        throws ClassNotFoundException\n{\n        synchronized (getClassLoadingLock(name)) {\n            // First, check if the class has already been loaded\n            Class&lt;?&gt; c = findLoadedClass(name);\n            if (c == null) {\n                long t0 = System.nanoTime();\n                try {\n                    if (parent != null) {\n                        c = parent.loadClass(name, false);\n                    } else {\n                        c = findBootstrapClassOrNull(name);\n                    }\n                } catch (ClassNotFoundException e) {\n                    // ClassNotFoundException thrown if class not found\n                    // from the non-null parent class loader\n                }\n\n                if (c == null) {\n                    // If still not found, then invoke findClass in order\n                    // to find the class.\n                    long t1 = System.nanoTime();\n                    c = findClass(name);\n\n                    // this is the defining class loader; record the stats\n                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);\n                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);\n                    sun.misc.PerfCounter.getFindClasses().increment();\n                }\n            }\n            if (resolve) {\n                resolveClass(c);\n            }\n            return c;\n        }\n}\n\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u662fjava.lang.ClassLoader\u7684loadClass\u65b9\u6cd5\uff0c\u524d\u9762\u7684loadClass\u6700\u7ec8\u8c03\u7528\u7684\u8fd8\u662f\u540e\u9762\u7684\u90a3\u4e2a\u4e24\u4e2a\u53c2\u6570\u7684\u65b9\u6cd5\u3002 * \u4ece\u5f53\u524d\u7c7b\u52a0\u8f7d\u5668\u7684\u5df2\u52a0\u8f7d\u7c7b\u7f13\u5b58\u4e2d\u6839\u636e\u7c7b\u7684\u5168\u8def\u5f84\u6765\u67e5\u8be2\u662f\u5426\u5b58\u5728\u8be5\u7c7b\uff0c\u5410\u8fc7\u5b58\u5728\u5219\u76f4\u63a5\u8fd4\u56de\u3002 * \u5982\u679c\u5f53\u524d\u7c7b\u5b58\u5728\u7236\u7c7b\u52a0\u8f7d\u5668\uff0c\u5219\u8c03\u7528\u7236\u7c7b\u52a0\u8f7d\u5668\u7684loadClass\u65b9\u6cd5\u5bf9\u9f50\u8fdb\u884c\u52a0\u8f7d\u3002 * \u5982\u679c\u7c7b\u52a0\u8f7d\u5668\u4e0d\u5b58\u5728\u7236\u7c7b\u52a0\u8f7d\u5668\uff0c\u5219\u76f4\u63a5\u8c03\u7528\u5404\u7c7b\u52a0\u8f7d\u5668\u5bf9\u5404\u7c7b\u8fdb\u884c\u52a0\u8f7d\u3002 * \u5982\u679c\u5f53\u524d\u6240\u6709\u7236\u7c7b\u52a0\u8f7d\u5668\u90fd\u6ca1\u6709\u6210\u529f\u52a0\u8f7dclass\uff0c\u5219\u5c1d\u8bd5\u8c03\u7528\u5f53\u524d\u7c7b\u52a0\u8f7d\u5668\u7684findClass\u8fdb\u884c\u52a0\u8f7d\uff0c\u8be5\u65b9\u6cd5\u5c31\u662f\u6211\u4eec\u81ea\u5b9a\u4e49\u52a0\u8f7d\u5668\u9700\u8981\u91cd\u5199\u7684\u65b9\u6cd5\u3002 * \u7531\u4e8eloadClass\u6307\u5b9a\u4e86resolve\u4e3afalse\uff0c\u6240\u4ee5\u4e0d\u4f1a\u8fdb\u884c\u8fde\u63a5\u9636\u6bb5\u7684\u7ee7\u7eed\u6267\u884c\uff0c\u8fd9\u4e5f\u5c31\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u901a\u8fc7\u7c7b\u52a0\u8f7d\u5668\u52a0\u8f7d\u7c7b\u5e76\u4e0d\u4f1a\u5bfc\u81f4\u7d2f\u5f97\u521d\u59cb\u5316\u3002</p> <p>\u90a3\u4e48\u56de\u5230\u5f00\u59cb\u65f6\u7684\u95ee\u9898\uff0c\u5982\u4f55\u5728\u4f7f\u7528ide\u73af\u5883\uff0c\u5728\u4e0d\u5220\u9664.class\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b\u80fd\u591f\u8ba9\u6211\u4eec\u7684\u81ea\u5b9a\u4e49ClassLoader\u6765\u52a0\u8f7d\u6211\u4eec\u7f16\u5199\u7684\u7c7b\uff1f</p> <p>\u7b2c\u4e00\u79cd\u65b9\u6cd5\u662f\u7ed5\u8fc7\u7cfb\u7edf\u52a0\u8f7d\u5668\uff0c\u76f4\u63a5\u5c06\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\u4f5c\u4e3aMyClassLoader\u7684\u7236\u52a0\u8f7d\u5668\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>public class MyClassLoaderTest {\n\n    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {\n        ClassLoader extClassLoader = MyClassLoaderTest.class.getClassLoader().getParent();\n        MyClassLoader classLoader = new MyClassLoader(\"/Users/gaohui/Documents/workspace1/Test/bin/\",extClassLoader);\n        Class&lt;?&gt; aClass = classLoader.loadClass(\"main.HelloWorld\");\n        System.out.println(aClass.getClassLoader());\n        //\u8fd9\u4e2a\u65f6\u5019\u4f1a\u6253\u5370\u51fastatic\u4ee3\u7801\u5757\u7684\u8f93\u51fa\n        Object helloWorld = aClass.newInstance();\n        System.out.println(helloWorld);\n    }\n}\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>main.MyClassLoader@5c647e05\nHello Wolrd class is Initialized\nmain.HelloWorld@55f96302\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u901a\u8fc7MyClassLoaderTest.class\u83b7\u53d6\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\uff0c\u7136\u540e\u518d\u83b7\u53d6\u7cfb\u7edf\u7c7b\u52a0\u8f7d\u5668\u7684\u7236\u7c7b\u52a0\u8f7d\u5668\u4e2d\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\uff0c\u65f6\u671f\u79f0\u4e3aMyClassLoader\u7684\u7236\u7c7b\u52a0\u8f7d\u5668\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u6839\u52a0\u8f7d\u5668\u548c\u6269\u5c55\u7c7b\u52a0\u8f7d\u5668\u90fd\u65e0\u6cd5\u5bf9\"main.HelloWorld\"\u7c7b\u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d\uff0c\u81ea\u7136\u800c\u7136\u5730\u5c31\u4ea4\u7ed9\u4e86MyClassLoader\u5bf9HelloWorld\u8fdb\u884c\u52a0\u8f7d\u4e86\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5145\u5206\u5229\u7528\u4e86\u7c7b\u52a0\u8f7d\u53cc\u4eb2\u59d4\u6258\u673a\u5236\u7684\u7279\u6027\u3002</p> <p>\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u662f\u5728\u6784\u9020MyClassLoader\u7684\u65f6\u5019\u6307\u5b9a\u5176\u7236\u7c7b\u52a0\u8f7d\u5668\u4e3anull\uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>package main;\n\npublic class MyClassLoaderTest {\n\n    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {\n        //ClassLoader extClassLoader = MyClassLoaderTest.class.getClassLoader().getParent();\n        MyClassLoader classLoader = new MyClassLoader(\"/Users/gaohui/Documents/workspace1/Test/bin/\",null);\n        Class&lt;?&gt; aClass = classLoader.loadClass(\"main.HelloWorld\");\n        System.out.println(aClass.getClassLoader());\n        //\u8fd9\u4e2a\u65f6\u5019\u4f1a\u6253\u5370\u51fastatic\u4ee3\u7801\u5757\u7684\u8f93\u51fa\n        Object helloWorld = aClass.newInstance();\n        System.out.println(helloWorld);\n    }\n\n}\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>main.MyClassLoader@5c647e05\nHello Wolrd class is Initialized\nmain.HelloWorld@55f96302\n</code></pre> <p>\u6839\u636eloadClass\u65b9\u6cd5\u7684\u6e90\u7801\u5206\u6790\uff0c\u5f53\u524d\u7c7b\u6ca1\u6709\u5728\u7236\u7c7b\u52a0\u8f7d\u5668\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u76f4\u63a5\u4f7f\u7528\u6839\u52a0\u8f7d\u5668\u5bf9\u8be5\u7c7b\u8fdb\u884c\u52a0\u8f7d\uff0c\u5f88\u663e\u7136\uff0cHelloWorld\u5728\u6839\u52a0\u8f7d\u5668\u7684\u52a0\u8f7d\u8def\u5f84\u4e0b\u662f\u65e0\u6cd5\u627e\u5230\u7684\uff0c\u90a3\u4e48\u5b83\u81ea\u7136\u800c\u7136\u5730\u5c31\u4ea4\u7ed9\u5f53\u524d\u7c7b\u52a0\u8f7d\u5668\u8fdb\u884c\u52a0\u8f7d\u4e86\u3002</p>"},{"location":"JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","title":"\u6df1\u5165\u7406\u89e3JVM\u865a\u62df\u673a\u8bfb\u4e66\u7b14\u8bb0","text":""},{"location":"JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/#_1","title":"\u6574\u7406\u5b8c\u6210","text":"<ul> <li>Java\u7684\u5185\u5b58\u533a\u57df</li> <li>JVM\u7684GC\u548c\u5185\u5b58\u5206\u914d</li> <li>JVM\u7c7b\u52a0\u8f7d\u673a\u5236</li> <li>JVM\u7c7b\u52a0\u8f7d\u5668</li> </ul>"},{"location":"JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/#_2","title":"\u5f85\u6574\u7406","text":"<ul> <li>Java\u7ebf\u7a0b\u5b89\u5168\u4e0e\u9501\u4f18\u5316</li> <li>JVM\u7a0b\u5e8f\u7f16\u8bd1\u4e0e\u4ee3\u7801\u4f18\u5316</li> <li>JVM\u7c7b\u6587\u4ef6\u7ed3\u6784</li> <li>JVM\u5b57\u8282\u7801\u6267\u884c\u5f15\u64ce</li> </ul>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/","title":"ConcurrentHashMap\u662f\u5982\u4f55\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u7684","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0cConcurrentHashMap\u662f\u5982\u4f55\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u7684</p> <p>\u4e4b\u524d\u5206\u6790\u8fc7HashMap\u7684\u4e00\u4e9b\u5b9e\u73b0\u7ec6\u8282\uff0c\u5173\u4e8eHashMap\u4f60\u9700\u8981\u77e5\u9053\u7684\u4e00\u4e9b\u7ec6\u8282, \u4eca\u5929\u6211\u4eec\u4ece\u6e90\u7801\u89d2\u5ea6\u6765\u770b\u770bConcurrentHashMap\u662f\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u5176\u5b9e\u7f51\u4e0a\u8fd9\u7c7b\u6587\u7ae0\u5206\u6790\u7279\u522b\u591a\uff0c\u79c9\u7740\u201d\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45\uff0c\u7edd\u77e5\u6b64\u4e8b\u8981\u8eac\u884c\u201c\u7684\u539f\u5219\uff0c\u6211\u4eec\u5c1d\u8bd5\u81ea\u5df1\u53bb\u5206\u6790\u4e0b\uff0c\u5e0c\u671b\u8fd9\u6837\u5bf9\u4e8eConcurrentHashMap\u6709\u4e00\u4e2a\u66f4\u6df1\u523b\u7684\u7406\u89e3\u3002</p>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#hashmapconcurrenthashmap","title":"\u4e3a\u4ec0\u4e48\u8bf4HashMap\u7ebf\u7a0b\u4e0d\u5b89\u5168\uff0c\u800cConcurrentHashMap\u5c31\u7ebf\u7a0b\u5b89\u5168","text":"<p>\u5176\u5b9eConcurrentHashMap\u5728Android\u5f00\u53d1\u4e2d\u4f7f\u7528\u7684\u573a\u666f\u5e76\u4e0d\u591a\uff0c\u4f46\u662fConcurrentHashMap\u4e3a\u4e86\u652f\u6301\u591a\u7ebf\u7a0b\u5e76\u53d1\u8fd9\u4e9b\u4f18\u79c0\u7684\u8bbe\u8ba1\u5374\u662f\u6700\u503c\u5f97\u6211\u4eec\u5b66\u4e60\u7684\u5730\u65b9\uff0c\u5f80\u5f80\u201dConcurrentHashMap\u662f\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u201c\u8fd9\u7c7b\u95ee\u9898\u5374\u662f\u9762\u8bd5\u5b98\u6bd4\u8f83\u559c\u6b22\u95ee\u7684\u95ee\u9898\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u5c1d\u8bd5\u7528\u4ee3\u7801\u6a21\u62df\u4e0bHashMap\u5728\u591a\u7ebf\u7a0b\u573a\u666f\u4e0b\u4f1a\u4e0d\u5b89\u5168\uff0c\u5982\u679c\u628a\u8fd9\u4e2a\u573a\u666f\u66ff\u6362\u6210ConcurrentHashMap\u4f1a\u4e0d\u4f1a\u6709\u95ee\u9898\u3002</p> <p>\u56e0\u4e3a\u4e0d\u540c\u4e8e\u5176\u4ed6\u7684\u7ebf\u7a0b\u540c\u6b65\u95ee\u9898\uff0c\u60f3\u6a21\u62df\u51fa\u4e00\u79cd\u573a\u666f\u6765\u8868\u660eHashMap\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u7a0d\u5fae\u6709\u70b9\u9ebb\u70e6\uff0c\u53ef\u80fd\u662fhash\u6563\u5217\u6709\u5173\uff0c\u5728\u6570\u636e\u91cf\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba1\u7b97\u51fa\u6765\u7684hashCode\u662f\u4e0d\u592a\u5bb9\u6613\u4ea7\u751f\u78b0\u649e\u7684\uff0c\u7f51\u4e0a\u5f88\u591a\u6587\u7ae0\u90fd\u662f\u5c1d\u8bd5\u4ece\u6e90\u7801\u89d2\u5ea6\u6765\u5206\u6790HashMap\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u6211\u4eec\u6765\u770b\u4e0b\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801,\u6211\u4eec\u6784\u902010\u4e2a\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u522b\u5f80map\u4e2dput 1000\u4e2a\u6570\u636e\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u4e2a\u6570\u636e\u7684key\u4e0d\u4e00\u6837\uff0c\u6211\u4eec\u5c06i+ \u7ebf\u7a0b\u540d\u5b57\u6765\u4f5c\u4e3amap \u7684key\uff0c\u8fd9\u6837\uff0c\u5982\u679c\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u7d2f\u52a0\u5b8c\u7684\u8bdd\uff0c\u6211\u4eec\u9884\u671f\u7684map\u7684size\u5e94\u8be5\u662f10 * 1000 = 10000\u3002</p> <pre><code>\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.concurrent.ConcurrentHashMap;\n\npublic class HashMapTest {\n\n    public static void main(String[] args) {\n        Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();\n\n//       Map&lt;String, String&gt; map = new ConcurrentHashMap&lt;String, String&gt;();\n        for (int i = 0; i &lt; 10; i++) {\n            MyThread testThread = new MyThread(map, \"\u7ebf\u7a0b\u540d\u5b57\uff1a\" + i);\n            testThread.start();\n        }\n        //\u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u90fd\u7ed3\u675f\n        while(Thread.activeCount() &gt; 1)\n            Thread.yield();\n\n        System.out.println(map.size());\n    }\n}\n\n\nclass MyThread extends Thread {\n    public Map&lt;String, String&gt; map;\n    public String name;\n\n    public MyThread(Map&lt;String, String&gt; map, String name) {\n      this.map = map;\n      this.name = name;\n    }\n    public void run() {\n        for(int i =0;i&lt;1000;i++) {\n            map.put(i + name, i + name);\n        }\n    }\n  }\n\n\n</code></pre> <p>\u4f7f\u7528HashMap\uff0c\u7a0b\u5e8f\u8fd0\u884c\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>9930\n\n</code></pre> <p>\u90a3\u6211\u4eec\u5982\u679c\u628a\u8fd9\u91cc\u7684HashMap\u6362\u6210ConcurrentHashMap\u6765\u8bd5\u8bd5\u770b\u770b\u6548\u679c\u5982\u4f55\uff0c\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>10000\n\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u4e0d\u7ba1\u8fd0\u884c\u51e0\u6b21\uff0cHashMap\u7684size\u90fd\u662f\u5c0f\u4e8e10000\u7684\uff0c\u800cConcurrentHashMap\u7684size\u90fd\u662f10000\u3002\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u4e5f\u8bc1\u660e\u4e86ConcurrentHashMap\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u800cHashMap\u5219\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u3002 HashMap\u5728\u591a\u7ebf\u7a0bput\u7684\u65f6\u5019\uff0c\u5f53\u4ea7\u751fhash\u78b0\u649e\u7684\u65f6\u5019\uff0c\u4f1a\u5bfc\u81f4\u4e22\u5931\u6570\u636e\uff0c\u56e0\u4e3a\u8981put\u7684\u4e24\u4e2a\u503chash\u76f8\u540c\uff0c\u5982\u679c\u8fd9\u4e2a\u5bf9\u4e8ehash\u6876\u7684\u4f4d\u7f6e\u4e2a\u6570\u5c0f\u4e8e8\uff0c\u90a3\u4e48\u5e94\u8be5\u662f\u4ee5\u94fe\u8868\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u7531\u4e8e\u6ca1\u6709\u505a\u901a\u8fc7\uff0c\u540e\u9762put\u7684\u5143\u7d20\u53ef\u80fd\u4f1a\u76f4\u63a5\u8986\u76d6\u4e4b\u524d\u90a3\u4e2a\u7ebf\u7a0bput\u7684\u6570\u636e\uff0c\u8fd9\u6837\u5c31\u5bfc\u81f4\u4e86\u6570\u636e\u4e22\u5931\u3002</p> <p>\u5176\u5b9e\u5217\u4e3e\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u53ea\u662f\u4e3a\u4e86\u4ece\u4e00\u4e2a\u89d2\u5ea6\u6765\u5c55\u793a\u4e0b\u4e3a\u4ec0\u4e48\u8bf4HashMap\u7ebf\u7a0b\u4e0d\u5b89\u5168\uff0c\u800cConcurrentHashMap\u5219\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u9274\u4e8eHashMap\u7ebf\u7a0b\u5b89\u5168\u4f8b\u5b50\u6bd4\u8f83\u96be\u5217\u4e3e\u51fa\u6765\uff0c\u6240\u6709\u624d\u901a\u8fc7\u6253\u5370size\u8fd9\u4e2a\u89d2\u5ea6\u6765\u6a21\u62df\u4e86\u4e0b\u3002</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u6df1\u5165\u89e3\u8bfbHashMap\u7ebf\u7a0b\u5b89\u5168\u6027\u95ee\u9898\u5c31\u8be6\u7ec6\u4ecb\u7ecd\u4e86HashMap\u53ef\u80fd\u4f1a\u51fa\u73b0\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002 \u6587\u7ae0\u4e3b\u8981\u8bb2\u4e86\u4e24\u4e2a\u53ef\u80fd\u4f1a\u51fa\u73b0\u7ebf\u7a0b\u4e0d\u5b89\u5168\u5730\u65b9\uff0c\u4e00\u4e2a\u662f\u591a\u7ebf\u7a0b\u7684put\u53ef\u80fd\u5bfc\u81f4\u5143\u7d20\u7684\u4e22\u5931\uff0c\u53e6\u4e00\u4e2a\u662fput\u548cget\u5e76\u53d1\u65f6\uff0c\u53ef\u80fd\u5bfc\u81f4get\u4e3anull\uff0c\u4f46\u662f\u4e5f\u4ec5\u662f\u5728\u6e90\u7801\u5c42\u9762\u5206\u6790\u4e86\u4e0b\uff0c\u56e0\u4e3a\u8fd9\u4e2d\u573a\u666f\u60f3\u8981\u5b8c\u5168\u7528\u4ee3\u7801\u5c55\u793a\u51fa\u6765\u662f\u7a0d\u5fae\u6709\u70b9\u9ebb\u70e6\u7684\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u770b\u770bConcurrentHashMap\u662f\u5982\u4f55\u505a\u5230\u7ebf\u7a0b\u5b89\u5168\u7684\u3002</p>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#jdk8concurrenthashmap","title":"JDK8\u7684ConcurrentHashMap\u6587\u6863\u63d0\u70bc","text":"<ul> <li>ConcurrentHashMap\u652f\u6301\u68c0\u7d22\u7684\u5b8c\u5168\u5e76\u53d1\u548c\u66f4\u65b0\u7684\u9ad8\u9884\u671f\u5e76\u53d1\u6027,\u8fd9\u91cc\u7684\u8bf4\u6cd5\u5f88\u6709\u610f\u601d\u68c0\u7d22\u652f\u6301\u5b8c\u5168\u5e76\u53d1\uff0c\u66f4\u65b0\u5219\u652f\u6301\u9ad8\u9884\u671f\u5e76\u53d1\u6027\uff0c\u56e0\u4e3a\u5b83\u7684\u68c0\u7d22\u64cd\u4f5c\u662f\u6ca1\u6709\u52a0\u9501\u7684\uff0c\u5b9e\u9645\u4e0a\u68c0\u7d22\u4e5f\u6ca1\u6709\u5fc5\u8981\u52a0\u9501\u3002</li> <li>\u5b9e\u9645\u4e0aConcurrentHashMap\u548cHashtable\u5728\u4e0d\u8003\u8651\u5b9e\u73b0\u7ec6\u8282\u6765\u8bf4\uff0c\u8fd9\u4e24\u8005\u5b8c\u5168\u662f\u53ef\u4ee5\u4e92\u76f8\u64cd\u4f5c\u7684,Hashtable\u5728get\uff0cput\uff0cremove\u7b49\u8fd9\u4e9b\u65b9\u6cd5\u4e2d\u5168\u90e8\u52a0\u5165\u4e86synchronized\uff0c\u8fd9\u6837\u7684\u95ee\u9898\u662f\u80fd\u591f\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\uff0c\u4f46\u662f\u7f3a\u70b9\u662f\u6027\u80fd\u592a\u5dee\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u52a0\u9501\u7684\uff0c\u4f46\u662fConcurrentHashMap\u7684\u68c0\u6d4b\u64cd\u4f5c\u5374\u662f\u6ca1\u6709\u52a0\u9501\u7684\u3002</li> <li>ConcurrentHashMap\u68c0\u7d22\u64cd\u4f5c(\u5305\u62ecget)\u901a\u5e38\u4e0d\u4f1a\u963b\u585e\uff0c\u56e0\u6b64\u53ef\u80fd\u4e0e\u66f4\u65b0\u64cd\u4f5c(\u5305\u62ecput\u548cremove)\u91cd\u53e0\u3002</li> <li>ConcurrentHashMap\u8ddfHashtable\u7c7b\u4f3c\u4f46\u4e0d\u540c\u4e8eHashMap\uff0c\u5b83\u4e0d\u53ef\u4ee5\u5b58\u653e\u7a7a\u503c\uff0ckey\u548cvalue\u90fd\u4e0d\u53ef\u4ee5\u4e3anull\u3002</li> </ul> <p>\u5370\u8c61\u4e2d\u4e00\u76f4\u4ee5\u4e3aConcurrentHashMap\u662f\u57fa\u4e8eSegment\u5206\u6bb5\u9501\u6765\u5b9e\u73b0\u7684\uff0c\u4e4b\u524d\u6ca1\u4ed4\u7ec6\u770b\u8fc7\u6e90\u7801\uff0c\u4e00\u76f4\u6709\u8fd9\u4e48\u4e2a\u9519\u8bef\u7684\u8ba4\u8bc6\u3002ConcurrentHashMap\u662f\u57fa\u4e8eSegment\u5206\u6bb5\u9501\u6765\u5b9e\u73b0\u7684\uff0c\u8fd9\u53e5\u8bdd\u4e5f\u4e0d\u80fd\u8bf4\u4e0d\u5bf9\uff0c\u52a0\u4e2a\u524d\u63d0\u6761\u4ef6\u5c31\u662f\u6b63\u786e\u7684\u4e86\uff0cConcurrentHashMap\u4eceJDK1.5\u5f00\u59cb\u968fjava.util.concurrent\u5305\u4e00\u8d77\u5f15\u5165JDK\u4e2d\uff0c\u5728JDK8\u4ee5\u524d\uff0cConcurrentHashMap\u90fd\u662f\u57fa\u4e8eSegment\u5206\u6bb5\u9501\u6765\u5b9e\u73b0\u7684\uff0c\u5728JDK8\u4ee5\u540e\uff0c\u5c31\u6362\u6210synchronized\u548cCAS\u8fd9\u5957\u5b9e\u73b0\u673a\u5236\u4e86\u3002</p> <p>JDK1.8\u4e2d\u7684ConcurrentHashMap\u4e2d\u4ecd\u7136\u5b58\u5728Segment\u8fd9\u4e2a\u7c7b\uff0c\u800c\u8fd9\u4e2a\u7c7b\u7684\u58f0\u660e\u5219\u662f\u4e3a\u4e86\u517c\u5bb9\u4e4b\u524d\u7684\u7248\u672c\u5e8f\u5217\u5316\u800c\u5b58\u5728\u7684\u3002</p> <pre><code>   /**\n     * Stripped-down version of helper class used in previous version,\n     * declared for the sake of serialization compatibility.\n     */\n    static class Segment&lt;K,V&gt; extends ReentrantLock implements Serializable {\n        private static final long serialVersionUID = 2249069246763182397L;\n        final float loadFactor;\n        Segment(float lf) { this.loadFactor = lf; }\n    }\n\n</code></pre> <p>JDK1.8\u4e2d\u7684ConcurrentHashMap\u4e0d\u518d\u4f7f\u7528Segment\u5206\u6bb5\u9501\uff0c\u800c\u662f\u4ee5table\u6570\u7ec4\u7684\u5934\u7ed3\u70b9\u4f5c\u4e3asynchronized\u7684\u9501\u3002\u548cJDK1.8\u4e2d\u7684HashMap\u7c7b\u4f3c\uff0c\u5bf9\u4e8ehashCode\u76f8\u540c\u7684\u65f6\u5019\uff0c\u5728Node\u8282\u70b9\u7684\u6570\u91cf\u5c11\u4e8e8\u4e2a\u65f6\uff0c\u8fd9\u65f6\u7684Node\u5b58\u50a8\u7ed3\u6784\u662f\u94fe\u8868\u5f62\u5f0f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N)\uff0c\u5f53Node\u8282\u70b9\u7684\u4e2a\u6570\u8d85\u8fc78\u4e2a\u65f6\uff0c\u5219\u4f1a\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\uff0c\u6b64\u65f6\u8bbf\u95ee\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(long(N))\u3002</p> <pre><code> /**\n     * The array of bins. Lazily initialized upon first insertion.\n     * Size is always a power of two. Accessed directly by iterators.\n     */\n    transient volatile Node&lt;K,V&gt;[] table;\n</code></pre> <p>\u6570\u636e\u7ed3\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a </p> <p>\u5176\u5b9eConcurrentHashMap\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u4e3b\u8981\u6709\u4e09\u4e2a\u5730\u65b9\u3002</p> <ul> <li>\u4e00\u3001\u4f7f\u7528volatile\u4fdd\u8bc1\u5f53Node\u4e2d\u7684\u503c\u53d8\u5316\u65f6\u5bf9\u4e8e\u5176\u4ed6\u7ebf\u7a0b\u662f\u53ef\u89c1\u7684</li> <li>\u4e8c\u3001\u4f7f\u7528table\u6570\u7ec4\u7684\u5934\u7ed3\u70b9\u4f5c\u4e3asynchronized\u7684\u9501\u6765\u4fdd\u8bc1\u5199\u64cd\u4f5c\u7684\u5b89\u5168</li> <li>\u4e09\u3001\u5f53\u5934\u7ed3\u70b9\u4e3anull\u65f6\uff0c\u4f7f\u7528CAS\u64cd\u4f5c\u6765\u4fdd\u8bc1\u6570\u636e\u80fd\u6b63\u786e\u7684\u5199\u5165\u3002</li> </ul>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#volatile","title":"\u4f7f\u7528volatile","text":"<p>\u53ef\u4ee5\u770b\u5230\uff0cNode\u4e2d\u7684val\u548cnext\u90fd\u88abvolatile\u5173\u952e\u5b57\u4fee\u9970\u3002</p> <p>volatile\u7684happens-before\u89c4\u5219\uff1a\u5bf9\u4e00\u4e2avolatile\u53d8\u91cf\u7684\u5199\u4e00\u5b9a\u53ef\u89c1\uff08happens-before)\u4e8e\u968f\u540e\u5bf9\u5b83\u7684\u8bfb\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u6539\u52a8val\u7684\u503c\u6216\u8005next\u7684\u503c\u5bf9\u4e8e\u5176\u4ed6\u7ebf\u7a0b\u662f\u53ef\u89c1\u7684\uff0c\u56e0\u4e3avolatile\u5173\u952e\u5b57\uff0c\u4f1a\u5728\u8bfb\u6307\u4ee4\u524d\u63d2\u5165\u8bfb\u5c4f\u969c\uff0c\u53ef\u4ee5\u8ba9\u9ad8\u901f\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u5931\u6548\uff0c\u91cd\u65b0\u4ece\u4e3b\u5185\u5b58\u52a0\u8f7d\u6570\u636e\u3002</p> <pre><code>static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {\n        final int hash;\n        final K key;\n        volatile V val;\n        volatile Node&lt;K,V&gt; next;\n  }\n  ...\n</code></pre> <p>\u53e6\u5916\uff0cConcurrentHashMap\u63d0\u4f9b\u7c7b\u4f3ctabAt\u6765\u8bfb\u53d6Table\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\uff0c\u8fd9\u91cc\u662f\u4ee5volatile\u8bfb\u7684\u65b9\u5f0f\u8bfb\u53d6table\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\uff0c\u4e3b\u8981\u901a\u8fc7Unsafe\u8fd9\u4e2a\u7c7b\u6765\u5b9e\u73b0\u7684\uff0c\u4fdd\u8bc1\u5176\u4ed6\u7ebf\u7a0b\u6539\u53d8\u4e86\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u7684\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u5f53\u524d\u7ebf\u7a0bget\u7684\u65f6\u5019\u80fd\u62ff\u5230\u3002</p> <pre><code> static final &lt;K,V&gt; Node&lt;K,V&gt; tabAt(Node&lt;K,V&gt;[] tab, int i) {\n        return (Node&lt;K,V&gt;)U.getObjectVolatile(tab, ((long)i &lt;&lt; ASHIFT) + ABASE);\n    }\n</code></pre> <p>\u800c\u4e0e\u4e4b\u5bf9\u5e94\u7684\uff0c\u662fsetTabAt,\u8fd9\u91cc\u662f\u4ee5volatile\u5199\u7684\u65b9\u5f0f\u5f80\u6570\u7ec4\u5199\u5165\u5143\u7d20\uff0c\u8fd9\u6837\u80fd\u4fdd\u8bc1\u4fee\u6539\u540e\u80fd\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u53ef\u89c1\u3002</p> <pre><code> static final &lt;K,V&gt; void setTabAt(Node&lt;K,V&gt;[] tab, int i, Node&lt;K,V&gt; v) {\n        U.putObjectVolatile(tab, ((long)i &lt;&lt; ASHIFT) + ABASE, v);\n    }\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u4e0bConcurrentHashMap\u7684putVal\u65b9\u6cd5\uff1a</p> <pre><code>  /** Implementation for put and putIfAbsent */\n    final V putVal(K key, V value, boolean onlyIfAbsent) {\n        if (key == null || value == null) throw new NullPointerException();\n        int hash = spread(key.hashCode());\n        int binCount = 0;\n        for (Node&lt;K,V&gt;[] tab = table;;) {\n            Node&lt;K,V&gt; f; int n, i, fh;\n            if (tab == null || (n = tab.length) == 0)\n                tab = initTable();\n            //\u5f53\u5934\u7ed3\u70b9\u4e3anull,\u5219\u901a\u8fc7casTabAt\u65b9\u5f0f\u5199\u5165\n            else if ((f = tabAt(tab, i = (n - 1) &amp; hash)) == null) {\n                if (casTabAt(tab, i, null,\n                             new Node&lt;K,V&gt;(hash, key, value, null)))\n                    break;                   // no lock when adding to empty bin\n            }\n            else if ((fh = f.hash) == MOVED)\n              //\u6b63\u5728\u6269\u5bb9\n                tab = helpTransfer(tab, f);\n            else {\n                V oldVal = null;\n                //\u5934\u7ed3\u70b9\u4e0d\u4e3anull\uff0c\u4f7f\u7528synchronized\u52a0\u9501\n                synchronized (f) {\n                    if (tabAt(tab, i) == f) {\n                        if (fh &gt;= 0) {\n                            //\u6b64\u65f6hash\u6876\u662f\u94fe\u8868\u7ed3\u6784\n                            binCount = 1;\n                            for (Node&lt;K,V&gt; e = f;; ++binCount) {\n                                K ek;\n                                if (e.hash == hash &amp;&amp;\n                                    ((ek = e.key) == key ||\n                                     (ek != null &amp;&amp; key.equals(ek)))) {\n                                    oldVal = e.val;\n                                    if (!onlyIfAbsent)\n                                        e.val = value;\n                                    break;\n                                }\n                                Node&lt;K,V&gt; pred = e;\n                                if ((e = e.next) == null) {\n                                    pred.next = new Node&lt;K,V&gt;(hash, key,\n                                                              value, null);\n                                    break;\n                                }\n                            }\n                        }\n                        else if (f instanceof TreeBin) {\n                            //\u6b64\u65f6\u662f\u7ea2\u9ed1\u6811\n                            Node&lt;K,V&gt; p;\n                            binCount = 2;\n                            if ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,\n                                                           value)) != null) {\n                                oldVal = p.val;\n                                if (!onlyIfAbsent)\n                                    p.val = value;\n                            }\n                        }\n                        else if (f instanceof ReservationNode)\n                            throw new IllegalStateException(\"Recursive update\");\n                    }\n                }\n                if (binCount != 0) {\n                    //\u5f53\u94fe\u8868\u7ed3\u6784\u5927\u4e8e\u7b49\u4e8e8\uff0c\u5219\u5c06\u94fe\u8868\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\n                    if (binCount &gt;= TREEIFY_THRESHOLD)\n                        treeifyBin(tab, i);\n                    if (oldVal != null)\n                  return oldVal;\n                    break;\n                }\n            }\n        }\n        addCount(1L, binCount);\n        return null;\n    }\n</code></pre> <p>\u5728putVal\u65b9\u6cd5\u91cd\u8981\u7684\u5730\u65b9\u90fd\u52a0\u4e86\u6ce8\u91ca\uff0c\u53ef\u4ee5\u5e2e\u52a9\u7406\u89e3\uff0c\u73b0\u5728\u6211\u4eec\u4e00\u6b65\u4e00\u6b65\u6765\u770bputVal\u65b9\u6cd5\u3002</p>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#cas","title":"\u4f7f\u7528CAS","text":"<p>\u5f53\u6709\u4e00\u4e2a\u65b0\u7684\u503c\u9700\u8981put\u5230ConcurrentHashMap\u4e2d\u65f6\uff0c\u9996\u5148\u4f1a\u904d\u5386ConcurrentHashMap\u7684table\u6570\u7ec4\uff0c\u7136\u540e\u6839\u636ekey\u7684hashCode\u6765\u5b9a\u4f4d\u5230\u9700\u8981\u5c06\u8fd9\u4e2avalue\u653e\u5230\u6570\u7ec4\u7684\u54ea\u4e2a\u4f4d\u7f6e\u3002</p> <p><code>tabAt(tab, i = (n - 1) &amp; hash))</code>\u5c31\u662f\u5b9a\u4f4d\u5230\u8fd9\u4e2a\u6570\u7ec4\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u5f53\u524d\u8fd9\u4e2a\u4f4d\u7f6e\u7684Node\u4e3anull\uff0c\u5219\u901a\u8fc7CAS\u65b9\u5f0f\u7684\u65b9\u6cd5\u5199\u5165\u3002\u6240\u8c13\u7684CAS\uff0c\u5373\u5373compareAndSwap\uff0c\u6267\u884cCAS\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5c06\u5185\u5b58\u4f4d\u7f6e\u7684\u503c\u4e0e\u9884\u671f\u539f\u503c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u5904\u7406\u5668\u4f1a\u81ea\u52a8\u5c06\u8be5\u4f4d\u7f6e\u503c\u66f4\u65b0\u4e3a\u65b0\u503c\uff0c\u5426\u5219\uff0c\u5904\u7406\u5668\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\u3002</p> <p>\u8fd9\u91cc\u5c31\u662f\u8c03\u7528casTabAt\u65b9\u6cd5\u6765\u5b9e\u73b0\u7684\u3002</p> <pre><code>     static final &lt;K,V&gt; boolean casTabAt(Node&lt;K,V&gt;[] tab, int i,\n                                        Node&lt;K,V&gt; c, Node&lt;K,V&gt; v) {\n        return U.compareAndSwapObject(tab, ((long)i &lt;&lt; ASHIFT) + ABASE, c, v);\n    }\n\n</code></pre> <p>casTabAt\u540c\u6837\u662f\u901a\u8fc7\u8c03\u7528Unsafe\u7c7b\u6765\u5b9e\u73b0\u7684\uff0c\u8c03\u7528Unsafe\u7684compareAndSwapObject\u6765\u5b9e\u73b0\uff0c\u5176\u5b9e\u5982\u679c\u4ed4\u7ec6\u53bb\u8ffd\u8e2a\u8fd9\u6761\u7ebf\u8def\uff0c\u4f1a\u53d1\u73b0\u5176\u5b9e\u6700\u7ec8\u8c03\u7528\u7684\u662fcmpxchg\u8fd9\u4e2aCPU\u6307\u4ee4\u6765\u5b9e\u73b0\u7684\uff0c\u8fd9\u662f\u4e00\u4e2aCPU\u7684\u539f\u5b50\u6307\u4ee4\uff0c\u80fd\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002</p>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#synchronized","title":"\u4f7f\u7528synchronized","text":"<p>\u5f53\u5934\u7ed3\u70b9\u4e0d\u4e3anull\u65f6\uff0c\u5219\u4f7f\u7528\u8be5\u5934\u7ed3\u70b9\u52a0\u9501\uff0c\u8fd9\u6837\u5c31\u80fd\u591a\u7ebf\u7a0b\u53bbput hashCode\u76f8\u540c\u7684\u65f6\u5019\u4e0d\u4f1a\u51fa\u73b0\u6570\u636e\u4e22\u5931\u7684\u95ee\u9898\u3002synchronized\u662f\u4e92\u65a5\u9501\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u591f\u62ff\u5230\u8fd9\u4e2a\u9501\uff0c\u4ece\u800c\u4fdd\u8bc1\u4e86put\u64cd\u4f5c\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002</p> <p>\u4e0b\u9762\u662fConcurrentHashMap\u7684put\u64cd\u4f5c\u7684\u793a\u610f\u56fe\uff0c\u56fe\u7247\u6765\u81ea\u4e8eConcurrentHashMap\u6e90\u7801\u5206\u6790(JDK8)get/put/remove\u65b9\u6cd5\u5206\u6790\u3002 </p>"},{"location":"Java/ConcurrentHashMap%E6%98%AF%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84/#_1","title":"\u53c2\u8003\u6587\u7ae0","text":"<p>\u4eceConcurrentHashMap\u7684\u6f14\u8fdb\u770bJava\u591a\u7ebf\u7a0b\u6838\u5fc3\u6280\u672f</p> <p>ConcurrentHashMap\u6e90\u7801\u5206\u6790(JDK8)get/put/remove\u65b9\u6cd5\u5206\u6790</p>"},{"location":"Java/Java%E4%B8%AD%E4%B8%80%E4%BA%9B%E6%AF%94%E8%BE%83%E9%9A%BE%E7%90%86%E8%A7%A3%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/","title":"Java\u4e2d\u4e00\u4e9b\u6bd4\u8f83\u96be\u7406\u89e3\u7684\u77e5\u8bc6\u70b9","text":""},{"location":"Java/Java%E4%B8%AD%E4%B8%80%E4%BA%9B%E6%AF%94%E8%BE%83%E9%9A%BE%E7%90%86%E8%A7%A3%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/#java","title":"Java\u4e2d\u4e00\u4e9b\u6bd4\u8f83\u96be\u7406\u89e3\u7684\u77e5\u8bc6\u70b9\uff08\u6cdb\u578b\uff0c\u6ce8\u89e3\uff0c\u53cd\u5c04\uff09","text":"<p>\u5bf9\u4e8e Java \u4e2d\u7684\u6cdb\u578b\uff0c\u6ce8\u89e3\uff0c\u53cd\u5c04\u7b49\u8fd9\u4e9b\u77e5\u8bc6\u70b9\uff0c\u56e0\u4e3a\u6211\u4eec\u5e73\u65f6\u53ea\u4f1a\u4f7f\u7528\u5230\u5b83\u4eec\u7684\u57fa\u7840\u529f\u80fd\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u5f88\u591a\u65f6\u5019\u53ea\u662f\u77e5\u9053\u4e2a\u5927\u6982\uff0c\u4f46\u662f\u5bf9\u4e8e\u8fd9\u4e9b\u77e5\u8bc6\u7684\u7406\u89e3\u5f80\u5f80\u662f\u4f60\u4e0e\u4e00\u822c\u5f00\u53d1\u8005\u62c9\u5f00\u5dee\u8ddd\u7684\u5730\u65b9\u3002</p> <p>\u4e0b\u9762\u7684\u4e24\u7bc7\u6587\u7ae0\u4e3b\u8981\u4ece\u7f51\u7edc\u535a\u5ba2\u4e2d\u6458\u8981\u4e0b\u6765\u7684\u6587\u7ae0\uff0c\u6587\u672b\u6709\u94fe\u63a5\uff0c\u6682\u65f6\u8fd9\u4e00\u5757\u6211\u8fd9\u8fb9\u6ca1\u6709\u8fdb\u884c\u7279\u6b8a\u6574\u7406\u3002</p> <p>Java\u4e2d\u7684\u6ce8\u89e3</p> <p>Java\u4e2d\u7684\u6cdb\u578b</p> <p><code>\u5f85\u8865\u5145</code></p> <p>[Java\u4e2d\u7684\u53cd\u5c04]</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/","title":"Java\u4e2d\u7684\u6cdb\u578b","text":""},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_1","title":"\u6cdb\u578b\u7684\u5b9a\u4e49","text":"<p>\u6cdb\u578b\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u53c2\u6570\u5316\u7c7b\u578b\uff0c\u6216\u8005\u8bf4\u53ef\u4ee5\u5c06\u7c7b\u578b\u5f53\u505a\u53c2\u6570\u4f20\u9012\u7ed9\u4e00\u4e2a\u7c7b\u6216\u8005\u65b9\u6cd5\uff0c\u6cdb\u578b\u6700\u4e3b\u8981\u4f5c\u7528\u662f\u7ea6\u675f\u3002</p> <p>\u4ec0\u4e48\u53eb\u53c2\u6570\u5316\u7c7b\u578b\u5462\uff1f</p> <pre><code>public class Cache {\n    Object value;\n    public Object getValue() {\n        return value;\n    }\n    public void setValue(Object value) {\n        this.value = value;\n    }\n}\n</code></pre> <p>\u5047\u8bbe Cache \u80fd\u591f\u5b58\u53d6\u4efb\u4f55\u7c7b\u578b\u7684\u503c\uff0c\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u5b83\u3002</p> <pre><code>Cache cache = new Cache();\ncache.setValue(134);\nint value = (int) cache.getValue();\ncache.setValue(\"hello\");\nString value1 = (String) cache.getValue();\n</code></pre> <p>\u4f7f\u7528\u7684\u65b9\u6cd5\u4e5f\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u6211\u4eec\u505a\u6b63\u786e\u7684\u5f3a\u5236\u8f6c\u6362\u5c31\u597d\u4e86\u3002</p> <p>\u4f46\u662f\uff0c\u6cdb\u578b\u5374\u7ed9\u6211\u4eec\u5e26\u6765\u4e86\u4e0d\u4e00\u6837\u7684\u7f16\u7a0b\u4f53\u9a8c\u3002</p> <pre><code>public class Cache&lt;T&gt; {\n    T value;\n\n    public Object getValue() {\n        return value;\n    }\n\n    public void setValue(T value) {\n        this.value = value;\n    }\n}\n</code></pre> <p>\u8fd9\u5c31\u662f\u6cdb\u578b\uff0c\u5b83\u5c06 value \u8fd9\u4e2a\u5c5e\u6027\u7684\u7c7b\u578b\u4e5f\u53c2\u6570\u5316\u4e86\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u53c2\u6570\u5316\u7c7b\u578b\u3002\u518d\u770b\u5b83\u7684\u4f7f\u7528\u65b9\u6cd5\u3002</p> <pre><code>Cache&lt;String&gt; cache1 = new Cache&lt;String&gt;();\ncache1.setValue(\"123\");\nString value2 = cache1.getValue();\n\nCache&lt;Integer&gt; cache2 = new Cache&lt;Integer&gt;();\ncache2.setValue(456);\nint value3 = cache2.getValue();\n\n</code></pre> <p>\u8fd9\u6837\u6765\u770b\uff0c - \u5728\u4e0e\u666e\u901a\u7684 Object \u4ee3\u66ff\u4e00\u5207\u7c7b\u578b\u8fd9\u6837\u7b80\u5355\u7c97\u66b4\u800c\u8a00\uff0c\u6cdb\u578b\u4f7f\u5f97\u6570\u636e\u7684\u7c7b\u522b\u53ef\u4ee5\u50cf\u53c2\u6570\u4e00\u6837\u7531\u5916\u90e8\u4f20\u9012\u8fdb\u6765\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u79cd\u6269\u5c55\u80fd\u529b\u3002\u5b83\u66f4\u7b26\u5408\u9762\u5411\u62bd\u8c61\u5f00\u53d1\u7684\u8f6f\u4ef6\u7f16\u7a0b\u5b97\u65e8\u3002 - \u5f53\u5177\u4f53\u7684\u7c7b\u578b\u786e\u5b9a\u540e\uff0c\u6cdb\u578b\u53c8\u63d0\u4f9b\u4e86\u4e00\u79cd\u7c7b\u578b\u68c0\u6d4b\u7684\u673a\u5236\uff0c\u53ea\u6709\u76f8\u5339\u914d\u7684\u6570\u636e\u624d\u80fd\u6b63\u5e38\u7684\u8d4b\u503c\uff0c\u5426\u5219\u7f16\u8bd1\u5668\u5c31\u4e0d\u901a\u8fc7\u3002\u6240\u4ee5\u8bf4\uff0c\u5b83\u662f\u4e00\u79cd\u7c7b\u578b\u5b89\u5168\u68c0\u6d4b\u673a\u5236\uff0c\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u63d0\u9ad8\u4e86\u8f6f\u4ef6\u7684\u5b89\u5168\u6027\u9632\u6b62\u51fa\u73b0\u4f4e\u7ea7\u7684\u5931\u8bef\u3002 - \u6cdb\u578b\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u4e0d\u5fc5\u8981\u7b49\u5230\u8fd0\u884c\u7684\u65f6\u5019\u624d\u53bb\u5f3a\u5236\u8f6c\u6362\uff0c\u5728\u5b9a\u4e49\u6216\u8005\u5b9e\u4f8b\u5316\u9636\u6bb5\uff0c\u56e0\u4e3a Cache\u8fd9\u4e2a\u7c7b\u578b\u663e\u5316\u7684\u6548\u679c\uff0c\u7a0b\u5e8f\u5458\u80fd\u591f\u4e00\u76ee\u4e86\u7136\u731c\u6d4b\u51fa\u4ee3\u7801\u8981\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b\u3002"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_2","title":"\u6cdb\u578b\u7684\u5b9a\u4e49\u548c\u4f7f\u7528","text":"<ul> <li>\u6cdb\u578b\u7c7b</li> <li>\u6cdb\u578b\u65b9\u6cd5</li> <li>\u6cdb\u578b\u63a5\u53e3</li> </ul>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_3","title":"\u6cdb\u578b\u7c7b","text":"<pre><code>public class Test&lt;T&gt; {\n    T field;\n}\n</code></pre> <p>\u5c16\u62ec\u53f7 &lt;&gt;\u4e2d\u7684 T \u88ab\u79f0\u4f5c\u662f\u7c7b\u578b\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u4ee3\u4efb\u4f55\u7c7b\u578b\u3002\u4e8b\u5b9e\u4e0a\uff0cT \u53ea\u662f\u4e00\u79cd\u4e60\u60ef\u6027\u5199\u6cd5\uff0c\u5982\u679c\u4f60\u613f\u610f\u3002\u4f60\u53ef\u4ee5\u8fd9\u6837\u5199\u3002</p> <pre><code>public class Test&lt;Hello&gt; {\n    Hello field;\n}\n</code></pre> <p>\u4f46\u51fa\u4e8e\u89c4\u8303\u7684\u76ee\u7684\uff0cJava \u8fd8\u662f\u5efa\u8bae\u6211\u4eec\u7528\u5355\u4e2a\u5927\u5199\u5b57\u6bcd\u6765\u4ee3\u8868\u7c7b\u578b\u53c2\u6570\u3002\u5e38\u89c1\u7684\u5982\uff1a</p> <ol> <li>T \u4ee3\u8868\u4e00\u822c\u7684\u4efb\u4f55\u7c7b\u3002</li> <li>E \u4ee3\u8868 Element \u7684\u610f\u601d\uff0c\u6216\u8005 Exception \u5f02\u5e38\u7684\u610f\u601d\u3002</li> <li>K \u4ee3\u8868 Key \u7684\u610f\u601d\u3002</li> <li>V \u4ee3\u8868 Value \u7684\u610f\u601d\uff0c\u901a\u5e38\u4e0e K \u4e00\u8d77\u914d\u5408\u4f7f\u7528\u3002</li> <li>S \u4ee3\u8868 Subtype \u7684\u610f\u601d\uff0c\u6587\u7ae0\u540e\u9762\u90e8\u5206\u4f1a\u8bb2\u89e3\u793a\u610f\u3002</li> </ol> <p>\u5982\u679c\u4e00\u4e2a\u7c7b\u88ab \u7684\u5f62\u5f0f\u5b9a\u4e49\uff0c\u90a3\u4e48\u5b83\u5c31\u88ab\u79f0\u4e3a\u662f\u6cdb\u578b\u7c7b\u3002 <p>\u6cdb\u578b\u7c7b\u4e0d\u53ea\u63a5\u53d7\u4e00\u4e2a\u7c7b\u578b\u53c2\u6570\uff0c\u5b83\u8fd8\u53ef\u4ee5\u8fd9\u6837\u63a5\u53d7\u591a\u4e2a\u7c7b\u578b\u53c2\u6570\u3002</p> <pre><code>public class MultiType &lt;E,T&gt;{\n    E value1;\n    T value2;\n\n    public E getValue1(){\n        return value1;\n    }\n\n    public T getValue2(){\n        return value2;\n    }\n}\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_4","title":"\u6cdb\u578b\u65b9\u6cd5","text":"<pre><code>public class Test1 {\n\n    public &lt;T&gt; void testMethod(T t){\n\n    }\n}\n</code></pre> <p>\u6cdb\u578b\u65b9\u6cd5\u4e0e\u6cdb\u578b\u7c7b\u7a0d\u6709\u4e0d\u540c\u7684\u5730\u65b9\u662f\uff0c\u7c7b\u578b\u53c2\u6570\u4e5f\u5c31\u662f\u5c16\u62ec\u53f7\u90a3\u4e00\u90e8\u5206\u662f\u5199\u5728\u8fd4\u56de\u503c\u524d\u9762\u7684\u3002\u4e2d\u7684 T \u88ab\u79f0\u4e3a\u7c7b\u578b\u53c2\u6570\uff0c\u800c\u65b9\u6cd5\u4e2d\u7684 T \u88ab\u79f0\u4e3a\u53c2\u6570\u5316\u7c7b\u578b\uff0c\u5b83\u4e0d\u662f\u8fd0\u884c\u65f6\u771f\u6b63\u7684\u53c2\u6570\u3002 <p>\u5f53\u7136\uff0c\u58f0\u660e\u7684\u7c7b\u578b\u53c2\u6570\uff0c\u5176\u5b9e\u4e5f\u662f\u53ef\u4ee5\u5f53\u4f5c\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u7684\u3002</p> <pre><code>public  &lt;T&gt; T testMethod1(T t){\n        return null;\n}\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_5","title":"\u6cdb\u578b\u7c7b\u4e0e\u6cdb\u578b\u65b9\u6cd5\u7684\u5171\u5b58\u73b0\u8c61","text":"<pre><code>public class Test1&lt;T&gt;{\n\n    public  void testMethod(T t){\n        System.out.println(t.getClass().getName());\n    }\n    public  &lt;T&gt; T testMethod1(T t){\n        return t;\n    }\n}\n\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0cTest1\u662f\u6cdb\u578b\u7c7b\uff0ctestMethod \u662f\u6cdb\u578b\u7c7b\u4e2d\u7684\u666e\u901a\u65b9\u6cd5\uff0c\u800c testMethod1 \u662f\u4e00\u4e2a\u6cdb\u578b\u65b9\u6cd5\u3002\u800c\u6cdb\u578b\u7c7b\u4e2d\u7684\u7c7b\u578b\u53c2\u6570\u4e0e\u6cdb\u578b\u65b9\u6cd5\u4e2d\u7684\u7c7b\u578b\u53c2\u6570\u662f\u6ca1\u6709\u76f8\u5e94\u7684\u8054\u7cfb\u7684\uff0c\u6cdb\u578b\u65b9\u6cd5\u59cb\u7ec8\u4ee5\u81ea\u5df1\u5b9a\u4e49\u7684\u7c7b\u578b\u53c2\u6570\u4e3a\u51c6\u3002 <p>\u6240\u4ee5\uff0c\u9488\u5bf9\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u7f16\u5199\u6d4b\u8bd5\u4ee3\u7801\u3002</p> <pre><code>Test1&lt;String&gt; t = new Test1();\nt.testMethod(\"generic\");\nInteger i = t.testMethod1(new Integer(1));\n</code></pre> <p>\u6cdb\u578b\u7c7b\u7684\u5b9e\u9645\u7c7b\u578b\u53c2\u6570\u662f String\uff0c\u800c\u4f20\u9012\u7ed9\u6cdb\u578b\u65b9\u6cd5\u7684\u7c7b\u578b\u53c2\u6570\u662f Integer\uff0c\u4e24\u8005\u4e0d\u60f3\u5e72\u3002</p> <p>\u4f46\u662f\uff0c\u4e3a\u4e86\u907f\u514d\u6df7\u6dc6\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u6cdb\u578b\u7c7b\u4e2d\u5b58\u5728\u6cdb\u578b\u65b9\u6cd5\uff0c\u90a3\u4e48\u4e24\u8005\u7684\u7c7b\u578b\u53c2\u6570\u6700\u597d\u4e0d\u8981\u540c\u540d\u3002\u6bd4\u5982\uff0cTest1\u4ee3\u7801\u53ef\u4ee5\u66f4\u6539\u4e3a\u8fd9\u6837\u3002 <pre><code>public class Test1&lt;T&gt;{\n\n    public  void testMethod(T t){\n        System.out.println(t.getClass().getName());\n    }\n    public  &lt;E&gt; E testMethod1(E e){\n        return e;\n    }\n}\n\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_6","title":"\u6cdb\u578b\u63a5\u53e3","text":"<p>\u6cdb\u578b\u63a5\u53e3\u548c\u6cdb\u578b\u7c7b\u5dee\u4e0d\u591a\uff0c\u6240\u4ee5\u4e00\u7b14\u5e26\u8fc7\u3002</p> <pre><code>public interface Iterable&lt;T&gt; {\n}\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_7","title":"\u901a\u914d\u7b26 \uff1f","text":"<p>\u9664\u4e86\u7528 \u8868\u793a\u6cdb\u578b\u5916\uff0c\u8fd8\u6709 &lt;?&gt;\u8fd9\u79cd\u5f62\u5f0f\u3002\uff1f \u88ab\u79f0\u4e3a\u901a\u914d\u7b26\u3002 <p>\u53ef\u80fd\u6709\u540c\u5b66\u4f1a\u60f3\uff0c\u5df2\u7ecf\u6709\u4e86 \u7684\u5f62\u5f0f\u4e86\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u5f15\u8fdb &lt;?&gt;\u8fd9\u6837\u7684\u6982\u5ff5\u5462\uff1f <pre><code>class Base{}\n\nclass Sub extends Base{}\n\nSub sub = new Sub();\nBase base = sub;            \n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u663e\u793a\uff0cBase \u662f Sub \u7684\u7236\u7c7b\uff0c\u5b83\u4eec\u4e4b\u95f4\u662f\u7ee7\u627f\u5173\u7cfb\uff0c\u6240\u4ee5 Sub \u7684\u5b9e\u4f8b\u53ef\u4ee5\u7ed9\u4e00\u4e2a Base \u5f15\u7528\u8d4b\u503c\uff0c\u90a3\u4e48</p> <pre><code>List&lt;Sub&gt; lsub = new ArrayList&lt;&gt;();\nList&lt;Base&gt; lbase = lsub;\n\n</code></pre> <p>\u6700\u540e\u4e00\u884c\u4ee3\u7801\u6210\u7acb\u5417\uff1f\u7f16\u8bd1\u4f1a\u901a\u8fc7\u5417\uff1f \u7b54\u6848\u662f\u5426\u5b9a\u7684\u3002</p> <p>\u7f16\u8bd1\u5668\u4e0d\u4f1a\u8ba9\u5b83\u901a\u8fc7\u7684\u3002Sub \u662f Base \u7684\u5b50\u7c7b\uff0c\u4e0d\u4ee3\u8868 List<sub>\u548c List\u6709\u7ee7\u627f\u5173\u7cfb\u3002 <p>\u4f46\u662f\uff0c\u5728\u73b0\u5b9e\u7f16\u7801\u4e2d\uff0c\u786e\u5b9e\u6709\u8fd9\u6837\u7684\u9700\u6c42\uff0c\u5e0c\u671b\u6cdb\u578b\u80fd\u591f\u5904\u7406\u67d0\u4e00\u8303\u56f4\u5185\u7684\u6570\u636e\u7c7b\u578b\uff0c\u6bd4\u5982\u67d0\u4e2a\u7c7b\u548c\u5b83\u7684\u5b50\u7c7b\uff0c\u5bf9\u6b64 Java \u5f15\u5165\u4e86\u901a\u914d\u7b26\u8fd9\u4e2a\u6982\u5ff5\u3002</p> <p>\u6240\u4ee5\uff0c\u901a\u914d\u7b26\u7684\u51fa\u73b0\u662f\u4e3a\u4e86\u6307\u5b9a\u6cdb\u578b\u4e2d\u7684\u7c7b\u578b\u8303\u56f4\u3002</p> <p>\u901a\u914d\u7b26\u6709 3 \u79cd\u5f62\u5f0f\u3002 1. &lt;?&gt;\u88ab\u79f0\u4f5c\u65e0\u9650\u5b9a\u7684\u901a\u914d\u7b26\u3002 2. &lt;? extends T&gt;\u88ab\u79f0\u4f5c\u6709\u4e0a\u9650\u7684\u901a\u914d\u7b26\u3002 3. &lt;? super T&gt;\u88ab\u79f0\u4f5c\u6709\u4e0b\u9650\u7684\u901a\u914d\u7b26\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#_8","title":"\u65e0\u9650\u5b9a\u901a\u914d\u7b26 &lt;?&gt;","text":"<p>\u65e0\u9650\u5b9a\u901a\u914d\u7b26\u7ecf\u5e38\u4e0e\u5bb9\u5668\u7c7b\u914d\u5408\u4f7f\u7528\uff0c\u5b83\u5176\u4e2d\u7684 ? \u5176\u5b9e\u4ee3\u8868\u7684\u662f\u672a\u77e5\u7c7b\u578b\uff0c\u6240\u4ee5\u6d89\u53ca\u5230 ? \u65f6\u7684\u64cd\u4f5c\uff0c\u4e00\u5b9a\u4e0e\u5177\u4f53\u7c7b\u578b\u65e0\u5173\u3002</p> <pre><code>public void testWildCards(Collection&lt;?&gt; collection){\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u65b9\u6cd5\u5185\u7684\u53c2\u6570\u662f\u88ab\u65e0\u9650\u5b9a\u901a\u914d\u7b26\u4fee\u9970\u7684 Collection \u5bf9\u8c61\uff0c\u5b83\u9690\u7565\u5730\u8868\u8fbe\u4e86\u4e00\u4e2a\u610f\u56fe\u6216\u8005\u53ef\u4ee5\u8bf4\u662f\u9650\u5b9a\uff0c\u90a3\u5c31\u662f testWidlCards() \u8fd9\u4e2a\u65b9\u6cd5\u5185\u90e8\u65e0\u9700\u5173\u6ce8 Collection \u4e2d\u7684\u771f\u5b9e\u7c7b\u578b\uff0c\u56e0\u4e3a\u5b83\u662f\u672a\u77e5\u7684\u3002\u6240\u4ee5\uff0c\u4f60\u53ea\u80fd\u8c03\u7528 Collection \u4e2d\u4e0e\u7c7b\u578b\u65e0\u5173\u7684\u65b9\u6cd5\u3002</p> <pre><code>public void testWildCards(Collection&lt;?&gt; collection){\n        collection.add(\"123\"); //\u7f16\u8bd1\u4e0d\u901a\u8fc7\n        collection.add(123);   ////\u7f16\u8bd1\u4e0d\u901a\u8fc7\n\n        collection.size(); ////\u7f16\u8bd1\u901a\u8fc7\n        collection.iterator(); ////\u7f16\u8bd1\u901a\u8fc7\n    }\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5f53 &lt;?&gt;\u5b58\u5728\u65f6\uff0cCollection \u5bf9\u8c61\u4e27\u5931\u4e86 add() \u65b9\u6cd5\u7684\u529f\u80fd\uff0c\u7f16\u8bd1\u5668\u4e0d\u901a\u8fc7\u3002</p> <p>\u6709\u4eba\u8bf4\uff0c&lt;?&gt;\u63d0\u4f9b\u4e86\u53ea\u8bfb\u7684\u529f\u80fd\uff0c\u4e5f\u5c31\u662f\u5b83\u5220\u51cf\u4e86\u589e\u52a0\u5177\u4f53\u7c7b\u578b\u5143\u7d20\u7684\u80fd\u529b\uff0c\u53ea\u4fdd\u7559\u4e0e\u5177\u4f53\u7c7b\u578b\u65e0\u5173\u7684\u529f\u80fd\u3002\u5b83\u4e0d\u7ba1\u88c5\u8f7d\u5728\u8fd9\u4e2a\u5bb9\u5668\u5185\u7684\u5143\u7d20\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u5b83\u53ea\u5173\u5fc3\u5143\u7d20\u7684\u6570\u91cf\u3001\u5bb9\u5668\u662f\u5426\u4e3a\u7a7a\uff1f\u6211\u60f3\u8fd9\u79cd\u9700\u6c42\u8fd8\u662f\u5f88\u5e38\u89c1\u7684\u5427\u3002</p> <p>\u6709\u540c\u5b66\u53ef\u80fd\u4f1a\u60f3\uff0c&lt;?&gt;\u65e2\u7136\u4f5c\u7528\u8fd9\u4e48\u6e3a\u5c0f\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8fd8\u8981\u5f15\u7528\u5b83\u5462\uff1f \u007f</p> <p>\u4e2a\u4eba\u8ba4\u4e3a\uff0c\u63d0\u9ad8\u4e86\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\uff0c\u7a0b\u5e8f\u5458\u770b\u5230\u8fd9\u6bb5\u4ee3\u7801\u65f6\uff0c\u5c31\u80fd\u591f\u8fc5\u901f\u5bf9\u6b64\u5efa\u7acb\u6781\u7b80\u6d01\u7684\u5370\u8c61\uff0c\u80fd\u591f\u5feb\u901f\u63a8\u65ad\u6e90\u7801\u4f5c\u8005\u7684\u610f\u56fe\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/#extends-t","title":"&lt;? extends T&gt;","text":"\u4ee3\u8868\u7740\u7c7b\u578b\u672a\u77e5\uff0c\u4f46\u662f\u6211\u4eec\u7684\u786e\u9700\u8981\u5bf9\u4e8e\u7c7b\u578b\u7684\u63cf\u8ff0\u518d\u7cbe\u786e\u4e00\u70b9\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u786e\u5b9a\u7c7b\u522b\uff0c\u6bd4\u5982\u7c7b\u578b A \u53ca \u7c7b\u578b A \u7684\u5b50\u7c7b\u90fd\u53ef\u4ee5\u3002   <pre><code>// &lt;? extends T&gt; \u4ee3\u8868\u7c7b\u578b T \u53ca T \u7684\u5b50\u7c7b\u3002\npublic void testSub(Collection&lt;? extends Base&gt; para){\n\n } \n</code></pre>   \u4e0a\u9762\u4ee3\u7801\u4e2d\uff0cpara \u8fd9\u4e2a Collection \u63a5\u53d7 Base \u53ca Base \u7684\u5b50\u7c7b\u7684\u7c7b\u578b\u3002 \u4f46\u662f\uff0c\u5b83\u4ecd\u7136\u4e27\u5931\u4e86\u5199\u64cd\u4f5c\u7684\u80fd\u529b\u3002\u4e5f\u5c31\u662f\u8bf4   <pre><code>para.add(new Sub());  //\u7f16\u8bd1\u4e0d\u901a\u8fc7\npara.add(new Base()); //\u7f16\u8bd1\u4e0d\u901a\u8fc7\n</code></pre>   \u4ecd\u7136\u7f16\u8bd1\u4e0d\u901a\u8fc7\u3002 \u6ca1\u6709\u5173\u7cfb\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u5177\u4f53\u7c7b\u578b\uff0c\u4f46\u662f\u6211\u4eec\u81f3\u5c11\u6e05\u695a\u4e86\u7c7b\u578b\u7684\u8303\u56f4\u3002  \u53e6\u5916\uff0c\u5728kotlin\u4e2d\uff0c \u5199\u6cd5\u662f  <pre><code>fun test(list: ArrayList&lt;out Base&gt;) {\n\n}\n</code></pre>   ####   ``` ``` \u8fd9\u4e2a\u548c ``````\u76f8\u5bf9\u5e94\uff0c\u4ee3\u8868 T \u53ca T \u7684\u8d85\u7c7b\u3002  ``` public void testSuper(Collection para){ }   ```    ``````\u795e\u5947\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u5b83\u62e5\u6709\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5199\u64cd\u4f5c\u7684\u80fd\u529b\u3002   ``` public void testSuper(Collection para){      para.add(new Sub());//\u7f16\u8bd1\u901a\u8fc7      para.add(new Base());//\u7f16\u8bd1\u4e0d\u901a\u8fc7   }    <pre><code>\n```&lt;? super Sub&gt;``` \u8868\u793a\u51e1\u662fSub\u4ee5\u53caSub\u7684\u5b50\u7c7b\u90fd\u53ef\u4ee5\u5199\u5165\u5230\u8fd9\u4e2aCollection\u96c6\u5408\u4e2d\u3002\n\n\n\u6211\u4eec\u63a5\u7740\u6539\u6210&lt;? super Base&gt;\n\n\n\n\n</code></pre>   java public void testSuper(Collection para){      para.add(new Sub());//\u7f16\u8bd1\u901a\u8fc7      para.add(new Base());//\u7f16\u8bd1\u901a\u8fc7   }  <pre><code>\n\n```&lt;? super Base&gt;```\u8868\u793aBase\u4ee5\u53caBase\u7684\u5b50\u7c7b\u90fd\u80fd\u591f\u6267\u884c\u5199\u64cd\u4f5c\u3002\n\n\u53e6\u5916\uff0c\u5728kotlin\u4e2d\uff0c&lt;? extends T&gt; \u5199\u6cd5\u662f\n</code></pre>   fun test(list: ArrayList) {  }  <pre><code>\n\u603b\u7ed3\u6765\u8bf4\uff0cout\u548cextends\u76f8\u5bf9\u5e94\uff0c\u800cin\u548csuper\u76f8\u5bf9\u5e94\u3002\n\n\u901a\u914d\u7b26\u4e0e\u7c7b\u578b\u53c2\u6570\u7684\u533a\u522b\u4e00\u822c\u800c\u8a00\uff0c\u901a\u914d\u7b26\u80fd\u5e72\u7684\u4e8b\u60c5\u90fd\u53ef\u4ee5\u7528\u7c7b\u578b\u53c2\u6570\u66ff\u6362\u3002 \n\u6bd4\u5982 \n\n</code></pre>  public void testWildCards(Collection <p>collection){</p> <p>}</p> <pre><code>\u53ef\u4ee5\u88ab\n</code></pre> <p>public  void test(Collection collection){} <pre><code>\u53d6\u4ee3\u3002\n\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u7528\u6cdb\u578b\u65b9\u6cd5\u6765\u53d6\u4ee3\u901a\u914d\u7b26\uff0c\u90a3\u4e48\u4e0a\u9762\u4ee3\u7801\u4e2d collection \u662f\u80fd\u591f\u8fdb\u884c\u5199\u64cd\u4f5c\u7684\u3002\u53ea\u4e0d\u8fc7\u8981\u8fdb\u884c\u5f3a\u5236\u8f6c\u6362\u3002\n</code></pre> <p>public  void test(Collection collection){     collection.add((T)new Integer(12));     collection.add((T)\"123\"); } <pre><code>\n#### \u6cdb\u578b\u64e6\u9664\n\n\u6cdb\u578b\u662f Java 1.5 \u7248\u672c\u624d\u5f15\u8fdb\u7684\u6982\u5ff5\uff0c\u5728\u8fd9\u4e4b\u524d\u662f\u6ca1\u6709\u6cdb\u578b\u7684\u6982\u5ff5\u7684\uff0c\u4f46\u663e\u7136\uff0c\u6cdb\u578b\u4ee3\u7801\u80fd\u591f\u5f88\u597d\u5730\u548c\u4e4b\u524d\u7248\u672c\u7684\u4ee3\u7801\u5f88\u597d\u5730\u517c\u5bb9\u3002\n\n\u8fd9\u662f\u56e0\u4e3a\uff0c\u6cdb\u578b\u4fe1\u606f\u53ea\u5b58\u5728\u4e8e\u4ee3\u7801\u7f16\u8bd1\u9636\u6bb5\uff0c\u5728\u8fdb\u5165 JVM \u4e4b\u524d\uff0c\u4e0e\u6cdb\u578b\u76f8\u5173\u7684\u4fe1\u606f\u4f1a\u88ab\u64e6\u9664\u6389\uff0c\u4e13\u4e1a\u672f\u8bed\u53eb\u505a\u7c7b\u578b\u64e6\u9664\u3002\n\n\u901a\u4fd7\u5730\u8bb2\uff0c\u6cdb\u578b\u7c7b\u548c\u666e\u901a\u7c7b\u5728 java \u865a\u62df\u673a\u5185\u662f\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u7684\u5730\u65b9\u3002\u56de\u987e\u6587\u7ae0\u5f00\u59cb\u65f6\u7684\u90a3\u6bb5\u4ee3\u7801\uff1a\n</code></pre> <p>List l1 = new ArrayList(); List l2 = new ArrayList(); <p>System.out.println(l1.getClass() == l2.getClass());</p> <pre><code>\u6253\u5370\u7684\u7ed3\u679c\u4e3a true \u662f\u56e0\u4e3a List&lt;String&gt;\u548c List&lt;Integer&gt;\u5728 jvm \u4e2d\u7684 Class \u90fd\u662f List.class\u3002\n\n\u6cdb\u578b\u4fe1\u606f\u88ab\u64e6\u9664\u4e86\u3002\n\n\u53ef\u80fd\u540c\u5b66\u4f1a\u95ee\uff0c\u90a3\u4e48\u7c7b\u578b String \u548c Integer \u600e\u4e48\u529e\uff1f\n\n\u7b54\u6848\u662f\u6cdb\u578b\u8f6c\u8bd1\u3002\n\n</code></pre> <p>public class Erasure {     T object; <pre><code>public Erasure(T object) {\n    this.object = object;\n}\n</code></pre> <p>}</p> <pre><code>\nErasure \u662f\u4e00\u4e2a\u6cdb\u578b\u7c7b\uff0c\u6211\u4eec\u67e5\u770b\u5b83\u5728\u8fd0\u884c\u65f6\u7684\u72b6\u6001\u4fe1\u606f\u53ef\u4ee5\u901a\u8fc7\u53cd\u5c04\u3002\n</code></pre> <p>Erasure erasure = new Erasure(\"hello\"); Class eclz = erasure.getClass(); System.out.println(\"erasure class is:\"+eclz.getName()); <pre><code>\n\u6253\u5370\u7684\u7ed3\u679c\u662f\n</code></pre> <p>erasure class is:com.frank.test.Erasure</p> <pre><code>\nClass \u7684\u7c7b\u578b\u4ecd\u7136\u662f Erasure \u5e76\u4e0d\u662f Erasure&lt;T&gt;\u8fd9\u79cd\u5f62\u5f0f\uff0c\u90a3\u6211\u4eec\u518d\u770b\u770b\u6cdb\u578b\u7c7b\u4e2d T \u7684\u7c7b\u578b\u5728 jvm \u4e2d\u662f\u4ec0\u4e48\u5177\u4f53\u7c7b\u578b\u3002\n\n</code></pre> <p>Field[] fs = eclz.getDeclaredFields(); for ( Field f:fs) {     System.out.println(\"Field name \"+f.getName()+\" type:\"+f.getType().getName()); }</p> <pre><code>\u6253\u5370\u7ed3\u679c\u662f\n</code></pre> <p>Field name object type:java.lang.Object</p> <pre><code>\n\u90a3\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u8bf4\uff0c\u6cdb\u578b\u7c7b\u88ab\u7c7b\u578b\u64e6\u9664\u540e\uff0c\u76f8\u5e94\u7684\u7c7b\u578b\u5c31\u88ab\u66ff\u6362\u6210 Object \u7c7b\u578b\u5462\uff1f\n\n\u8fd9\u79cd\u8bf4\u6cd5\uff0c\u4e0d\u5b8c\u5168\u6b63\u786e\u3002\n\n\u6211\u4eec\u66f4\u6539\u4e00\u4e0b\u4ee3\u7801\u3002\n</code></pre> <p>public class Erasure { //  public class Erasure {     T object; <pre><code>public Erasure(T object) {\n    this.object = object;\n}\n</code></pre> <p>}</p> <pre><code>\n\u73b0\u5728\u518d\u770b\u6d4b\u8bd5\u7ed3\u679c\uff1a\n</code></pre> <p>Field name object type:java.lang.String</p> <pre><code>\n\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u4e0b\u7ed3\u8bba\u4e86\uff0c\n&gt; \u5728\u6cdb\u578b\u7c7b\u88ab\u7c7b\u578b\u64e6\u9664\u7684\u65f6\u5019\uff0c\u4e4b\u524d\u6cdb\u578b\u7c7b\u4e2d\u7684\u7c7b\u578b\u53c2\u6570\u90e8\u5206\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u4e0a\u9650\uff0c\u5982 &lt;T&gt;\u5219\u4f1a\u88ab\u8f6c\u8bd1\u6210\u666e\u901a\u7684 Object \u7c7b\u578b\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u4e0a\u9650\u5982 &lt;T extends String&gt;\u5219\u7c7b\u578b\u53c2\u6570\u5c31\u88ab\u66ff\u6362\u6210\u7c7b\u578b\u4e0a\u9650\u3002\n\n\n#### \u6cdb\u578b\u4e2d\u503c\u5f97\u6ce8\u610f\u7684\u5730\u65b9\n\n#### \u6cdb\u578b\u7c7b\u6216\u8005\u6cdb\u578b\u65b9\u6cd5\u4e2d\uff0c\u4e0d\u63a5\u53d7 8 \u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3002\n\n\u6cdb\u578b\u7c7b\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u662f\u5806\u5bf9\u8c61\uff0c\u4e0d\u80fd\u662f8\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3002\n\n\u6240\u4ee5\uff0c\u4f60\u6ca1\u6709\u529e\u6cd5\u8fdb\u884c\u8fd9\u6837\u7684\u7f16\u7801\u3002\n</code></pre> <p>List li = new ArrayList&lt;&gt;(); List li = new ArrayList&lt;&gt;(); <pre><code>\u9700\u8981\u4f7f\u7528\u5b83\u4eec\u5bf9\u5e94\u7684\u5305\u88c5\u7c7b\u3002\n</code></pre> <p>List li = new ArrayList&lt;&gt;(); List li1 = new ArrayList&lt;&gt;(); <pre><code>\n#### \u5bf9\u6cdb\u578b\u65b9\u6cd5\u7684\u56f0\u60d1\n</code></pre> <p>public  T test(T t){     return null; } <pre><code>\n\u6709\u7684\u540c\u5b66\u53ef\u80fd\u5bf9\u4e8e\u8fde\u7eed\u7684\u4e24\u4e2a T \u611f\u5230\u56f0\u60d1\uff0c\u5176\u5b9e &lt;T&gt;\u662f\u4e3a\u4e86\u8bf4\u660e\u7c7b\u578b\u53c2\u6570\uff0c\u662f\u58f0\u660e,\u800c\u540e\u9762\u7684\u4e0d\u5e26\u5c16\u62ec\u53f7\u7684 T \u662f\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u3002\n\u4f60\u53ef\u4ee5\u76f8\u50cf\u4e00\u4e0b\uff0c\u5982\u679c test() \u8fd9\u6837\u88ab\u8c03\u7528.\n\n</code></pre> <p>test(\"123\");</p> <pre><code>\u90a3\u4e48\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\n</code></pre> <p>public String test(String t);</p> <pre><code>\n#### Java\u4e0d\u80fd\u521b\u5efa\u5177\u4f53\u7c7b\u578b\u7684\u6cdb\u578b\u6570\u7ec4\n\u8fd9\u53e5\u8bdd\u53ef\u80fd\u96be\u4ee5\u7406\u89e3\uff0c\u4ee3\u7801\u8bf4\u660e\u3002\n</code></pre> <p>List[] li2 = new ArrayList[]; List li3 = new ArrayList[]; <pre><code>\u8fd9\u4e24\u884c\u4ee3\u7801\u662f\u65e0\u6cd5\u5728\u7f16\u8bd1\u5668\u4e2d\u7f16\u8bd1\u901a\u8fc7\u7684\u3002\u539f\u56e0\u8fd8\u662f\u7c7b\u578b\u64e6\u9664\u5e26\u6765\u7684\u5f71\u54cd\u3002\n\nList&lt;Integer&gt;\u548c List&lt;Boolean&gt;\u5728 jvm \u4e2d\u7b49\u540c\u4e8eList&lt;Object&gt;\uff0c\u6240\u6709\u7684\u7c7b\u578b\u4fe1\u606f\u90fd\u88ab\u64e6\u9664\uff0c\u7a0b\u5e8f\u4e5f\u65e0\u6cd5\u5206\u8fa8\u4e00\u4e2a\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u5177\u4f53\u662f List&lt;Integer&gt;\u7c7b\u578b\u8fd8\u662f List&lt;Boolean&gt;\u7c7b\u578b\u3002\n\n\u4f46\u662f\uff0c\n</code></pre> <p>List&lt;?&gt;[] li3 = new ArrayList&lt;?&gt;[10]; li3[1] = new ArrayList(); List&lt;?&gt; v = li3[1]; ``` \u501f\u52a9\u4e8e\u65e0\u9650\u5b9a\u901a\u914d\u7b26\u5374\u53ef\u4ee5\uff0c\u524d\u9762\u8bb2\u8fc7 \uff1f\u4ee3\u8868\u672a\u77e5\u7c7b\u578b\uff0c\u6240\u4ee5\u5b83\u6d89\u53ca\u7684\u64cd\u4f5c\u90fd\u57fa\u672c\u4e0a\u4e0e\u7c7b\u578b\u65e0\u5173\uff0c\u56e0\u6b64 jvm \u4e0d\u9700\u8981\u9488\u5bf9\u5b83\u5bf9\u7c7b\u578b\u4f5c\u5224\u65ad\uff0c\u56e0\u6b64\u5b83\u80fd\u7f16\u8bd1\u901a\u8fc7\uff0c\u4f46\u662f\uff0c\u53ea\u63d0\u4f9b\u4e86\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u56e0\u4e3a\u901a\u914d\u7b26\u539f\u56e0\uff0c\u5b83\u53ea\u80fd\u8bfb\uff0c\u4e0d\u80fd\u5199\u3002\u6bd4\u5982\uff0c\u4e0a\u9762\u7684 v \u8fd9\u4e2a\u5c40\u90e8\u53d8\u91cf\uff0c\u5b83\u53ea\u80fd\u8fdb\u884c get() \u64cd\u4f5c\uff0c\u4e0d\u80fd\u8fdb\u884c add() \u64cd\u4f5c\u3002 <p>\u6587\u7ae0\u53c2\u8003 Java \u6cdb\u578b\uff0c\u4f60\u4e86\u89e3\u7c7b\u578b\u64e6\u9664\u5417\uff1f</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/","title":"Java\u4e2d\u7684\u6ce8\u89e3","text":""},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_1","title":"\u6ce8\u89e3\u76f8\u5f53\u4e8e\u662f\u52a0\u5728\u4ee3\u7801\u4e0a\u7684\u6807\u7b7e\u3002","text":""},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_2","title":"\u6ce8\u89e3\u7684\u5b9a\u4e49","text":"<pre><code>public @interface Test {\n}\n</code></pre> <p>\u521b\u5efa\u5f62\u5f0f\u8ddf\u63a5\u53e3\u7c7b\u4f3c\uff0c\u5728interface\u524d\u9700\u8981\u52a0\"@\"\u7b26\u53f7</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_3","title":"\u5143\u6ce8\u89e3","text":"<p>\u4e3a\u4ec0\u4e48\u9700\u8981\u5143\u6ce8\u89e3\uff1f\u5143\u6ce8\u89e3\u662f\u7528\u6765\u5e72\u561b\u7684\uff1f</p> <p>\u9996\u5148\u5143\u6ce8\u89e3\u662f\u53ef\u4ee5\u6ce8\u89e3\u5230\u6ce8\u89e3\u4e0a\u7684\u6ce8\u89e3\uff0c\u6216\u8005\u8bf4\u5143\u6ce8\u89e3\u662f\u4e00\u79cd\u57fa\u672c\u6ce8\u89e3\uff0c\u4f46\u662f\u5b83\u80fd\u591f\u5e94\u7528\u5230\u5176\u5b83\u7684\u6ce8\u89e3\u4e0a\u9762\u3002</p> <p>\u56e0\u4e3a\u6ce8\u89e3\u5b9a\u4e49\u51fa\u6765\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u7684\u4f5c\u7528\u57df\u662f\u4ec0\u4e48\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u6ce8\u89e3\u5c06\u5e94\u7528\u4e8e\u4ec0\u4e48\u5730\u65b9\uff08\u4f8b\u5982\u662f\u4e00\u4e2a\u65b9\u6cd5\u6216\u8005\u4e00\u4e2a\u5b57\u6bb5\u4e0a\uff09\u3002\u53e6\u5916\uff0c\u6ce8\u89e3\u5b9a\u4e49\u51fa\u6765\uff0c\u9700\u8981\u660e\u786e\u6ce8\u89e3\u662f\u54ea\u4e00\u4e2a\u7ea7\u522b\u53ef\u7528\uff0c\u5728\u6e90\u4ee3\u7801\u4e2d\uff08SOURCE\uff09\u3001\u7c7b\u6587\u4ef6\u4e2d\uff08CLASS\uff09\u6216\u8005\u8fd0\u884c\u65f6\uff08RUNTIME\uff09\u3002</p> <p>\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u5143\u6ce8\u89e3\uff0c\u5143\u6ce8\u89e3\u5c31\u662f\u5e2e\u52a9\u5b9a\u4e49\u4e00\u4e0b\u6ce8\u89e3\u7684\u662f\u600e\u4e48\u4f7f\u7528\u7684\u3002</p> <p>\u5143\u6ce8\u89e3\u6709@Retention\u3001@Documented\u3001@Target\u3001@Inherited\u3001@Repeatable 5 \u79cd\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#retention","title":"@Retention","text":"<p>Retention \u7684\u82f1\u6587\u610f\u4e3a\u4fdd\u7559\u671f\u7684\u610f\u601d\u3002\u5f53 @Retention \u5e94\u7528\u5230\u4e00\u4e2a\u6ce8\u89e3\u4e0a\u7684\u65f6\u5019\uff0c\u5b83\u89e3\u91ca\u8bf4\u660e\u4e86\u8fd9\u4e2a\u6ce8\u89e3\u7684\u7684\u5b58\u6d3b\u65f6\u95f4\u3002</p> <p>\u5b83\u7684\u53d6\u503c\u5982\u4e0b\uff1a</p> <p>RetentionPolicy.SOURCE \u6ce8\u89e3\u53ea\u5728\u6e90\u7801\u9636\u6bb5\u4fdd\u7559\uff0c\u5728\u7f16\u8bd1\u5668\u8fdb\u884c\u7f16\u8bd1\u65f6\u5b83\u5c06\u88ab\u4e22\u5f03\u5ffd\u89c6\u3002 RetentionPolicy.CLASS \u6ce8\u89e3\u53ea\u88ab\u4fdd\u7559\u5230\u7f16\u8bd1\u8fdb\u884c\u7684\u65f6\u5019\uff0c\u5b83\u5e76\u4e0d\u4f1a\u88ab\u52a0\u8f7d\u5230 JVM \u4e2d\u3002 RetentionPolicy.RUNTIME \u6ce8\u89e3\u53ef\u4ee5\u4fdd\u7559\u5230\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u88ab\u52a0\u8f7d\u8fdb\u5165\u5230 JVM \u4e2d\uff0c\u6240\u4ee5\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u53ef\u4ee5\u83b7\u53d6\u5230\u5b83\u4eec\u3002</p> <pre><code>@Retention(RetentionPolicy.RUNTIME)\npublic @interface Test {\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u6307\u5b9aTest\u6ce8\u89e3\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8fd0\u884c\u5468\u671f\u88ab\u83b7\u53d6\u5230\uff0c\u56e0\u6b64\u5b83\u7684\u751f\u547d\u5468\u671f\u975e\u5e38\u7684\u957f\u3002</p> <p>\u8fd9\u91cc\u5bf9\u4e8e\u6ce8\u89e3\u7684@Retention\u600e\u4e48\u4f7f\u7528\u8fd8\u662f\u6709\u70b9\u7591\u95ee\uff0c\u4ec0\u4e48\u65f6\u5019\u8be5\u7528Source\uff0c\u4ec0\u4e48\u65f6\u5019\u8be5\u7528CLASS\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u8be5\u7528RUNTIME\u5462\uff1f</p> <p>\u6839\u636e\u4e3b\u952e\u7684\u5b58\u6d3b\u65f6\u95f4\u6765\u5212\u5206\u5982\u4e0b \u9996\u5148\u8981\u660e\u786e\u5b58\u6d3b\u7684\u65f6\u95f4\u957f\u5ea6 SOURCE &lt; CLASS &lt; RUNTIME \uff0c\u6240\u4ee5\u524d\u8005\u80fd\u4f5c\u7528\u7684\u5730\u65b9\u540e\u8005\u4e00\u5b9a\u4e5f\u80fd\u4f5c\u7528\u3002</p> <p>\u4e3e\u4f8b\uff0c\u4e00\u822c\u5982\u679c\u9700\u8981\u5728\u8fd0\u884c\u65f6\u53bb\u52a8\u6001\u83b7\u53d6\u6ce8\u89e3\u4fe1\u606f\uff0c\u90a3\u53ea\u80fd\u7528 RUNTIME \u6ce8\u89e3\uff0c\u6bd4\u5982Android\u4e2d\u4f7f\u7528@Deprecated\u6807\u8bb0\u65b9\u6cd5\uff0c\u5b57\u6bb5\uff0c\u7c7b\u7b49\u662f\u5426\u5e9f\u5f03\uff0c \u8fd8\u6709\u5f88\u591a\u573a\u666f\u4e5f\u4f1a\u4f7f\u7528Runtime\uff0c\u4f8b\u5982dagger2\u4e2d\u7684Component\u6ce8\u89e3\uff0cdagger2\u4e2d\u4f1a\u5728\u8fd0\u884c\u65f6\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u6ce8\u89e3\u6709\u4e9b\u7279\u6b8a\u7684\u884c\u4e3a\u4ea4\u4e92\u3002</p> <p>\u5982\u679c\u8981\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u4e00\u4e9b\u9884\u5904\u7406\u64cd\u4f5c\uff0c\u6bd4\u5982\u751f\u6210\u4e00\u4e9b\u8f85\u52a9\u4ee3\u7801\uff08\u5982 ButterKnife\uff09\uff0c\u5c31\u7528 CLASS\u6ce8\u89e3\u3002</p> <p>\u4f8b\u5982AndroidX\u5305\u4e0b\u9762\u7684DrawableRes\u3002</p> <pre><code>@Documented\n@Retention(RetentionPolicy.CLASS)\n@Target({ElementType.METHOD, ElementType.PARAMETER, ElementType.FIELD, ElementType.LOCAL_VARIABLE})\npublic @interface DrawableRes {\n}\n</code></pre> <p>DrawableRes\u8868\u793a\u671f\u671b\u6574\u6570\u53c2\u6570\u3001\u5b57\u6bb5\u6216\u65b9\u6cd5\u8fd4\u56de\u503c\u662f\u4e00\u4e2adrawable\u8d44\u6e90\u5f15\u7528\u3002</p> <p>\u5982\u679c\u53ea\u662f\u505a\u4e00\u4e9b\u68c0\u67e5\u6027\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982 @Override \u548c @SuppressWarnings\uff0c\u4f7f\u7528SOURCE \u6ce8\u89e3\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#documented","title":"@Documented","text":"<p>\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u4e2a\u5143\u6ce8\u89e3\u80af\u5b9a\u662f\u548c\u6587\u6863\u6709\u5173\u3002\u5b83\u7684\u4f5c\u7528\u662f\u80fd\u591f\u5c06\u6ce8\u89e3\u4e2d\u7684\u5143\u7d20\u5305\u542b\u5230 Javadoc \u4e2d\u53bb\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#target","title":"@Target","text":"<p>Target \u662f\u76ee\u6807\u7684\u610f\u601d\uff0c@Target \u6307\u5b9a\u4e86\u6ce8\u89e3\u8fd0\u7528\u7684\u5730\u65b9\u3002</p> <p>\u4f60\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff0c\u5f53\u4e00\u4e2a\u6ce8\u89e3\u88ab @Target \u6ce8\u89e3\u65f6\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u5c31\u88ab\u9650\u5b9a\u4e86\u8fd0\u7528\u7684\u573a\u666f\u3002</p> <p>@Target \u6709\u4e0b\u9762\u7684\u53d6\u503c</p> <ul> <li>ElementType.ANNOTATION_TYPE \u53ef\u4ee5\u7ed9\u4e00\u4e2a\u6ce8\u89e3\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.CONSTRUCTOR \u53ef\u4ee5\u7ed9\u6784\u9020\u65b9\u6cd5\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.FIELD \u53ef\u4ee5\u7ed9\u5c5e\u6027\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.LOCAL_VARIABLE \u53ef\u4ee5\u7ed9\u5c40\u90e8\u53d8\u91cf\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.METHOD \u53ef\u4ee5\u7ed9\u65b9\u6cd5\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.PACKAGE \u53ef\u4ee5\u7ed9\u4e00\u4e2a\u5305\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.PARAMETER \u53ef\u4ee5\u7ed9\u4e00\u4e2a\u65b9\u6cd5\u5185\u7684\u53c2\u6570\u8fdb\u884c\u6ce8\u89e3</li> <li>ElementType.TYPE \u53ef\u4ee5\u7ed9\u4e00\u4e2a\u7c7b\u578b\u8fdb\u884c\u6ce8\u89e3\uff0c\u6bd4\u5982\u7c7b\u3001\u63a5\u53e3\u3001\u679a\u4e3e</li> </ul>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#inherited","title":"@Inherited","text":"<p>Inherited \u662f\u7ee7\u627f\u7684\u610f\u601d\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u662f\u8bf4\u6ce8\u89e3\u672c\u8eab\u53ef\u4ee5\u7ee7\u627f\uff0c\u800c\u662f\u8bf4\u5982\u679c\u4e00\u4e2a\u8d85\u7c7b\u88ab @Inherited \u6ce8\u89e3\u8fc7\u7684\u6ce8\u89e3\u8fdb\u884c\u6ce8\u89e3\u7684\u8bdd\uff0c\u90a3\u4e48\u5982\u679c\u5b83\u7684\u5b50\u7c7b\u6ca1\u6709\u88ab\u4efb\u4f55\u6ce8\u89e3\u5e94\u7528\u7684\u8bdd\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u7c7b\u5c31\u7ee7\u627f\u4e86\u8d85\u7c7b\u7684\u6ce8\u89e3\u3002</p> <pre><code>@Inherited\n@Retention(RetentionPolicy.RUNTIME)\n@interface Test {}\n\n@Test\npublic class A {}\n\npublic class B extends A {}\n\n</code></pre> <p>\u6ce8\u89e3 Test \u88ab @Inherited \u4fee\u9970\uff0c\u4e4b\u540e\u7c7b A \u88ab Test \u6ce8\u89e3\uff0c\u7c7b B \u7ee7\u627f A,\u7c7b B \u4e5f\u62e5\u6709 Test \u8fd9\u4e2a\u6ce8\u89e3\u3002</p> <p>@Repeatable Repeatable \u81ea\u7136\u662f\u53ef\u91cd\u590d\u7684\u610f\u601d\u3002@Repeatable \u662f Java 1.8 \u624d\u52a0\u8fdb\u6765\u7684\uff0c\u6240\u4ee5\u7b97\u662f\u4e00\u4e2a\u65b0\u7684\u7279\u6027\u3002</p> <p>\u4ec0\u4e48\u6837\u7684\u6ce8\u89e3\u4f1a\u591a\u6b21\u5e94\u7528\u5462\uff1f\u901a\u5e38\u662f\u6ce8\u89e3\u7684\u503c\u53ef\u4ee5\u540c\u65f6\u53d6\u591a\u4e2a\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4e00\u4e2a\u4eba\u4ed6\u65e2\u662f\u7a0b\u5e8f\u5458\u53c8\u662f\u4ea7\u54c1\u7ecf\u7406,\u540c\u65f6\u4ed6\u8fd8\u662f\u4e2a\u753b\u5bb6\u3002</p> <pre><code>@interface Persons {\n    Person[]  value();\n}\n\n@Repeatable(Persons.class)\n@interface Person{\n    String role default \"\";\n}\n\n@Person(role=\"artist\")\n@Person(role=\"coder\")\n@Person(role=\"PM\")\npublic class SuperMan{\n\n}\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_4","title":"\u6ce8\u89e3\u7684\u5c5e\u6027","text":"<p>\u6ce8\u89e3\u7684\u5c5e\u6027\u4e5f\u53eb\u505a\u6210\u5458\u53d8\u91cf\u3002\u6ce8\u89e3\u53ea\u6709\u6210\u5458\u53d8\u91cf\uff0c\u6ca1\u6709\u65b9\u6cd5\u3002\u6ce8\u89e3\u7684\u6210\u5458\u53d8\u91cf\u5728\u6ce8\u89e3\u7684\u5b9a\u4e49\u4e2d\u4ee5\u201c\u65e0\u5f62\u53c2\u7684\u65b9\u6cd5\u201d\u5f62\u5f0f\u6765\u58f0\u660e\uff0c\u5176\u65b9\u6cd5\u540d\u5b9a\u4e49\u4e86\u8be5\u6210\u5458\u53d8\u91cf\u7684\u540d\u5b57\uff0c\u5176\u8fd4\u56de\u503c\u5b9a\u4e49\u4e86\u8be5\u6210\u5458\u53d8\u91cf\u7684\u7c7b\u578b\u3002</p> <pre><code>@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Test {\n    int id();\n    String msg();\n}\n\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u5b9a\u4e49\u4e86 Test \u8fd9\u4e2a\u6ce8\u89e3\u4e2d\u62e5\u6709 id \u548c msg \u4e24\u4e2a\u5c5e\u6027\u3002\u5728\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5e94\u8be5\u7ed9\u5b83\u4eec\u8fdb\u884c\u8d4b\u503c\u3002</p> <p>\u8d4b\u503c\u7684\u65b9\u5f0f\u662f\u5728\u6ce8\u89e3\u7684\u62ec\u53f7\u5185\u4ee5 value=\"\" \u5f62\u5f0f\uff0c\u591a\u4e2a\u5c5e\u6027\u4e4b\u524d\u7528 \uff0c\u9694\u5f00\u3002</p> <pre><code>@Test(id=3,msg=\"hello annotation\")\npublic class Test {\n\n}\n\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6ce8\u89e3\u4e2d\u5b9a\u4e49\u5c5e\u6027\u65f6\u5b83\u7684\u7c7b\u578b\u5fc5\u987b\u662f 8 \u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u5916\u52a0 \u7c7b\u3001\u63a5\u53e3\u3001\u6ce8\u89e3\u53ca\u5b83\u4eec\u7684\u6570\u7ec4\u3002</p> <p>\u6ce8\u89e3\u4e2d\u5c5e\u6027\u53ef\u4ee5\u6709\u9ed8\u8ba4\u503c\uff0c\u9ed8\u8ba4\u503c\u9700\u8981\u7528 default \u5173\u952e\u503c\u6307\u5b9a\u3002\u6bd4\u5982\uff1a</p> <pre><code>@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface TestAnnotation {\n    public int id() default -1;\n    public String msg() default \"Hi\";\n}\n\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_5","title":"\u6ce8\u89e3\u7684\u63d0\u53d6","text":"<p>\u8981\u60f3\u6b63\u786e\u68c0\u9605\u6ce8\u89e3\uff0c\u79bb\u4e0d\u5f00\u4e00\u4e2a\u624b\u6bb5\uff0c\u90a3\u5c31\u662f\u53cd\u5c04\u3002</p>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#_6","title":"\u6ce8\u89e3\u4e0e\u53cd\u5c04\u3002","text":"<p>\u6ce8\u89e3\u901a\u8fc7\u53cd\u5c04\u83b7\u53d6\u3002\u9996\u5148\u53ef\u4ee5\u901a\u8fc7 Class \u5bf9\u8c61\u7684 isAnnotationPresent() \u65b9\u6cd5\u5224\u65ad\u5b83\u662f\u5426\u5e94\u7528\u4e86\u67d0\u4e2a\u6ce8\u89e3\u3002</p> <pre><code>public boolean isAnnotationPresent(Class&lt;? extends Annotation&gt; annotationClass) {}\n\n</code></pre> <p>\u7136\u540e\u901a\u8fc7 getAnnotation() \u65b9\u6cd5\u6765\u83b7\u53d6 Annotation \u5bf9\u8c61\u3002</p> <pre><code> public &lt;A extends Annotation&gt; A getAnnotation(Class&lt;A&gt; annotationClass) {}\n\n</code></pre> <p>\u6216\u8005\u662f getAnnotations() \u65b9\u6cd5\u3002</p> <pre><code>public Annotation[] getAnnotations() {}\n</code></pre> <pre><code>@TestAnnotation()\npublic class Test {\n    public static void main(String[] args) {\n        boolean hasAnnotation = Test.class.isAnnotationPresent(TestAnnotation.class);\n        if ( hasAnnotation ) {\n            TestAnnotation testAnnotation = Test.class.getAnnotation(TestAnnotation.class);\n            System.out.println(\"id:\"+testAnnotation.id());\n            System.out.println(\"msg:\"+testAnnotation.msg());\n        }\n    }\n}\n</code></pre> <p>\u7a0b\u5e8f\u7684\u8fd0\u884c\u7ed3\u679c\u662f\uff1a</p> <pre><code>id:-1\nmsg:\n</code></pre>"},{"location":"Java/Java%E4%B8%AD%E7%9A%84%E6%B3%A8%E8%A7%A3/#apt","title":"apt\u6280\u672f","text":"<p>link</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/","title":"Java\u57fa\u7840\u77e5\u8bc6\u603b\u7ed3","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0cJava\u57fa\u7840\u77e5\u8bc6\u603b\u7ed3</p> <ul> <li>1. Java \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e09\u5927\u7279\u6027: \u5c01\u88c5 \u7ee7\u627f \u591a\u6001 </li> <li>\u5c01\u88c5 </li> <li>\u7ee7\u627f </li> <li>\u591a\u6001</li> <li>2. Java\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f</li> <li>3. \u62bd\u8c61\u7c7b\u548c\u63a5\u53e3\u7684\u533a\u522b </li> <li>\u62bd\u8c61\u7c7b\u4e0e\u63a5\u53e3\uff1a</li> <li>\u5e38\u7528\u5173\u952e\u5b57this\u3001super\u3001static\u548cfinal <ul> <li>this: \u4ee3\u8868\u5bf9\u8c61\u3002\u5c31\u662f\u6240\u5728\u51fd\u6570\u6240\u5c5e\u5bf9\u8c61\u7684\u5f15\u7528\u3002 </li> <li>super\u5173\u952e\u5b57</li> <li>static\uff1a\u5173\u952e\u5b57\uff0c\u662f\u4e00\u4e2a\u4fee\u9970\u7b26\uff0c\u7528\u4e8e\u4fee\u9970\u6210\u5458(\u6210\u5458\u53d8\u91cf\u548c\u6210\u5458\u51fd\u6570)\u3002 </li> <li>\u9759\u6001\u4ee3\u7801\u5757\uff1a\u5c31\u662f\u4e00\u4e2a\u6709\u9759\u6001\u5173\u952e\u5b57\u6807\u793a\u7684\u4e00\u4e2a\u4ee3\u7801\u5757\u533a\u57df\u3002\u5b9a\u4e49\u5728\u7c7b\u4e2d\u3002 </li> <li>final\uff1a\u5173\u952e\u5b57</li> </ul> </li> <li>4. StringBuffer\u548cStringBuilder\u7684\u533a\u522b</li> <li>5. Object\u7c7b\u7684equal\u548chashcode\u65b9\u6cd5    - hashCode\uff08\uff09\u4e0eequals\uff08\uff09\u7684\u76f8\u5173\u89c4\u5b9a</li> <li>6. == \u4e0e equals</li> <li>7. String\u4e3a\u4ec0\u4e48\u8981\u8bbe\u8ba1\u6210\u4e0d\u53ef\u53d8\u7684</li> <li>8.\u53ef\u5426\u7528try-catch\u6355\u83b7OOM\u4ee5\u907f\u514d\u5176\u53d1\u751f</li> <li>9. \u5355\u4f8b\u8bbe\u8ba1\u6a21\u5f0f</li> <li>10.\u5185\u90e8\u7c7b</li> <li>11. \u591a\u7ebf\u7a0b</li> <li>12.\u4e3a\u4ec0\u4e48\u8981\u6709Runnable\u63a5\u53e3\u7684\u51fa\u73b0</li> <li>13.\u7ebf\u7a0b\u95f4\u901a\u4fe1\uff1a\u601d\u8def\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5728\u64cd\u4f5c\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u4f46\u662f\u64cd\u4f5c\u7684\u52a8\u4f5c\u5374\u4e0d\u4e00\u6837\u3002 </li> <li>\u7b49\u5f85\u5524\u9192\u673a\u5236\uff1a\u6d89\u53ca\u7684\u65b9\u6cd5\uff1a </li> <li>wait\u548csleep\u533a\u522b\uff1a \u5206\u6790\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff1a\u4ece\u6267\u884c\u6743\u548c\u9501\u4e0a\u6765\u5206\u6790\uff1a</li> <li>14.Lock\u63a5\u53e3</li> <li>15. \u5bf9\u8c61\u7684\u5e8f\u5217\u5316 </li> <li>transient\u4f7f\u7528\u7ec6\u8282\u2014\u2014\u88abtransient\u5173\u952e\u5b57\u4fee\u9970\u7684\u53d8\u91cf\u771f\u7684\u4e0d\u80fd\u88ab\u5e8f\u5217\u5316\u5417\uff1f</li> </ul>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#1-java","title":"1. Java \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e09\u5927\u7279\u6027: \u5c01\u88c5 \u7ee7\u627f \u591a\u6001","text":""},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_1","title":"\u5c01\u88c5","text":"<p>\u662f\u6307\u9690\u85cf\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u5b9e\u73b0\u7ec6\u8282\uff0c\u4ec5\u5bf9\u5916\u63d0\u4f9b\u516c\u5171\u8bbf\u95ee\u65b9\u5f0f\u3002 - \u597d\u5904\uff1a   - \u5c06\u53d8\u5316\u9694\u79bb   - \u4fbf\u4e8e\u4f7f\u7528   - \u63d0\u9ad8\u91cd\u7528\u6027   - \u5b89\u5168\u6027 - \u5c01\u88c5\u539f\u5219\uff1a   - \u5c06\u4e0d\u9700\u8981\u5bf9\u5916\u63d0\u4f9b\u7684\u5185\u5bb9\u90fd\u9690\u85cf\u8d77\u6765\uff0c\u628a\u5c5e\u6027\u90fd\u9690\u85cf\uff0c\u63d0\u4f9b\u516c\u5171\u65b9\u6cd5\u5bf9\u5176\u8bbf\u95ee\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_2","title":"\u7ee7\u627f","text":"<p>\u597d\u5904\uff1a 1. \u63d0\u9ad8\u4e86\u4ee3\u7801\u7684\u590d\u7528\u6027\u3002 2. \u8ba9\u7c7b\u4e0e\u7c7b\u4e4b\u95f4\u4ea7\u751f\u4e86\u5173\u7cfb\uff0c\u63d0\u4f9b\u4e86\u53e6\u4e00\u4e2a\u7279\u5f81\u591a\u6001\u7684\u524d\u63d0\u3002</p> <p>\u7236\u7c7b\u7684\u7531\u6765\uff1a\u5176\u5b9e\u662f\u7531\u591a\u4e2a\u7c7b\u4e0d\u65ad\u5411\u4e0a\u62bd\u53d6\u5171\u6027\u5185\u5bb9\u800c\u6765\u7684\u3002 java\u4e2d\u5bf9\u4e8e\u7ee7\u627f\uff0cjava\u53ea\u652f\u6301\u5355\u7ee7\u627f\u3002java\u867d\u7136\u4e0d\u76f4\u63a5\u652f\u6301\u591a\u7ee7\u627f\uff0c\u4f46\u662f\u4fdd\u7559\u4e86\u8fd9\u79cd\u591a\u7ee7\u627f\u673a\u5236\uff0c\u8fdb\u884c\u6539\u826f\u3002</p> <ul> <li>\u5355\u7ee7\u627f\uff1a\u4e00\u4e2a\u7c7b\u53ea\u80fd\u6709\u4e00\u4e2a\u7236\u7c7b\u3002</li> <li>\u591a\u7ee7\u627f\uff1a\u4e00\u4e2a\u7c7b\u53ef\u4ee5\u6709\u591a\u4e2a\u7236\u7c7b\u3002</li> </ul> <p>\u4e3a\u4ec0\u4e48\u4e0d\u652f\u6301\u591a\u7ee7\u627f\u5462\uff1f</p> <p>\u56e0\u4e3a\u5f53\u4e00\u4e2a\u7c7b\u540c\u65f6\u7ee7\u627f\u4e24\u4e2a\u7236\u7c7b\u65f6\uff0c\u4e24\u4e2a\u7236\u7c7b\u4e2d\u6709\u76f8\u540c\u7684\u529f\u80fd\uff0c\u90a3\u4e48\u5b50\u7c7b\u5bf9\u8c61\u8c03\u7528\u8be5\u529f\u80fd\u65f6\uff0c\u8fd0\u884c\u54ea\u4e00\u4e2a\u5462\uff1f\u56e0\u4e3a\u7236\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4e2d\u5b58\u5728\u65b9\u6cd5\u4f53\u3002 \u4f46\u662fjava\u652f\u6301\u591a\u91cd\u7ee7\u627f\u3002A\u7ee7\u627fB  B\u7ee7\u627fC  C\u7ee7\u627fD\u3002 \u591a\u91cd\u7ee7\u627f\u7684\u51fa\u73b0\uff0c\u5c31\u6709\u4e86\u7ee7\u627f\u4f53\u7cfb\u3002\u4f53\u7cfb\u4e2d\u7684\u9876\u5c42\u7236\u7c7b\u662f\u901a\u8fc7\u4e0d\u65ad\u5411\u4e0a\u62bd\u53d6\u800c\u6765\u7684\u3002\u5b83\u91cc\u9762\u5b9a\u4e49\u7684\u8be5\u4f53\u7cfb\u6700\u57fa\u672c\u6700\u5171\u6027\u5185\u5bb9\u7684\u529f\u80fd\u3002 \u6240\u4ee5\uff0c\u4e00\u4e2a\u4f53\u7cfb\u8981\u60f3\u88ab\u4f7f\u7528\uff0c\u76f4\u63a5\u67e5\u9605\u8be5\u7cfb\u7edf\u4e2d\u7684\u7236\u7c7b\u7684\u529f\u80fd\u5373\u53ef\u77e5\u9053\u8be5\u4f53\u7cfb\u7684\u57fa\u672c\u7528\u6cd5\u3002\u90a3\u4e48\u60f3\u8981\u4f7f\u7528\u4e00\u4e2a\u4f53\u7cfb\u65f6\uff0c\u9700\u8981\u5efa\u7acb\u5bf9\u8c61\u3002\u5efa\u8bae\u5efa\u7acb\u6700\u5b50\u7c7b\u5bf9\u8c61\uff0c\u56e0\u4e3a\u6700\u5b50\u7c7b\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528\u7236\u7c7b\u4e2d\u7684\u529f\u80fd\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5b50\u7c7b\u7279\u6709\u7684\u4e00\u4e9b\u529f\u80fd\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_3","title":"\u591a\u6001","text":"<p>\u51fd\u6570\u672c\u8eab\u5c31\u5177\u5907\u591a\u6001\u6027\uff0c\u67d0\u4e00\u79cd\u4e8b\u7269\u6709\u4e0d\u540c\u7684\u5177\u4f53\u7684\u4f53\u73b0\u3002</p> <ul> <li>\u4f53\u73b0\uff1a\u7236\u7c7b\u5f15\u7528\u6216\u8005\u63a5\u53e3\u7684\u5f15\u7528\u6307\u5411\u4e86\u81ea\u5df1\u7684\u5b50\u7c7b\u5bf9\u8c61\u3002//Animal a = new Cat();</li> <li>\u591a\u6001\u7684\u597d\u5904\uff1a\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6269\u5c55\u6027\u3002</li> <li>\u591a\u6001\u7684\u5f0a\u7aef\uff1a\u5f53\u7236\u7c7b\u5f15\u7528\u6307\u5411\u5b50\u7c7b\u5bf9\u8c61\u65f6\uff0c\u867d\u7136\u63d0\u9ad8\u4e86\u6269\u5c55\u6027\uff0c\u4f46\u662f\u53ea\u80fd\u8bbf\u95ee\u7236\u7c7b\u4e2d\u5177\u5907\u7684\u65b9\u6cd5\uff0c\u4e0d\u53ef\u4ee5\u8bbf\u95ee\u5b50\u7c7b\u4e2d\u7279\u6709\u7684\u65b9\u6cd5\u3002(\u524d\u671f\u4e0d\u80fd\u4f7f\u7528\u540e\u671f\u4ea7\u751f\u7684\u529f\u80fd\uff0c\u5373\u8bbf\u95ee\u7684\u5c40\u9650\u6027)</li> <li>\u591a\u6001\u7684\u524d\u63d0\uff1a<ul> <li>1\uff1a\u5fc5\u987b\u8981\u6709\u5173\u7cfb\uff0c\u6bd4\u5982\u7ee7\u627f\u3001\u6216\u8005\u5b9e\u73b0\u3002</li> <li>2\uff1a\u901a\u5e38\u4f1a\u6709\u8986\u76d6\u64cd\u4f5c\u3002</li> </ul> </li> </ul>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#2-java","title":"2. Java\u5bf9\u8c61\u7684\u751f\u547d\u5468\u671f","text":"<p>Java\u5bf9\u8c61\u5728\u865a\u62df\u673a\u4e0a\u8fd0\u884c\u67097\u9636\u6bb5\uff1a\u521b\u5efa\u3001\u5e94\u7528\u3001\u4e0d\u53ef\u89c1\u3001\u4e0d\u53ef\u8fbe\u3001\u6536\u96c6\u3001\u7ec8\u7ed3\u3001\u5bf9\u8c61\u7a7a\u95f4\u91cd\u65b0\u5206\u914d\u3002</p> <p></p> <ol> <li>\u521b\u5efa\u9636\u6bb5(Created)</li> </ol> <p>\u521b\u5efaJava\u5bf9\u8c61\u9636\u6bb5\u7684\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a \u2460\u3000\u4e3a\u5bf9\u8c61\u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff1b \u2461\u3000\u6784\u9020\u5bf9\u8c61\uff1b \u2462\u3000\u4ece\u8d85\u7c7b\u5230\u5b50\u7c7b\u5bf9static\u6210\u5458\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u7c7b\u7684static\u6210\u5458\u7684\u521d\u59cb\u5316\u5728ClassLoader\u52a0\u8f7d\u8be5\u7c7b\u65f6\u8fdb\u884c\uff1b \u2463\u3000\u8d85\u7c7b\u6210\u5458\u53d8\u91cf\u6309\u987a\u5e8f\u521d\u59cb\u5316\uff0c\u9012\u5f52\u8c03\u7528\u8d85\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff1b \u2464\u3000\u5b50\u7c7b\u6210\u5458\u53d8\u91cf\u6309\u987a\u5e8f\u521d\u59cb\u5316\uff0c\u4e00\u65e6\u5bf9\u8c61\u88ab\u521b\u5efa\uff0c\u5b50\u7c7b\u6784\u9020\u65b9\u6cd5\u5c31\u8c03\u7528\u8be5\u5bf9\u8c61\u5e76\u4e3a\u67d0\u4e9b\u53d8\u91cf\u8d4b\u503c\uff0c\u5b8c\u6210\u540e\u8fd9\u4e2a\u5bf9\u8c61\u7684\u72b6\u6001\u5c31\u5207\u6362\u5230\u4e86\u5e94\u7528\u9636\u6bb5\u3002</p> <ol> <li>\u5e94\u7528\u9636\u6bb5(InUse)</li> </ol> <p>\u5bf9\u8c61\u81f3\u5c11\u88ab\u4e00\u4e2a\u5f3a\u5f15\u7528\u6301\u6709\u3002\u9664\u975e\u5728\u7cfb\u7edf\u4e2d\u663e\u5f0f\u5730\u4f7f\u7528\u4e86\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u6216\u865a\u5f15\u7528\u3002</p> <ol> <li>\u4e0d\u53ef\u89c1\u9636\u6bb5(Invisible)</li> </ol> <p>\u5904\u4e8e\u4e0d\u53ef\u89c1\u9636\u6bb5\u7684\u5bf9\u8c61\u5728\u865a\u62df\u673a\u7684\u5bf9\u8c61\u5f15\u7528\u6839\u96c6\u5408\u4e2d\u518d\u4e5f\u627e\u4e0d\u5230\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5f3a\u5f15\u7528\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u4e00\u822c\u662f\u6240\u6709\u7ebf\u7a0b\u6808\u4e2d\u7684\u4e34\u65f6\u53d8\u91cf\u3002\u6240\u6709\u5df2\u7ecf\u88c5\u8f7d\u7684\u9759\u6001\u53d8\u91cf\u6216\u662f\u5bf9\u672c\u5730\u4ee3\u7801\u63a5\u53e3\u7684\u5f15\u7528\u3002</p> <p>\u5f53\u4e00\u4e2a\u5bf9\u8c61\u5904\u4e8e\u4e0d\u53ef\u89c1\u9636\u6bb5\u65f6\uff0c\u8bf4\u660e\u7a0b\u5e8f\u672c\u8eab\u4e0d\u518d\u6301\u6709\u8be5\u5bf9\u8c61\u7684\u4efb\u4f55\u5f3a\u5f15\u7528\uff0c\u867d\u7136\u8be5\u5bf9\u8c61\u4ecd\u7136\u5b58\u5728\u3002\u8be5\u5bf9\u8c61\u53ef\u80fd\u88ab\u865a\u62df\u673a\u4e2d\u7684\u67d0\u4e9b\u5df2\u88c5\u8f7d\u7684\u9759\u6001\u53d8\u91cf\u7ebf\u7a0b\u6216JNI\u7b49\u5f3a\u5f15\u7528\u6301\u6709\uff0c\u8fd9\u4e9b\u7279\u6b8a\u7684\u5f3a\u5f15\u7528\u79f0\u4e3a\u201cGC Root\u201d\u3002\u5b58\u5728\u8fd9\u4e9bGC Root\u4f1a\u5bfc\u81f4\u5bf9\u8c61\u7684\u5185\u5b58\u6cc4\u6f0f\uff0c\u65e0\u6cd5\u88ab\u56de\u6536\u3002</p> <ol> <li>\u4e0d\u53ef\u8fbe\u9636\u6bb5(Unreachable)</li> </ol> <p>\u5bf9\u8c61\u5904\u4e8e\u4e0d\u53ef\u8fbe\u9636\u6bb5\u662f\u6307\u8be5\u5bf9\u8c61\u4e0d\u518d\u88ab\u4efb\u4f55\u5f3a\u5f15\u7528\u6301\u6709\uff0c\u56de\u6536\u5668\u53d1\u73b0\u8be5\u5bf9\u8c61\u5df2\u7ecf\u4e0d\u53ef\u8fbe\u3002</p> <ol> <li>\u6536\u96c6\u9636\u6bb5(Collected)</li> </ol> <p>\u5f53\u5783\u573e\u56de\u6536\u5668\u53d1\u73b0\u8be5\u5bf9\u8c61\u5df2\u7ecf\u5904\u4e8e\u201c\u4e0d\u53ef\u8fbe\u9636\u6bb5\u201d\u5e76\u4e14\u5783\u573e\u56de\u6536\u5668\u5df2\u7ecf\u5bf9\u8be5\u5bf9\u8c61\u7684\u5185\u5b58\u7a7a\u95f4\u91cd\u65b0\u5206\u914d\u505a\u597d\u51c6\u5907\u65f6\uff0c\u5bf9\u8c61\u8fdb\u5165\u201c\u6536\u96c6\u9636\u6bb5\u201d\u5982\u679c\u8be5\u5bf9\u8c61\u5df2\u7ecf\u91cd\u5199\u4e86finalize()\u65b9\u6cd5\uff0c\u5219\u6267\u884c\u8be5\u65b9\u6cd5\u7684\u64cd\u4f5c\u3002</p> <ol> <li>\u7ec8\u7ed3\u9636\u6bb5(Finalized)</li> </ol> <p>\u5f53\u5bf9\u8c61\u6267\u884c\u5b8cfinalize()\u65b9\u6cd5\u540e\u4ecd\u7136\u5904\u4e8e\u4e0d\u53ef\u8fbe\u72b6\u6001\u65f6\uff0c\u8be5\u5bf9\u8c61\u8fdb\u5165\u7ec8\u7ed3\u9636\u6bb5\u3002\u5728\u8be5\u9636\u6bb5\uff0c\u7b49\u5f85\u5783\u573e\u56de\u6536\u5668\u56de\u6536\u8be5\u5bf9\u8c61\u7a7a\u95f4\u3002</p> <ol> <li>\u5bf9\u8c61\u7a7a\u95f4\u91cd\u65b0\u5206\u914d\u9636\u6bb5(Deallocated)</li> </ol> <p>\u82e5\u5783\u573e\u56de\u6536\u5668\u5bf9\u8be5\u5bf9\u8c61\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u8fdb\u884c\u56de\u6536\u6216\u8005\u518d\u5206\u914d\uff0c\u5219\u8be5\u5bf9\u8c61\u5f7b\u5e95\u6d88\u5931\uff0c\u8fd9\u4e2a\u9636\u6bb5\u79f0\u4e3a\u201c\u5bf9\u8c61\u7a7a\u95f4\u91cd\u65b0\u5206\u914d\u9636\u6bb5\u201d\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#3","title":"3. \u62bd\u8c61\u7c7b\u548c\u63a5\u53e3\u7684\u533a\u522b","text":"<p>\u4ece\u8bbe\u8ba1\u5c42\u9762\u6765\u8bf4\uff0c\u62bd\u8c61\u662f\u5bf9\u7c7b\u7684\u62bd\u8c61\uff0c\u662f\u4e00\u79cd\u6a21\u677f\u8bbe\u8ba1\uff0c\u63a5\u53e3\u662f\u884c\u4e3a\u7684\u62bd\u8c61\uff0c\u662f\u4e00\u79cd\u884c\u4e3a\u7684\u89c4\u8303\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_4","title":"\u62bd\u8c61\u7c7b\u4e0e\u63a5\u53e3\uff1a","text":"<ul> <li>\u62bd\u8c61\u7c7b\uff1a\u4e00\u822c\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u4f53\u7cfb\u5355\u5143\uff0c\u5c06\u4e00\u7ec4\u5171\u6027\u5185\u5bb9\u8fdb\u884c\u62bd\u53d6\uff0c\u7279\u70b9\uff1a\u53ef\u4ee5\u5728\u7c7b\u4e2d\u5b9a\u4e49\u62bd\u8c61\u5185\u5bb9\u8ba9\u5b50\u7c7b\u5b9e\u73b0\uff0c\u53ef\u4ee5\u5b9a\u4e49\u975e\u62bd\u8c61\u5185\u5bb9\u8ba9\u5b50\u7c7b\u76f4\u63a5\u4f7f\u7528\u3002\u5b83\u91cc\u9762\u5b9a\u4e49\u7684\u90fd\u662f\u4e00\u4e9b\u4f53\u7cfb\u4e2d\u7684\u57fa\u672c\u5185\u5bb9\u3002</li> <li>\u63a5\u53e3\uff1a\u4e00\u822c\u7528\u4e8e\u5b9a\u4e49\u5bf9\u8c61\u7684\u6269\u5c55\u529f\u80fd\uff0c\u662f\u5728\u7ee7\u627f\u4e4b\u5916\u8fd8\u9700\u8fd9\u4e2a\u5bf9\u8c61\u5177\u5907\u7684\u4e00\u4e9b\u529f\u80fd\u3002</li> </ul> <p>\u62bd\u8c61\u7c7b\u548c\u63a5\u53e3\u7684\u5171\u6027\uff1a\u90fd\u662f\u4e0d\u65ad\u5411\u4e0a\u62bd\u53d6\u7684\u7ed3\u679c\u3002</p> <ol> <li>\u63a5\u53e3\u7684\u65b9\u6cd5\u9ed8\u8ba4\u662fpublic\uff0c\u6240\u6709\u65b9\u6cd5\u5728\u63a5\u53e3\u4e2d\u4e0d\u80fd\u6709\u5b9e\u73b0\uff0c\u62bd\u8c61\u7c7b\u53ef\u4ee5\u6709\u975e\u62bd\u8c61\u7684\u65b9\u6cd5</li> <li>\u63a5\u53e3\u4e2d\u7684\u5b9e\u4f8b\u53d8\u91cf\u9ed8\u8ba4\u662ffinal\u7c7b\u578b\u7684\uff0c\u800c\u62bd\u8c61\u7c7b\u4e2d\u5219\u4e0d\u4e00\u5b9a</li> <li>\u4e00\u4e2a\u7c7b\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2a\u63a5\u53e3\uff0c\u4f46\u6700\u591a\u53ea\u80fd\u5b9e\u73b0\u4e00\u4e2a\u62bd\u8c61\u7c7b</li> <li>\u4e00\u4e2a\u7c7b\u5b9e\u73b0\u63a5\u53e3\u7684\u8bdd\u8981\u5b9e\u73b0\u63a5\u53e3\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u800c\u62bd\u8c61\u7c7b\u4e0d\u4e00\u5b9a</li> <li>\u63a5\u53e3\u4e0d\u80fd\u7528new\u5b9e\u4f8b\u5316\uff0c\u4f46\u53ef\u4ee5\u58f0\u660e\uff0c\u4f46\u662f\u5fc5\u987b\u5f15\u7528\u4e00\u4e2a\u5b9e\u73b0\u8be5\u63a5\u53e3\u7684\u5bf9\u8c61</li> </ol>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#thissuperstaticfinal","title":"\u5e38\u7528\u5173\u952e\u5b57this\u3001super\u3001static\u548cfinal","text":""},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#this","title":"this: \u4ee3\u8868\u5bf9\u8c61\u3002\u5c31\u662f\u6240\u5728\u51fd\u6570\u6240\u5c5e\u5bf9\u8c61\u7684\u5f15\u7528\u3002","text":"<p>this\u5230\u5e95\u4ee3\u8868\u4ec0\u4e48\u5462\uff1f\u54ea\u4e2a\u5bf9\u8c61\u8c03\u7528\u4e86this\u6240\u5728\u7684\u51fd\u6570\uff0cthis\u5c31\u4ee3\u8868\u54ea\u4e2a\u5bf9\u8c61\uff0c\u5c31\u662f\u54ea\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u3002 \u5f00\u53d1\u65f6\uff0c\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528this\u5462\uff1f \u5728\u5b9a\u4e49\u529f\u80fd\u65f6\uff0c\u5982\u679c\u8be5\u529f\u80fd\u5185\u90e8\u4f7f\u7528\u5230\u4e86\u8c03\u7528\u8be5\u529f\u80fd\u7684\u5bf9\u8c61\uff0c\u8fd9\u65f6\u5c31\u7528this\u6765\u8868\u793a\u8fd9\u4e2a\u5bf9\u8c61\u3002</p> <p>this \u8fd8\u53ef\u4ee5\u7528\u4e8e\u6784\u9020\u51fd\u6570\u95f4\u7684\u8c03\u7528\u3002 \u8c03\u7528\u683c\u5f0f\uff1athis(\u5b9e\u9645\u53c2\u6570)\uff1b this\u5bf9\u8c61\u540e\u9762\u8ddf\u4e0a .  \u8c03\u7528\u7684\u662f\u6210\u5458\u5c5e\u6027\u548c\u6210\u5458\u65b9\u6cd5(\u4e00\u822c\u65b9\u6cd5)\uff1b this\u5bf9\u8c61\u540e\u9762\u8ddf\u4e0a () \u8c03\u7528\u7684\u662f\u672c\u7c7b\u4e2d\u7684\u5bf9\u5e94\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u3002</p> <p>\u6ce8\u610f\uff1a\u7528this\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u5fc5\u987b\u5b9a\u4e49\u5728\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e00\u884c\u3002\u56e0\u4e3a\u6784\u9020\u51fd\u6570\u662f\u7528\u4e8e\u521d\u59cb\u5316\u7684\uff0c\u6240\u4ee5\u521d\u59cb\u5316\u52a8\u4f5c\u4e00\u5b9a\u8981\u6267\u884c\u3002\u5426\u5219\u7f16\u8bd1\u5931\u8d25\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#super","title":"super\u5173\u952e\u5b57","text":"<p>super\uff1a\u4ee3\u8868\u662f\u5b50\u7c7b\u6240\u5c5e\u7684\u7236\u7c7b\u4e2d\u7684\u5185\u5b58\u7a7a\u95f4\u5f15\u7528\u3002      \u6ce8\u610f\uff1a\u5b50\u7236\u7c7b\u4e2d\u901a\u5e38\u662f\u4e0d\u4f1a\u51fa\u73b0\u540c\u540d\u6210\u5458\u53d8\u91cf\u7684\uff0c\u56e0\u4e3a\u7236\u7c7b\u4e2d\u53ea\u8981\u5b9a\u4e49\u4e86\uff0c\u5b50\u7c7b\u5c31\u4e0d\u7528\u5728\u5b9a\u4e49\u4e86\uff0c\u76f4\u63a5\u7ee7\u627f\u8fc7\u6765\u7528\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>java\u4e2d\u5b50\u7c7b\u7684\u6240\u6709\u6784\u9020\u51fd\u6570\u4e2d\u7684\u7b2c\u4e00\u884c\uff0c\u5176\u5b9e\u90fd\u6709\u4e00\u6761\u9690\u8eab\u7684\u8bed\u53e5super()\uff0csuper(): \u8868\u793a\u7236\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u5e76\u4f1a\u8c03\u7528\u4e8e\u53c2\u6570\u76f8\u5bf9\u5e94\u7684\u7236\u7c7b\u4e2d\u7684\u6784\u9020\u51fd\u6570\u3002\u800csuper():\u662f\u5728\u8c03\u7528\u7236\u7c7b\u4e2d\u7a7a\u53c2\u6570\u7684\u6784\u9020\u51fd\u6570\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#static","title":"static\uff1a\u5173\u952e\u5b57\uff0c\u662f\u4e00\u4e2a\u4fee\u9970\u7b26\uff0c\u7528\u4e8e\u4fee\u9970\u6210\u5458(\u6210\u5458\u53d8\u91cf\u548c\u6210\u5458\u51fd\u6570)\u3002","text":"<p>\u7279\u70b9\uff1a   1. \u60f3\u8981\u5b9e\u73b0\u5bf9\u8c61\u4e2d\u7684\u5171\u6027\u6570\u636e\u7684\u5bf9\u8c61\u5171\u4eab\u3002\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u6570\u636e\u8fdb\u884c\u9759\u6001\u4fee\u9970\u3002   2. \u88ab\u9759\u6001\u4fee\u9970\u7684\u6210\u5458\uff0c\u53ef\u4ee5\u76f4\u63a5\u88ab\u7c7b\u540d\u6240\u8c03\u7528\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u9759\u6001\u7684\u6210\u5458\u591a\u4e86\u4e00\u79cd\u8c03\u7528\u65b9\u5f0f\u3002\u7c7b\u540d.\u9759\u6001\u65b9\u5f0f\u3002   3. \u9759\u6001\u968f\u7740\u7c7b\u7684\u52a0\u8f7d\u800c\u52a0\u8f7d\u3002\u800c\u4e14\u4f18\u5148\u4e8e\u5bf9\u8c61\u5b58\u5728\u3002</p> <p>\u5f0a\u7aef\uff1a 1. \u6709\u4e9b\u6570\u636e\u662f\u5bf9\u8c61\u7279\u6709\u7684\u6570\u636e\uff0c\u662f\u4e0d\u53ef\u4ee5\u88ab\u9759\u6001\u4fee\u9970\u7684\u3002\u56e0\u4e3a\u90a3\u6837\u7684\u8bdd\uff0c\u7279\u6709\u6570\u636e\u4f1a\u53d8\u6210\u5bf9\u8c61\u7684\u5171\u4eab\u6570\u636e\u3002\u8fd9\u6837\u5bf9\u4e8b\u7269\u7684\u63cf\u8ff0\u5c31\u51fa\u4e86\u95ee\u9898\u3002\u6240\u4ee5\uff0c\u5728\u5b9a\u4e49\u9759\u6001\u65f6\uff0c\u5fc5\u987b\u8981\u660e\u786e\uff0c\u8fd9\u4e2a\u6570\u636e\u662f\u5426\u662f\u88ab\u5bf9\u8c61\u6240\u5171\u4eab\u7684\u3002 2. \u9759\u6001\u65b9\u6cd5\u53ea\u80fd\u8bbf\u95ee\u9759\u6001\u6210\u5458\uff0c\u4e0d\u53ef\u4ee5\u8bbf\u95ee\u975e\u9759\u6001\u6210\u5458\u3002 \u56e0\u4e3a\u9759\u6001\u65b9\u6cd5\u52a0\u8f7d\u65f6\uff0c\u4f18\u5148\u4e8e\u5bf9\u8c61\u5b58\u5728\uff0c\u6240\u4ee5\u6ca1\u6709\u529e\u6cd5\u8bbf\u95ee\u5bf9\u8c61\u4e2d\u7684\u6210\u5458\u3002 3.\u9759\u6001\u65b9\u6cd5\u4e2d\u4e0d\u80fd\u4f7f\u7528this\uff0csuper\u5173\u952e\u5b57\u3002 \u56e0\u4e3athis\u4ee3\u8868\u5bf9\u8c61\uff0c\u800c\u9759\u6001\u5728\u65f6\uff0c\u6709\u53ef\u80fd\u6ca1\u6709\u5bf9\u8c61\uff0c\u6240\u4ee5this\u65e0\u6cd5\u4f7f\u7528\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_5","title":"\u9759\u6001\u4ee3\u7801\u5757\uff1a\u5c31\u662f\u4e00\u4e2a\u6709\u9759\u6001\u5173\u952e\u5b57\u6807\u793a\u7684\u4e00\u4e2a\u4ee3\u7801\u5757\u533a\u57df\u3002\u5b9a\u4e49\u5728\u7c7b\u4e2d\u3002","text":"<p>\u4f5c\u7528\uff1a\u53ef\u4ee5\u5b8c\u6210\u7c7b\u7684\u521d\u59cb\u5316\u3002\u9759\u6001\u4ee3\u7801\u5757\u968f\u7740\u7c7b\u7684\u52a0\u8f7d\u800c\u6267\u884c\uff0c\u800c\u4e14\u53ea\u6267\u884c\u4e00\u6b21\uff08new \u591a\u4e2a\u5bf9\u8c61\u5c31\u53ea\u6267\u884c\u4e00\u6b21\uff09\u3002\u5982\u679c\u548c\u4e3b\u51fd\u6570\u5728\u540c\u4e00\u7c7b\u4e2d\uff0c\u4f18\u5148\u4e8e\u4e3b\u51fd\u6570\u6267\u884c\u3002</p> <p>\u9759\u6001\u4ee3\u7801\u5757\u3001\u6784\u9020\u4ee3\u7801\u5757\u3001\u6784\u9020\u51fd\u6570\u540c\u65f6\u5b58\u5728\u65f6\u7684\u6267\u884c\u987a\u5e8f\uff1a\u9759\u6001\u4ee3\u7801\u5757 -&gt; \u6784\u9020\u4ee3\u7801\u5757 -&gt; \u6784\u9020\u51fd\u6570\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#final","title":"final\uff1a\u5173\u952e\u5b57","text":"<p>\u5728Java\u4e2d\uff0cfinal\u5173\u952e\u5b57\u53ef\u4ee5\u7528\u6765\u4fee\u9970\u7c7b\u3001\u65b9\u6cd5\u548c\u53d8\u91cf\uff08\u5305\u62ec\u6210\u5458\u53d8\u91cf\u548c\u5c40\u90e8\u53d8\u91cf\uff09\u3002</p> <ul> <li>\u4fee\u9970\u7c7b</li> </ul> <p>\u5f53\u7528final\u4fee\u9970\u4e00\u4e2a\u7c7b\u65f6\uff0c\u8868\u660e\u8fd9\u4e2a\u7c7b\u4e0d\u80fd\u88ab\u7ee7\u627f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u4f60\u6c38\u8fdc\u4e0d\u4f1a\u8ba9\u4ed6\u88ab\u7ee7\u627f\uff0c\u5c31\u53ef\u4ee5\u7528final\u8fdb\u884c\u4fee\u9970\u3002</p> <ul> <li>\u4fee\u9970\u65b9\u6cd5</li> </ul> <p>\u4e0b\u9762\u8fd9\u6bb5\u8bdd\u6458\u81ea\u300aJava\u7f16\u7a0b\u601d\u60f3\u300b\u7b2c\u56db\u7248\u7b2c143\u9875\uff1a</p> <p>\u201c\u4f7f\u7528final\u65b9\u6cd5\u7684\u539f\u56e0\u6709\u4e24\u4e2a\u3002\u7b2c\u4e00\u4e2a\u539f\u56e0\u662f\u628a\u65b9\u6cd5\u9501\u5b9a\uff0c\u4ee5\u9632\u4efb\u4f55\u7ee7\u627f\u7c7b\u4fee\u6539\u5b83\u7684\u542b\u4e49\uff1b\u7b2c\u4e8c\u4e2a\u539f\u56e0\u662f\u6548\u7387\u3002\u5728\u65e9\u671f\u7684Java\u5b9e\u73b0\u7248\u672c\u4e2d\uff0c\u4f1a\u5c06final\u65b9\u6cd5\u8f6c\u4e3a\u5185\u5d4c\u8c03\u7528\u3002\u4f46\u662f\u5982\u679c\u65b9\u6cd5\u8fc7\u4e8e\u5e9e\u5927\uff0c\u53ef\u80fd\u770b\u4e0d\u5230\u5185\u5d4c\u8c03\u7528\u5e26\u6765\u7684\u4efb\u4f55\u6027\u80fd\u63d0\u5347\u3002\u5728\u6700\u8fd1\u7684Java\u7248\u672c\u4e2d\uff0c\u4e0d\u9700\u8981\u4f7f\u7528final\u65b9\u6cd5\u8fdb\u884c\u8fd9\u4e9b\u4f18\u5316\u4e86\u3002\u201c</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u53ea\u6709\u5728\u60f3\u660e\u786e\u7981\u6b62 \u8be5\u65b9\u6cd5\u5728\u5b50\u7c7b\u4e2d\u88ab\u8986\u76d6\u7684\u60c5\u51b5\u4e0b\u624d\u5c06\u65b9\u6cd5\u8bbe\u7f6e\u4e3afinal\u7684\u3002</p> <p>\u6ce8\uff1a\u7c7b\u7684private\u65b9\u6cd5\u4f1a\u9690\u5f0f\u5730\u88ab\u6307\u5b9a\u4e3afinal\u65b9\u6cd5\u3002</p> <ul> <li>\u4fee\u9970\u53d8\u91cf</li> </ul> <p>\u5bf9\u4e8e\u4e00\u4e2afinal\u53d8\u91cf\uff0c\u5982\u679c\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5219\u5176\u6570\u503c\u4e00\u65e6\u5728\u521d\u59cb\u5316\u4e4b\u540e\u4fbf\u4e0d\u80fd\u66f4\u6539\uff1b\u5982\u679c\u662f\u5f15\u7528\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5219\u5728\u5bf9\u5176\u521d\u59cb\u5316\u4e4b\u540e\u4fbf\u4e0d\u80fd\u518d\u8ba9\u5176\u6307\u5411\u53e6\u4e00\u4e2a\u5bf9\u8c61\u3002 \u3000\u3000</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#4-stringbufferstringbuilder","title":"4. StringBuffer\u548cStringBuilder\u7684\u533a\u522b","text":"<p>1\u3001StringBuffer \u4e0e StringBuilder \u4e2d\u7684\u65b9\u6cd5\u548c\u529f\u80fd\u5b8c\u5168\u662f\u7b49\u4ef7\u7684\uff0c</p> <p>2\u3001\u53ea\u662fStringBuffer \u4e2d\u7684\u65b9\u6cd5\u5927\u90fd\u91c7\u7528\u4e86 synchronized \u5173\u952e\u5b57\u8fdb\u884c\u4fee\u9970\uff0c\u56e0\u6b64\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u800c StringBuilder \u6ca1\u6709\u8fd9\u4e2a\u4fee\u9970\uff0c\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u3002 </p> <p>3\u3001\u5728\u5355\u7ebf\u7a0b\u7a0b\u5e8f\u4e0b\uff0cStringBuilder\u6548\u7387\u66f4\u5feb\uff0c\u56e0\u4e3a\u5b83\u4e0d\u9700\u8981\u52a0\u9501\uff0c\u4e0d\u5177\u5907\u591a\u7ebf\u7a0b\u5b89\u5168\uff0c\u800cStringBuffer\u5219\u6bcf\u6b21\u90fd\u9700\u8981\u5224\u65ad\u9501\uff0c\u6548\u7387\u76f8\u5bf9\u66f4\u4f4e</p> <ul> <li>StringBuffer\u521d\u59cb\u5316\u53ca\u6269\u5bb9\u673a\u5236</li> </ul> <p>1.StringBuffer()\u7684\u521d\u59cb\u5bb9\u91cf\u53ef\u4ee5\u5bb9\u7eb316\u4e2a\u5b57\u7b26\uff0c\u5f53\u8be5\u5bf9\u8c61\u7684\u5b9e\u4f53\u5b58\u653e\u7684\u5b57\u7b26\u7684\u957f\u5ea6\u5927\u4e8e16\u65f6\uff0c\u5b9e\u4f53\u5bb9\u91cf\u5c31\u81ea\u52a8\u589e\u52a0\u3002StringBuffer\u5bf9\u8c61\u53ef\u4ee5\u901a\u8fc7length()\u65b9\u6cd5\u83b7\u53d6\u5b9e\u4f53\u4e2d\u5b58\u653e\u7684\u5b57\u7b26\u5e8f\u5217\u957f\u5ea6\uff0c\u901a\u8fc7capacity()\u65b9\u6cd5\u6765\u83b7\u53d6\u5f53\u524d\u5b9e\u4f53\u7684\u5b9e\u9645\u5bb9\u91cf\u3002</p> <p>2.StringBuffer(int size)\u53ef\u4ee5\u6307\u5b9a\u5206\u914d\u7ed9\u8be5\u5bf9\u8c61\u7684\u5b9e\u4f53\u7684\u521d\u59cb\u5bb9\u91cf\u53c2\u6570\u4e3a\u53c2\u6570size\u6307\u5b9a\u7684\u5b57\u7b26\u4e2a\u6570\u3002\u5f53\u8be5\u5bf9\u8c61\u7684\u5b9e\u4f53\u5b58\u653e\u7684\u5b57\u7b26\u5e8f\u5217\u7684\u957f\u5ea6\u5927\u4e8esize\u4e2a\u5b57\u7b26\u65f6\uff0c\u5b9e\u4f53\u7684\u5bb9\u91cf\u5c31\u81ea\u52a8\u7684\u589e\u52a0\u3002\u4ee5\u4fbf\u5b58\u653e\u6240\u589e\u52a0\u7684\u5b57\u7b26\u3002</p> <p>3.StringBuffer(String s)\u53ef\u4ee5\u6307\u5b9a\u7ed9\u5bf9\u8c61\u7684\u5b9e\u4f53\u7684\u521d\u59cb\u5bb9\u91cf\u4e3a\u53c2\u6570\u5b57\u7b26\u4e32s\u7684\u957f\u5ea6\u989d\u5916\u518d\u52a016\u4e2a\u5b57\u7b26\u3002\u5f53\u8be5\u5bf9\u8c61\u7684\u5b9e\u4f53\u5b58\u653e\u7684\u5b57\u7b26\u5e8f\u5217\u957f\u5ea6\u5927\u4e8esize\u4e2a\u5b57\u7b26\u65f6\uff0c\u5b9e\u4f53\u7684\u5bb9\u91cf\u81ea\u52a8\u7684\u589e\u52a0\uff0c\u4ee5\u4fbf\u5b58\u653e\u6240\u589e\u52a0\u7684\u5b57\u7b26\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#5-objectequalhashcode","title":"5. Object\u7c7b\u7684equal\u548chashcode\u65b9\u6cd5","text":"<p>\u56e0\u4e3ahashCode()\u5e76\u4e0d\u662f\u5b8c\u5168\u53ef\u9760\uff0c\u6709\u65f6\u5019\u4e0d\u540c\u7684\u5bf9\u8c61\u4ed6\u4eec\u751f\u6210\u7684hashcode\u4e5f\u4f1a\u4e00\u6837\uff08\u751f\u6210hash\u503c\u5f97\u516c\u5f0f\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\uff09\uff0c\u6240\u4ee5hashCode()\u53ea\u80fd\u8bf4\u662f\u5927\u90e8\u5206\u65f6\u5019\u53ef\u9760\uff0c\u5e76\u4e0d\u662f\u7edd\u5bf9\u53ef\u9760\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\uff1a - equal()\u76f8\u7b49\u7684\u4e24\u4e2a\u5bf9\u8c61\u4ed6\u4eec\u7684hashCode()\u80af\u5b9a\u76f8\u7b49\uff0c\u4e5f\u5c31\u662f\u7528equal()\u5bf9\u6bd4\u662f\u7edd\u5bf9\u53ef\u9760\u7684\u3002 - hashCode()\u76f8\u7b49\u7684\u4e24\u4e2a\u5bf9\u8c61\u4ed6\u4eec\u7684equal()\u4e0d\u4e00\u5b9a\u76f8\u7b49\uff0c\u4e5f\u5c31\u662fhashCode()\u4e0d\u662f\u7edd\u5bf9\u53ef\u9760\u7684\u3002</p> <p>boolean equals(Object obj)\uff1a\u7528\u4e8e\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\uff0c\u5176\u5b9e\u5185\u90e8\u6bd4\u8f83\u7684\u5c31\u662f\u4e24\u4e2a\u5bf9\u8c61\u5730\u5740\u3002 \u800c\u6839\u636e\u5bf9\u8c61\u7684\u5c5e\u6027\u4e0d\u540c\uff0c\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u76f8\u540c\u7684\u5177\u4f53\u5185\u5bb9\u4e5f\u4e0d\u4e00\u6837\u3002\u6240\u4ee5\u5728\u5b9a\u4e49\u7c7b\u65f6\uff0c\u4e00\u822c\u90fd\u4f1a\u590d\u5199equals\u65b9\u6cd5\uff0c\u5efa\u7acb\u672c\u7c7b\u7279\u6709\u7684\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u76f8\u540c\u7684\u4f9d\u636e\u3002</p> <p>int hashCode()\uff1a\u8fd4\u56de\u8be5\u5bf9\u8c61\u7684\u54c8\u5e0c\u7801\u503c\u3002\u652f\u6301\u6b64\u65b9\u6cd5\u662f\u4e3a\u4e86\u63d0\u9ad8\u54c8\u5e0c\u8868\u7684\u6027\u80fd\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#hashcodeequals","title":"hashCode\uff08\uff09\u4e0eequals\uff08\uff09\u7684\u76f8\u5173\u89c4\u5b9a","text":"<ul> <li>\u5982\u679c\u4e24\u4e2a\u5bf9\u8c61\u76f8\u7b49\uff0c\u5219hashcode\u4e00\u5b9a\u4e5f\u662f\u76f8\u540c\u7684</li> <li>\u4e24\u4e2a\u5bf9\u8c61\u76f8\u7b49,\u5bf9\u4e24\u4e2a\u5bf9\u8c61\u5206\u522b\u8c03\u7528equals\u65b9\u6cd5\u90fd\u8fd4\u56detrue</li> <li>\u4e24\u4e2a\u5bf9\u8c61\u6709\u76f8\u540c\u7684hashcode\u503c\uff0c\u5b83\u4eec\u4e5f\u4e0d\u4e00\u5b9a\u662f\u76f8\u7b49\u7684 \u56e0\u6b64\uff0cequals \u65b9\u6cd5\u88ab\u8986\u76d6\u8fc7\uff0c\u5219 hashCode \u65b9\u6cd5\u4e5f\u5fc5\u987b\u88ab\u8986\u76d6</li> <li>hashCode() \u7684\u9ed8\u8ba4\u884c\u4e3a\u662f\u5bf9\u5806\u4e0a\u7684\u5bf9\u8c61\u4ea7\u751f\u72ec\u7279\u503c\u3002\u5982\u679c\u6ca1\u6709\u91cd\u5199 hashCode()\uff0c\u5219\u8be5 class \u7684\u4e24\u4e2a\u5bf9\u8c61\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u4f1a\u76f8\u7b49\uff08\u5373\u4f7f\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u6307\u5411\u76f8\u540c\u7684\u6570\u636e\uff09</li> </ul>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#6-equals","title":"6. == \u4e0e equals","text":"<p>== : \u5b83\u7684\u4f5c\u7528\u662f\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u7684\u5730\u5740\u662f\u4e0d\u662f\u76f8\u7b49\u3002\u5373\uff0c\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u662f\u4e0d\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61(\u201c==\u201d\u57fa\u672c\u6570\u636e\u7c7b\u578b\u6bd4\u8f83\u7684\u662f\u503c\uff0c\u5f15\u7528\u6570\u636e\u7c7b\u578b\u6bd4\u8f83\u7684\u662f\u5185\u5b58\u5730\u5740)\u3002</p> <p>equals() : \u5b83\u7684\u4f5c\u7528\u4e5f\u662f\u5224\u65ad\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49\u3002\u4f46\u5b83\u4e00\u822c\u6709\u4e24\u79cd\u4f7f\u7528\u60c5\u51b5\uff1a -  \u60c5\u51b51\uff1a\u7c7b\u6ca1\u6709\u8986\u76d6 equals() \u65b9\u6cd5\u3002\u5219\u901a\u8fc7 equals() \u6bd4\u8f83\u8be5\u7c7b\u7684\u4e24\u4e2a\u5bf9\u8c61\u65f6\uff0c\u7b49\u4ef7\u4e8e\u901a\u8fc7\u201c==\u201d\u6bd4\u8f83\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u3002 - \u60c5\u51b52\uff1a\u7c7b\u8986\u76d6\u4e86 equals() \u65b9\u6cd5\u3002\u4e00\u822c\uff0c\u6211\u4eec\u90fd\u8986\u76d6 equals() \u65b9\u6cd5\u6765\u4e24\u4e2a\u5bf9\u8c61\u7684\u5185\u5bb9\u76f8\u7b49\uff1b\u82e5\u5b83\u4eec\u7684\u5185\u5bb9\u76f8\u7b49\uff0c\u5219\u8fd4\u56de true (\u5373\uff0c\u8ba4\u4e3a\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u76f8\u7b49)\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>public class Test {\n    public static void main(String[] args) {\n        String a = new String(\"ab\"); // a \u4e3a\u4e00\u4e2a\u5f15\u7528\n        String b = new String(\"ab\"); // b\u4e3a\u53e6\u4e00\u4e2a\u5f15\u7528,\u5bf9\u8c61\u7684\u5185\u5bb9\u4e00\u6837\n        String aa = \"ab\"; // \u653e\u5728\u5e38\u91cf\u6c60\u4e2d\n        String bb = \"ab\"; // \u4ece\u5e38\u91cf\u6c60\u4e2d\u67e5\u627e\n        if (aa == bb) // true\n            System.out.println(\"aa==bb\");\n        if (a == b) // false\uff0c\u975e\u540c\u4e00\u5bf9\u8c61\n            System.out.println(\"a==b\");\n        if (a.equals(b)) // true\n            System.out.println(\"aEQb\");\n        if (42 == 42.0) { // true\n            System.out.println(\"true\");\n        }\n    }\n}\n</code></pre> <p>\u8bf4\u660e\uff1a - String \u4e2d\u7684 equals \u65b9\u6cd5\u662f\u88ab\u91cd\u5199\u8fc7\u7684\uff0c\u56e0\u4e3a object \u7684 equals \u65b9\u6cd5\u662f\u6bd4\u8f83\u7684\u5bf9\u8c61\u7684\u5185\u5b58\u5730\u5740\uff0c\u800c String \u7684 equals \u65b9\u6cd5\u6bd4\u8f83\u7684\u662f\u5bf9\u8c61\u7684\u503c\u3002 - \u5f53\u521b\u5efa String \u7c7b\u578b\u7684\u5bf9\u8c61\u65f6\uff0c\u865a\u62df\u673a\u4f1a\u5728\u5e38\u91cf\u6c60\u4e2d\u67e5\u627e\u6709\u6ca1\u6709\u5df2\u7ecf\u5b58\u5728\u7684\u503c\u548c\u8981\u521b\u5efa\u7684\u503c\u76f8\u540c\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u6709\u5c31\u628a\u5b83\u8d4b\u7ed9\u5f53\u524d\u5f15\u7528\u3002\u5982\u679c\u6ca1\u6709\u5c31\u5728\u5e38\u91cf\u6c60\u4e2d\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a String \u5bf9\u8c61\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#7-string","title":"7. String\u4e3a\u4ec0\u4e48\u8981\u8bbe\u8ba1\u6210\u4e0d\u53ef\u53d8\u7684","text":"<ol> <li>\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u7684\u9700\u8981</li> </ol> <p>\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60(String pool, String intern pool, String\u4fdd\u7559\u6c60) \u662fJava\u5806\u5185\u5b58\u4e2d\u4e00\u4e2a\u7279\u6b8a\u7684\u5b58\u50a8\u533a\u57df, \u5f53\u521b\u5efa\u4e00\u4e2aString\u5bf9\u8c61\u65f6,\u5047\u5982\u6b64\u5b57\u7b26\u4e32\u503c\u5df2\u7ecf\u5b58\u5728\u4e8e\u5e38\u91cf\u6c60\u4e2d,\u5219\u4e0d\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61,\u800c\u662f\u5f15\u7528\u5df2\u7ecf\u5b58\u5728\u7684\u5bf9\u8c61\u3002</p> <ol> <li>\u5141\u8bb8String\u5bf9\u8c61\u7f13\u5b58HashCode Java\u4e2dString\u5bf9\u8c61\u7684\u54c8\u5e0c\u7801\u88ab\u9891\u7e41\u5730\u4f7f\u7528, \u6bd4\u5982\u5728hashMap \u7b49\u5bb9\u5668\u4e2d\u3002</li> </ol> <p>\u5b57\u7b26\u4e32\u4e0d\u53d8\u6027\u4fdd\u8bc1\u4e86hash\u7801\u7684\u552f\u4e00\u6027,\u56e0\u6b64\u53ef\u4ee5\u653e\u5fc3\u5730\u8fdb\u884c\u7f13\u5b58.\u8fd9\u4e5f\u662f\u4e00\u79cd\u6027\u80fd\u4f18\u5316\u624b\u6bb5,\u610f\u5473\u7740\u4e0d\u5fc5\u6bcf\u6b21\u90fd\u53bb\u8ba1\u7b97\u65b0\u7684\u54c8\u5e0c\u7801. \u5728String\u7c7b\u7684\u5b9a\u4e49\u4e2d\u6709\u5982\u4e0b\u4ee3\u7801:</p> <pre><code>private int hash;//\u7528\u6765\u7f13\u5b58HashCode\n</code></pre> <ol> <li>\u5b89\u5168\u6027 String\u88ab\u8bb8\u591a\u7684Java\u7c7b(\u5e93)\u7528\u6765\u5f53\u505a\u53c2\u6570,\u4f8b\u5982 \u7f51\u7edc\u8fde\u63a5\u5730\u5740URL,\u6587\u4ef6\u8def\u5f84path,\u8fd8\u6709\u53cd\u5c04\u673a\u5236\u6240\u9700\u8981\u7684String\u53c2\u6570\u7b49, \u5047\u82e5String\u4e0d\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684,\u5c06\u4f1a\u5f15\u8d77\u5404\u79cd\u5b89\u5168\u9690\u60a3\u3002</li> </ol>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#8try-catchoom","title":"8.\u53ef\u5426\u7528try-catch\u6355\u83b7OOM\u4ee5\u907f\u514d\u5176\u53d1\u751f","text":"<p>\u5728try\u8bed\u53e5\u4e2d\u58f0\u660e\u4e86\u5f88\u5927\u7684\u5bf9\u8c61\uff0c\u5bfc\u81f4OOM\uff0c\u5e76\u4e14\u53ef\u4ee5\u786e\u8ba4OOM\u662f\u7531try\u8bed\u53e5\u4e2d\u7684\u5bf9\u8c61\u58f0\u660e\u5bfc\u81f4\u7684\uff0c\u90a3\u4e48\u5728catch\u8bed\u53e5\u4e2d\uff0c\u53ef\u4ee5\u91ca\u653e\u6389\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u89e3\u51b3OOM\u7684\u95ee\u9898\uff0c\u7ee7\u7eed\u6267\u884c\u5269\u4f59\u8bed\u53e5\u3002\u4f46\u662f\u8fd9\u901a\u5e38\u4e0d\u662f\u5408\u9002\u7684\u505a\u6cd5\u3002Java\u4e2d\u7ba1\u7406\u5185\u5b58\u9664\u4e86\u663e\u5f0f\u5730catch OOM\u4e4b\u5916\u8fd8\u6709\u66f4\u591a\u6709\u6548\u7684\u65b9\u6cd5\uff1a\u6bd4\u5982SoftReference, WeakReference, \u786c\u76d8\u7f13\u5b58\u7b49\u3002\u5728JVM\u7528\u5149\u5185\u5b58\u4e4b\u524d\uff0c\u4f1a\u591a\u6b21\u89e6\u53d1GC\uff0c\u8fd9\u4e9bGC\u4f1a\u964d\u4f4e\u7a0b\u5e8f\u8fd0\u884c\u7684\u6548\u7387\u3002\u5982\u679cOOM\u7684\u539f\u56e0\u4e0d\u662ftry\u8bed\u53e5\u4e2d\u7684\u5bf9\u8c61\uff08\u6bd4\u5982\u5185\u5b58\u6cc4\u6f0f\uff09\uff0c\u90a3\u4e48\u5728catch\u8bed\u53e5\u4e2d\u4f1a\u7ee7\u7eed\u629b\u51faOOM</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#9","title":"9. \u5355\u4f8b\u8bbe\u8ba1\u6a21\u5f0f","text":"<p>\u89e3\u51b3\u7684\u95ee\u9898\uff1a\u4fdd\u8bc1\u4e00\u4e2a\u7c7b\u5728\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u552f\u4e00\u6027\u3002</p> <p>\u6bd4\u5982\uff1a\u591a\u7a0b\u5e8f\u8bfb\u53d6\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u65f6\uff0c\u5efa\u8bae\u914d\u7f6e\u6587\u4ef6\u5c01\u88c5\u6210\u5bf9\u8c61\u3002\u4f1a\u65b9\u4fbf\u64cd\u4f5c\u5176\u4e2d\u6570\u636e\uff0c\u53c8\u8981\u4fdd\u8bc1\u591a\u4e2a\u7a0b\u5e8f\u8bfb\u5230\u7684\u662f\u540c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u5bf9\u8c61\uff0c\u5c31\u9700\u8981\u8be5\u914d\u7f6e\u6587\u4ef6\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u662f\u552f\u4e00\u7684\u3002</p> <p>\u5982\u4f55\u4fdd\u8bc1\u5bf9\u8c61\u552f\u4e00\u6027\u5462\uff1f</p> <p>\u601d\u60f3\uff1a - 1. \u4e0d\u8ba9\u5176\u4ed6\u7a0b\u5e8f\u521b\u5efa\u8be5\u7c7b\u5bf9\u8c61\u3002 - 2. \u5728\u672c\u7c7b\u4e2d\u521b\u5efa\u4e00\u4e2a\u672c\u7c7b\u5bf9\u8c61\u3002 - 3. \u5bf9\u5916\u63d0\u4f9b\u65b9\u6cd5\uff0c\u8ba9\u5176\u4ed6\u7a0b\u5e8f\u83b7\u53d6\u8fd9\u4e2a\u5bf9\u8c61\u3002</p> <pre><code>    //\u997f\u6c49\u5f0f\nclass Single{\n    private Single(){} //\u79c1\u6709\u5316\u6784\u9020\u51fd\u6570\u3002\n        private static Single s = new Single(); //\u521b\u5efa\u79c1\u6709\u5e76\u9759\u6001\u7684\u672c\u7c7b\u5bf9\u8c61\u3002\n        public static Single getInstance(){ //\u5b9a\u4e49\u516c\u6709\u5e76\u9759\u6001\u7684\u65b9\u6cd5\uff0c\u8fd4\u56de\u8be5\u5bf9\u8c61\u3002\n            return s;\n        }\n}\n\n</code></pre> <pre><code>    //\u61d2\u6c49\u5f0f:\u5ef6\u8fdf\u52a0\u8f7d\u65b9\u5f0f\u3002\nclass Single2{\n    private Single2(){}\n        private static Single2 s = null;\n            public static Single2 getInstance(){\n                if(s==null)\n                    s = new Single2();\n                return s;\n            }\n}\n\n</code></pre>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#10","title":"10.\u5185\u90e8\u7c7b","text":"<p>\u5982\u679cA\u7c7b\u9700\u8981\u76f4\u63a5\u8bbf\u95eeB\u7c7b\u4e2d\u7684\u6210\u5458\uff0c\u800cB\u7c7b\u53c8\u9700\u8981\u5efa\u7acbA\u7c7b\u7684\u5bf9\u8c61\u3002\u8fd9\u65f6,\u4e3a\u4e86\u65b9\u4fbf\u8bbe\u8ba1\u548c\u8bbf\u95ee\uff0c\u76f4\u63a5\u5c06A\u7c7b\u5b9a\u4e49\u5728B\u7c7b\u4e2d\u3002\u5c31\u53ef\u4ee5\u4e86\u3002A\u7c7b\u5c31\u79f0\u4e3a\u5185\u90e8\u7c7b\u3002\u5185\u90e8\u7c7b\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5916\u90e8\u7c7b\u4e2d\u7684\u6210\u5458\u3002\u800c\u5916\u90e8\u7c7b\u60f3\u8981\u8bbf\u95ee\u5185\u90e8\u7c7b\uff0c\u5fc5\u987b\u8981\u5efa\u7acb\u5185\u90e8\u7c7b\u7684\u5bf9\u8c61\u3002</p> <pre><code>class Outer{\n    int num = 4;    \n    class  Inner {\n        void show(){\n            System.out.println(\"inner show run \"+num);          \n        }\n    }\n    public void method(){\n        Inner in = new Inner();//\u521b\u5efa\u5185\u90e8\u7c7b\u7684\u5bf9\u8c61\u3002\n        in.show();//\u8c03\u7528\u5185\u90e8\u7c7b\u7684\u65b9\u6cd5\u3002 \n    }\n}\n</code></pre> <p>\u5f53\u5185\u90e8\u7c7b\u5b9a\u4e49\u5728\u5916\u90e8\u7c7b\u4e2d\u7684\u6210\u5458\u4f4d\u7f6e\u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u6210\u5458\u4fee\u9970\u7b26\u4fee\u9970 private\u3001static\u3002 - 1\uff1a\u9ed8\u8ba4\u4fee\u9970\u7b26\u3002 \u76f4\u63a5\u8bbf\u95ee\u5185\u90e8\u7c7b\u683c\u5f0f\uff1a\u5916\u90e8\u7c7b\u540d.\u5185\u90e8\u7c7b\u540d \u53d8\u91cf\u540d =  \u5916\u90e8\u7c7b\u5bf9\u8c61.\u5185\u90e8\u7c7b\u5bf9\u8c61; Outer.Inner in = new Outer.new Inner();//\u8fd9\u79cd\u5f62\u5f0f\u5f88\u5c11\u7528\u3002     \u4f46\u662f\u8fd9\u79cd\u5e94\u7528\u4e0d\u591a\u89c1\uff0c\u56e0\u4e3a\u5185\u90e8\u7c7b\u4e4b\u6240\u4ee5\u5b9a\u4e49\u5728\u5185\u90e8\u5c31\u662f\u4e3a\u4e86\u5c01\u88c5\u3002\u60f3\u8981\u83b7\u53d6\u5185\u90e8\u7c7b\u5bf9\u8c61\u901a\u5e38\u90fd\u901a\u8fc7\u5916\u90e8\u7c7b\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u3002\u8fd9\u6837\u53ef\u4ee5\u5bf9\u5185\u90e8\u7c7b\u5bf9\u8c61\u8fdb\u884c\u63a7\u5236\u3002 - 2\uff1a\u79c1\u6709\u4fee\u9970\u7b26\u3002     \u901a\u5e38\u5185\u90e8\u7c7b\u88ab\u5c01\u88c5\uff0c\u90fd\u4f1a\u88ab\u79c1\u6709\u5316\uff0c\u56e0\u4e3a\u5c01\u88c5\u6027\u4e0d\u8ba9\u5176\u4ed6\u7a0b\u5e8f\u76f4\u63a5\u8bbf\u95ee\u3002  - 3\uff1a\u9759\u6001\u4fee\u9970\u7b26\u3002     \u5982\u679c\u5185\u90e8\u7c7b\u88ab\u9759\u6001\u4fee\u9970\uff0c\u76f8\u5f53\u4e8e\u5916\u90e8\u7c7b\uff0c\u4f1a\u51fa\u73b0\u8bbf\u95ee\u5c40\u9650\u6027\uff0c\u53ea\u80fd\u8bbf\u95ee\u5916\u90e8\u7c7b\u4e2d\u7684\u9759\u6001\u6210\u5458\u3002     \u6ce8\u610f\uff1b\u5982\u679c\u5185\u90e8\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u9759\u6001\u6210\u5458\uff0c\u90a3\u4e48\u8be5\u5185\u90e8\u7c7b\u5fc5\u987b\u662f\u9759\u6001\u7684\u3002</p> <p>\u5185\u90e8\u7c7b\u7f16\u8bd1\u540e\u7684\u6587\u4ef6\u540d\u4e3a\uff1a\u201c\u5916\u90e8\u7c7b\u540d$\u5185\u90e8\u7c7b\u540d.java\u201d\uff1b</p> <p>\u4e3a\u4ec0\u4e48\u5185\u90e8\u7c7b\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5916\u90e8\u7c7b\u4e2d\u7684\u6210\u5458\u5462\uff1f</p> <p>\u90a3\u662f\u56e0\u4e3a\u5185\u90e8\u4e2d\u90fd\u6301\u6709\u4e00\u4e2a\u5916\u90e8\u7c7b\u7684\u5f15\u7528\u3002\u8fd9\u4e2a\u662f\u5f15\u7528\u662f \u5916\u90e8\u7c7b\u540d.this  \u5185\u90e8\u7c7b\u53ef\u4ee5\u5b9a\u4e49\u5728\u5916\u90e8\u7c7b\u4e2d\u7684\u6210\u5458\u4f4d\u7f6e\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u5728\u5916\u90e8\u7c7b\u4e2d\u7684\u5c40\u90e8\u4f4d\u7f6e\u4e0a\u3002 \u5f53\u5185\u90e8\u7c7b\u88ab\u5b9a\u4e49\u5728\u5c40\u90e8\u4f4d\u7f6e\u4e0a\uff0c\u53ea\u80fd\u8bbf\u95ee\u5c40\u90e8\u4e2d\u88abfinal\u4fee\u9970\u7684\u5c40\u90e8\u53d8\u91cf\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#11","title":"11. \u591a\u7ebf\u7a0b","text":"<p>\u8fdb\u7a0b\uff1a\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u7a0b\u5e8f\u3002\u5176\u5b9e\u8fdb\u7a0b\u5c31\u662f\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u5185\u5b58\u5206\u914d\u7a7a\u95f4\u3002 \u7ebf\u7a0b\uff1a\u5176\u5b9e\u5c31\u662f\u8fdb\u7a0b\u4e2d\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c\u63a7\u5236\u5355\u5143\uff0c\u4e00\u6761\u6267\u884c\u8def\u5f84\u3002 \u8fdb\u7a0b\u8d1f\u8d23\u7684\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u7a7a\u95f4\u7684\u6807\u793a\u3002\u7ebf\u7a0b\u8d1f\u8d23\u7684\u662f\u5e94\u7528\u7a0b\u5e8f\u7684\u6267\u884c\u987a\u5e8f\u3002</p> <p>\u4e00\u4e2a\u8fdb\u7a0b\u81f3\u5c11\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u884c\uff0c\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u51fa\u73b0\u591a\u4e2a\u7ebf\u7a0b\u65f6\uff0c\u5c31\u79f0\u8fd9\u4e2a\u5e94\u7528\u7a0b\u5e8f\u662f\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u6808\u533a\u4e2d\u90fd\u6709\u81ea\u5df1\u7684\u6267\u884c\u7a7a\u95f4\uff0c\u81ea\u5df1\u7684\u65b9\u6cd5\u533a\u3001\u81ea\u5df1\u7684\u53d8\u91cf\u3002 jvm\u5728\u542f\u52a8\u7684\u65f6\uff0c\u9996\u5148\u6709\u4e00\u4e2a\u4e3b\u7ebf\u7a0b\uff0c\u8d1f\u8d23\u7a0b\u5e8f\u7684\u6267\u884c\uff0c\u8c03\u7528\u7684\u662fmain\u51fd\u6570\u3002\u4e3b\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\u90fd\u5728main\u65b9\u6cd5\u4e2d\u3002 \u5f53\u4ea7\u751f\u5783\u573e\u65f6\uff0c\u6536\u5783\u573e\u7684\u52a8\u4f5c\uff0c\u662f\u4e0d\u9700\u8981\u4e3b\u7ebf\u7a0b\u6765\u5b8c\u6210\uff0c\u56e0\u4e3a\u8fd9\u6837\uff0c\u4f1a\u51fa\u73b0\u4e3b\u7ebf\u7a0b\u4e2d\u7684\u4ee3\u7801\u6267\u884c\u4f1a\u505c\u6b62\uff0c\u4f1a\u53bb\u8fd0\u884c\u5783\u573e\u56de\u6536\u5668\u4ee3\u7801\uff0c\u6548\u7387\u8f83\u4f4e\uff0c\u6240\u4ee5\u7531\u5355\u72ec\u4e00\u4e2a\u7ebf\u7a0b\u6765\u8d1f\u8d23\u5783\u573e\u56de\u6536\u3002 </p> <p>\u968f\u673a\u6027\u7684\u539f\u7406\uff1a\u56e0\u4e3acpu\u7684\u5feb\u901f\u5207\u6362\u9020\u6210\uff0c\u54ea\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5230\u4e86cpu\u7684\u6267\u884c\u6743\uff0c\u54ea\u4e2a\u7ebf\u7a0b\u5c31\u6267\u884c\u3002</p> <p>\u8fd4\u56de\u5f53\u524d\u7ebf\u7a0b\u7684\u540d\u79f0\uff1aThread.currentThread().getName() \u7ebf\u7a0b\u7684\u540d\u79f0\u662f\u7531\uff1aThread-\u7f16\u53f7\u5b9a\u4e49\u7684\u3002\u7f16\u53f7\u4ece0\u5f00\u59cb\u3002 \u7ebf\u7a0b\u8981\u8fd0\u884c\u7684\u4ee3\u7801\u90fd\u7edf\u4e00\u5b58\u653e\u5728\u4e86run\u65b9\u6cd5\u4e2d\u3002</p> <p>\u7ebf\u7a0b\u8981\u8fd0\u884c\u5fc5\u987b\u8981\u901a\u8fc7\u7c7b\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u5f00\u542f\u3002start\u65b9\u6cd5\u3002\uff08\u542f\u52a8\u540e\uff0c\u5c31\u591a\u4e86\u4e00\u6761\u6267\u884c\u8def\u5f84\uff09 start\u65b9\u6cd5\uff1a1\uff09\u3001\u542f\u52a8\u4e86\u7ebf\u7a0b\uff1b2\uff09\u3001\u8ba9jvm\u8c03\u7528\u4e86run\u65b9\u6cd5\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#12runnable","title":"12.\u4e3a\u4ec0\u4e48\u8981\u6709Runnable\u63a5\u53e3\u7684\u51fa\u73b0","text":"<ul> <li> <p>1\uff1a\u901a\u8fc7\u7ee7\u627fThread\u7c7b\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5b8c\u6210\u591a\u7ebf\u7a0b\u7684\u5efa\u7acb\u3002\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u6709\u4e00\u4e2a\u5c40\u9650\u6027\uff0c\u5982\u679c\u4e00\u4e2a\u7c7b\u5df2\u7ecf\u6709\u4e86\u81ea\u5df1\u7684\u7236\u7c7b\uff0c\u5c31\u4e0d\u53ef\u4ee5\u7ee7\u627fThread\u7c7b\uff0c\u56e0\u4e3ajava\u5355\u7ee7\u627f\u7684\u5c40\u9650\u6027\u3002 \u53ef\u662f\u8be5\u7c7b\u4e2d\u7684\u8fd8\u6709\u90e8\u5206\u4ee3\u7801\u9700\u8981\u88ab\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u3002\u8fd9\u65f6\u600e\u4e48\u529e\u5462\uff1f \u53ea\u6709\u5bf9\u8be5\u7c7b\u8fdb\u884c\u989d\u5916\u7684\u529f\u80fd\u6269\u5c55\uff0cjava\u5c31\u63d0\u4f9b\u4e86\u4e00\u4e2a\u63a5\u53e3Runnable\u3002\u8fd9\u4e2a\u63a5\u53e3\u4e2d\u5b9a\u4e49\u4e86run\u65b9\u6cd5\uff0c\u5176\u5b9erun\u65b9\u6cd5\u7684\u5b9a\u4e49\u5c31\u662f\u4e3a\u4e86\u5b58\u50a8\u591a\u7ebf\u7a0b\u8981\u8fd0\u884c\u7684\u4ee3\u7801\u3002 \u6240\u4ee5\uff0c\u901a\u5e38\u521b\u5efa\u7ebf\u7a0b\u90fd\u7528\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u3002 \u56e0\u4e3a\u5b9e\u73b0Runnable\u63a5\u53e3\u53ef\u4ee5\u907f\u514d\u5355\u7ee7\u627f\u7684\u5c40\u9650\u6027\u3002</p> </li> <li> <p>2\uff1a\u5176\u5b9e\u662f\u5c06\u4e0d\u540c\u7c7b\u4e2d\u9700\u8981\u88ab\u591a\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\u8fdb\u884c\u62bd\u53d6\u3002\u5c06\u591a\u7ebf\u7a0b\u8981\u8fd0\u884c\u7684\u4ee3\u7801\u7684\u4f4d\u7f6e\u5355\u72ec\u5b9a\u4e49\u5230\u63a5\u53e3\u4e2d\u3002\u4e3a\u5176\u4ed6\u7c7b\u8fdb\u884c\u529f\u80fd\u6269\u5c55\u63d0\u4f9b\u4e86\u524d\u63d0\u3002 \u6240\u4ee5Thread\u7c7b\u5728\u63cf\u8ff0\u7ebf\u7a0b\u65f6\uff0c\u5185\u90e8\u5b9a\u4e49\u7684run\u65b9\u6cd5\uff0c\u4e5f\u6765\u81ea\u4e8eRunnable\u63a5\u53e3\u3002</p> </li> </ul> <p>\u5b9e\u73b0Runnable\u63a5\u53e3\u53ef\u4ee5\u907f\u514d\u5355\u7ee7\u627f\u7684\u5c40\u9650\u6027\u3002\u800c\u4e14\uff0c\u7ee7\u627fThread\uff0c\u662f\u53ef\u4ee5\u5bf9Thread\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u8fdb\u884c\u5b50\u7c7b\u590d\u5199\u7684\u3002\u4f46\u662f\u4e0d\u9700\u8981\u505a\u8fd9\u4e2a\u590d\u5199\u52a8\u4f5c\u7684\u8bdd\uff0c\u53ea\u4e3a\u5b9a\u4e49\u7ebf\u7a0b\u4ee3\u7801\u5b58\u653e\u4f4d\u7f6e\uff0c\u5b9e\u73b0Runnable\u63a5\u53e3\u66f4\u65b9\u4fbf\u4e00\u4e9b\u3002\u6240\u4ee5Runnable\u63a5\u53e3\u5c06\u7ebf\u7a0b\u8981\u6267\u884c\u7684\u4efb\u52a1\u5c01\u88c5\u6210\u4e86\u5bf9\u8c61\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#13","title":"13.\u7ebf\u7a0b\u95f4\u901a\u4fe1\uff1a\u601d\u8def\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5728\u64cd\u4f5c\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u4f46\u662f\u64cd\u4f5c\u7684\u52a8\u4f5c\u5374\u4e0d\u4e00\u6837\u3002","text":"<p>1\uff1a\u5c06\u8d44\u6e90\u5c01\u88c5\u6210\u5bf9\u8c61\u3002 2\uff1a\u5c06\u7ebf\u7a0b\u6267\u884c\u7684\u4efb\u52a1(\u4efb\u52a1\u5176\u5b9e\u5c31\u662frun\u65b9\u6cd5\u3002)\u4e5f\u5c01\u88c5\u6210\u5bf9\u8c61\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#_6","title":"\u7b49\u5f85\u5524\u9192\u673a\u5236\uff1a\u6d89\u53ca\u7684\u65b9\u6cd5\uff1a","text":"<p>wait:\u5c06\u540c\u6b65\u4e2d\u7684\u7ebf\u7a0b\u5904\u4e8e\u51bb\u7ed3\u72b6\u6001\u3002\u91ca\u653e\u4e86\u6267\u884c\u6743\uff0c\u91ca\u653e\u4e86\u8d44\u683c\u3002\u540c\u65f6\u5c06\u7ebf\u7a0b\u5bf9\u8c61\u5b58\u50a8\u5230\u7ebf\u7a0b\u6c60\u4e2d\u3002 notify\uff1a\u5524\u9192\u7ebf\u7a0b\u6c60\u4e2d\u67d0\u4e00\u4e2a\u7b49\u5f85\u7ebf\u7a0b\u3002 notifyAll:\u5524\u9192\u7684\u662f\u7ebf\u7a0b\u6c60\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u3002</p> <p>\u6ce8\u610f\uff1a 1\uff1a\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u9700\u8981\u5b9a\u4e49\u5728\u540c\u6b65\u4e2d\u3002  2\uff1a\u56e0\u4e3a\u8fd9\u4e9b\u65b9\u6cd5\u5fc5\u987b\u8981\u6807\u793a\u6240\u5c5e\u7684\u9501\u3002     \u4f60\u8981\u77e5\u9053 A\u9501\u4e0a\u7684\u7ebf\u7a0b\u88abwait\u4e86,\u90a3\u8fd9\u4e2a\u7ebf\u7a0b\u5c31\u76f8\u5f53\u4e8e\u5904\u4e8eA\u9501\u7684\u7ebf\u7a0b\u6c60\u4e2d\uff0c\u53ea\u80fdA\u9501\u7684notify\u5524\u9192\u3002 3\uff1a\u8fd9\u4e09\u4e2a\u65b9\u6cd5\u90fd\u5b9a\u4e49\u5728Object\u7c7b\u4e2d\u3002\u4e3a\u4ec0\u4e48\u64cd\u4f5c\u7ebf\u7a0b\u7684\u65b9\u6cd5\u5b9a\u4e49\u5728Object\u7c7b\u4e2d\uff1f     \u56e0\u4e3a\u8fd9\u4e09\u4e2a\u65b9\u6cd5\u90fd\u9700\u8981\u5b9a\u4e49\u540c\u6b65\u5185\uff0c\u5e76\u6807\u793a\u6240\u5c5e\u7684\u540c\u6b65\u9501\uff0c\u65e2\u7136\u88ab\u9501\u8c03\u7528\uff0c\u800c\u9501\u53c8\u53ef\u4ee5\u662f\u4efb\u610f\u5bf9\u8c61\uff0c\u90a3\u4e48\u80fd\u88ab\u4efb\u610f\u5bf9\u8c61\u8c03\u7528\u7684\u65b9\u6cd5\u4e00\u5b9a\u5b9a\u4e49\u5728Object\u7c7b\u4e2d\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#waitsleep","title":"wait\u548csleep\u533a\u522b\uff1a \u5206\u6790\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff1a\u4ece\u6267\u884c\u6743\u548c\u9501\u4e0a\u6765\u5206\u6790\uff1a","text":"<ul> <li>wait\uff1a\u53ef\u4ee5\u6307\u5b9a\u65f6\u95f4\u4e5f\u53ef\u4ee5\u4e0d\u6307\u5b9a\u65f6\u95f4\u3002\u4e0d\u6307\u5b9a\u65f6\u95f4\uff0c\u53ea\u80fd\u7531\u5bf9\u5e94\u7684notify\u6216\u8005notifyAll\u6765\u5524\u9192\u3002</li> <li>sleep\uff1a\u5fc5\u987b\u6307\u5b9a\u65f6\u95f4\uff0c\u65f6\u95f4\u5230\u81ea\u52a8\u4ece\u51bb\u7ed3\u72b6\u6001\u8f6c\u6210\u8fd0\u884c\u72b6\u6001(\u4e34\u65f6\u963b\u585e\u72b6\u6001)\u3002</li> <li>wait\uff1a\u7ebf\u7a0b\u4f1a\u91ca\u653e\u6267\u884c\u6743\uff0c\u800c\u4e14\u7ebf\u7a0b\u4f1a\u91ca\u653e\u9501\u3002</li> <li>sleep\uff1a\u7ebf\u7a0b\u4f1a\u91ca\u653e\u6267\u884c\u6743\uff0c\u4f46\u4e0d\u662f\u4e0d\u91ca\u653e\u9501\u3002</li> </ul> <p>\u7ebf\u7a0b\u7684\u505c\u6b62\uff1a\u901a\u8fc7stop\u65b9\u6cd5\u5c31\u53ef\u4ee5\u505c\u6b62\u7ebf\u7a0b\u3002\u4f46\u662f\u8fd9\u4e2a\u65b9\u5f0f\u8fc7\u65f6\u4e86\u3002 \u505c\u6b62\u7ebf\u7a0b\uff1a\u539f\u7406\u5c31\u662f\uff1a\u8ba9\u7ebf\u7a0b\u8fd0\u884c\u7684\u4ee3\u7801\u7ed3\u675f\uff0c\u4e5f\u5c31\u662f\u7ed3\u675frun\u65b9\u6cd5\u3002</p> <p>\u600e\u4e48\u7ed3\u675frun\u65b9\u6cd5\uff1f\u4e00\u822crun\u65b9\u6cd5\u91cc\u80af\u5b9a\u5b9a\u4e49\u5faa\u73af\u3002\u6240\u4ee5\u53ea\u8981\u7ed3\u675f\u5faa\u73af\u5373\u53ef\u3002 - \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u5b9a\u4e49\u5faa\u73af\u7684\u7ed3\u675f\u6807\u8bb0\u3002 - \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u5982\u679c\u7ebf\u7a0b\u5904\u4e8e\u4e86\u51bb\u7ed3\u72b6\u6001\uff0c\u662f\u4e0d\u53ef\u80fd\u8bfb\u5230\u6807\u8bb0\u7684\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u901a\u8fc7Thread\u7c7b\u4e2d\u7684interrupt\u65b9\u6cd5\uff0c\u5c06\u5176\u51bb\u7ed3\u72b6\u6001\u5f3a\u5236\u6e05\u9664\u3002\u8ba9\u7ebf\u7a0b\u6062\u590d\u5177\u5907\u6267\u884c\u8d44\u683c\u7684\u72b6\u6001\uff0c\u8ba9\u7ebf\u7a0b\u53ef\u4ee5\u8bfb\u5230\u6807\u8bb0\uff0c\u5e76\u7ed3\u675f\u3002</p>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#14lock","title":"14.Lock\u63a5\u53e3","text":"<p>\u591a\u7ebf\u7a0b\u5728JDK1.5\u7248\u672c\u5347\u7ea7\u65f6\uff0c\u63a8\u51fa\u4e00\u4e2a\u63a5\u53e3Lock\u63a5\u53e3\u3002 \u89e3\u51b3\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u4f7f\u7528\u540c\u6b65\u7684\u5f62\u5f0f\uff0c(\u540c\u6b65\u4ee3\u7801\u5757\uff0c\u8981\u4e48\u540c\u6b65\u51fd\u6570)\u5176\u5b9e\u6700\u7ec8\u4f7f\u7528\u7684\u90fd\u662f\u9501\u673a\u5236\u3002</p> <p>\u5230\u4e86\u540e\u671f\u7248\u672c\uff0c\u76f4\u63a5\u5c06\u9501\u5c01\u88c5\u6210\u4e86\u5bf9\u8c61\u3002\u7ebf\u7a0b\u8fdb\u5165\u540c\u6b65\u5c31\u662f\u5177\u5907\u4e86\u9501\uff0c\u6267\u884c\u5b8c\uff0c\u79bb\u5f00\u540c\u6b65\uff0c\u5c31\u662f\u91ca\u653e\u4e86\u9501\u3002 \u5728\u540e\u671f\u5bf9\u9501\u7684\u5206\u6790\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0\uff0c\u83b7\u53d6\u9501\uff0c\u6216\u8005\u91ca\u653e\u9501\u7684\u52a8\u4f5c\u5e94\u8be5\u662f\u9501\u8fd9\u4e2a\u4e8b\u7269\u66f4\u6e05\u695a\u3002\u6240\u4ee5\u5c06\u8fd9\u4e9b\u52a8\u4f5c\u5b9a\u4e49\u5728\u4e86\u9501\u5f53\u4e2d\uff0c\u5e76\u628a\u9501\u5b9a\u4e49\u6210\u5bf9\u8c61\u3002</p> <p>\u6240\u4ee5\u540c\u6b65\u662f\u9690\u793a\u7684\u9501\u64cd\u4f5c\uff0c\u800cLock\u5bf9\u8c61\u662f\u663e\u793a\u7684\u9501\u64cd\u4f5c\uff0c\u5b83\u7684\u51fa\u73b0\u5c31\u66ff\u4ee3\u4e86\u540c\u6b65\u3002</p> <p>\u5728\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u4f7f\u7528Object\u7c7b\u4e2dwait\u3001notify\u3001notifyAll\u7684\u65b9\u5f0f\u6765\u5b8c\u6210\u7684\u3002\u90a3\u662f\u56e0\u4e3a\u540c\u6b65\u4e2d\u7684\u9501\u662f\u4efb\u610f\u5bf9\u8c61\uff0c\u6240\u4ee5\u64cd\u4f5c\u9501\u7684\u7b49\u5f85\u5524\u9192\u7684\u65b9\u6cd5\u90fd\u5b9a\u4e49\u5728Object\u7c7b\u4e2d\u3002</p> <p>\u73b0\u5728\u9501\u662f\u6307\u5b9a\u5bf9\u8c61Lock\u3002\u6240\u4ee5\u67e5\u627e\u7b49\u5f85\u5524\u9192\u673a\u5236\u65b9\u5f0f\u9700\u8981\u901a\u8fc7Lock\u63a5\u53e3\u6765\u5b8c\u6210\u3002\u800cLock\u63a5\u53e3\u4e2d\u5e76\u6ca1\u6709\u76f4\u63a5\u64cd\u4f5c\u7b49\u5f85\u5524\u9192\u7684\u65b9\u6cd5\uff0c\u800c\u662f\u5c06\u8fd9\u4e9b\u65b9\u5f0f\u53c8\u5355\u72ec\u5c01\u88c5\u5230\u4e86\u4e00\u4e2a\u5bf9\u8c61\u4e2d\u3002\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u662fCondition\uff0c\u5c06Object\u4e2d\u7684\u4e09\u4e2a\u65b9\u6cd5\u8fdb\u884c\u5355\u72ec\u7684\u5c01\u88c5\u3002\u5e76\u63d0\u4f9b\u4e86\u529f\u80fd\u4e00\u81f4\u7684\u65b9\u6cd5 await()\u3001signal()\u3001signalAll()\u4f53\u73b0\u65b0\u7248\u672c\u5bf9\u8c61\u7684\u597d\u5904\u3002</p> <pre><code>class BoundedBuffer {\n   final Lock lock = new ReentrantLock();\n   final Condition notFull  = lock.newCondition(); \n   final Condition notEmpty = lock.newCondition(); \n   final Object[] items = new Object[100];\n   int putptr, takeptr, count;\n   public void put(Object x) throws InterruptedException {\n        lock.lock();\n        try {\n            while (count == items.length) \n                notFull.await();\n            items[putptr] = x; \n            if (++putptr == items.length) putptr = 0;\n            ++count;\n            notEmpty.signal();\n        } \n        finally {\n            lock.unlock();\n        }\n   }\n   public Object take() throws InterruptedException {\n        lock.lock();\n        try {\n            while (count == 0) \n                notEmpty.await();\n            Object x = items[takeptr]; \n            if (++takeptr == items.length) takeptr = 0;\n            --count;\n            notFull.signal();\n            return x;\n        } \n        finally {\n            lock.unlock();\n        }\n   } \n }\n\n</code></pre>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#15","title":"15. \u5bf9\u8c61\u7684\u5e8f\u5217\u5316","text":"<ul> <li>\u76ee\u7684\uff1a\u5c06\u4e00\u4e2a\u5177\u4f53\u7684\u5bf9\u8c61\u8fdb\u884c\u6301\u4e45\u5316\uff0c\u5199\u5165\u5230\u786c\u76d8\u4e0a\u3002</li> <li>\u6ce8\u610f\uff1a\u9759\u6001\u6570\u636e\u4e0d\u80fd\u88ab\u5e8f\u5217\u5316\uff0c\u56e0\u4e3a\u9759\u6001\u6570\u636e\u4e0d\u5728\u5806\u5185\u5b58\u4e2d\uff0c\u662f\u5b58\u50a8\u5728\u9759\u6001\u65b9\u6cd5\u533a\u4e2d\u3002</li> </ul> <p>\u5982\u4f55\u5c06\u975e\u9759\u6001\u7684\u6570\u636e\u4e0d\u8fdb\u884c\u5e8f\u5217\u5316\uff1f - \u7528transient \u5173\u952e\u5b57\u4fee\u9970\u6b64\u53d8\u91cf\u5373\u53ef\u3002 - transient\u5173\u952e\u5b57\u53ea\u80fd\u4fee\u9970\u53d8\u91cf\uff0c\u800c\u4e0d\u80fd\u4fee\u9970\u65b9\u6cd5\u548c\u7c7b\u3002\u6ce8\u610f\uff0c\u672c\u5730\u53d8\u91cf\u662f\u4e0d\u80fd\u88abtransient\u5173\u952e\u5b57\u4fee\u9970\u7684</p> <p>Serializable\uff1a\u7528\u4e8e\u542f\u52a8\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u529f\u80fd\uff0c\u53ef\u4ee5\u5f3a\u5236\u8ba9\u6307\u5b9a\u7c7b\u5177\u5907\u5e8f\u5217\u5316\u529f\u80fd\uff0c\u8be5\u63a5\u53e3\u4e2d\u6ca1\u6709\u6210\u5458\uff0c\u8fd9\u662f\u4e00\u4e2a\u6807\u8bb0\u63a5\u53e3\u3002\u8fd9\u4e2a\u6807\u8bb0\u63a5\u53e3\u7528\u4e8e\u7ed9\u5e8f\u5217\u5316\u7c7b\u63d0\u4f9bUID\u3002\u8fd9\u4e2auid\u662f\u4f9d\u636e\u7c7b\u4e2d\u7684\u6210\u5458\u7684\u6570\u5b57\u7b7e\u540d\u8fdb\u884c\u8fd0\u884c\u83b7\u53d6\u7684\u3002\u5982\u679c\u4e0d\u9700\u8981\u81ea\u52a8\u83b7\u53d6\u4e00\u4e2auid\uff0c\u53ef\u4ee5\u5728\u7c7b\u4e2d\uff0c\u624b\u52a8\u6307\u5b9a\u4e00\u4e2a\u540d\u79f0\u4e3aserialVersionUID id\u53f7\u3002\u4f9d\u636e\u7f16\u8bd1\u5668\u7684\u4e0d\u540c\uff0c\u6216\u8005\u5bf9\u4fe1\u606f\u7684\u9ad8\u5ea6\u654f\u611f\u6027\u3002\u6700\u597d\u6bcf\u4e00\u4e2a\u5e8f\u5217\u5316\u7684\u7c7b\u90fd\u8fdb\u884c\u624b\u52a8\u663e\u793a\u7684UID\u7684\u6307\u5b9a\u3002</p> <pre><code>import java.io.*;\nclass ObjectStreamDemo {\n    public static void main(String[] args) throws Exception{\n        writeObj();\n        readObj();\n    }\n    public static void readObj()throws Exception{\n        ObjectInputStream ois = new ObjectInputStream(new FileInputStream(\"obj.txt\"));\n        Object obj = ois.readObject();//\u8bfb\u53d6\u4e00\u4e2a\u5bf9\u8c61\u3002\n        System.out.println(obj.toString());\n    }\n    public static void writeObj()throws IOException{\n        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"obj.txt\"));\n        oos.writeObject(new Person(\"lisi\",25)); //\u5199\u5165\u4e00\u4e2a\u5bf9\u8c61\u3002\n        oos.close();\n    }\n}\nclass Person implements Serializable{\n    private static final long serialVersionUID = 42L;\n    private transient String name;//\u7528transient\u4fee\u9970\u540ename\u5c06\u4e0d\u4f1a\u8fdb\u884c\u5e8f\u5217\u5316\n    public int age;\n    Person(String name,int age){\n        this.name = name;\n        this.age = age;\n    }\n    public String toString(){\n        return name+\"::\"+age;\n    }\n}\n</code></pre>"},{"location":"Java/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/#transienttransient","title":"transient\u4f7f\u7528\u7ec6\u8282\u2014\u2014\u88abtransient\u5173\u952e\u5b57\u4fee\u9970\u7684\u53d8\u91cf\u771f\u7684\u4e0d\u80fd\u88ab\u5e8f\u5217\u5316\u5417\uff1f","text":"<p>\u6ce8\u610f\u4e0b\u9762\u4f8b\u5b50\u5b9e\u73b0Externalizable\u63a5\u53e3\uff0c\u800c\u4e0d\u662fSerilizable\u6216Parcelable\u3002</p> <pre><code>public class ExternalizableTest implements Externalizable {\n\n    private transient String content = \"\u662f\u7684\uff0c\u6211\u5c06\u4f1a\u88ab\u5e8f\u5217\u5316\uff0c\u4e0d\u7ba1\u6211\u662f\u5426\u88abtransient\u5173\u952e\u5b57\u4fee\u9970\";\n\n    @Override\n    public void writeExternal(ObjectOutput out) throws IOException {\n        out.writeObject(content);\n    }\n\n    @Override\n    public void readExternal(ObjectInput in) throws IOException,\n            ClassNotFoundException {\n        content = (String) in.readObject();\n    }\n\n    public static void main(String[] args) throws Exception {\n\n        ExternalizableTest et = new ExternalizableTest();\n        ObjectOutput out = new ObjectOutputStream(new FileOutputStream(\n                new File(\"test\")));\n        out.writeObject(et);\n\n        ObjectInput in = new ObjectInputStream(new FileInputStream(new File(\n                \"test\")));\n        et = (ExternalizableTest) in.readObject();\n        System.out.println(et.content);\n\n        out.close();\n        in.close();\n    }\n}\n\n</code></pre> <p>content\u53d8\u91cf\u4f1a\u88ab\u5e8f\u5217\u5316\u5417\uff1f\u597d\u5427\uff0c\u6211\u628a\u7b54\u6848\u90fd\u8f93\u51fa\u6765\u4e86\uff0c\u662f\u7684\uff0c\u8fd0\u884c\u7ed3\u679c\u5c31\u662f\uff1a</p> <p>\u662f\u7684\uff0c\u6211\u5c06\u4f1a\u88ab\u5e8f\u5217\u5316\uff0c\u4e0d\u7ba1\u6211\u662f\u5426\u88abtransient\u5173\u952e\u5b57\u4fee\u9970</p> <p>\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff0c\u4e0d\u662f\u8bf4\u7c7b\u7684\u53d8\u91cf\u88abtransient\u5173\u952e\u5b57\u4fee\u9970\u4ee5\u540e\u5c06\u4e0d\u80fd\u5e8f\u5217\u5316\u4e86\u5417\uff1f</p> <p>\u6211\u4eec\u77e5\u9053\u5728Java\u4e2d\uff0c\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u4e24\u79cd\u63a5\u53e3\u6765\u5b9e\u73b0\uff0c\u82e5\u5b9e\u73b0\u7684\u662fSerializable\u63a5\u53e3\uff0c\u5219\u6240\u6709\u7684\u5e8f\u5217\u5316\u5c06\u4f1a\u81ea\u52a8\u8fdb\u884c\uff0c - \u82e5\u5b9e\u73b0\u7684\u662fExternalizable\u63a5\u53e3\uff0c\u5219\u6ca1\u6709\u4efb\u4f55\u4e1c\u897f\u53ef\u4ee5\u81ea\u52a8\u5e8f\u5217\u5316\uff0c\u9700\u8981\u5728writeExternal\u65b9\u6cd5\u4e2d\u8fdb\u884c\u624b\u5de5\u6307\u5b9a\u6240\u8981\u5e8f\u5217\u5316\u7684\u53d8\u91cf\uff0c\u8fd9\u4e0e\u662f\u5426\u88abtransient\u4fee\u9970\u65e0\u5173\u3002</p>"},{"location":"Java/Java%E7%B3%BB%E5%88%97%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/","title":"Java\u7cfb\u5217\u96c6\u5408\u6e90\u7801\u5206\u6790","text":""},{"location":"Java/Java%E7%B3%BB%E5%88%97%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/#java","title":"Java \u7cfb\u5217\u96c6\u5408\u6e90\u7801\u5206\u6790","text":"<p>\u5de5\u6b32\u5584\u5176\u4e8b\uff0c\u5fc5\u5148\u5229\u5176\u5668\u3002\u5e73\u65f6\u6211\u4eec\u7528\u7684\u6700\u591a\u7684API\u5c31\u662fJava\u4e2d\u5404\u5f0f\u5404\u6837\u7684\u96c6\u5408\u7c7b\u4e86\uff0c\u8981\u60f3\u8fd0\u7528\u5f97\u5f53\uff0c\u5fc5\u987b\u8981\u5bf9\u96c6\u5408\u4e2d\u4e00\u4e9b\u5b9e\u73b0\u7ec6\u8282\u6709\u6240\u4e86\u89e3\u3002</p> <p>ArrayList\u548cVector\u7684\u533a\u522b \u4e3b\u8981\u4ecb\u7ecd\u4e86ArrayList\u548cVector\u7684\u5dee\u5f02\uff0cVector\u56e0\u4e3a\u5176\u81ea\u8eab\u6027\u80fd\u7684\u95ee\u9898\uff0c\u6211\u4eec\u73b0\u5728\u51e0\u4e4e\u4e0d\u7528\u8fd9\u4e2a\u96c6\u5408\u7c7b\u4e86\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7b80\u5355\u4e86\u89e3\u4e0b\u3002</p> <p>ArrayList\u548cLinkedList\u7684\u533a\u522b \u4e3b\u8981\u4ecb\u7ecd\u4e86ArrayList\u548cLinkedList\u7684\u5dee\u5f02\uff0c\u8fd9\u4e24\u4e2a\u96c6\u5408\u53ef\u4ee5\u8bf4\u662f\u6211\u4eec\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u9047\u5230\u6700\u591a\u7684\u96c6\u5408\u7c7b\uff0c\u6211\u4eec\u9700\u8981\u5b66\u4e60\u4e24\u8005\u5728\u5b9e\u73b0\u4e0a\u7684\u5dee\u5f02\u6027\u6765\u7075\u6d3b\u5730\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u8c03\u6574\u96c6\u5408\u7684\u4f7f\u7528\u7b56\u7565\u3002</p> <p>\u5173\u4e8eHashMap\u4f60\u9700\u8981\u77e5\u9053\u7684\u4e00\u4e9b\u7ec6\u8282 \u8fd9\u7bc7\u6587\u7ae0\u4e3b\u8981\u4ecb\u7ecd\u4e86HashMap\u4e2d\u4e00\u4e9b\u5b9e\u73b0\u7ec6\u8282\uff0c\u5982\u4f55\u89e3\u51b3hash\u78b0\u649e\uff0c\u5982\u4f55\u6269\u5bb9\u7b49\u95ee\u9898\u3002</p> <p>ConcurrentHashMap\u662f\u5982\u4f55\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u7684\uff0cConcurrentHashMap\u5728Android \u7684\u5f00\u53d1\u4e2d\u7528\u7684\u5f88\u5c11\uff0c\u4f46\u662f\u5728\u9762\u8bd5\u8fc7\u7a0b\u4e2d\u9762\u8bd5\u5b98\u7ecf\u5e38\u4f1a\u7ed3\u5408\u591a\u7ebf\u7a0b\u7684\u76f8\u5173\u77e5\u8bc6\u6765\u8003\u9a8c\u4f60\u5bf9\u4e8e\u5b83\u7684\u7406\u89e3\u3002</p> <p>Java\u4e2d\u7684\u7ea2\u9ed1\u6811\u89e3\u6790\u8fd9\u7bc7\u6587\u7ae0\u6700\u65e9\u662f\u7531\u6211\u5728\u516c\u53f8\u5185\u90e8\u7684\u4e00\u4e2a\u5206\u4eab\u8f6c\u6362\u8fc7\u6765\u7684\uff0c\u4e4b\u524d\u53d1\u5728\u6398\u91d1\u5e73\u53f0\uff0c\u4ec5\u8fd9\u4e00\u7bc7\u6587\u7ae0\u5c31\u6536\u83b7\u4e86\u56db\u767e\u591a\u7684\u70b9\u8d5e\uff0c\u4e3a\u4e86\u5c06\u7ea2\u9ed1\u6811\u8bb2\u6e05\u695a\uff0c\u8bf4\u4e86\u5f88\u591a\u5f20\u56fe\uff0c\u7406\u89e3\u7ea2\u9ed1\u6811\uff0c\u8fd9\u7bc7\u6587\u7ae0\u5c31\u591f\u4e86\u3002</p>"},{"location":"Java/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%88%86%E6%9E%90ArrayList%E5%92%8CVector%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790ArrayList\u548cVector\u7684\u533a\u522b","text":""},{"location":"Java/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%88%86%E6%9E%90ArrayList%E5%92%8CVector%E7%9A%84%E5%8C%BA%E5%88%AB/#arraylistvector","title":"ArrayList\u548cVector\u7684\u533a\u522b","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c ArrayList\u548cVector\u7684\u533a\u522b</p> <p>ArrayList\u548cVector\u8fd9\u4e24\u4e2a\u96c6\u5408\u672c\u8d28\u4e0a\u5e76\u6ca1\u6709\u4ec0\u4e48\u592a\u5927\u7684\u4e0d\u505c\uff0c\u4ed6\u4eec\u90fd\u5b9e\u73b0\u4e86List\u63a5\u53e3\uff0c\u800c\u4e14\u5e95\u5c42\u90fd\u662f\u57fa\u4e8eJava\u6570\u7ec4\u6765\u5b58\u50a8\u96c6\u5408\u5143\u7d20\u3002</p> <p>\u5728ArrayList\u96c6\u5408\u7c7b\u7684\u6e90\u4ee3\u7801\u4e2d\u4e5f\u53ef\u4ee5\u770b\u5230\u4e0b\u9762\u4e00\u884c\uff1a</p> <pre><code>    transient Object[] elementData; // non-private to simplify nested class access\n</code></pre> <p>\u5728Vector\u96c6\u5408\u7c7b\u7684\u6e90\u4ee3\u7801\u4e2d\u4e5f\u53ef\u4ee5\u770b\u5230\u7c7b\u4f3c\u7684\u4e00\u884c\uff1a</p> <pre><code>    protected Object[] elementData;\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0cArrayList\u4f7f\u7528transient\u4fee\u9970\u4e86elementData\u6570\u7ec4\uff0c\u8fd9\u4fdd\u8bc1\u7cfb\u7edf\u5e8f\u5217\u5316ArrayList\u5bf9\u8c61\u65f6\u4e0d\u4f1a\u76f4\u63a5\u5e8f\u5217\u5316elementData\u6570\u7ec4\uff0c\u800c\u662f\u901a\u8fc7ArrayList\u63d0\u4f9b\u7684writeObject\u3001readObject\u65b9\u6cd5\u6765\u5b9e\u73b0\u5b9a\u5236\u5e8f\u5217\u5316\uff1b</p> <p>\u4f46\u5bf9\u4e8eVector\u800c\u8a00\uff0c\u5b83\u6ca1\u6709\u4f7f\u7528transient\u4fee\u9970elementData\u6570\u636e\uff0c\u800c\u4e14Vector\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2awriteObject\u65b9\u6cd5\uff0c\u5e76\u672a\u5b8c\u5168\u5b9e\u73b0\u8ba2\u5236\u5e8f\u5217\u5316\u3002</p> <p>\u4ece\u5e8f\u5217\u5316\u673a\u5236\u7684\u89d2\u5ea6\u6765\u770b\uff0cArrayList\u7684\u5b9e\u73b0\u6bd4Vector\u7684\u5b9e\u73b0\u66f4\u5b89\u5168\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0cVector\u5176\u5b9e\u5c31\u662fArrayList\u7684\u7ebf\u7a0b\u5b89\u5168\u7248\u672c\uff0cArrayList\u548cVector\u7edd\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u662f\u76f8\u540c\u7684\uff0c\u53ea\u662fVector\u7684\u65b9\u6cd5\u589e\u52a0\u4e86synchronized\u4fee\u9970\u3002</p> <p>\u4e0b\u9762\u5148\u6765\u770bArrayList\u4e2d\u7684add(int index,E element)\u65b9\u6cd5\u7684\u6e90\u4ee3\u7801\u3002</p> <pre><code>      public void add(int index, E element) {\n        //\u68c0\u67e5\u662f\u5426\u4e0b\u6807\u8d8a\u754c\n        rangeCheckForAdd(index);\n        //\u4fdd\u8bc1ArrayList\u5e95\u5c42\u7684\u6570\u7ec4\u53ef\u4ee5\u4fdd\u5b58\u6240\u6709\u96c6\u5408\u5143\u7d20\n        ensureCapacityInternal(size + 1);  // Increments modCount!!\n        //\u5c06elementData\u6570\u7ec4\u4e2d\u7684index\u4f4d\u7f6e\u4e4b\u540e\u7684\u6240\u6709\u5143\u7d20\u5411\u540e\u79fb\u52a8\u4e00\u4f4d\n        //\u4e5f\u5c31\u662f\u5c06elementData\u6570\u7ec4\u7684index\u4f4d\u7f6e\u7684\u5143\u7d20\u7a7a\u51fa\u6765\n        System.arraycopy(elementData, index, elementData, index + 1,\n                         size - index);\n        //\u5c06\u65b0\u5143\u7d20\u5c06\u5165elementData\u6570\u7ec4\u7684index\u7684\u4f4d\u7f6e\n        elementData[index] = element;\n        size++;\n    }\n</code></pre> <p>\u518d\u6765\u770bVector\u4e2d\u7684add(int index,E element)\u65b9\u6cd5\u7684\u6e90\u4ee3\u7801\uff1a</p> <pre><code>     public void add(int index, E element) {\n        insertElementAt(element, index);\n    };\n</code></pre> <p>\u4ece\u4e0a\u9762\u53ef\u4ee5\u770b\u51fa\uff0cVector\u7684add(int index,E element)\u65b9\u6cd5\u5176\u5b9e\u5c31\u662finsertElementAt(int index,E element).</p> <p>\u63a5\u7740\u6765\u770binsertElementAt(int index,E element)\u7684\u6e90\u7801\u3002  ```java         public synchronized void insertElementAt(E obj, int index) {         //\u589e\u52a0\u96c6\u5408\u7684\u4fee\u6539\u6b21\u6570         modCount++;         //\u5982\u679c\u6dfb\u52a0\u4f4d\u7f6e\u5927\u4e8e\u96c6\u5408\u957f\u5ea6\uff0c\u5219\u629b\u51fa\u5f02\u5e38         if (index &gt; elementCount) {             throw new ArrayIndexOutOfBoundsException(index                                                      + \" &gt; \" + elementCount);         }         //\u4fdd\u8bc1Vector\u5e95\u5c42\u7684\u6570\u7ec4\u53ef\u4ee5\u4fdd\u5b58\u6240\u6709\u96c6\u5408\u5143\u7d20         ensureCapacityHelper(elementCount + 1);          //\u5c06elementData\u6570\u7ec4\u4e2d\u7684index\u4f4d\u7f6e\u4e4b\u540e\u7684\u6240\u6709\u5143\u7d20\u5411\u540e\u79fb\u52a8\u4e00\u4f4d         //\u4e5f\u5c31\u662f\u5c06elementData\u6570\u7ec4\u7684index\u4f4d\u7f6e\u7684\u5143\u7d20\u7a7a\u51fa\u6765         System.arraycopy(elementData, index, elementData, index + 1, elementCount - index);           //\u5c06\u65b0\u5143\u7d20\u5c06\u5165elementData\u6570\u7ec4\u7684index\u7684\u4f4d\u7f6e         elementData[index] = obj;         elementCount++;     }</p> <pre><code>\n\u5c06ArrayList\u4e2d\u7684add(int index,E element)\u65b9\u6cd5\u548cVector\u7684insertElementAt(int index,E element)\u65b9\u6cd5\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0Vector\u7684insertElementAt(int index,E element)\u65b9\u6cd5\u53ea\u662f\u591a\u4e86\u4e2asynchronized\u4fee\u9970\uff0c\u800c\u4e14\u591a\u4e86\u4e00\u884c\u4ee3\u7801modCount++\uff0c\u8fd9\u5e76\u4e0d\u4ee3\u8868ArrayList\u4e2d\u7684add(int index,E element)\u65b9\u6cd5\u6ca1\u6709\u8fd9\u884c\u4ee3\u7801\uff0cArrayList\u53ea\u662f\u5c06\u8fd9\u884c\u4ee3\u7801\u653e\u5728ensureCapacityInternal\u4e2d\u5b8c\u6210\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u770bensureCapacityInternal(int minCapacity)\u65b9\u6cd5\u7684\u6e90\u7801\uff1a\n```java\n    private void ensureCapacityInternal(int minCapacity) {\n        //\u5f53elementData\u6570\u7ec4\u4e3a\u7a7a\uff0c\u5982\u679c\u4f20\u8fdb\u6765\u7684minCapacity\uff1c=10\u65f6\uff0cminCapacity\u53d610\uff0c\u5426\u5219\u53d6\u4f20\u8fdb\u6765\u7684\u53c2\u6570\n        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {\n            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);\n        }\n\n        ensureExplicitCapacity(minCapacity);\n    }\n\n    private void ensureExplicitCapacity(int minCapacity) {\n        modCount++;\n\n        // overflow-conscious code\n        //\u5982\u679cminCapacity\u5927\u4e8e\u539f\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5219\u9700\u8981\u6269\u5bb9\n        if (minCapacity - elementData.length &gt; 0)\n            grow(minCapacity);\n    }\n   private void grow(int minCapacity) {\n        // overflow-conscious code\n        int oldCapacity = elementData.length;\n        //\u5c06\u65b0\u5bb9\u91cf\u6269\u5145\u4e3a\u539f\u6765\u76841.5\u500d\n        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);\n        //\u5982\u679c\u65b0\u7684newCapacity\u4f9d\u7136\u5c0f\u4e8eminCapacity\uff0c\u76f4\u63a5\u5c06minCapacity\u8d4b\u503c\u7ed9newCapacity\n        if (newCapacity - minCapacity &lt; 0)\n            newCapacity = minCapacity;\n        //\u5982\u679c\u65b0\u7684newCapacity\u8d85\u8fc7\u6700\u5927\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8fdb\u884c\u66f4\u5927\u7684\u6269\u5bb9 \n        if (newCapacity - MAX_ARRAY_SIZE &gt; 0)\n            newCapacity = hugeCapacity(minCapacity);\n        // minCapacity is usually close to size, so this is a win:\n        //\u901a\u8fc7Arrays.copyOf\u6269\u5145\u4e00\u4e2a\u65b0\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u957f\u5ea6\u4e3anewCapacity\n        elementData = Arrays.copyOf(elementData, newCapacity);\n    }\n</code></pre> <pre><code>     private void ensureCapacityHelper(int minCapacity) {\n        // overflow-conscious code\n          //\u5982\u679cminCapacity\u5927\u4e8e\u539f\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5219\u9700\u8981\u6269\u5bb9\n        if (minCapacity - elementData.length &gt; 0)\n            grow(minCapacity);\n    }\n    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n\n    private void grow(int minCapacity) {\n        // overflow-conscious code\n        int oldCapacity = elementData.length;\n        //\u5982\u679ccapacityIncrement\u5927\u4e8e0\uff0c\u5219\u65b0\u7684newCapacity\u7b49\u4e8e\u65e7\u7684oldCapacity\u52a0\u4e0acapacityIncrement\uff0c\n        //\u5982\u679c\u4e0d\u662f\uff0c\u5219\u65b0\u7684newCapacity\u7b49\u4e8e\u65e7\u7684oldCapacity*2\uff0c\u8868\u793a\u6269\u5bb9\u4e24\u500d\n        int newCapacity = oldCapacity + ((capacityIncrement &gt; 0) ?\n                                         capacityIncrement : oldCapacity);\n         //\u5982\u679c\u65b0\u7684newCapacity\u4f9d\u7136\u5c0f\u4e8eminCapacity\uff0c\u76f4\u63a5\u5c06minCapacity\u8d4b\u503c\u7ed9newCapacity           \n        if (newCapacity - minCapacity &lt; 0)\n            newCapacity = minCapacity;\n        //\u5982\u679c\u65b0\u7684newCapacity\u8d85\u8fc7\u6700\u5927\u7684\u6570\u7ec4\u957f\u5ea6\uff0c\u5219\u8fdb\u884c\u66f4\u5927\u7684\u6269\u5bb9\n        if (newCapacity - MAX_ARRAY_SIZE &gt; 0)\n            newCapacity = hugeCapacity(minCapacity);\n        //\u901a\u8fc7Arrays.copyOf\u6269\u5145\u4e00\u4e2a\u65b0\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u957f\u5ea6\u4e3anewCapacity    \n        elementData = Arrays.copyOf(elementData, newCapacity);\n    }\n</code></pre> <p>\u5c06ArrayList\u4e2d\u7684ensureCapacityInternal\u548cVector\u4e2d\u7684ensureCapacityHelper\u65b9\u6cd5\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u51e0\u4e4e\u5b8c\u5168\u76f8\u540c\uff0c\u53ea\u662f\u5728\u6269\u5145\u5e95\u5c42\u6570\u7ec4\u7684\u5bb9\u91cf\u65f6\u7565\u6709\u533a\u522b\u800c\u5df2\u3002ArrayList\u603b\u662f\u5c06\u5e95\u5c42\u6570\u7ec4\u7684\u5bb9\u91cf\u6269\u5145\u4e3a\u539f\u6765\u76841.5\u500d\uff0c\u4f46Vector\u5219\u591a\u4e86\u4e00\u4e2a\u9009\u62e9\u3002</p> <p>\u5f53capacityIncrement\u5927\u4e8e0\u65f6\uff0c\u6269\u5145\u540e\u7684\u5bb9\u91cf\u7b49\u4e8e\u539f\u6765\u7684\u5bb9\u91cf\u52a0\u4e0a\u8fd9\u4e2acapacityIncrement\u7684\u503c\uff0c\u5982\u679c\u4e0d\u662f\u5927\u4e8e0\uff0c\u5219\u6269\u5145\u4e3a\u539f\u6765\u5bb9\u91cf\u76842\u500d\u3002</p> <p>Vector\u7684ensureCapacityHelper\u65b9\u6cd5\u5728\u6269\u5145\u6570\u7ec4\u5bb9\u91cf\u65f6\u591a\u4e00\u4e2a\u9009\u62e9\u662f\u56e0\u4e3a\uff0c\u521b\u5efaVector\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2acapacityIncrement\u53c2\u6570\uff0c\u5982\u4e0b\u6784\u9020\u65b9\u6cd5\uff1a</p> <p>Vector(int initialCapacity, int capacityIncrement)\uff1a\u4ee5initialCapacity\u4f5c\u4e3a\u5e95\u5c42\u6570\u7ec4\u7684\u521d\u59cb\u957f\u5ea6\uff0c\u4ee5capacityIncrement\u4f5c\u4e3a\u6269\u5145\u6570\u7ec4\u65f6\u7684\u589e\u5927\u6b65\u957f\u6765\u521b\u5efaVector\u5bf9\u8c61\u3002</p> <p>\u4f46\u662f\u5bf9\u4e8eArrayList\u800c\u8a00\uff0c\u5b83\u7684\u6784\u9020\u65b9\u6cd5\u6700\u591a\u53ea\u80fd\u6307\u5b9a\u4e00\u4e2ainitialCapacity\u53c2\u6570\u3002</p>"},{"location":"Java/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E5%88%86%E6%9E%90ArrayList%E5%92%8CVector%E7%9A%84%E5%8C%BA%E5%88%AB/#_1","title":"\u6ce8\u610f","text":"<p>\u5373\u4f7f\u9700\u8981\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u4f7f\u7528List\u96c6\u5408\uff0c\u800c\u4e14\u9700\u8981\u4fdd\u8bc1List\u96c6\u5408\u7684\u7ebf\u7a0b\u5b89\u5168\uff0c\u4f9d\u7136\u53ef\u4ee5\u907f\u514d\u4f7f\u7528Vector\uff0c\u800c\u662f\u8003\u8651\u5c06ArrayList\u5305\u88c5\u6210\u7ebf\u7a0b\u5b89\u5168\u7684\u96c6\u5408\u7c7b\u3002Java\u63d0\u4f9b\u4e86\u4e00\u4e2aCollections\u5de5\u5177\u7c7b\uff0c\u901a\u8fc7\u8be5\u5de5\u5177synchronizedList\u65b9\u6cd5\u53ef\u4ee5\u5c06\u4e00\u4e2a\u666e\u745e\u7684ArrayList\u5305\u88c5\u6210\u7ebf\u7a0b\u5b89\u5168\u7684ArrayList\u3002</p>"},{"location":"Java/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E8%A7%A3%E6%9E%90ArrayList%E5%92%8CLinkedList%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"\u4ece\u6e90\u7801\u89d2\u5ea6\u89e3\u6790ArrayList\u548cLinkedList\u7684\u533a\u522b","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790ArrayList\u548cLinkedList\u7684\u533a\u522b</p> <p>List\u4ee3\u8868\u4e00\u79cd\u7ebf\u6027\u8868\u7684\u6570\u636e\u7ed3\u6784\uff0cArrayList\u5219\u662f\u4e00\u79cd\u987a\u5e8f\u5b58\u50a8\u7684\u7ebf\u6027\u8868\u3002ArrayList\u5e95\u5c42\u91c7\u7528\u6570\u7ec4\u6765\u4fdd\u5b58\u6bcf\u4e2a\u96c6\u5408\u7684\u5143\u7d20\uff0cLinkedList\u5219\u662f\u4e00\u79cd\u94fe\u5f0f\u5b58\u50a8\u7684\u7ebf\u6027\u8868\u3002\u5176\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u4f46\u5b83\u4e0d\u4ec5\u5b9e\u73b0\u4e86List\u63a5\u53e3\uff0c\u8fd8\u662f\u60f3\u4e86Deque\u63a5\u53e3\u3002\u4e5f\u5c31\u662f\u8bf4LinkedList\u65e2\u53ef\u4ee5\u5f53\u6210\u53cc\u5411\u94fe\u8868\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5f53\u6210\u961f\u5217\u4f7f\u7528\uff0c\u8fd8\u53ef\u4ee5\u5f53\u6210\u6808\u6765\u9002\u7528\u4e8e\uff08Deque\u4ee3\u8868\u53cc\u7aef\u961f\u5217\uff0c\u5373\u5177\u6709\u961f\u5217\u7684\u7279\u5f81\uff0c\u4e5f\u5177\u6709\u6808\u7684\u7279\u5f81\uff09\u3002</p> <p>\u5728\u4ece\u6e90\u7801\u89d2\u5ea6\u5206\u6790ArrayList\u548cVector\u7684\u533a\u522b\u4e2d\u5df2\u7ecf\u5206\u6790\u8fc7\uff0cArrayList\u5e95\u5c42\u91c7\u7528\u4e00\u4e2aelementData\u6570\u7ec4\u6765\u4fdd\u5b58\u6240\u6709\u96c6\u5408\u7684\u5143\u7d20\uff0c\u56e0\u6b64ArrayList\u5728\u63d2\u5165\u5143\u7d20\u65f6\u9700\u8981\u5b8c\u6210\u4e0b\u9762\u4e24\u4ef6\u4e8b\u60c5\u3002</p> <ul> <li>\u4fdd\u8bc1ArrayList\u5e95\u5c42\u5c01\u88c5\u7684\u6570\u7ec4\u957f\u5ea6\u5927\u4e8e\u96c6\u5408\u5143\u7d20\u7684\u4e2a\u6570\uff1b</li> <li>\u5c06\u63d2\u5165\u4f4d\u7f6e\u4e4b\u540e\u7684\u6240\u6709\u6570\u7ec4\u5143\u7d20\u201c\u6574\u4f53\u642c\u5bb6\u201d\uff0c\u5411\u540e\u79fb\u52a8\u4e00\u201c\u683c\u201d\u3002</li> </ul> <p>\u53cd\u8fc7\u6765\uff0c\u5f53\u5220\u9664ArrayList\u96c6\u5408\u4e2d\u6307\u5b9a\u7684\u5143\u7d20\u65f6\uff0c\u7a0b\u5e8f\u4e5f\u9700\u8981\u201c\u6574\u4f53\u642c\u5bb6\u201d\uff0c\u800c\u4e14\u8fd8\u9700\u8981\u5c06\u88ab\u5220\u9664\u7d22\u5f15\u5904\u7684\u6570\u7ec4\u5143\u7d20\u7f6e\u4e3anull\u3002\u4e0b\u9762\u662fArrayList\u96c6\u5408\u7684remove(int idnex)\u65b9\u6cd5\u7684\u6e90\u7801\u3002</p> <pre><code>     public E remove(int index) {\n         //\u5982\u679cindex\u662f\u5927\u4e8e\u6216\u8005\u7b49\u4e8esize\uff0c\u629b\u51fa\u5f02\u5e38\n        rangeCheck(index);\n\n        modCount++;\n        //\u4fdd\u5b58\u7d22\u5f15\u5904\u7684\u5143\u7d20\n        E oldValue = elementData(index);\n        //\u8ba1\u7b97\u9700\u8981\u201c\u6574\u4f53\u642c\u5bb6\u201d\u7684\u5143\u7d20\u4e2a\u6570\n        int numMoved = size - index - 1;\n        //\u5f53numMoved\u5927\u4e8e0\u65f6\uff0c\u5f00\u59cb\u642c\u5bb6\n        if (numMoved &gt; 0)\n            System.arraycopy(elementData, index+1, elementData, index,\n                             numMoved);\n        //\u91ca\u653e\u88ab\u5220\u9664\u5143\u7d20\uff0c\u4ee5\u4fbfGC\u56de\u6536\u8be5\u5143\u7d20  \n        elementData[--size] = null; // clear to let GC do its work\n\n        return oldValue;\n    }\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u6765\u770b\uff0c\u5bf9\u4e8eArrayList\u800c\u8a00\uff0c\u5f53\u7a0b\u5e8f\u5411ArrayList\u4e2d\u6dfb\u52a0\u3001\u5220\u9664\u96c6\u5408\u5143\u7d20\u65f6\uff0cArrayList\u5e95\u5c42\u90fd\u9700\u8981\u5bf9\u6570\u7ec4\u8fdb\u884c\u201c\u6574\u4f53\u642c\u5bb6\u201d\uff0c\u56e0\u6b64\u6027\u80fd\u6bd4\u8f83\u5dee\u3002</p> <p>\u4f46\u5982\u679c\u7a0b\u5e8f\u8c03\u7528get(int index)\u65b9\u6cd5\u6765\u53d6\u51faArrayList\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u65f6\uff0c\u6027\u80fd\u548c\u6570\u636e\u51e0\u4e4e\u76f8\u540c--\u975e\u5e38\u5feb\u3002</p> <pre><code>     public E get(int index) {\n        rangeCheck(index);\n\n        return elementData(index);\n    }\n</code></pre> <p>LinkedList\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u53cc\u5411\u5217\u8868\uff0c\u56e0\u6b64\u5b83\u4f7f\u7528\u5982\u4e0b\u5185\u90e8\u7c7b\u6765\u4fdd\u5b58\u6bcf\u4e2a\u96c6\u5408\u5143\u7d20\u3002</p> <pre><code>    private static class Node&lt;E&gt; {\n        //\u96c6\u5408\u5143\u7d20   \n        E item;\n        //\u4fdd\u5b58\u6307\u5411\u4e0b\u4e00\u4e2a\u94fe\u8868\u8282\u70b9\u7684\u5f15\u7528\n        Node&lt;E&gt; next;\n        //\u4fdd\u5b58\u6307\u5411\u4e0a\u4e00\u4e2a\u8282\u70b9\u7684\u5f15\u7528\n        Node&lt;E&gt; prev;\n        //\u6784\u9020\u65b9\u6cd5\n        Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) {\n            this.item = element;\n            this.next = next;\n            this.prev = prev;\n        }\n    }\n</code></pre> <p>\u7531\u4e8eLinkedList\u91c7\u7528\u53cc\u5411\u94fe\u8868\u6765\u4fdd\u5b58\u96c6\u5408\u5143\u7d20\uff0c\u56e0\u6b64\u5b83\u5728\u6dfb\u52a0\u96c6\u5408\u5143\u7d20\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u5bf9\u94fe\u8868\u8fdb\u884c\u5982\u4e0b\u56fe\u6240\u793a\u7684\u64cd\u4f5c\u5373\u53ef\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\u3002</p> <p></p> <pre><code>     public void add(int index, E element) {\n        checkPositionIndex(index);\n\n        //\u5982\u679cindex==size\uff0c\u5219\u76f4\u63a5\u5728\u628a\u65b0\u8282\u70b9\u52a0\u5728\u6700\u540e\n        //\u5426\u5219\uff0c\u5728index\u7d22\u5f15\u5904\u7684\u8282\u70b9\u4e4b\u524d\u63d2\u5165\u65b0\u8282\u70b9\n        if (index == size)\n            linkLast(element);\n        else\n            linkBefore(element, node(index));\n    }\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff0c\u7531\u4e8eLinkedList\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u56e0\u6b64\u5b83\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u5728\u6307\u5b9a\u8282\u70b9\u4e4b\u524d\u63d2\u5165\u65b0\u8282\u70b9\uff0cLinkedList\u5728\u6307\u5b9a\u4f4d\u7f6e\u6dfb\u52a0\u65b0\u8282\u70b9\u5c31\u662f\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684\u3002 -  node(int index):\u641c\u7d22\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u5143\u7d20\u3002 -  linkBefore(E e, Node succ):\u5728succ\u8282\u70b9\u4e4b\u524d\u63d2\u5165element\u65b0\u8282\u70b9\u3002 <p>node(int index\u5b9e\u9645\u4e0a\u5c31\u662fget(int index)\u65b9\u6cd5\u7684\u5e95\u5c42\u5b9e\u73b0\u3002\u5bf9\u4e8eArrayList\u6765\u8bf4\uff0c\u7531\u4e8e\u5b83\u5e95\u5c42\u91c7\u7528\u6570\u7ec4\u6765\u4fdd\u5b58\u96c6\u5408\u5143\u7d20\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u6839\u636e\u6570\u7ec4\u7d22\u5f15\u53d6\u51faindex\u4f4d\u7f6e\u7684\u5143\u7d20\uff1b\u4f46\u662f\u5bf9\u4e8eLinkedList\u5c31\u6bd4\u8f83\u9ebb\u70e6\u4e86\uff0cLinkedList\u5fc5\u987b\u8981\u4e00\u4e2a\u4e00\u4e2a\u5143\u7d20\u7684\u641c\u7d22\uff0c\u76f4\u5230\u627e\u5230\u7b2cindex\u4e2a\u5143\u7d20\u4e3a\u6b62\u3002</p> <pre><code>      /**\n     * Returns the (non-null) Node at the specified element index.\n     */\n     //\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u8282\u70b9\n    Node&lt;E&gt; node(int index) {\n        // assert isElementIndex(index);\n\n        //\u4ece\u94fe\u8868\u7684\u5934\u7aef\u5f00\u59cb\u641c\u7d22\n        if (index &lt; (size &gt;&gt; 1)) {\n            Node&lt;E&gt; x = first;\n            for (int i = 0; i &lt; index; i++)\n                x = x.next;\n            return x;\n        } else {\n            //\u4ece\u94fe\u8868\u7684\u5c3e\u7aef\u5f00\u59cb\u641c\u7d22\n            Node&lt;E&gt; x = last;\n            for (int i = size - 1; i &gt; index; i--)\n                x = x.prev;\n            return x;\n        }\n    }\n</code></pre> <p>\u4e0a\u9762\u7684node(int index)\u65b9\u6cd5\u5c31\u662f\u4e00\u4e2a\u5143\u7d20\u4e00\u4e2a\u5143\u7d20\u5730\u627e\u5230index\u7d22\u5f15\u5904\u7684\u5143\u7d20\uff0c\u53ea\u662f\u7531\u4e8eLinkedList\u662f\u4e00\u4e2a\u53cc\u5411\u94fe\u8868\uff0c\u56e0\u6b64\u5148\u6839\u636eindex\u7684\u503c\u5224\u65ad\u5b83\u5230\u5e95\u79bb\u94fe\u8868\u7684\u5934\u7aef\u8fd1\uff08\u5f53index &lt; (size &gt;&gt; 1)\u65f6\uff09\uff0c\u8fd8\u662f\u79bb\u94fe\u8868\u7684\u5c3e\u7aef\u8fd1\u3002\u5982\u679c\u79bb\u5934\u7aef\u8fd1\u5219\u4ece\u5934\u7aef\u5f00\u59cb\u641c\u7d22\uff0c\u5982\u679c\u79bb\u5c3e\u7aef\u8fd1\u5219\u4ece\u5c3e\u7aef\u5f00\u59cb\u641c\u7d22\u3002</p> <p>LinkedList\u7684get(int index)\u65b9\u6cd5\u53ea\u662f\u5bf9\u4e0a\u9762ode(int index)\u65b9\u6cd5\u7684\u7b80\u5355\u5305\u88c5\u3002</p> <p>```java     /*      * Returns the element at the specified position in this list.      *      * @param index index of the element to return      * @return the element at the specified position in this list      * @throws IndexOutOfBoundsException {@inheritDoc}      /     public E get(int index) {         checkElementIndex(index);         return node(index).item;     }</p> <pre><code>\n\u65e0\u8bba\u5982\u4f55\uff0cLinkedList\u4e3a\u4e86\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u5143\u7d20\u90fd\u662f\u6bd4\u8f83\u9ebb\u70e6\u7684\uff0c\u7cfb\u7edf\u5f00\u9500\u4e5f\u4f1a\u6bd4\u8f83\u5927\u3002\u4f46\u5355\u7eaf\u7684\u63d2\u5165\u64cd\u4f5c\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff0c\u53ea\u8981\u4fee\u6539\u51e0\u4e2a\u7b80\u5355\u79bb\u7684previous\u3001next\u5f15\u7528\u7684\u503c\u3002\n\n ```java\n   /**\n     * Inserts element e before non-null Node succ.\n     */\n     //\u5728\u6307\u5b9a\u8282\u70b9succ\u524d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\n    void linkBefore(E e, Node&lt;E&gt; succ) {\n        // assert succ != null;\n        final Node&lt;E&gt; pred = succ.prev;\n        //\u521b\u5efa\u65b0\u8282\u70b9\uff0c\u65b0\u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u6267\u884csucc\uff0c\u4e0a\u4e00\u4e2a\u8282\u70b9\u6307\u5411succ\u7684\u4e0a\u4e00\u4e2a\u8282\u70b9\n        final Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, succ);\n        //\u8ba9succ\u5411\u524d\u6307\u5411\u65b0\u8282\u70b9\n        succ.prev = newNode;\n        if (pred == null)\n            first = newNode;\n        else\n            //\u8ba9succ\u7684\u4e0a\u4e00\u4e2a\u8282\u70b9\u5411\u540e\u6307\u5411\u65b0\u8282\u70b9\n            pred.next = newNode;\n        size++;\n        modCount++;\n    }\n</code></pre> <p>\u5982\u679c\u53ea\u662f\u5355\u7eaf\u5730\u6dfb\u52a0\u67d0\u4e2a\u8282\u70b9\uff0cLinkedList\u7684\u6027\u80fd\u4f1a\u975e\u5e38\u597d\uff0c\u53ef\u60dc\u5982\u679c\u9700\u8981\u5411\u6307\u5b9a\u7d22\u5f15\u5904\u6dfb\u52a0\u8282\u70b9\uff0cLinkedList\u5fc5\u987b\u5148\u627e\u5230\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u8282\u70b9--\u8fd9\u4e2a\u641c\u7d22\u8fc7\u7a0b\u7684\u7cfb\u7edf\u5f00\u9500\u5e76\u4e0d\u5c0f\uff0c\u56e0\u4e3aLinkedList\u7684add(int index,E element)\u65b9\u6cd5\u7684\u6027\u80fd\u5e76\u4e0d\u662f\u7279\u522b\u597d\u3002</p> <p>\u5f53\u5355\u7eaf\u5730\u628aLinkedList\u5f53\u6210\u53cc\u5411\u94fe\u8868\u6765\u4f7f\u7528\uff0c\u4f7f\u7528addFirst(E e)\u3001addLast(E e)\u3001offerFirst(E e)\u3001offerLast(E e)\u3001pollFirst()\u3001pollLast\u7b49\u65b9\u6cd5\u6765\u64cd\u4f5cLinkedList\u96c6\u5408\u5143\u7d20\u65f6\uff0cLinkedList\u7684\u6027\u80fd\u975e\u5e38\u597d\u3002</p> <p>LinkedList\u4e2d\u5220\u9664\u4e00\u4e2a\u5143\u7d20\uff1a</p> <p></p> <p>\u7c7b\u4f3c\u5730\uff0cLinkedList\u4e3a\u4e86\u5b9e\u73b0remove(int index)\u65b9\u6cd5\uff0c\u4e5f\u5fc5\u987b\u901a\u8fc7node(int index)\u65b9\u6cd5\u627e\u5230index\u5904\u7684\u8282\u70b9\uff0c\u7136\u540e\u4fee\u6539\u5b83\u524d\u4e00\u4e2a\u8282\u70b9\u7684next\u5f15\u7528\u4ee5\u53ca\u540e\u4e00\u4e2a\u8282\u70b9previous\u5f15\u7528\u3002</p> <p>```java    public E remove(int index) {         checkElementIndex(index);         //\u641c\u7d22\u5230\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u8282\u70b9\uff0c\u7136\u540e\u5220\u9664\u8be5\u8282\u70b9         return unlink(node(index));     }</p> <pre><code> /**\n * Unlinks non-null node x.\n */\nE unlink(Node&lt;E&gt; x) {\n    // assert x != null;\n    final E element = x.item;\n    final Node&lt;E&gt; next = x.next;\n    final Node&lt;E&gt; prev = x.prev;\n\n    if (prev == null) {\n        first = next;\n    } else {\n        prev.next = next;\n        x.prev = null;\n    }\n\n    if (next == null) {\n        last = prev;\n    } else {\n        next.prev = prev;\n        x.next = null;\n    }\n\n    x.item = null;\n    size--;\n    modCount++;\n    return element;\n}\n</code></pre> <p>```</p>"},{"location":"Java/%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E8%A7%A3%E6%9E%90ArrayList%E5%92%8CLinkedList%E7%9A%84%E5%8C%BA%E5%88%AB/#arraylistlinkedlist","title":"ArrayList\u548cLinkedList\u7684\u6027\u80fd\u5206\u6790\u548c\u9002\u7528\u573a\u666f","text":"<p>\u5f53\u7a0b\u5e8f\u9700\u8981\u4ee5get(int index)\u65b9\u6cd5\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u5143\u7d20\u65f6\uff0cArrayList\u6027\u80fd\u5927\u5927\u5730\u4f18\u4e8eLinkedlist.\u56e0\u4e3aArraylist\u5e95\u5c42\u4ee5\u6570\u7ec4\u6765\u4fdd\u5b58\u96c6\u5408\u5143\u7d20\uff0c\u6240\u793a\u8c03\u7528get(int index)\u65b9\u6cd5\u6765\u83b7\u53d6\u6307\u5b9a\u7d22\u5f15\u5904\u7684\u5143\u7d20\u65f6\uff0c\u5e95\u5c42\u5b9e\u9645\u4e0a\u8c03\u7528 elementdata\uff3bindex\uff3d\u6765\u8fd4\u56de\u8be5\u5143\u7d20\uff0c\u56e0\u6b64\u6027\u80fd\u975e\u5e38\u597d\u3002</p> <p>\u5f53\u7a0b\u5e8f\u8c03\u7528 add(int index\uff0c Object obj)\u5411List\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20\u65f6\uff0c Arraylist\u5fc5\u987b\u5bf9\u5e95\u5c42\u6570\u7ec4\u5143\u7d20\u8fdb\u884c\u201c\u6574\u4f53\u642c\u5bb6\u201d\uff0c\u5982\u679c\u6dfb\u52a0\u5143\u7d20\u5bfc\u81f4\u96c6\u5408\u957f\u5ea6\u5c06\u8981\u8d85\u8fc7\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\uff0cArrayList\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u957f\u5ea6\u4e3a\u539f\u6765\u957f\u5ea61.5\u500d\u7684\u6570\u7ec4\uff0c\u518d\u7531\u5783\u573e\u56de\u6536\u673a\u5236\u56de\u6536\u539f\u6709\u6570\u7ec4\uff0c\u56e0\u6b64 \u5f00\u9500\u6bd4\u8f83\u5927\u3002\u5bf9\u4e8e LinkedList\u800c\u8a00\uff0c\u5b83\u7684\u4e3b\u8981\u5f00\u9500\u96c6\u4e2d\u5728 node(index)\u65b9\u6cd5\u4e0a\uff0c\u8be5\u65b9\u6cd5\u5fc5\u9808\u4e00\u4e2a\u4e2a\u5730\u641c\u7d22\u8fc7\u53bb\uff0c\u76f4\u5230\u627e\u5230idex\u5904\u7684\u5143\u7d20\uff0c\u7136\u540e\u518d\u5728\u8be5\u5143\u7d20\u4e4b\u524d\u63d2\u5165\u65b0\u5143\u7d22\u3002\u5373\u4f7f\u5982\u6b64\uff0c\u6267\u884c\u8be5\u65b9\u6cd5\u7684\u65f6\u5019 LinkedList\u65b9\u6cd5\u7684\u6027\u80fd\u4f9d\u7136\u9ad8\u4e8eArrayList</p> <p>\u5f53\u7a0b\u5e8f\u8c03\u7528 remove\uff08int index\uff09\u65b9\u6cd5\u5220\u9664 index\u7d22\u5f15\u5904\u7684\u5143\u7d20\u65f6\uff0c Arraylist\u540c\u6837\u4e5f\u9700\u8981\u5bf9\u5e95\u5c42\u6570\u7ec4\u5143\u7d20\u8fdb\u884c\u201c\u6574\u4f53\u642c\u5bb6\u201d\u3002\u4f46\u8c03\u7528 remove\uff08int index\uff09\u65b9\u6cd5\u5225\u9664\u96c6\u5408\u5143\u7d20\u65f6\uff0c Arraylist\u65e0\u9700\u8003\u8651\u521b\u5efa\u65b0\u6570\u7ec4\uff0c\u56e0\u6b64\u6267\u884c ArrayList\u7684 remove\uff08int index\uff09\u65b9\u6cd5\u6bd4\u6267\u884cadd\uff08 int index\uff0c Object o)\u65b9\u6cd5\u7565\u5feb\u4e00\u70b9\u3002\u5f53 Linkedlist\u8c03\u7528 remove\uff08 int index\uff09\u65b9\u6cd5\u5220\u9664\u96c6\u5408\u5143\u7d20\u65f6\uff0c\u4e0e\u8c03\u7528 add\uff08int index,Oject obj\uff09\u65b9\u6cd5\u6dfb\u52a0\u5143\u7d20\u7684\u7cfb\u7edf\u5f00\u9500\u51e0\u4e4e\u5b8c\u5168\u76f8\u540c\u3002</p> <p>\u5f53\u7a0b\u5e8f\u8c03\u7528add(Object obj\uff09\u65b9\u6cd5\u5411List\u96c6\u5408\u5c3e\u7aef\u6dfb\u52a0\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u5927\u90e8\u5206\u65f6\u5019 ArrayList\u65e0\u9700\u5bf9\u5e95\u5c42\u6570\u7ec4\u5143\u7d20\u8fdb\u884c\u201c\u6574\u4f53\u642c\u5bb6\u201d\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u83b7\u5f97\u5f88\u597d\u7684\u6027\u80fd\uff08\u751a\u81f3\u6bd4 Linkedlist\u7684add(Object obj)\u65b9\u6cd5\u7684\u6027\u80fd\u66f4\u597d;\u4f46\u5982\u679c\u6dfb\u52a0\u8fd9\u4e2a\u5143\u7d20\u5bfc\u81f4\u96c6\u5408\u957f\u5ea6\u5c06\u8981\u8d85\u8fc7\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\uff0c\u90a3\u4e48 ArrayList\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u957f\u5ea6\u4e3a\u539f\u6765\u957f\u5ea61.5\u500d\u7684\u6570\u7ec4\uff0c\u518d\u7531\u5783\u573e\u56de\u6536\u673a\u5236\u56de\u6536\u539f\u6709\u6570\u7ec4\u4e00\u4e00\u8fd9\u6837\u7cfb\u7edf\u5f00\u9500\u5c31\u6bd4\u8f83\u5927\u4e86\u3002\u4f46 Linkedlist\u8c03\u7528add(Object obj\uff09\u65b9\u6cd5\u6dfb\u52a0\u5143\u7cfb\u65f6\u603b\u53ef\u4ee5\u83b7\u5f97\u8f83\u597d\u7684\u6027\u80fd\u3002 \u5f53\u7a0b\u5e8f\u628a Linkedlist\u5f53\u6210\u53cc\u7aef\u961f\u5217\u3001\u6808\u4f7f\u7528\uff0c\u8c03\u7528 addfirst\uff08E e\uff09\u3001 addLast\uff08E e\uff09\u3001 getFirst\u3001 getLast\uff08E e\uff09\u3001offer\uff08E e\uff09\u3001 offerFirst()\u3001 offerLast()\u7b49\u65b9\u6cd5\u6765\u64cd\u4f5c\u96c6\u5408\u5143\u7d20\u65f6\uff0c Linkedlist\u4ee5\u5feb\u901f\u5b9a\u4f4d\u9700\u8981\u64cd\u4f5c\u7684\u5143\u7d20\uff0c\u56e0\u6b64 Linkedlist\u603b\u662f\u5177\u6709\u8f83\u597d\u7684\u6027\u80fd\u8868\u73b0\u3002 \u4e0a\u9762\u5206\u6790\u4e86ArrayList\u3001 Linkedlis\u5404\u81ea\u7684\u9002\u7528\u573a\u666f\u3002\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c ArrayList\u7684\u6027\u80fd\u603bLinkedlist\uff0c\u56e0\u6b64\u7edd\u5927\u90e8\u5206\u90fd\u5e94\u8be5\u8003\u8651\u4f7f\u7528 Arraylis\u96c6\u5408\u3002\u4f46\u5982\u679c\u7a0b\u5e8f\u7ecf\u5e38\u9700\u8981\u6dfb\u52a0\u9664\u5143\u7d20\uff0c\u5c24\u5176\u662f\u7ecf\u5e38\u9700\u8981\u8c03\u7528add(E e\uff09\u65b9\u6cd5\u5411\u96c6\u5408\u4e2d\u6dfb\u52a0\u5143\u7d20\u65f6\uff0c\u5219\u5e94\u8be5\u8003\u8651\u4f7f\u7528 LinkedList\u96c6\u5408\u3002</p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/","title":"\u5173\u4e8eHashMap\u4f60\u9700\u8981\u77e5\u9053\u7684\u4e00\u4e9b\u7ec6\u8282","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c\u5173\u4e8eHashMap\u4f60\u9700\u8981\u77e5\u9053\u7684\u4e00\u4e9b\u7ec6\u8282</p> <p>\u5728\u5b98\u65b9\u6587\u6863\u4e2d\u7684\u63cf\u8ff0\uff1a</p> <p>Hash table based implementation of the Map interface. This implementation provides all of the optional map operations, and permits null values and the null key. (The HashMap class is roughly equivalent to Hashtable, except that it is unsynchronized and permits nulls.) This class makes no guarantees as to the order of the map; in particular, it does not guarantee that the order will remain constant over time.</p> <p>\u57fa\u4e8eMap\u63a5\u53e3\u7684\u54c8\u5e0c\u8868\u7684\u5b9e\u73b0\u3002\u6b64\u5b9e\u73b0\u63d0\u4f9b\u6240\u6709\u53ef\u9009\u7684\u6620\u5c04\u64cd\u4f5c\uff0c\u5e76\u5141\u8bb8\u7a7a\u503c\u548c\u7a7a\u952e\u3002\uff08HashMap\u7c7b\u5927\u81f4\u7b49\u540c\u4e8eHashTable\uff0c\u53ea\u662f\u5b83\u4e0d\u540c\u6b65\u5e76\u4e14\u5141\u8bb8\u7a7a\u503c\u3002\uff09\u8fd9\u4e2a\u7c7b\u4e0d\u4fdd\u8bc1\u6620\u5c04\u7684\u987a\u5e8f\uff1b\u7279\u522b\u662f\uff0c\u5b83\u4e0d\u4fdd\u8bc1\u987a\u5e8f\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u4fdd\u6301\u4e0d\u53d8\u3002</p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#_1","title":"\u4e24\u4e2a\u91cd\u8981\u7684\u53c2\u6570","text":"<p>\u5728HashMap\u4e2d\u6709\u4e24\u4e2a\u5f88\u91cd\u8981\u7684\u53c2\u6570\uff0c\u5bb9\u91cf(Capacity)\u548c\u8d1f\u8f7d\u56e0\u5b50(Load factor)</p> <ul> <li>Initial capacity The capacity is the number of buckets in the hash table, The initial capacity is simply the capacity at the time the hash table is created.</li> <li>Load factor The load factor is a measure of how full the hash table is allowed to get before its capacity is automatically increased.</li> </ul> <p>\u7b80\u5355\u7684\u8bf4\uff0cCapacity\u5c31\u662fbuckets\u7684\u6570\u76ee\uff0cLoad factor\u5c31\u662fbuckets\u586b\u6ee1\u7a0b\u5ea6\u7684\u6700\u5927\u6bd4\u4f8b\u3002\u5982\u679c\u5bf9\u8fed\u4ee3\u6027\u80fd\u8981\u6c42\u5f88\u9ad8\u7684\u8bdd\u4e0d\u8981\u628acapacity\u8bbe\u7f6e\u8fc7\u5927\uff0c\u4e5f\u4e0d\u8981\u628aload factor\u8bbe\u7f6e\u8fc7\u5c0f\u3002\u5f53bucket\u586b\u5145\u7684\u6570\u76ee\uff08\u5373hashmap\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\uff09\u5927\u4e8ecapacity*load factor\u65f6\u5c31\u9700\u8981\u8c03\u6574buckets\u7684\u6570\u76ee\u4e3a\u5f53\u524d\u76842\u500d\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u6765\u4e00\u8d77\u770b\u770b HashMap \u5185\u90e8\u7684\u7ed3\u6784\uff0c\u5b83\u53ef\u4ee5\u770b\u4f5c\u662f\u6570\u7ec4(Node[] table)\u548c\u94fe\u8868\u7ed3 \u5408\u7ec4\u6210\u7684\u590d\u5408\u7ed3\u6784\uff0c\u6570\u7ec4\u88ab\u5206\u4e3a\u4e00\u4e2a\u4e2a\u6876(bucket)\uff0c\u901a\u8fc7\u54c8\u5e0c\u503c\u51b3\u5b9a\u4e86\u952e\u503c\u5bf9\u5728\u8fd9\u4e2a\u6570\u7ec4\u7684\u5bfb\u5740;\u54c8\u5e0c\u503c\u76f8\u540c\u7684\u952e\u503c\u5bf9\uff0c\u5219\u4ee5\u94fe\u8868\u5f62\u5f0f\u5b58\u50a8\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684\u793a\u610f\u56fe\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u94fe\u8868\u5927\u5c0f\u8d85\u8fc7\u9608\u503c(TREEIFY_THRESHOLD, 8)\uff0c\u56fe\u4e2d\u7684\u94fe\u8868\u5c31\u4f1a\u88ab\u6539\u9020\u4e3a\u6811\u5f62\u7ed3\u6784\u3002</p> <p></p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#put","title":"put\u51fd\u6570\u7684\u5b9e\u73b0","text":"<p>\u63a5\u7740\u6765\u770b put \u65b9\u6cd5\u5b9e\u73b0:</p> <p>put\u51fd\u6570\u5927\u81f4\u7684\u601d\u8def\u4e3a\uff1a</p> <ol> <li>\u5bf9key\u7684hashCode()\u505ahash\uff0c\u7136\u540e\u518d\u8ba1\u7b97index;</li> <li>\u5982\u679c\u6ca1\u78b0\u649e\u76f4\u63a5\u653e\u5230bucket\u91cc\uff1b</li> <li>\u5982\u679c\u78b0\u649e\u4e86\uff0c\u4ee5\u94fe\u8868\u7684\u5f62\u5f0f\u5b58\u5728buckets\u540e\uff1b</li> <li>\u5982\u679c\u78b0\u649e\u5bfc\u81f4\u94fe\u8868\u8fc7\u957f(\u5927\u4e8e\u7b49\u4e8eTREEIFY_THRESHOLD)\uff0c\u5c31\u628a\u94fe\u8868\u8f6c\u6362\u6210\u7ea2\u9ed1\u6811\uff1b</li> <li>\u5982\u679c\u8282\u70b9\u5df2\u7ecf\u5b58\u5728\u5c31\u66ff\u6362old value(\u4fdd\u8bc1key\u7684\u552f\u4e00\u6027)</li> <li>\u5982\u679cbucket\u6ee1\u4e86(\u8d85\u8fc7load factor*current capacity)\uff0c\u5c31\u8981resize\u3002</li> </ol> <pre><code>public V put(K key, V value) {\n    // \u5bf9key\u7684hashCode()\u505ahash\n    return putVal(hash(key), key, value, false, true);\n}\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;\n    // tab\u4e3a\u7a7a\u5219\u521b\u5efa\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // \u8ba1\u7b97index\uff0c\u5e76\u5bf9null\u505a\u5904\u7406\n    if ((p = tab[i = (n - 1) &amp; hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n    else {\n        Node&lt;K,V&gt; e; K k;\n        // \u8282\u70b9\u5b58\u5728\n        if (p.hash == hash &amp;&amp;\n            ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))\n            e = p;\n        // \u8be5\u94fe\u4e3a\u6811\n        else if (p instanceof TreeNode)\n            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);\n        // \u8be5\u94fe\u4e3a\u94fe\u8868\n        else {\n            for (int binCount = 0; ; ++binCount) {\n                if ((e = p.next) == null) {\n                    p.next = newNode(hash, key, value, null);\n                    if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                if (e.hash == hash &amp;&amp;\n                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))\n                    break;\n                p = e;\n            }\n        }\n        // \u5199\u5165\n        if (e != null) { // existing mapping for key\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // \u8d85\u8fc7load factor*current capacity\uff0cresize\n    if (++size &gt; threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n</code></pre> <p>\u4ece putVal \u65b9\u6cd5\u6700\u521d\u7684\u51e0\u884c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0\u51e0\u4e2a\u6709\u610f\u601d\u7684\u5730\u65b9: - \u5982\u679c\u8868\u683c\u662f null\uff0cresize \u65b9\u6cd5\u4f1a\u8d1f\u8d23\u521d\u59cb\u5316\u5b83\uff0c\u8fd9\u4ece tab = resize() \u53ef\u4ee5\u770b\u51fa\u3002 - resize \u65b9\u6cd5\u517c\u987e\u4e24\u4e2a\u804c\u8d23\uff0c\u521b\u5efa\u521d\u59cb\u5b58\u50a8\u8868\u683c\uff0c\u6216\u8005\u5728\u5bb9\u91cf\u4e0d\u6ee1\u8db3\u9700\u6c42\u7684\u65f6\u5019\uff0c\u8fdb\u884c\u6269\u5bb9 (resize)\u3002 - \u5728\u653e\u7f6e\u65b0\u7684\u952e\u503c\u5bf9\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u53d1\u751f\u4e0b\u9762\u6761\u4ef6\uff0c\u5c31\u4f1a\u53d1\u751f\u6269\u5bb9\u3002</p> <pre><code>    if (++size &gt; threshold)\n    resize();\n</code></pre> <ul> <li>\u5177\u4f53\u952e\u503c\u5bf9\u5728\u54c8\u5e0c\u8868\u4e2d\u7684\u4f4d\u7f6e(\u6570\u7ec4 index)\u53d6\u51b3\u4e8e\u4e0b\u9762\u7684\u4f4d\u8fd0\u7b97:</li> </ul> <pre><code>    i = (n - 1) &amp; hash\n</code></pre> <p>\u4ed4\u7ec6\u89c2\u5bdf\u54c8\u5e0c\u503c\u7684\u6e90\u5934\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5b83\u5e76\u4e0d\u662f key \u672c\u8eab\u7684 hashCode\uff0c\u800c\u662f\u6765\u81ea\u4e8e HashMap \u5185\u90e8\u7684\u53e6\u5916\u4e00\u4e2a hash \u65b9\u6cd5\u3002\u6ce8\u610f\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u91cc\u9700\u8981\u5c06\u9ad8\u4f4d\u6570\u636e\u79fb\u4f4d\u5230\u4f4e\u4f4d\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\u5462?\u8fd9\u662f\u56e0\u4e3a\u6709\u4e9b\u6570\u636e\u8ba1\u7b97\u51fa\u7684\u54c8\u5e0c\u503c\u5dee\u5f02\u4e3b\u8981\u5728\u9ad8\u4f4d\uff0c\u800c HashMap \u91cc\u7684\u54c8\u5e0c\u5bfb\u5740\u662f\u5ffd \u7565\u5bb9\u91cf\u4ee5\u4e0a\u7684\u9ad8\u4f4d\u7684\uff0c\u90a3\u4e48\u8fd9\u79cd\u5904\u7406\u5c31\u53ef\u4ee5\u6709\u6548\u907f\u514d\u7c7b\u4f3c\u60c5\u51b5\u4e0b\u7684\u54c8\u5e0c\u78b0\u649e\u3002</p> <pre><code>    static final int hash(Object kye) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt;16);\n    }\n</code></pre> <ul> <li>\u6211\u524d\u9762\u63d0\u5230\u7684\u94fe\u8868\u7ed3\u6784(\u8fd9\u91cc\u53eb bin)\uff0c\u4f1a\u5728\u8fbe\u5230\u4e00\u5b9a\u95e8\u9650\u503c\u65f6\uff0c\u53d1\u751f\u6811\u5316\uff0c\u6211\u7a0d\u540e\u4f1a\u5206\u6790 \u4e3a\u4ec0\u4e48 HashMap \u9700\u8981\u5bf9 bin \u8fdb\u884c\u5904\u7406\u3002</li> </ul> <p>\u53ef\u4ee5\u770b\u5230\uff0cputVal \u65b9\u6cd5\u672c\u8eab\u903b\u8f91\u975e\u5e38\u96c6\u4e2d\uff0c\u4ece\u521d\u59cb\u5316\u3001\u6269\u5bb9\u5230\u6811\u5316\uff0c\u5168\u90e8\u90fd\u548c\u5b83\u6709\u5173\u3002</p> <p>\u8fdb\u4e00\u6b65\u5206\u6790\u4e00\u4e0b\u8eab\u517c\u591a\u804c\u7684 resize \u65b9\u6cd5\uff0c\u5f88\u591a\u670b\u53cb\u90fd\u53cd\u9988\u7ecf\u5e38\u88ab\u9762\u8bd5\u5b98\u8ffd\u95ee\u5b83\u7684\u6e90\u7801\u8bbe\u8ba1\u3002</p> <pre><code>\nfinal Node&lt;K,V&gt;[] resize() {\n    // ...\n    else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACIY &amp;&amp;\n                oldCap &gt;= DEFAULT_INITIAL_CAPAITY)\n        newThr = oldThr &lt;&lt; 1; // double there\n       // ...\n    else if (oldThr &gt; 0) // initial capacity was placed in threshold\n        newCap = oldThr;\n    else {\n        // zero initial threshold signifies using defaultsfults newCap = DEFAULT_INITIAL_CAPAITY;\n        newThr = (int)(DEFAULT_LOAD_ATOR* DEFAULT_INITIAL_CAPACITY;\n    }\n    if (newThr ==0) {\n        float ft = (float)newCap * loadFator;\n        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?(int)ft : Intege\n    }\n    threshold = neThr;\n    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newap]; table = n;\n    // \u79fb\u52a8\u5230\u65b0\u7684\u6570\u7ec4\u7ed3\u6784 e \u6570\u7ec4\u7ed3\u6784 }\n</code></pre> <p>\u4f9d\u636e resize \u6e90\u7801\uff0c\u4e0d\u8003\u8651\u6781\u7aef\u60c5\u51b5(\u5bb9\u91cf\u7406\u8bba\u6700\u5927\u6781\u9650\u7531 MAXIMUM_CAPACITY \u6307\u5b9a\uff0c\u6570\u503c \u4e3a 1&lt;&lt;30\uff0c\u4e5f\u5c31\u662f 2 \u7684 30 \u6b21\u65b9)\uff0c\u6211\u4eec\u53ef\u4ee5\u5f52\u7eb3\u4e3a: - \u95e8\u9650\u503c\u7b49\u4e8e(\u8d1f\u8f7d\u56e0\u5b50)x(\u5bb9\u91cf)\uff0c\u5982\u679c\u6784\u5efa HashMap \u7684\u65f6\u5019\u6ca1\u6709\u6307\u5b9a\u5b83\u4eec\uff0c\u90a3\u4e48\u5c31\u662f\u4f9d \u636e\u76f8\u5e94\u7684\u9ed8\u8ba4\u5e38\u91cf\u503c\u3002 - \u95e8\u9650\u901a\u5e38\u662f\u4ee5\u500d\u6570\u8fdb\u884c\u8c03\u6574 (newThr = oldThr &lt;&lt; 1)\uff0c\u6211\u524d\u9762\u63d0\u5230\uff0c\u6839\u636e putVal \u4e2d\u7684\u903b \u8f91\uff0c\u5f53\u5143\u7d20\u4e2a\u6570\u8d85\u8fc7\u95e8\u9650\u5927\u5c0f\u65f6\uff0c\u5219\u8c03\u6574 Map \u5927\u5c0f\u3002 - \u6269\u5bb9\u540e\uff0c\u9700\u8981\u5c06\u8001\u7684\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u91cd\u65b0\u653e\u7f6e\u5230\u65b0\u7684\u6570\u7ec4\uff0c\u8fd9\u662f\u6269\u5bb9\u7684\u4e00\u4e2a\u4e3b\u8981\u5f00\u9500\u6765\u6e90\u3002</p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#_2","title":"\u5bb9\u91cf\u3001\u8d1f\u8f7d\u56e0\u5b50","text":"<p>\u524d\u9762\u6211\u4eec\u5feb\u901f\u68b3\u7406\u4e86\u4e00\u4e0b HashMap \u4ece\u521b\u5efa\u5230\u653e\u5165\u952e\u503c\u5bf9\u7684\u76f8\u5173\u903b\u8f91\uff0c\u73b0\u5728\u601d\u8003\u4e00\u4e0b\uff0c\u4e3a\u4ec0\u4e48 \u6211\u4eec\u9700\u8981\u5728\u4e4e\u5bb9\u91cf\u548c\u8d1f\u8f7d\u56e0\u5b50\u5462?</p> <p>\u8fd9\u662f\u56e0\u4e3a\u5bb9\u91cf\u548c\u8d1f\u8f7d\u7cfb\u6570\u51b3\u5b9a\u4e86\u53ef\u7528\u7684\u6876\u7684\u6570\u91cf\uff0c\u7a7a\u6876\u592a\u591a\u4f1a\u6d6a\u8d39\u7a7a\u95f4\uff0c\u5982\u679c\u4f7f\u7528\u7684\u592a\u6ee1\u5219\u4f1a\u4e25 \u91cd\u5f71\u54cd\u64cd\u4f5c\u7684\u6027\u80fd\u3002\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u5047\u8bbe\u53ea\u6709\u4e00\u4e2a\u6876\uff0c\u90a3\u4e48\u5b83\u5c31\u9000\u5316\u6210\u4e86\u94fe\u8868\uff0c\u5b8c\u5168\u4e0d\u80fd\u63d0\u4f9b\u6240\u8c13 \u5e38\u6570\u65f6\u95f4\u5b58\u50a8\u7684\u6027\u80fd\u3002 \u65e2\u7136\u5bb9\u91cf\u548c\u8d1f\u8f7d\u56e0\u5b50\u8fd9\u4e48\u91cd\u8981\uff0c\u6211\u4eec\u5728\u5b9e\u8df5\u4e2d\u5e94\u8be5\u5982\u4f55\u9009\u62e9\u5462?</p> <p>\u5982\u679c\u80fd\u591f\u77e5\u9053 HashMap \u8981\u5b58\u53d6\u7684\u952e\u503c\u5bf9\u6570\u91cf\uff0c\u53ef\u4ee5\u8003\u8651\u9884\u5148\u8bbe\u7f6e\u5408\u9002\u7684\u5bb9\u91cf\u5927\u5c0f\u3002\u5177\u4f53\u6570\u503c \u6211\u4eec\u53ef\u4ee5\u6839\u636e\u6269\u5bb9\u53d1\u751f\u7684\u6761\u4ef6\u6765\u505a\u7b80\u5355\u9884\u4f30\uff0c\u6839\u636e\u524d\u9762\u7684\u4ee3\u7801\u5206\u6790\uff0c\u6211\u4eec\u77e5\u9053\u5b83\u9700\u8981\u7b26\u5408\u8ba1\u7b97\u6761\u4ef6:</p> <p>\u8d1f\u8f7d\u56e0\u5b50 * \u5bb9\u91cf &gt; \u5143\u7d20\u6570\u91cf</p> <p>\u6240\u4ee5\uff0c\u9884\u5148\u8bbe\u7f6e\u7684\u5bb9\u91cf\u9700\u8981\u6ee1\u8db3\uff0c\u5927\u4e8e\u201c\u9884\u4f30\u5143\u7d20\u6570\u91cf / \u8d1f\u8f7d\u56e0\u5b50\u201d\uff0c\u540c\u65f6\u5b83\u662f 2 \u7684\u5e42\u6570\uff0c\u7ed3\u8bba\u5df2\u7ecf\u975e\u5e38\u6e05\u6670\u4e86\u3002</p> <p>\u800c\u5bf9\u4e8e\u8d1f\u8f7d\u56e0\u5b50\uff0c\u6211\u5efa\u8bae: - \u5982\u679c\u6ca1\u6709\u7279\u522b\u9700\u6c42\uff0c\u4e0d\u8981\u8f7b\u6613\u8fdb\u884c\u66f4\u6539\uff0c\u56e0\u4e3a JDK \u81ea\u8eab\u7684\u9ed8\u8ba4\u8d1f\u8f7d\u56e0\u5b50\u662f\u975e\u5e38\u7b26\u5408\u901a\u7528\u573a\u666f\u7684\u9700\u6c42\u7684\u3002</p> <ul> <li>\u5982\u679c\u786e\u5b9e\u9700\u8981\u8c03\u6574\uff0c\u5efa\u8bae\u4e0d\u8981\u8bbe\u7f6e\u8d85\u8fc7 0.75 \u7684\u6570\u503c\uff0c\u56e0\u4e3a\u4f1a\u663e\u8457\u589e\u52a0\u51b2\u7a81\uff0c\u964d\u4f4e HashMap \u7684\u6027\u80fd\u3002</li> <li>\u5982\u679c\u4f7f\u7528\u592a\u5c0f\u7684\u8d1f\u8f7d\u56e0\u5b50\uff0c\u6309\u7167\u4e0a\u9762\u7684\u516c\u5f0f\uff0c\u9884\u8bbe\u5bb9\u91cf\u503c\u4e5f\u8fdb\u884c\u8c03\u6574\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u52a0  \u9891\u7e41\u7684\u6269\u5bb9\uff0c\u589e\u52a0\u65e0\u8c13\u7684\u5f00\u9500\uff0c\u672c\u8eab\u8bbf\u95ee\u6027\u80fd\u4e5f\u4f1a\u53d7\u5f71\u54cd\u3002</li> </ul>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#_3","title":"\u6811\u5316\u6539\u9020","text":"<p>\u6211\u4eec\u524d\u9762\u63d0\u5230\u4e86\u6811\u5316\u6539\u9020\uff0c\u5bf9\u5e94\u903b\u8f91\u4e3b\u8981\u5728 putVal \u548c treeifyBin \u4e2d\u3002</p> <p>```java      final void treeifyBin(Node[] tab, int hash) {         int n, index; Node e;         if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)             resize();         else if ((e = tab[index = (n - 1) &amp; hash]) != null) {             // \u6811\u5316\u6539\u9020\u903b\u8f91          }     } <pre><code>\n\u4e0a\u9762\u662f\u7cbe\u7b80\u8fc7\u7684 treeifyBin \u793a\u610f\uff0c\u7efc\u5408\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c\u6811\u5316\u6539\u9020\u7684\u903b\u8f91\u5c31\u975e\u5e38\u6e05\u6670\u4e86\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\uff0c\u5f53 bin \u7684\u6570\u91cf\u5927\u4e8e TREEIFY_THRESHOLD \u65f6:\n- \u5982\u679c\u5bb9\u91cf\u5c0f\u4e8e MIN_TREEIFY_CAPACITY\uff0c\u53ea\u4f1a\u8fdb\u884c\u7b80\u5355\u7684\u6269\u5bb9\u3002\n- \u5982\u679c\u5bb9\u91cf\u5927\u4e8e MIN_TREEIFY_CAPACITY \uff0c\u5219\u4f1a\u8fdb\u884c\u6811\u5316\u6539\u9020\u3002 \n\n\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48 HashMap \u8981\u6811\u5316\u5462?\n\n\u672c\u8d28\u4e0a\u8fd9\u662f\u4e2a\u5b89\u5168\u95ee\u9898\u3002\u56e0\u4e3a\u5728\u5143\u7d20\u653e\u7f6e\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u54c8\u5e0c\u51b2\u7a81\uff0c\u90fd\u88ab\u653e\u7f6e\u5230\u540c\u4e00\u4e2a\u6876\n\u91cc\uff0c\u5219\u4f1a\u5f62\u6210\u4e00\u4e2a\u94fe\u8868\uff0c\u6211\u4eec\u77e5\u9053\u94fe\u8868\u67e5\u8be2\u662f\u7ebf\u6027\u7684\uff0c\u4f1a\u4e25\u91cd\u5f71\u54cd\u5b58\u53d6\u7684\u6027\u80fd\u3002\n\n### hash\u51fd\u6570\u7684\u5b9e\u73b0\n\u63a5\u7740\u6211\u4eec\u7740\u91cd\u6765\u770bhash\u51fd\u6570\u7684\u5b9e\u73b0\uff1a\n```java\n    static final int hash(Object kye) {\n        int h;\n        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt;16);\n    }\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u5b9e\u9645\u4e0a\u79f0\u4e3a\u201c\u6270\u52a8\u51fd\u6570\u201d\uff0cJava 8\u7684\u4ee3\u7801\u76f8\u5bf9Java 7\u662f\u505a\u8fc7\u7b80\u5316\u7684\uff0c\u4f46\u539f\u7406\u662f\u4e0d\u53d8\u7684\u3002</p> <p>\u6211\u4eec\u90fd\u77e5\u9053\u4e0a\u9762\u4ee3\u7801\u91cc\u7684key.hashCode()\u51fd\u6570\u8c03\u7528\u7684\u662fkey\u952e\u503c\u7c7b\u578b\u81ea\u5e26\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u8fd4\u56deint\u578b\u6563\u5217\u503c\u3002</p> <p>\u7406\u8bba\u4e0ahashCode\u662f\u4e00\u4e2aint\u503c\uff0c\u8fd9\u4e2aint\u503c\u8303\u56f4\u5728-2147483648\u548c2147483648\u4e4b\u95f4\uff0c\u5982\u679c\u76f4\u63a5\u62ff\u8fd9\u4e2ahashCode\u4f5c\u4e3aHashMap\u4e2d\u6570\u7ec4\u7684\u4e0b\u6807\u6765\u8bbf\u95ee\u7684\u8bdd\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u662f\u4e0d\u4f1a\u51fa\u73b0hash\u78b0\u649e\u7684\u3002 \u4f46\u662f\u8fd9\u6837\u7684\u8bdd\u4f1a\u5bfc\u81f4\u8fd9\u4e2aHashMap\u7684\u6570\u7ec4\u957f\u5ea6\u6bd4\u8f83\u957f\uff0c\u957f\u5ea6\u5927\u6982\u4e3a40\u4ebf\uff0c\u5185\u5b58\u80af\u5b9a\u662f\u653e\u4e0d\u4e0b\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u628a\u8fd9\u4e2ahashCode\u5bf9\u6570\u7ec4\u957f\u5ea6\u53d6\u4f59\uff0c\u7528\u5f97\u5230\u7684\u4f59\u6570\u6765\u8bbf\u95ee\u6570\u7ec4\u4e0b\u6807\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u770b\u5230HashMap\u4e2dget\u65b9\u6cd5\u548cput\u65b9\u6cd5\u90fd\u6709\u4e0b\u9762\u8fd9\u6837\u7684\u4ee3\u7801\uff1a</p> <pre><code>   tab[(n - 1) &amp; hash]\n</code></pre> <p>(n-1)&amp;hash\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e hash%n \u53d6\u4f59\u6570\uff0c\u4f46&amp;\u8ba1\u7b97\u901f\u5ea6\u66f4\u5feb\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4e3e\u4e2a\u4f8b\u5b50\uff1a \u4ee5\u521d\u59cb\u957f\u5ea6\u4e3a16\u4e3a\u4f8b\uff0c16-1=15\u30022\u8fdb\u5236\u8868\u793a\u662f00000000 00000000 00001111\u3002 \u6211\u4eec\u628a15\u548c\u67d0hashCode\u503c\u505a\u201c\u4e0e\u201d\u64cd\u4f5c\u5982\u4e0b\uff0c\u7ed3\u679c\u5c31\u662f\u622a\u53d6\u4e86\u6700\u4f4e\u7684\u56db\u4f4d\u503c\u3002</p> <pre><code>        10100101 11000100 00100101\n&amp;   00000000 00000000 00001111\n----------------------------------\n    00000000 00000000 00000101    //\u9ad8\u4f4d\u5168\u90e8\u5f52\u96f6\uff0c\u53ea\u4fdd\u7559\u672b\u56db\u4f4d\n</code></pre> <p>\u8fd9\u6837\u95ee\u9898\u5c31\u6765\u4e86\uff0c\u6211\u4eec\u5982\u679c\u53ea\u662f\u53d6\u4f4e\u4f4d\u7684\u60c5\u51b5\u4e0b\uff0c\u78b0\u649e\u5c31\u4f1a\u5f88\u4e25\u91cd\u3002</p> <p>\u8fd9\u65f6\u5019\u201c\u6270\u52a8\u51fd\u6570\u201d\u7684\u4ef7\u503c\u5c31\u4f53\u73b0\u51fa\u6765\u4e86\uff0c\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u5f20\u56fe\u7247\uff1a </p> <p>\u53f3\u4f4d\u79fb16\u4f4d\uff0c\u6b63\u597d\u662f32bit\u7684\u4e00\u534a\uff0c\u81ea\u5df1\u7684\u9ad8\u534a\u533a\u548c\u4f4e\u534a\u533a\u505a\u5f02\u6216\uff0c\u5c31\u662f\u4e3a\u4e86\u6df7\u5408\u539f\u59cb\u54c8\u5e0c\u7801\u7684\u9ad8\u4f4d\u548c\u4f4e\u4f4d\uff0c\u4ee5\u6b64\u6765\u52a0\u5927\u4f4e\u4f4d\u7684\u968f\u673a\u6027\u3002\u800c\u4e14\u6df7\u5408\u540e\u7684\u4f4e\u4f4d\u63ba\u6742\u4e86\u9ad8\u4f4d\u7684\u90e8\u5206\u7279\u5f81\uff0c\u8fd9\u6837\u9ad8\u4f4d\u7684\u4fe1\u606f\u4e5f\u88ab\u53d8\u76f8\u4fdd\u7559\u4e0b\u6765\u3002</p> <p>\u8fd9\u6837\u5927\u591a\u6570\u7684hashCode\u7684\u5206\u5e03\u5df2\u7ecf\u5f88\u4e0d\u9519\u4e86\uff0c\u5c31\u7b97\u662f\u53d1\u751f\u4e86\u78b0\u649e\u4e5f\u7528O(logn)\u7684tree\u53bb\u505a\u4e86\u3002\u4ec5\u4ec5\u5f02\u6216\u4e00\u4e0b\uff0c\u65e2\u51cf\u5c11\u4e86\u7cfb\u7edf\u7684\u5f00\u9500\uff0c\u4e5f\u4e0d\u4f1a\u9020\u6210\u7684\u56e0\u4e3a\u9ad8\u4f4d\u6ca1\u6709\u53c2\u4e0e\u4e0b\u6807\u7684\u8ba1\u7b97(table\u957f\u5ea6\u6bd4\u8f83\u5c0f\u65f6)\uff0c\u4ece\u800c\u5f15\u8d77\u7684\u78b0\u649e\u3002</p> <p>\u4ee5\u4e0a\u5c31\u662f\u5173\u4e8eHashMap\u4e2dhash\u51fd\u6570\u8bbe\u8ba1\u7684\u539f\u7406\u3002</p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#resize","title":"resize\u7684\u5b9e\u73b0\u539f\u7406","text":"<p>\u5f53put\u65f6\uff0c\u5982\u679c\u53d1\u73b0\u76ee\u524d\u7684bucket\u5360\u7528\u7a0b\u5ea6\u5df2\u7ecf\u8d85\u8fc7\u4e86Load Factor\u6240\u5e0c\u671b\u7684\u6bd4\u4f8b\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d1\u751fresize\u3002\u5728resize\u7684\u8fc7\u7a0b\uff0c\u7b80\u5355\u7684\u8bf4\u5c31\u662f\u628abucket\u6269\u5145\u4e3a2\u500d\uff0c\u4e4b\u540e\u91cd\u65b0\u8ba1\u7b97index\uff0c\u628a\u8282\u70b9\u518d\u653e\u5230\u65b0\u7684bucket\u4e2d\u3002resize\u7684\u6ce8\u91ca\u662f\u8fd9\u6837\u63cf\u8ff0\u7684\uff1a</p> <p>Initializes or doubles table size. If null, allocates in accord with initial capacity target held in field threshold. Otherwise, because we are using power-of-two expansion, the elements from each bin must either stay at same index, or move with a power of two offset in the new table.</p> <p>\u5927\u81f4\u610f\u601d\u5c31\u662f\u8bf4\uff0c\u5f53\u8d85\u8fc7\u9650\u5236\u7684\u65f6\u5019\u4f1aresize\uff0c\u7136\u800c\u53c8\u56e0\u4e3a\u6211\u4eec\u4f7f\u7528\u7684\u662f2\u6b21\u5e42\u7684\u6269\u5c55(\u6307\u957f\u5ea6\u6269\u4e3a\u539f\u67652\u500d)\uff0c\u6240\u4ee5\uff0c\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\uff0c\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\u518d\u79fb\u52a82\u6b21\u5e42\u7684\u4f4d\u7f6e\u3002</p> <p></p> <p>\u6211\u4eec\u6765\u4e0a\u9762\u8fd9\u5f20\u56fe\uff0cn\u4e3atable\u7684\u957f\u5ea6\uff0c\u56fe\uff08a\uff09\u8868\u793a\u6269\u5bb9\u524d\u7684key1\u548ckey2\u4e24\u79cdkey\u786e\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u7684\u793a\u4f8b\uff0c\u56fe\uff08b\uff09\u8868\u793a\u6269\u5bb9\u540ekey1\u548ckey2\u4e24\u79cdkey\u786e\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u7684\u793a\u4f8b\uff0c\u5176\u4e2dhash1\u662fkey1\u5bf9\u5e94\u7684\u54c8\u5e0c\u503c(\u4e5f\u5c31\u662f\u6839\u636ekey1\u7b97\u51fa\u6765\u7684hashcode\u503c)\u4e0e\u9ad8\u4f4d\u4e0e\u8fd0\u7b97\u7684\u7ed3\u679c\u3002</p> <p>\u5143\u7d20\u5728\u91cd\u65b0\u8ba1\u7b97hash\u4e4b\u540e\uff0c\u56e0\u4e3an\u53d8\u4e3a2\u500d\uff0c\u90a3\u4e48n-1\u7684mask\u8303\u56f4\u5728\u9ad8\u4f4d\u591a1bit(\u7ea2\u8272)\uff0c\u56e0\u6b64\u65b0\u7684index\u5c31\u4f1a\u53d1\u751f\u8fd9\u6837\u7684\u53d8\u5316\uff1a </p> <p>\u8fd9\u6837\u6211\u4eecresize\u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u50cfJDK1.7\u7684\u5b9e\u73b0\u90a3\u6837\u91cd\u65b0\u8ba1\u7b97hash\uff0c\u53ea\u9700\u8981\u770b\u770b\u539f\u6765\u7684hash\u503c\u65b0\u589e\u7684\u90a3\u4e2abit\u662f1\u8fd8\u662f0\u5c31\u597d\u4e86\uff0c\u662f0\u7684\u8bdd\u7d22\u5f15\u6ca1\u53d8\uff0c\u662f1\u7684\u8bdd\u7d22\u5f15\u53d8\u6210\u201c\u539f\u7d22\u5f15+oldCap\u3002</p> <p>\u8fd9\u4e2a\u5c31\u662fresize\u8bbe\u8ba1\u5de7\u5999\u7684\u5730\u65b9\uff0c\u5728\u6269\u5bb9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u91cd\u65b0\u53bb\u8ba1\u7b97hash\u7684\u503c\uff0c\u5143\u7d20\u7684\u4f4d\u7f6e\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\uff0c\u8981\u4e48\u662f\u5728\u539f\u4f4d\u7f6e\u518d\u79fb\u52a82\u6b21\u5e42\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"Java/%E5%85%B3%E4%BA%8EHashMap%E4%BD%A0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BB%86%E8%8A%82/#_4","title":"\u53c2\u8003\u6587\u7ae0","text":"<p>Java HashMap\u5de5\u4f5c\u539f\u7406\u53ca\u5b9e\u73b0</p> <p>HashMap \u7684 hash \u65b9\u6cd5\u539f\u7406</p> <p>HashMap\u7684\u6269\u5bb9\u673a\u5236</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/","title":"\u6211\u753b\u4e86\u8fd1\u767e\u5f20\u56fe\u6765\u7406\u89e3\u7ea2\u9ed1\u6811","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c\u6211\u753b\u4e86\u8fd1\u767e\u5f20\u56fe\u6765\u7406\u89e3\u7ea2\u9ed1\u6811,\u6587\u7ae0\u7565\u6709\u4fee\u6539\u3002</p> <p>\u4e4b\u524d\u5728\u516c\u53f8\u7ec4\u5185\u5206\u4eab\u4e86\u7ea2\u9ed1\u6811\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4eca\u5929\u628a\u5b83\u6574\u7406\u4e0b\u53d1\u51fa\u6765\uff0c\u5e0c\u671b\u80fd\u5bf9\u5927\u5bb6\u6709\u6240\u5e2e\u52a9\uff0c\u5bf9\u81ea\u5df1\u4e5f\u7b97\u662f\u4e00\u4e2a\u77e5\u8bc6\u70b9\u7684\u603b\u7ed3\u3002</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u7b97\u662f\u6211\u5199\u535a\u5ba2\u5199\u516c\u4f17\u53f7\u4ee5\u6765\u753b\u56fe\u6700\u591a\u7684\u4e00\u7bc7\u6587\u7ae0\u4e86\uff0c\u6ca1\u6709\u4e4b\u4e00\uff0c\u6211\u5e0c\u671b\u5c3d\u53ef\u80fd\u591a\u5730\u7528\u56fe\u7247\u6765\u5f62\u8c61\u5730\u63cf\u8ff0\u7ea2\u9ed1\u6811\u7684\u5404\u79cd\u64cd\u4f5c\u7684\u524d\u540e\u53d8\u6362\u539f\u7406\uff0c\u5e2e\u52a9\u5927\u5bb6\u6765\u7406\u89e3\u7ea2\u9ed1\u6811\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4e0b\u9762\uff0c\u591a\u56fe\u9884\u8b66\u5f00\u59cb\u4e86\u3002</p> <p>\u5728\u8bb2\u7ea2\u9ed1\u6811\u4e4b\u524d\uff0c\u6211\u4eec\u9996\u5148\u6765\u4e86\u89e3\u4e0b\u4e0b\u9762\u51e0\u4e2a\u6982\u5ff5\uff1a\u4e8c\u53c9\u6811\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u4ee5\u53ca\u5e73\u8861\u4e8c\u53c9\u6811\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_1","title":"\u4e8c\u53c9\u6811","text":"<p>\u4e8c\u53c9\u6811\u6307\u7684\u662f\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u53ea\u80fd\u6709\u4e24\u4e2a\u5b57\u6570\u7684\u6709\u5e8f\u6811\u3002\u901a\u5e38\u5de6\u8fb9\u7684\u5b50\u6811\u79f0\u4e3a<code>\u5de6\u5b50\u6811</code> \uff0c\u53f3\u8fb9\u7684\u5b50\u6811\u79f0\u4e3a<code>\u53f3\u5b50\u6811</code> \u3002\u8fd9\u91cc\u8bf4\u7684\u6709\u5e8f\u6811\u5f3a\u8c03\u7684\u662f\u4e8c\u53c9\u6811\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u6b21\u5e8f\u4e0d\u80fd\u968f\u610f\u98a0\u5012\u3002</p> <p>\u4e8c\u53c9\u6811\u7b80\u5355\u7684\u793a\u610f\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u4ee3\u7801\u5b9a\u4e49\uff1a</p> <pre><code>class Node {\n    T data;\n    Node left;\n    Node right;\n}\n</code></pre>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_2","title":"\u6392\u5e8f\u4e8c\u53c9\u6811","text":"<p>\u6240\u8c13\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u987e\u540d\u601d\u4e49\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u662f\u6709\u987a\u5e8f\u7684\uff0c\u5b83\u662f\u4e00\u79cd\u7279\u6b8a\u7ed3\u6784\u7684\u4e8c\u53c9\u6811\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6811\u4e2d\u6240\u6709\u8282\u70b9\u8fdb\u884c\u6392\u5e8f\u548c\u68c0\u7d22\u3002</p> <p>\u6027\u8d28 * \u82e5\u5b83\u7684\u5de6\u5b50\u6811\u4e0d\u7a7a\uff0c\u5219\u5de6\u5b50\u6811\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u5747\u5c0f\u4e8e\u5b83\u7684\u6839\u8282\u70b9\u7684\u503c\uff1b * \u82e5\u5979\u7684\u53f3\u5b50\u6811\u4e0d\u7a7a\uff0c\u5219\u53f3\u5b50\u6811\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u5747\u5927\u4e8e\u5b83\u7684\u6839\u8282\u70b9\u7684\u503c\uff1b * \u5177\u6709\u9012\u5f52\u6027\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u7684\u5de6\u5b50\u6811\u3001\u53f3\u5b50\u6811\u4e5f\u662f\u6392\u5e8f\u4e8c\u53c9\u6811\u3002</p> <p>\u6392\u5e8f\u4e8c\u53c9\u6811\u7b80\u5355\u793a\u610f\u56fe\uff1a</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_3","title":"\u6392\u5e8f\u4e8c\u53c9\u6811\u9000\u5316\u6210\u94fe\u8868","text":"<p>\u6392\u5e8f\u4e8c\u53c9\u6811\u7684\u5de6\u5b50\u6811\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u5c0f\u4e8e\u6839\u8282\u70b9\u7684\u503c\uff0c\u53f3\u5b50\u6811\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u5927\u4e8e\u6839\u8282\u70b9\u7684\u503c\uff0c\u5f53\u6211\u4eec\u63d2\u5165\u4e00\u7ec4\u5143\u7d20\u6b63\u597d\u662f\u6709\u5e8f\u7684\u65f6\u5019\uff0c\u8fd9\u65f6\u4f1a\u8ba9\u6392\u5e8f\u4e8c\u53c9\u6811\u9000\u5316\u6210\u94fe\u8868\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u662f\u5982\u4e0b\u56fe\u8fd9\u6837\u7684\uff1a </p> <p>\u4f46\u662f\uff0c\u5f53\u63d2\u5165\u7684\u4e00\u7ec4\u5143\u7d20\u6b63\u597d\u662f\u6709\u5e8f\u7684\u65f6\u5019\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u5c31\u53d8\u6210\u4e86\u4e0b\u8fb9\u8fd9\u6837\u4e86\uff0c\u5c31\u53d8\u6210\u4e86\u666e\u901a\u7684\u94fe\u8868\u7ed3\u6784\uff0c\u5982\u4e0b\u56fe\u6240\u793a: </p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u6392\u5e8f\u4e8c\u53c9\u6811\u68c0\u7d22\u6548\u7387\u7c7b\u4f3c\u4e8e\u4e8c\u5206\u67e5\u627e\uff0c\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(log n)\uff0c\u4f46\u662f\u5982\u679c\u6392\u5e8f\u4e8c\u53c9\u6811\u9000\u5316\u6210\u94fe\u8868\u7ed3\u6784\uff0c\u90a3\u4e48\u68c0\u7d22\u6548\u7387\u5c31\u53d8\u6210\u4e86\u7ebf\u6027\u7684 O(n) \u7684\uff0c\u8fd9\u6837\u76f8\u5bf9\u4e8e O(log n) \u6765\u8bf4\uff0c\u68c0\u7d22\u6548\u7387\u80af\u5b9a\u662f\u8981\u5dee\u4e0d\u5c11\u7684\u3002</p> <p>\u601d\u8003\uff0c\u4e8c\u5206\u67e5\u627e\u548c\u6b63\u5e38\u7684\u6392\u5e8f\u4e8c\u53c9\u6811\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f O(log n)\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u662fO(log n) \uff1f</p> <p>\u5173\u4e8e O(log n) \u7684\u5206\u6790\u4e0b\u9762\u8fd9\u7bc7\u6587\u7ae0\u8bb2\u89e3\u7684\u975e\u5e38\u597d\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u4e0b\u8fd9\u7bc7\u6587\u7ae0 \u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6587\u7ae0\u662f\u62ff\u4e8c\u5206\u67e5\u627e\u6765\u4e3e\u4f8b\u7684\uff0c\u4e8c\u5206\u67e5\u627e\u548c\u5e73\u8861\u4e8c\u53c9\u6811\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e00\u6837\u7684\uff0c\u7406\u89e3\u4e86\u4e8c\u5206\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u518d\u6765\u7406\u89e3\u5e73\u8861\u4e8c\u53c9\u6811\u5c31\u4e0d\u96be\u4e86\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002</p> <p>\u7ee7\u7eed\u56de\u5230\u6211\u4eec\u7684\u4e3b\u9898\u4e0a\uff0c\u4e3a\u4e86\u89e3\u51b3\u6392\u5e8f\u4e8c\u53c9\u6811\u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\u4f1a\u9000\u5316\u6210\u94fe\u8868\u7684\u95ee\u9898\uff08\u94fe\u8868\u7684\u68c0\u7d22\u6548\u7387\u662f O(n) \u76f8\u5bf9\u6b63\u5e38\u4e8c\u53c9\u6811\u6765\u8bf4\u8981\u5dee\u4e0d\u5c11\uff09\uff0c\u6240\u4ee5\u6709\u4eba\u53d1\u660e\u4e86<code>\u5e73\u8861\u4e8c\u53c9\u6811</code>\u548c<code>\u7ea2\u9ed1\u6811</code>\u7c7b\u4f3c\u7684\u5e73\u8861\u6811\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_4","title":"\u5e73\u8861\u4e8c\u53c9\u6811","text":"<p>\u5e73\u8861\u4e8c\u53c9\u6570\u53c8\u88ab\u79f0\u4e3a AVL \u6811\uff0cAVL \u6811\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5b83\u7684\u53d1\u660e\u4f5c\u8005 G.M. Adelson-Velsky \u548c E.M. Landis\uff0c\u53d6\u81ea\u4e24\u4eba\u540d\u5b57\u7684\u9996\u5b57\u6bcd\u3002</p> <p>\u5b98\u65b9\u5b9a\u4e49\uff1a\u5b83\u6216\u8005\u662f\u4e00\u9897\u7a7a\u6811\uff0c\u6216\u8005\u5177\u6709\u4ee5\u4e0b\u6027\u8d28\u7684\u6392\u5e8f\u4e8c\u53c9\u6811\uff1a\u5b83\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u6df1\u5ea6\u4e4b\u5dee(\u5e73\u8861\u56e0\u5b50)\u7684\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc71\uff0c\u4e14\u5b83\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u90fd\u662f\u4e00\u9897\u5e73\u8861\u4e8c\u53c9\u6811\u3002</p> <p>\u4e24\u4e2a\u6761\u4ef6\uff1a * \u5e73\u8861\u4e8c\u53c9\u6811\u5fc5\u987b\u662f\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u4e5f\u5c31\u662f\u8bf4\u5e73\u8861\u4e8c\u53c9\u6811\u4ed6\u7684\u5de6\u5b50\u6811\u6240\u6709\u8282\u70b9\u7684\u503c\u5fc5\u987b\u5c0f\u4e8e\u6839\u8282\u70b9\u7684\u503c\uff0c\u5b83\u7684\u53f3\u5b50\u6811\u4e0a\u6240\u6709\u8282\u70b9\u7684\u503c\u5fc5\u987b\u5927\u4e8e\u5b83\u7684\u6839\u8282\u70b9\u7684\u503c\u3002 * \u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u6df1\u5ea6\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc71\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_5","title":"\u7ea2\u9ed1\u6811","text":"<p>\u8bb2\u4e86\u8fd9\u4e48\u591a\u6982\u5ff5\uff0c\u63a5\u4e0b\u6765\u4e3b\u89d2\u7ea2\u9ed1\u6811\u7ec8\u4e8e\u8981\u4e0a\u573a\u4e86\u3002</p> <p>\u4e3a\u4ec0\u4e48\u6709\u7ea2\u9ed1\u6811\uff1f</p> <p>\u5176\u5b9e\u7ea2\u9ed1\u6811\u548c\u4e0a\u9762\u7684\u5e73\u8861\u4e8c\u53c9\u6811\u7c7b\u4f3c\uff0c\u672c\u8d28\u4e0a\u90fd\u662f\u4e3a\u4e86\u89e3\u51b3\u6392\u5e8f\u4e8c\u53c9\u6811\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\u9000\u5316\u6210\u94fe\u8868\u5bfc\u81f4\u68c0\u7d22\u6548\u7387\u5927\u5927\u964d\u4f4e\u7684\u95ee\u9898\uff0c\u7ea2\u9ed1\u6811\u6700\u65e9\u662f\u7531 Rudolf Bayer \u4e8e 1972 \u5e74\u53d1\u660e\u7684\u3002</p> <p>\u7ea2\u9ed1\u6811\u9996\u5148\u80af\u5b9a\u662f\u4e00\u4e2a\u6392\u5e8f\u4e8c\u53c9\u6811\uff0c\u5b83\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u589e\u52a0\u4e86\u4e00\u4e2a\u5b58\u50a8\u4f4d\u6765\u8868\u793a\u8282\u70b9\u7684\u989c\u8272\uff0c\u53ef\u4ee5\u662f RED \u6216 BLACK \u3002</p> <p>Java \u4e2d\u5b9e\u73b0\u7ea2\u9ed1\u6811\u5927\u6982\u7ed3\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_6","title":"\u7ea2\u9ed1\u6811\u7684\u7279\u6027","text":"<ul> <li>\u6027\u8d281\uff1a\u6bcf\u4e2a\u8282\u70b9\u8981\u4e48\u662f\u7ea2\u8272\uff0c\u8981\u4e48\u662f\u9ed1\u8272\u3002</li> <li>\u6027\u8d282\uff1a\u6839\u8282\u70b9\u6c38\u8fdc\u662f\u9ed1\u8272\u7684\u3002</li> <li>\u6027\u8d283\uff1a\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u7a7a\u8282\u70b9\uff08\u5373null\uff09\uff0c\u5e76\u4e14\u662f\u9ed1\u8272\u7684\u3002</li> <li>\u6027\u8d284\uff1a\u6bcf\u4e2a\u7ea2\u8272\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\u3002\uff08\u4ece\u6bcf\u4e2a\u53f6\u5b50\u5230\u6839\u7684\u8def\u5f84\u4e0a\u4e0d\u4f1a\u6709\u4e24\u4e2a\u8fde\u7eed\u7684\u7ea2\u8272\u8282\u70b9\u3002\uff09</li> <li>\u6027\u8d285\uff1a\u4ece\u4efb\u4e00\u8282\u70b9\u5230\u5176\u5b50\u6811\u4e2d\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u8def\u5f84\u90fd\u5305\u542b\u76f8\u540c\u6570\u91cf\u7684\u9ed1\u8272\u8282\u70b9\u3002</li> </ul> <p>\u9488\u5bf9\u4e0a\u9762\u7684 5 \u79cd\u6027\u8d28\uff0c\u6211\u4eec\u7b80\u5355\u7406\u89e3\u4e0b\uff0c\u5bf9\u4e8e\u6027\u8d28 1 \u548c\u6027\u8d28 2 \uff0c\u76f8\u5f53\u4e8e\u662f\u5bf9\u7ea2\u9ed1\u6811\u6bcf\u4e2a\u8282\u70b9\u7684\u7ea6\u675f\uff0c\u6839\u8282\u70b9\u662f\u9ed1\u8272\uff0c\u5176\u4ed6\u7684\u8282\u70b9\u8981\u4e48\u662f\u7ea2\u8272\uff0c\u8981\u4e48\u662f\u9ed1\u8272\u3002</p> <p>\u5bf9\u4e8e\u6027\u8d28 3 \u4e2d\u6307\u5b9a\u7ea2\u9ed1\u6811\u7684\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u7a7a\u8282\u70b9\uff0c\u800c\u4e14\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u9ed1\u8272\uff0c\u4f46 Java \u5b9e\u73b0\u7684\u7ea2\u9ed1\u6811\u4f1a\u4f7f\u7528 null \u6765\u4ee3\u8868\u7a7a\u8282\u70b9\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u904d\u5386 Java\u91cc\u7684\u7ea2\u9ed1\u6811\u7684\u65f6\u5019\u4f1a\u770b\u4e0d\u5230\u53f6\u5b50\u8282\u70b9\uff0c\u800c\u770b\u5230\u7684\u662f\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u90fd\u662f\u7ea2\u8272\u7684\uff0c\u8fd9\u4e00\u70b9\u9700\u8981\u6ce8\u610f\u3002</p> <p>\u5bf9\u4e8e\u6027\u8d28 5\uff0c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u7684\u63cf\u8ff0\u662f\u4ece\u4efb\u4e00\u8282\u70b9\uff0c\u4ece\u4efb\u4e00\u8282\u70b9\u5230\u5b83\u7684\u5b50\u6811\u7684\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u9ed1\u8272\u8282\u70b9\u7684\u6570\u91cf\u90fd\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u4e2a\u6570\u91cf\u88ab\u79f0\u4e3a\u8fd9\u4e2a\u8282\u70b9\u7684\u9ed1\u9ad8\u3002</p> <p>\u5982\u679c\u6211\u4eec\u4ece\u6839\u8282\u70b9\u51fa\u53d1\u5230\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u8def\u5f84\u90fd\u5305\u542b\u76f8\u540c\u6570\u91cf\u7684\u9ed1\u8272\u8282\u70b9\uff0c\u8fd9\u4e2a\u9ed1\u8272\u8282\u70b9\u7684\u6570\u91cf\u88ab\u79f0\u4e3a\u6811\u7684\u9ed1\u8272\u9ad8\u5ea6\u3002\u6811\u7684\u9ed1\u8272\u9ad8\u5ea6\u548c\u8282\u70b9\u7684\u9ed1\u8272\u9ad8\u5ea6\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\u533a\u5206\u3002</p> <p>\u5176\u5b9e\u5230\u8fd9\u91cc\u6709\u4eba\u53ef\u80fd\u4f1a\u95ee\u4e86\uff0c\u7ea2\u9ed1\u6811\u7684\u6027\u8d28\u8bf4\u4e86\u4e00\u5927\u5806\uff0c\u90a3\u662f\u4e0d\u662f\u8bf4\u53ea\u8981\u4fdd\u8bc1\u7ea2\u9ed1\u6811\u7684\u8282\u70b9\u662f\u7ea2\u9ed1\u4ea4\u66ff\u5c31\u80fd\u4fdd\u8bc1\u6811\u662f\u5e73\u8861\u7684\u5462\uff1f</p> <p>\u5176\u5b9e\u4e0d\u662f\u8fd9\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u6765\u770b\u4e0b\u9762\u8fd9\u5f20\u56fe\uff1a</p> <p></p> <p>\u5de6\u8fb9\u7684\u5b50\u6811\u90fd\u662f\u9ed1\u8272\u8282\u70b9\uff0c\u4f46\u662f\u8fd9\u4e2a\u7ea2\u9ed1\u6811\u4f9d\u7136\u662f\u5e73\u8861\u7684\uff0c5 \u6761\u6027\u8d28\u5b83\u90fd\u6ee1\u8db3\u3002</p> <p>\u8fd9\u4e2a\u6811\u7684\u9ed1\u8272\u9ad8\u5ea6\u4e3a 3\uff0c\u4ece\u6839\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u662f 2\uff0c\u8be5\u8def\u5f84\u4e0a\u5168\u662f\u9ed1\u8272\u8282\u70b9\uff0c\u5305\u62ec\u53f6\u5b50\u8282\u70b9\uff0c\u4ece\u6839\u8282\u70b9\u5230\u53f6\u5b50\u8282\u70b9\u6700\u957f\u8def\u5f84\u4e3a 4\uff0c\u6bcf\u4e2a\u9ed1\u8272\u8282\u70b9\u4e4b\u95f4\u4f1a\u63d2\u5165\u7ea2\u8272\u8282\u70b9\u3002</p> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u6027\u8d28 4 \u548c\u6027\u8d28 5\uff0c\u5176\u5b9e\u4e0a\u4fdd\u8bc1\u4e86\u6ca1\u6709\u4efb\u4f55\u4e00\u6761\u8def\u5f84\u4f1a\u6bd4\u5176\u4ed6\u8def\u5f84\u957f\u51fa\u4e24\u500d\uff0c\u6240\u4ee5\u8fd9\u6837\u7684\u7ea2\u9ed1\u6811\u662f\u5e73\u8861\u7684\u3002</p> <p>\u5176\u5b9e\u8fd9\u7b97\u662f\u4e00\u4e2a\u63a8\u8bba\uff0c\u7ea2\u9ed1\u6811\u5728\u6700\u5dee\u60c5\u51b5\u4e0b\uff0c\u6700\u957f\u7684\u8def\u5f84\u90fd\u4e0d\u4f1a\u6bd4\u6700\u77ed\u7684\u8def\u5f84\u957f\u51fa\u4e24\u500d\u3002\u5176\u5b9e\u7ea2\u9ed1\u6811\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u5b83\u53ea\u80fd\u4fdd\u8bc1\u5927\u81f4\u662f\u5e73\u8861\u7684\uff0c\u56e0\u4e3a\u7ea2\u9ed1\u6811\u7684\u9ad8\u5ea6\u4e0d\u4f1a\u65e0\u9650\u589e\u9ad8\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u7528\uff0c\u7ea2\u9ed1\u6811\u7684\u7edf\u8ba1\u6027\u80fd\u8981\u9ad8\u4e8e\u5e73\u8861\u4e8c\u53c9\u6811\uff0c\u4f46\u6781\u7aef\u6027\u80fd\u7565\u5dee\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_7","title":"\u7ea2\u9ed1\u6811\u7684\u63d2\u5165","text":"<p>\u60f3\u8981\u5f7b\u5e95\u7406\u89e3\u7ea2\u9ed1\u6811\uff0c\u9664\u4e86\u4e0a\u9762\u8bf4\u5230\u7684\u7406\u89e3\u7ea2\u9ed1\u6811\u7684\u6027\u8d28\u4ee5\u5916\uff0c\u5c31\u662f\u7406\u89e3\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u64cd\u4f5c\u4e86\u3002</p> <p>\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u548c\u666e\u901a\u6392\u5e8f\u4e8c\u53c9\u6811\u7684\u63d2\u5165\u57fa\u672c\u4e00\u81f4\uff0c\u6392\u5e8f\u4e8c\u53c9\u6811\u7684\u8981\u6c42\u662f\u5de6\u5b50\u6811\u4e0a\u7684\u6240\u6709\u8282\u70b9\u90fd\u8981\u6bd4\u6839\u8282\u70b9\u5c0f\uff0c\u53f3\u5b50\u6811\u4e0a\u7684\u6240\u6709\u8282\u70b9\u90fd\u8981\u6bd4\u8ddf\u8282\u70b9\u5927\uff0c\u5f53\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\u7684\u65f6\u5019\uff0c\u9996\u5148\u8981\u627e\u5230\u5f53\u524d\u8981\u63d2\u5165\u7684\u8282\u70b9\u9002\u5408\u653e\u5728\u6392\u5e8f\u4e8c\u53c9\u6811\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u63d2\u5165\u5f53\u524d\u8282\u70b9\u5373\u53ef\u3002\u7ea2\u9ed1\u6811\u548c\u6392\u5e8f\u4e8c\u53c9\u6811\u4e0d\u540c\u7684\u662f\uff0c\u7ea2\u9ed1\u6811\u9700\u8981\u5728\u63d2\u5165\u8282\u70b9\u8c03\u6574\u6811\u7684\u7ed3\u6784\u6765\u8ba9\u6811\u4fdd\u6301\u5e73\u8861\u3002</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7ea2\u9ed1\u6811\u4e2d\u65b0\u63d2\u5165\u7684\u8282\u70b9\u90fd\u662f\u7ea2\u8272\u7684\uff0c\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u8bf4\u65b0\u52a0\u5165\u5230\u7ea2\u9ed1\u6811\u4e2d\u7684\u8282\u70b9\u8981\u662f\u7ea2\u8272\u7684\u5462\uff1f</p> <p>\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff0c\u6211\u4eec\u4ece\u6027\u8d285\u4e2d\u77e5\u9053\uff0c\u5f53\u524d\u7ea2\u9ed1\u6811\u4e2d\u4ece\u6839\u8282\u70b9\u5230\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u9ed1\u8272\u8282\u70b9\u6570\u91cf\u662f\u4e00\u6837\u7684\uff0c\u6b64\u65f6\u5047\u5982\u65b0\u7684\u9ed1\u8272\u8282\u70b9\u7684\u8bdd\uff0c\u5fc5\u7136\u7834\u574f\u89c4\u5219\uff0c\u4f46\u52a0\u5165\u7ea2\u8272\u8282\u70b9\u5374\u4e0d\u4e00\u5b9a\uff0c\u9664\u975e\u5176\u7236\u8282\u70b9\u5c31\u662f\u7ea2\u8272\u8282\u70b9\uff0c\u56e0\u6b64\u52a0\u5165\u7ea2\u8272\u8282\u70b9\uff0c\u7834\u574f\u89c4\u5219\u7684\u53ef\u80fd\u6027\u5c0f\u4e00\u4e9b\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u91cd\u70b9\u6765\u8bb2\u7ea2\u9ed1\u6811\u63d2\u5165\u65b0\u8282\u70b9\u540e\u662f\u5982\u4f55\u4fdd\u6301\u5e73\u8861\u7684\u3002</p> <p>\u7ed9\u5b9a\u4e0b\u9762\u8fd9\u6837\u4e00\u9897\u7ea2\u9ed1\u6811\uff1a</p> <p></p> <p>\u5f53\u6211\u4eec\u63d2\u5165\u503c\u4e3a66\u7684\u8282\u70b9\u7684\u65f6\u5019\uff0c\u793a\u610f\u56fe\u5982\u4e0b\uff1a</p> <p></p> <p>\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u65f6\u5019\u7ed3\u6784\u4f9d\u7136\u9075\u5faa\u7740\u4e0a\u8ff05\u5927\u7279\u6027\uff0c\u65e0\u9700\u542f\u52a8\u81ea\u52a8\u5e73\u8861\u673a\u5236\u8c03\u6574\u8282\u70b9\u5e73\u8861\u72b6\u6001\u3002</p> <p>\u5982\u679c\u518d\u5411\u91cc\u9762\u63d2\u5165\u503c\u4e3a51\u7684\u8282\u70b9\u5462\uff0c\u8fd9\u4e2a\u65f6\u5019\u7ea2\u9ed1\u6811\u53d8\u6210\u4e86\u8fd9\u6837\u3002</p> <p></p> <p>\u8fd9\u6837\u7684\u7ed3\u6784\u5b9e\u9645\u4e0a\u662f\u4e0d\u6ee1\u8db3\u6027\u8d284\u7684\uff0c\u7ea2\u8272\u4e24\u4e2a\u5b50\u8282\u70b9\u5fc5\u987b\u662f\u9ed1\u8272\u7684\uff0c\u800c\u8fd9\u91cc49\u8fd9\u4e2a\u7ea2\u8272\u8282\u70b9\u73b0\u5728\u6709\u4e2a51\u7684\u7ea2\u8272\u8282\u70b9\u4e0e\u5176\u76f8\u8fde\u3002</p> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u9700\u8981\u8c03\u6574\u8fd9\u4e2a\u6811\u7684\u7ed3\u6784\u6765\u4fdd\u8bc1\u7ea2\u9ed1\u6811\u7684\u5e73\u8861\u3002</p> <p>\u9996\u5148\u5c1d\u8bd5\u5c0649\u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u5982\u4e0b\u793a\u610f\u56fe\u3002</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53d1\u73b0\u9ed1\u9ad8\u662f\u4e0d\u5bf9\u7684\uff0c\u5176\u4e2d 60-56-45-49-51-null \u8fd9\u6761\u8def\u5f84\u6709 4 \u4e2a\u9ed1\u8282\u70b9\uff0c\u5176\u4ed6\u8def\u5f84\u7684\u9ed1\u8272\u8282\u70b9\u662f 3 \u4e2a\u3002</p> <p>\u63a5\u7740\u8c03\u6574\u7ea2\u9ed1\u6811\uff0c\u6211\u4eec\u518d\u6b21\u5c1d\u8bd5\u628a45\u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ea2\u8272\u7684\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53d1\u73b0\u95ee\u9898\u53c8\u6765\u4e86\uff0c56-45-43 \u90fd\u662f\u7ea2\u8272\u8282\u70b9\u7684\uff0c\u51fa\u73b0\u4e86\u7ea2\u8272\u8282\u70b9\u76f8\u8fde\u7684\u95ee\u9898\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u9700\u8981\u518d\u628a 56 \u548c 43 \u8bbe\u7f6e\u4e3a\u9ed1\u8272\u7684\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>\u4e8e\u662f\u6211\u4eec\u628a 68 \u8fd9\u4e2a\u7ea2\u8272\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\u7684\u3002</p> <p></p> <p>\u5bf9\u4e8e\u8fd9\u79cd\u7ea2\u9ed1\u6811\u63d2\u5165\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u9700\u8981\u901a\u8fc7\u53d8\u8272\u5c31\u53ef\u4ee5\u4fdd\u6301\u6811\u7684\u5e73\u8861\u4e86\u3002\u4f46\u662f\u5e76\u4e0d\u662f\u6bcf\u6b21\u90fd\u662f\u8fd9\u4e48\u5e78\u8fd0\u7684\uff0c\u5f53\u53d8\u8272\u884c\u4e0d\u901a\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u53e6\u4e00\u4e2a\u624b\u6bb5\u5c31\u662f\u65cb\u8f6c\u4e86\u3002</p> <p>\u4f8b\u5982\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff0c\u540c\u6837\u8fd8\u662f\u62ff\u8fd9\u9897\u7ea2\u9ed1\u6811\u4e3e\u4f8b\u3002</p> <p></p> <p>\u73b0\u5728\u8fd9\u9897\u7ea2\u9ed1\u6811\uff0c\u6211\u4eec\u73b0\u5728\u63d2\u5165\u8282\u70b965\u3002</p> <p></p> <p>\u6211\u4eec\u5c1d\u8bd5\u628a 66 \u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>\u8fd9\u6837\u64cd\u4f5c\u4e4b\u540e\u9ed1\u9ad8\u53c8\u51fa\u73b0\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u4e86\uff0c60-68-64-null \u6709 3 \u4e2a\u9ed1\u8272\u8282\u70b9\uff0c\u800c60-68-64-66-null \u8fd9\u6761\u8def\u5f84\u6709 4 \u4e2a\u9ed1\u8272\u8282\u70b9\uff0c\u8fd9\u6837\u7684\u7ed3\u6784\u662f\u4e0d\u5e73\u8861\u7684\u3002</p> <p>\u6216\u8005\u6211\u4eec\u628a 68 \u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u628a 64 \u8bbe\u7f6e\u4e3a\u7ea2\u8272\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u4f46\u662f\uff0c\u540c\u6837\u7684\u95ee\u9898\uff0c\u4e0a\u9762\u8fd9\u9897\u7ea2\u9ed1\u6811\u7684\u9ed1\u8272\u9ad8\u5ea6\u8fd8\u662f\u4e0d\u4e00\u81f4\uff0c60-68-64-null \u548c 60-68-64-66-null \u8fd9\u4e24\u6761\u8def\u5f84\u9ed1\u8272\u9ad8\u5ea6\u8fd8\u662f\u4e0d\u4e00\u81f4\u3002</p> <p>\u8fd9\u79cd\u60c5\u51b5\u5982\u679c\u53ea\u901a\u8fc7\u53d8\u8272\u7684\u60c5\u51b5\u662f\u4e0d\u80fd\u4fdd\u6301\u7ea2\u9ed1\u6811\u7684\u5e73\u8861\u7684\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_8","title":"\u7ea2\u9ed1\u6811\u7684\u65cb\u8f6c","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u8bb2\u8bb2\u7ea2\u9ed1\u6811\u7684\u65cb\u8f6c\uff0c\u65cb\u8f6c\u5206\u4e3a\u5de6\u65cb\u548c\u53f3\u65cb\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_9","title":"\u5de6\u65cb","text":"<p>\u6587\u5b57\u63cf\u8ff0\uff1a\u9006\u65f6\u9488\u65cb\u8f6c\u4e24\u4e2a\u8282\u70b9\uff0c\u8ba9\u4e00\u4e2a\u8282\u70b9\u88ab\u5176\u53f3\u5b50\u8282\u70b9\u53d6\u4ee3\uff0c\u800c\u8be5\u8282\u70b9\u6210\u4e3a\u53f3\u5b50\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u3002</p> <p>\u6587\u5b57\u63cf\u8ff0\u592a\u62bd\u8c61\uff0c\u63a5\u4e0b\u6765\u770b\u4e0b\u56fe\u7247\u5c55\u793a\u3002</p> <p>\u9996\u5148\u65ad\u5f00\u8282\u70b9PL\u4e0e\u53f3\u5b50\u8282\u70b9G\u7684\u5173\u7cfb\uff0c\u540c\u65f6\u5c06\u5176\u53f3\u5b50\u8282\u70b9\u7684\u5f15\u7528\u6307\u5411\u8282\u70b9C2\uff1b\u7136\u540e\u65ad\u5f00\u8282\u70b9G\u4e0e\u5de6\u5b50\u8282\u70b9C2\u7684\u5173\u7cfb\uff0c\u540c\u65f6\u5c06G\u7684\u5de6\u5b50\u8282\u70b9\u7684\u5e94\u7528\u6307\u5411\u8282\u70b9PL\u3002</p> <p></p> <p>\u63a5\u4e0b\u6765\u518d\u653e\u4e0b gif \u56fe\uff0c\u5e0c\u671b\u80fd\u5e2e\u52a9\u5927\u5bb6\u66f4\u597d\u5730\u7406\u89e3\u5de6\u65cb\uff0c\u56fe\u7247\u6765\u81ea\u7f51\u7edc\u3002</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_10","title":"\u53f3\u65cb","text":"<p>\u6587\u5b57\u63cf\u8ff0\uff1a\u987a\u65f6\u9488\u65cb\u8f6c\u4e24\u4e2a\u8282\u70b9\uff0c\u8ba9\u4e00\u4e2a\u8282\u70b9\u88ab\u5176\u5de6\u5b50\u8282\u70b9\u53d6\u4ee3\uff0c\u800c\u8be5\u8282\u70b9\u6210\u4e3a\u5de6\u5b50\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\u3002</p> <p>\u53f3\u65cb\u7684\u56fe\u7247\u5c55\u793a\uff1a</p> <p>\u9996\u5148\u65ad\u5f00\u8282\u70b9G\u4e0e\u5de6\u5b50\u8282\u70b9PL\u7684\u5173\u7cfb\uff0c\u540c\u65f6\u5c06\u5176\u5de6\u5b50\u8282\u70b9\u7684\u5f15\u7528\u6307\u5411\u8282\u70b9C2\uff1b\u7136\u540e\u65ad\u5f00\u8282\u70b9PL\u4e0e\u53f3\u5b50\u8282\u70b9C2\u7684\u5173\u7cfb\uff0c\u540c\u65f6\u5c06PL\u7684\u53f3\u5b50\u8282\u70b9\u7684\u5e94\u7528\u6307\u5411\u8282\u70b9G\u3002</p> <p></p> <p>\u53f3\u65cb\u7684gif\u5c55\u793a\uff08\u56fe\u7247\u6765\u81ea\u7f51\u7edc\uff09:</p> <p></p> <p>\u4ecb\u7ecd\u5b8c\u4e86\u5de6\u65cb\u548c\u53f3\u65cb\u57fa\u672c\u64cd\u4f5c\uff0c\u6211\u4eec\u6765\u8be6\u7ec6\u4ecb\u7ecd\u4e0b\u7ea2\u9ed1\u6811\u7684\u51e0\u79cd\u65cb\u8f6c\u573a\u666f\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_11","title":"\u5de6\u5de6\u8282\u70b9\u65cb\u8f6c\uff08\u63d2\u5165\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u5de6\u8282\u70b9\uff0c\u63d2\u5165\u8282\u70b9\u4e5f\u662f\u5de6\u8282\u70b9\uff09","text":"<p>\u5982\u4e0b\u56fe\u6240\u793a\u7684\u7ea2\u9ed1\u6811\uff0c\u6211\u4eec\u63d2\u5165\u8282\u70b9\u662f65\u3002</p> <p></p> <p>\u64cd\u4f5c\u6b65\u9aa4\u5982\u4e0b\u53ef\u4ee5\u56f4\u7ed5\u7956\u7236\u8282\u70b9 69 \u53f3\u65cb\uff0c\u518d\u7ed3\u5408\u53d8\u8272\uff0c\u6b65\u9aa4\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_12","title":"\u5de6\u53f3\u8282\u70b9\u65cb\u8f6c\uff08\u63d2\u5165\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u5de6\u8282\u70b9\uff0c\u63d2\u5165\u8282\u70b9\u662f\u53f3\u8282\u70b9\uff09","text":"<p>\u8fd8\u662f\u4e0a\u9762\u8fd9\u9897\u7ea2\u9ed1\u6811\uff0c\u6211\u4eec\u518d\u63d2\u5165\u8282\u70b9 67\u3002</p> <p></p> <p>\u8fd9\u79cd\u60c5\u51b5\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c\uff0c\u5148\u56f4\u7ed5\u7236\u8282\u70b9 66 \u5de6\u65cb\uff0c\u7136\u540e\u518d\u56f4\u7ed5\u7956\u7236\u8282\u70b9 69 \u53f3\u65cb\uff0c\u6700\u540e\u518d\u5c06 67 \u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u628a 69 \u8bbe\u7f6e\u4e3a\u7ea2\u8272\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_13","title":"\u53f3\u5de6\u8282\u70b9\u65cb\u8f6c\uff08\u63d2\u5165\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u53f3\u8282\u70b9\uff0c\u63d2\u5165\u8282\u70b9\u5de6\u8282\u70b9\uff09","text":"<p>\u5982\u4e0b\u56fe\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u8981\u63d2\u5165\u8282\u70b968\u3002</p> <p></p> <p>\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u56f4\u7ed5\u7236\u8282\u70b9 69 \u53f3\u65cb\uff0c\u63a5\u7740\u518d\u56f4\u7ed5\u7956\u7236\u8282\u70b9 66 \u5de6\u65cb\uff0c\u6700\u540e\u628a 68 \u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u628a 66 \u8bbe\u7f6e\u4e3a\u7ea2\u8272\uff0c\u6211\u4eec\u7684\u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4\u5982\u4e0b\u6240\u793a\u3002</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_14","title":"\u53f3\u53f3\u8282\u70b9\u65cb\u8f6c\uff08\u63d2\u5165\u8282\u70b9\u7684\u7236\u8282\u70b9\u662f\u53f3\u8282\u70b9\uff0c\u63d2\u5165\u8282\u70b9\u4e5f\u662f\u53f3\u8282\u70b9\uff09","text":"<p>\u8fd8\u662f\u6765\u4e0a\u9762\u7684\u56fe\u6765\u4e3e\u4f8b\uff0c\u6211\u4eec\u5728\u8fd9\u9897\u7ea2\u9ed1\u6811\u4e0a\u63d2\u5165\u8282\u70b9 70 \u3002</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c\u56f4\u7ed5\u7956\u7236\u8282\u70b9 66 \u5de6\u65cb\uff0c\u518d\u628a\u65cb\u8f6c\u540e\u7684\u6839\u8282\u70b9 69 \u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u628a 66 \u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ea2\u8272\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u770b\u4e0b\u56fe\uff1a</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#java","title":"\u7ea2\u9ed1\u6811\u5728 Java \u4e2d\u7684\u5b9e\u73b0","text":"<p>Java \u4e2d\u7684\u7ea2\u9ed1\u6811\u5b9e\u73b0\u7c7b\u662f TreeMap \uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c1d\u8bd5\u4ece\u6e90\u7801\u89d2\u5ea6\u6765\u9010\u884c\u89e3\u91ca TreeMap \u8fd9\u4e00\u5957\u673a\u5236\u662f\u5982\u4f55\u8fd0\u4f5c\u7684\u3002</p> <pre><code>// TreeMap\u4e2d\u4f7f\u7528Entry\u6765\u63cf\u8ff0\u6bcf\u4e2a\u8282\u70b9\n static final class Entry&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {\n        K key;\n        V value;\n        Entry&lt;K,V&gt; left;\n        Entry&lt;K,V&gt; right;\n        Entry&lt;K,V&gt; parent;\n        boolean color = BLACK;\n        ...\n }\n</code></pre> <p>TreeMap \u7684put\u65b9\u6cd5\u3002</p> <pre><code> public V put(K key, V value) {\n        //\u5148\u4ee5t\u4fdd\u5b58\u94fe\u8868\u7684root\u8282\u70b9\n        Entry&lt;K,V&gt; t = root;\n        //\u5982\u679ct=null,\u8868\u660e\u662f\u4e00\u4e2a\u7a7a\u94fe\u8868\uff0c\u5373\u8be5TreeMap\u91cc\u6ca1\u6709\u4efb\u4f55Entry\u4f5c\u4e3aroot\n        if (t == null) {\n            compare(key, key); // type (and possibly null) check\n            //\u5c06\u65b0\u7684key-value\u521b\u5efa\u4e00\u4e2aEntry\uff0c\u5e76\u5c06\u8be5Entry\u4f5c\u4e3aroot\n            root = new Entry&lt;&gt;(key, value, null);\n            size = 1;\n            //\u8bb0\u5f55\u4fee\u6539\u6b21\u6570\u52a01\n            modCount++;\n            return null;\n        }\n        int cmp;\n        Entry&lt;K,V&gt; parent;\n        // split comparator and comparable paths\n        Comparator&lt;? super K&gt; cpr = comparator;\n        //\u5982\u679c\u6bd4\u8f83\u5668cpr\u4e0d\u4e3anull\uff0c\u5373\u8868\u660e\u91c7\u7528\u5b9a\u5236\u6392\u5e8f\n        if (cpr != null) {\n            do {\n                //\u4f7f\u7528parent\u4e0a\u6b21\u5faa\u73af\u540e\u7684t\u6240\u5f15\u7528\u7684Entry\n                parent = t;\n                 //\u5c06\u65b0\u63d2\u5165\u7684key\u548ct\u7684key\u8fdb\u884c\u6bd4\u8f83\n                cmp = cpr.compare(key, t.key);\n                //\u5982\u679c\u65b0\u63d2\u5165\u7684key\u5c0f\u4e8et\u7684key\uff0ct\u7b49\u4e8et\u7684\u5de6\u8fb9\u8282\u70b9\n                if (cmp &lt; 0)\n                    t = t.left;\n                //\u5982\u679c\u65b0\u63d2\u5165\u7684key\u5927\u4e8et\u7684key\uff0ct\u7b49\u4e8et\u7684\u53f3\u8fb9\u8282\u70b9    \n                else if (cmp &gt; 0)\n                    t = t.right;\n                else\n                //\u5982\u679c\u4e24\u4e2akey\u76f8\u7b49\uff0c\u65b0value\u8986\u76d6\u539f\u6709\u7684value\uff0c\u5e76\u8fd4\u56de\u539f\u6709\u7684value\n                    return t.setValue(value);\n            } while (t != null);\n        }\n        else {\n            if (key == null)\n                throw new NullPointerException();\n            @SuppressWarnings(\"unchecked\")\n                Comparable&lt;? super K&gt; k = (Comparable&lt;? super K&gt;) key;\n            do {\n                parent = t;\n                cmp = k.compareTo(t.key);\n                if (cmp &lt; 0)\n                    t = t.left;\n                else if (cmp &gt; 0)\n                    t = t.right;\n                else\n                    return t.setValue(value);\n            } while (t != null);\n        }\n        //\u5c06\u65b0\u63d2\u5165\u7684\u8282\u70b9\u4f5c\u4e3aparent\u8282\u70b9\u7684\u5b50\u8282\u70b9\n        Entry&lt;K,V&gt; e = new Entry&lt;&gt;(key, value, parent);\n        //\u5982\u679c\u65b0\u63d2\u5165key\u5c0f\u4e8eparent\u7684key,\u5219e\u4f5c\u4e3aparent\u7684\u5de6\u5b50\u8282\u70b9\n        if (cmp &lt; 0)\n            parent.left = e;\n        //\u5982\u679c\u65b0\u63d2\u5165key\u5c0f\u4e8eparent\u7684key\uff0c\u5219e\u4f5c\u4e3aparent\u7684\u53f3\u5b50\u8282\u70b9\n        else\n            parent.right = e;\n        //\u4fee\u590d\u7ea2\u9ed1\u6811\n        fixAfterInsertion(e);\n        size++;\n        modCount++;\n        return null;\n    }\n</code></pre> <pre><code>//\u63d2\u5165\u8282\u70b9\u540e\u4fee\u590d\u7ea2\u9ed1\u6811\nprivate void fixAfterInsertion(Entry&lt;K,V&gt; x) {\n    x.color = RED;\n\n    //\u76f4\u5230x\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e0d\u662f\u6839\uff0c\u4e14x\u7684\u7236\u8282\u70b9\u662f\u7ea2\u8272\n    while (x != null &amp;&amp; x != root &amp;&amp; x.parent.color == RED) {\n        //\u5982\u679cx\u7684\u7236\u8282\u70b9\u662f\u5176\u7236\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\n        if (parentOf(x) == leftOf(parentOf(parentOf(x)))) {\n            //\u83b7\u53d6x\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\n            Entry&lt;K,V&gt; y = rightOf(parentOf(parentOf(x)));\n            //\u5982\u679cx\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u662f\u7ea2\u8272\n            if (colorOf(y) == RED) {     \n                //\u5c06x\u7684\u7236\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\n                setColor(parentOf(x), BLACK);\n                //\u5c06x\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\n                setColor(y, BLACK);\n                //\u5c06x\u7684\u7236\u8282\u70b9\u7684\u7236\u8282\u70b9\u8bbe\u4e3a\u7ea2\u8272\n                setColor(parentOf(parentOf(x)), RED);\n                x = parentOf(parentOf(x));\n            }\n            //\u5982\u679cx\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u662f\u9ed1\u8272\n            else {   \n                //TODO \u5bf9\u5e94\u60c5\u51b5\u7b2c\u4e8c\u79cd\uff0c\u5de6\u53f3\u8282\u70b9\u65cb\u8f6c\n                //\u5982\u679cx\u662f\u5176\u7236\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\n                if (x == rightOf(parentOf(x))) {\n                    //\u5c06x\u7684\u7236\u8282\u70b9\u8bbe\u4e3ax\n                    x = parentOf(x);\n                    //\u53f3\u65cb\u8f6c\n                    rotateLeft(x);\n                }\n                //\u628ax\u7684\u7236\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\n                setColor(parentOf(x), BLACK);\n                //\u628ax\u7684\u7236\u8282\u70b9\u7236\u8282\u70b9\u8bbe\u4e3a\u7ea2\u8272\n                setColor(parentOf(parentOf(x)), RED);\n                rotateRight(parentOf(parentOf(x)));\n            }\n        }\n        //\u5982\u679cx\u7684\u7236\u8282\u70b9\u662f\u5176\u7236\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\n        else {\n            //\u83b7\u53d6x\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\n            Entry&lt;K,V&gt; y = leftOf(parentOf(parentOf(x)));\n            //\u53ea\u7740\u8272\u7684\u60c5\u51b5\u5bf9\u5e94\u7684\u662f\u6700\u5f00\u59cb\u4f8b\u5b50\uff0c\u6ca1\u6709\u65cb\u8f6c\u64cd\u4f5c\uff0c\u4f46\u662f\u8981\u5bf9\u5e94\u591a\u6b21\u53d8\u6362\n            //\u5982\u679cx\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u662f\u7ea2\u8272  \n            if (colorOf(y) == RED) {\n                //\u5c06x\u7684\u7236\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\n                setColor(parentOf(x), BLACK);\n                //\u5c06x\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u8bbe\u4e3a\u9ed1\u8272\n                setColor(y, BLACK);\n                //\u5c06X\u7684\u7236\u8282\u70b9\u7684\u7236\u8282\u70b9\uff08G\uff09\u8bbe\u7f6e\u7ea2\u8272\n                setColor(parentOf(parentOf(x)), RED);\n                //\u5c06x\u8bbe\u4e3ax\u7684\u7236\u8282\u70b9\u7684\u8282\u70b9\n                x = parentOf(parentOf(x));\n            }\n            //\u5982\u679cx\u7684\u7236\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u662f\u9ed1\u8272\n            else {\n                //\u5982\u679cx\u662f\u5176\u7236\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\n                if (x == leftOf(parentOf(x))) {\n                    //\u5c06x\u7684\u7236\u8282\u70b9\u8bbe\u4e3ax\n                    x = parentOf(x);\n                    //\u53f3\u65cb\u8f6c\n                    rotateRight(x);\n                }\n                //\u5c06x\u7684\u7236\u8282\u70b9\u8bbe\u4e3a\u9ed1\u8272\n                setColor(parentOf(x), BLACK);\n                //\u628ax\u7684\u7236\u8282\u70b9\u7684\u7236\u8282\u70b9\u8bbe\u4e3a\u7ea2\u8272\n                setColor(parentOf(parentOf(x)), RED);\n                rotateLeft(parentOf(parentOf(x)));\n            }\n        }\n    }\n    //\u5c06\u6839\u8282\u70b9\u5f3a\u5236\u8bbe\u7f6e\u4e3a\u9ed1\u8272\n    root.color = BLACK;\n}\n</code></pre> <p>TreeMap\u7684\u63d2\u5165\u8282\u70b9\u548c\u666e\u901a\u7684\u6392\u5e8f\u4e8c\u53c9\u6811\u6ca1\u5565\u533a\u522b\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f\uff0c\u5728TreeMap \u63d2\u5165\u8282\u70b9\u540e\u4f1a\u8c03\u7528\u65b9\u6cd5fixAfterInsertion(e)\u6765\u91cd\u65b0\u8c03\u6574\u7ea2\u9ed1\u6811\u7684\u7ed3\u6784\u6765\u8ba9\u7ea2\u9ed1\u6811\u4fdd\u6301\u5e73\u8861\u3002</p> <p>\u6211\u4eec\u91cd\u70b9\u5173\u6ce8\u4e0b\u7ea2\u9ed1\u6811\u7684fixAfterInsertion(e)\u65b9\u6cd5\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u5206\u522b\u4ecb\u7ecd\u4e24\u79cd\u573a\u666f\u6765\u6f14\u793afixAfterInsertion(e)\u65b9\u6cd5\u7684\u6267\u884c\u6d41\u7a0b\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_15","title":"\u7b2c\u4e00\u79cd\u573a\u666f\uff1a\u53ea\u9700\u53d8\u8272\u5373\u53ef\u5e73\u8861","text":"<p>\u540c\u6837\u662f\u62ff\u8fd9\u9897\u7ea2\u9ed1\u6811\u4e3e\u4f8b\uff0c\u73b0\u5728\u6211\u4eec\u63d2\u5165\u8282\u70b9 51\u3002</p> <p></p> <p>\u5f53\u6211\u4eec\u9700\u8981\u63d2\u5165\u8282\u70b951\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65f6\u5019TreeMap \u7684 put \u65b9\u6cd5\u6267\u884c\u540e\u4f1a\u5f97\u5230\u4e0b\u9762\u8fd9\u5f20\u56fe\u3002</p> <p></p> <p>\u63a5\u7740\u8c03\u7528fixAfterInsertion(e)\u65b9\u6cd5\uff0c\u5982\u4e0b\u4ee3\u7801\u6d41\u7a0b\u6240\u793a\u3002</p> <p></p> <p>\u5f53\u7b2c\u4e00\u6b21\u8fdb\u5165\u5faa\u73af\u540e\uff0c\u6267\u884c\u540e\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ea2\u9ed1\u6811\u7ed3\u6784\u3002</p> <p></p> <p>\u5728\u628a x \u91cd\u65b0\u8d4b\u503c\u540e\uff0c\u91cd\u65b0\u8fdb\u5165 while \u5faa\u73af\uff0c\u6b64\u65f6\u7684 x \u8282\u70b9\u4e3a 45 \u3002</p> <p></p> <p>\u6267\u884c\u4e0a\u8ff0\u6d41\u7a0b\u540e\uff0c\u5f97\u5230\u4e0b\u9762\u6240\u793a\u7684\u7ea2\u9ed1\u6811\u7ed3\u6784\u3002</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u5019x\u88ab\u91cd\u65b0\u8d4b\u503c\u4e3a60\uff0c\u56e0\u4e3a60\u662f\u6839\u8282\u70b9\uff0c\u6240\u4ee5\u4f1a\u9000\u51fa while \u5faa\u73af\u3002\u5728\u9000\u51fa\u5faa\u5e8f\u540e\uff0c\u4f1a\u518d\u6b21\u628a\u6839\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p> <p>\u6700\u540e\u7ecf\u8fc7\u4e24\u6b21\u6267\u884cwhile\u5faa\u73af\u540e\uff0c\u6211\u4eec\u7684\u7ea2\u9ed1\u6811\u4f1a\u8c03\u6574\u6210\u73b0\u5728\u8fd9\u6837\u7684\u7ed3\u6784\uff0c\u8fd9\u6837\u7684\u7ea2\u9ed1\u6811\u7ed3\u6784\u662f\u5e73\u8861\u7684\uff0c\u6240\u4ee5\u8def\u5f84\u7684\u9ed1\u9ad8\u4e00\u81f4\uff0c\u5e76\u4e14\u6ca1\u6709\u7ea2\u8272\u8282\u70b9\u76f8\u8fde\u7684\u60c5\u51b5\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_16","title":"\u7b2c\u4e8c\u79cd\u573a\u666f \u65cb\u8f6c\u642d\u914d\u53d8\u8272\u6765\u4fdd\u6301\u5e73\u8861","text":"<p>\u63a5\u4e0b\u6765\u6211\u4eec\u518d\u6765\u6f14\u793a\u7b2c\u4e8c\u79cd\u573a\u666f\uff0c\u9700\u8981\u7ed3\u5408\u53d8\u8272\u548c\u65cb\u8f6c\u4e00\u8d77\u6765\u4fdd\u6301\u5e73\u8861\u3002</p> <p>\u7ed9\u5b9a\u4e0b\u9762\u8fd9\u6837\u4e00\u9897\u7ea2\u9ed1\u6811\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u63d2\u5165\u8282\u70b966\uff0c\u5f97\u5230\u5982\u4e0b\u6811\u7ed3\u6784\u3002</p> <p></p> <p>\u540c\u6837\u5730\uff0c\u6211\u4eec\u8fdb\u5165fixAfterInsertion(e)\u65b9\u6cd5\u3002</p> <p></p> <p></p> <p>\u6700\u7ec8\u6211\u4eec\u5f97\u5230\u7684\u7ea2\u9ed1\u6811\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p> <p>\u8c03\u6574\u6210\u8fd9\u6837\u7684\u7ed3\u6784\u6211\u4eec\u7684\u7ea2\u9ed1\u6811\u53c8\u518d\u6b21\u4fdd\u6301\u5e73\u8861\u4e86\u3002</p> <p>\u6f14\u793a TreeMap \u7684\u6d41\u7a0b\u5c31\u62ff\u8fd9\u4e24\u79cd\u573a\u666f\u4e3e\u4f8b\u4e86\uff0c\u5176\u4ed6\u7684\u5c31\u4e0d\u4e00\u4e00\u4e3e\u4f8b\u4e86\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_17","title":"\u7ea2\u9ed1\u6811\u7684\u5220\u9664","text":"<p>\u56e0\u4e3a\u4e4b\u524d\u7684\u5206\u4eab\u53ea\u6574\u7406\u4e86\u7ea2\u9ed1\u6811\u7684\u63d2\u5165\u90e8\u5206\uff0c\u672c\u6765\u60f3\u7740\u7ea2\u9ed1\u6811\u7684\u5220\u9664\u5c31\u4e0d\u6574\u7406\u4e86\uff0c\u6709\u4eba\u8ddf\u6211\u53cd\u9988\u8bf4\u7ea2\u9ed1\u6811\u7684\u5220\u9664\u76f8\u5bf9\u66f4\u590d\u6742\uff0c\u4e8e\u662f\u7d22\u6027\u8fd8\u662f\u628a\u7ea2\u9ed1\u6811\u7684\u5220\u9664\u518d\u6574\u7406\u4e0b\u3002</p> <p>\u5220\u9664\u76f8\u5bf9\u63d2\u5165\u6765\u8bf4\uff0c\u7684\u786e\u662f\u8981\u590d\u6742\u4e00\u70b9\uff0c\u4f46\u662f\u590d\u6742\u7684\u5730\u65b9\u662f\u56e0\u4e3a\u5728\u5220\u9664\u8282\u70b9\u7684\u8fd9\u4e2a\u64cd\u4f5c\u60c5\u51b5\u6709\u5f88\u591a\u79cd\uff0c\u4f46\u662f\u63d2\u5165\u4e0d\u4e00\u6837\uff0c\u63d2\u5165\u8282\u70b9\u7684\u65f6\u5019\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u8282\u70b9\u7684\u4f4d\u7f6e\u662f\u786e\u5b9a\u7684\uff0c\u5728\u8282\u70b9\u63d2\u5165\u6210\u529f\u540e\u53ea\u9700\u8981\u8c03\u6574\u7ea2\u9ed1\u6811\u7684\u5e73\u8861\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u4f46\u662f\u5220\u9664\u4e0d\u4e00\u6837\u7684\u662f\uff0c\u5220\u9664\u8282\u70b9\u7684\u65f6\u5019\u6211\u4eec\u4e0d\u80fd\u7b80\u5355\u5730\u628a\u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3anull\uff0c\u56e0\u4e3a\u5982\u679c\u8fd9\u4e2a\u8282\u70b9\u6709\u5b50\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u7b80\u5355\u5730\u628a\u5f53\u524d\u5220\u9664\u7684\u8282\u70b9\u8bbe\u7f6e\u4e3anull\uff0c\u8fd9\u4e2a\u88ab\u5220\u9664\u7684\u8282\u70b9\u7684\u4f4d\u7f6e\u9700\u8981\u6709\u65b0\u7684\u8282\u70b9\u6765\u586b\u8865\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u9700\u8981\u5206\u591a\u79cd\u60c5\u51b5\u6765\u5904\u7406\u4e86\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_18","title":"\u5220\u9664\u8282\u70b9\u662f\u6839\u8282\u70b9","text":"<p>\u76f4\u63a5\u5220\u9664\u6839\u8282\u70b9\u5373\u53ef\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_19","title":"\u5220\u6389\u8282\u70b9\u7684\u5de6\u5b50\u8282\u70b9\u548c\u53f3\u5b50\u8282\u70b9\u90fd\u662f\u4e3a\u7a7a","text":"<p>\u76f4\u63a5\u5220\u9664\u5f53\u524d\u8282\u70b9\u5373\u53ef\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_20","title":"\u5220\u9664\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\u4e0d\u4e3a\u7a7a","text":"<p>\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u4f7f\u7528\u5b50\u8282\u70b9\u6765\u4ee3\u66ff\u5f53\u524d\u9700\u8981\u5220\u9664\u7684\u8282\u70b9\uff0c\u7136\u540e\u518d\u628a\u5b50\u8282\u70b9\u5220\u9664\u5373\u53ef\u3002</p> <p>\u7ed9\u5b9a\u4e0b\u9762\u8fd9\u68f5\u6811\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5220\u9664\u8282\u70b969\u7684\u65f6\u5019\u3002</p> <p></p> <p>\u9996\u5148\u7528\u5b50\u8282\u70b9\u4ee3\u66ff\u5f53\u524d\u5f85\u5220\u9664\u8282\u70b9\uff0c\u7136\u540e\u518d\u628a\u5b50\u8282\u70b9\u5220\u9664\u3002</p> <p></p> <p>\u6700\u7ec8\u7684\u7ea2\u9ed1\u6811\u7ed3\u6784\u5982\u4e0b\u9762\u6240\u793a\uff0c\u8fd9\u4e2a\u7ed3\u6784\u7684\u7ea2\u9ed1\u6811\u6211\u4eec\u662f\u4e0d\u9700\u8981\u901a\u8fc7\u53d8\u8272+\u65cb\u8f6c\u6765\u4fdd\u6301\u7ea2\u9ed1\u6811\u7684\u5e73\u8861\u4e86\uff0c\u56e0\u4e3a\u5c06\u5b50\u8282\u70b9\u5220\u9664\u540e\u6811\u5df2\u7ecf\u662f\u5e73\u8861\u7684\u4e86\u3002</p> <p></p> <p>\u8fd8\u6709\u4e00\u79cd\u573a\u666f\u662f\u5f53\u6211\u4eec\u5f85\u5220\u9664\u8282\u70b9\u662f\u9ed1\u8272\u7684\uff0c\u9ed1\u8272\u7684\u8282\u70b9\u88ab\u5220\u9664\u540e\uff0c\u6811\u7684\u9ed1\u9ad8\u5c31\u4f1a\u51fa\u73b0\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u91cd\u65b0\u8c03\u6574\u7ed3\u6784\u3002</p> <p>\u8fd8\u662f\u62ff\u4e0a\u9762\u8fd9\u9897\u5220\u9664\u8282\u70b9\u540e\u7684\u7ea2\u9ed1\u6811\u4e3e\u4f8b\uff0c\u6211\u4eec\u73b0\u5728\u9700\u8981\u5220\u9664\u8282\u70b967\u3002</p> <p></p> <p>\u56e0\u4e3a67 \u8fd9\u4e2a\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u8282\u70b9\u90fd\u662fnull\uff0c\u6240\u4ee5\u76f4\u63a5\u5220\u9664,\u5f97\u5230\u5982\u4e0b\u56fe\u6240\u793a\u7ed3\u6784\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6811\u7684\u9ed1\u9ad8\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u5de6\u8fb9\u9ed1\u9ad8\u662f3\uff0c\u53f3\u8fb9\u662f2\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u628a64\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ea2\u8272\u6765\u4fdd\u6301\u5e73\u8861\u3002</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_21","title":"\u5220\u9664\u8282\u70b9\u4e24\u4e2a\u5b50\u8282\u70b9\u90fd\u4e0d\u4e3a\u7a7a","text":"<p>\u5220\u9664\u8282\u70b9\u4e24\u4e2a\u5b50\u8282\u70b9\u90fd\u4e0d\u4e3a\u7a7a\u7684\u60c5\u51b5\u4e0b\uff0c\u8ddf\u4e0a\u9762\u6709\u4e00\u4e2a\u8282\u70b9\u4e0d\u4e3a\u7a7a\u7684\u60c5\u51b5\u4e0b\u4e5f\u662f\u6709\u70b9\u7c7b\u4f3c\uff0c\u540c\u6837\u662f\u9700\u8981\u627e\u80fd\u66ff\u4ee3\u5f53\u524d\u8282\u70b9\u7684\u8282\u70b9\uff0c\u627e\u5230\u540e\uff0c\u628a\u80fd\u66ff\u4ee3\u5220\u9664\u8282\u70b9\u503c\u590d\u5236\u8fc7\u6765\uff0c\u7136\u540e\u518d\u628a\u66ff\u4ee3\u8282\u70b9\u5220\u9664\u6389\u3002</p> <ul> <li>\u5148\u627e\u5230\u66ff\u4ee3\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u524d\u9a71\u8282\u70b9\u6216\u8005\u540e\u7ee7\u8282\u70b9</li> <li>\u7136\u540e\u628a\u524d\u9a71\u8282\u70b9\u6216\u8005\u540e\u7ee7\u8282\u70b9\u590d\u5236\u5230\u5f53\u524d\u5f85\u5220\u9664\u8282\u70b9\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u5728\u5220\u9664\u524d\u9a71\u8282\u70b9\u6216\u8005\u540e\u7ee7\u8282\u70b9\u3002</li> </ul> <p>\u90a3\u4e48\u4ec0\u4e48\u53eb\u505a\u524d\u9a71\uff0c\u4ec0\u4e48\u53eb\u505a\u540e\u7ee7\u5462\uff1f \u524d\u9a71\u662f\u5de6\u5b50\u6811\u4e2d\u6700\u5927\u7684\u8282\u70b9\uff0c\u540e\u7ee7\u5219\u662f\u53f3\u5b50\u6811\u4e2d\u6700\u5c0f\u7684\u8282\u70b9\u3002</p> <p>\u524d\u9a71\u6216\u8005\u540e\u7ee7\u90fd\u662f\u6700\u63a5\u8fd1\u5f53\u524d\u8282\u70b9\u7684\u8282\u70b9\uff0c\u5f53\u6211\u4eec\u9700\u8981\u5220\u9664\u5f53\u524d\u8282\u70b9\u7684\u65f6\u5019\uff0c\u4e5f\u5c31\u662f\u627e\u5230\u80fd\u66ff\u4ee3\u5f53\u524d\u8282\u70b9\u7684\u8282\u70b9\uff0c\u80fd\u591f\u66ff\u4ee3\u5f53\u524d\u8282\u70b9\u80af\u5b9a\u662f\u6700\u63a5\u8fd1\u5f53\u524d\u8282\u70b9\u3002</p> <p>\u5728\u5f53\u524d\u5220\u9664\u8282\u70b9\u4e24\u4e2a\u5b50\u8282\u70b9\u4e0d\u4e3a\u7a7a\u7684\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u518d\u8fdb\u884c\u7ec6\u5206\uff0c\u4e3b\u8981\u5206\u4e3a\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_22","title":"\u7b2c\u4e00\u79cd\uff0c\u524d\u9a71\u8282\u70b9\u4e3a\u9ed1\u8272\u8282\u70b9\uff0c\u540c\u65f6\u6709\u4e00\u4e2a\u975e\u7a7a\u8282\u70b9","text":"<p>\u5982\u4e0b\u9762\u8fd9\u6837\u4e00\u68f5\u6811\uff0c\u6211\u4eec\u9700\u8981\u5220\u9664\u8282\u70b964\uff1a</p> <p></p> <p>\u9996\u5148\u627e\u5230\u524d\u9a71\u8282\u70b9\uff0c\u628a\u524d\u9a71\u8282\u70b9\u590d\u5236\u5230\u5f53\u524d\u8282\u70b9\uff1a</p> <p></p> <p>\u63a5\u7740\u5220\u9664\u524d\u9a71\u8282\u70b9\u3002</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u501963\u548c60\u8fd9\u4e2a\u8282\u70b9\u90fd\u662f\u7ea2\u8272\u7684\uff0c\u6211\u4eec\u5c1d\u8bd5\u628a60\u8fd9\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ea2\u8272\u5373\u53ef\u4f7f\u6574\u4e2a\u7ea2\u9ed1\u6811\u8fbe\u5230\u5e73\u8861\u3002</p> <p></p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_23","title":"\u7b2c\u4e8c\u79cd\uff0c\u524d\u9a71\u8282\u70b9\u4e3a\u9ed1\u8272\u8282\u70b9\uff0c\u540c\u65f6\u5b50\u8282\u70b9\u90fd\u4e3a\u7a7a","text":"<p>\u524d\u9a71\u8282\u70b9\u662f\u9ed1\u8272\u7684\uff0c\u5b50\u8282\u70b9\u90fd\u4e3a\u7a7a\uff0c\u8fd9\u4e2a\u65f6\u5019\u64cd\u4f5c\u6b65\u9aa4\u4e0e\u4e0a\u9762\u57fa\u672c\u7c7b\u4f3c\u3002</p> <p>\u5982\u4e0b\u64cd\u4f5c\u6b65\u9aa4\uff1a</p> <p></p> <p>\u56e0\u4e3a\u8981\u5220\u9664\u8282\u70b964\uff0c\u63a5\u7740\u627e\u5230\u524d\u9a71\u8282\u70b963\uff0c\u628a63\u8282\u70b9\u590d\u5236\u5230\u5f53\u524d\u4f4d\u7f6e\uff0c\u7136\u540e\u5c06\u524d\u9a71\u8282\u70b963\u5220\u9664\u6389\uff0c\u53d8\u8272\u540e\u51fa\u73b0\u9ed1\u9ad8\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u540e\u628a63\u8282\u70b9\u8bbe\u7f6e\u4e3a\u9ed1\u8272\uff0c\u628a65\u8282\u70b9\u8bbe\u7f6e\u4e3a\u7ea2\u8272\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u7ea2\u9ed1\u6811\u7684\u5e73\u8861\u3002</p>"},{"location":"Java/%E6%88%91%E7%94%BB%E4%BA%86%E8%BF%91%E7%99%BE%E5%BC%A0%E5%9B%BE%E6%9D%A5%E7%90%86%E8%A7%A3%E7%BA%A2%E9%BB%91%E6%A0%91/#_24","title":"\u7b2c\u4e09\u79cd\uff0c\u524d\u9a71\u8282\u70b9\u4e3a\u7ea2\u8272\u8282\u70b9\uff0c\u540c\u65f6\u5b50\u8282\u70b9\u90fd\u4e3a\u7a7a","text":"<p>\u7ed9\u5b9a\u4e0b\u9762\u8fd9\u9897\u7ea2\u9ed1\u6811\uff0c\u6211\u4eec\u9700\u8981\u5220\u9664\u8282\u70b964\u7684\u65f6\u5019\u3002</p> <p></p> <p>\u540c\u6837\u5730\uff0c\u6211\u4eec\u627e\u523064\u7684\u524d\u9a71\u8282\u70b963\uff0c\u63a5\u7740\u628a63\u8d4b\u503c\u523064\u8fd9\u4e2a\u4f4d\u7f6e\u3002</p> <p></p> <p>\u7136\u540e\u5220\u9664\u524d\u9a71\u8282\u70b9\u3002</p> <p></p> <p>\u5220\u9664\u8282\u70b9\u540e\u4e0d\u9700\u8981\u53d8\u8272\u4e5f\u4e0d\u9700\u8981\u65cb\u8f6c\u5373\u53ef\u4fdd\u6301\u6811\u7684\u5e73\u8861\u3002</p> <p>\u7ec8\u4e8e\u628a\u7ea2\u9ed1\u6811\u7684\u57fa\u672c\u539f\u7406\u90e8\u5206\u5199\u5b8c\u4e86\uff0c\u7528\u4e86\u5f88\u591a\u793a\u610f\u56fe\uff0c\u8fd9\u7bc7\u6587\u7ae0\u662f\u5728\u4e4b\u524d\u5206\u4eab\u7684 ppt \u4e0a\u518d\u6574\u7406\u51fa\u6765\uff0c\u6211\u89c9\u5f97\u81ea\u5df1\u5e94\u8be5\u7b97\u662f\u628a\u57fa\u672c\u64cd\u4f5c\u8bb2\u660e\u767d\u4e86\uff0c\u6574\u7406\u8fd9\u7bc7\u6587\u7ae0\u524d\u524d\u540e\u540e\u7528\u4e86\u8fd1\u4e00\u5468\u5de6\u53f3\uff0c\u56e0\u4e3a\u5e73\u65f6\u4e0a\u73ed\uff0c\u57fa\u672c\u4e0a\u53ea\u6709\u5468\u672b\u6709\u65f6\u95f4\u624d\u6709\u65f6\u95f4\u6574\u7406\uff0c\u5982\u6709\u95ee\u9898\u8bf7\u7559\u8a00\u8ba8\u8bba\u3002</p> <p>\u5982\u679c\u60a8\u89c9\u5f97\u5199\u5f97\u8fd8\u53ef\u4ee5\uff0c\u8bf7\u60a8\u5e2e\u5fd9\u70b9\u4e2a\u597d\u770b\uff0c\u60a8\u7684\u70b9\u8d5e\u771f\u7684\u662f\u5bf9\u6211\u6700\u5927\u7684\u652f\u6301\uff0c\u4e5f\u662f\u6211\u80fd\u7ee7\u7eed\u5199\u4e0b\u53bb\u7684\u52a8\u529b\uff0c\u611f\u8c22\u3002</p> <p>\u539f\u6587\u94fe\u63a5</p> <p>\u6587\u7ae0\u4e2d\u5f88\u591a\u53c2\u8003\u4e86\u4e0b\u9762\u6587\u7ae0\u7684\u4e00\u4e9b\u793a\u610f\u56fe\uff0c\u975e\u5e38\u611f\u8c22\u4ee5\u4e0b\u6587\u7ae0\u3002</p> <p>What does the time complexity O(log n) actually mean?</p> <p>Java\u63d0\u9ad8\u7bc7--TreeMap</p> <p>\u5173\u4e8e\u7ea2\u9ed1\u6811(R-B tree)\u539f\u7406\uff0c\u770b\u8fd9\u7bc7\u5982\u4f55</p>"},{"location":"Java/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90Sting%23intern/","title":"\u6df1\u5165\u89e3\u6790Sting#intern","text":"<p>\u6df1\u5165\u89e3\u6790Sting#intern</p>"},{"location":"Kotlin/Kotlin%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B/","title":"Kotlin\u4e2d\u7684\u6cdb\u578b","text":""},{"location":"MultiThread/Java%E4%B8%AD%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%90%86%E8%A7%A3%E7%B3%BB%E5%88%97/","title":"Java\u4e2d\u591a\u7ebf\u7a0b\u7406\u89e3\u7cfb\u5217","text":""},{"location":"MultiThread/Java%E4%B8%AD%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%90%86%E8%A7%A3%E7%B3%BB%E5%88%97/#java","title":"Java\u4e2d\u591a\u7ebf\u7a0b\u7406\u89e3\u7cfb\u5217","text":"<p>\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u8be6\u89e3</p> <p>synchronized\u5173\u952e\u5b57\u7684\u539f\u7406</p> <p>\u6df1\u5165\u89e3\u6790volatile\u5173\u952e\u5b57</p> <p>\u4e00\u6b21\u641e\u61c2sleep\u3001wait\u3001yield\u3001join\u548cinterrupted\u7ebf\u7a0b\u76f8\u5173\u65b9\u6cd5</p> <p>\u4eceAtomicInteger\u6765\u770bCAS\u673a\u5236</p> <p>\u591a\u7ebf\u7a0b\u95f4\u901a\u4fe1</p> <p>ThreadLocal</p> <p>ReentrantLock</p> <p>\u4f7f\u7528\u5355\u4e00\u7ebf\u7a0b\u7ef4\u6301\u5bf9\u8c61\u72b6\u6001\u7684\u4e00\u81f4\u6027 </p>"},{"location":"MultiThread/ReentrantLock/","title":"ReentrantLock","text":"<p>\u53ef\u91cd\u5165\u9501\u51e0\u70b9\u7279\u6027\uff1a</p> <ul> <li>\u53ef\u91cd\u5165</li> <li>\u53ef\u4e2d\u65ad \uff08\u53ef\u6253\u7834\u6b7b\u9501\uff09</li> <li>\u53ef\u9650\u65f6</li> </ul>"},{"location":"MultiThread/ReentrantLock/#_1","title":"\u53ef\u91cd\u5165","text":"<p>\u7531\u4e8eReentrantLock\u662f\u91cd\u5165\u9501\uff0c\u6240\u4ee5\u53ef\u4ee5\u53cd\u590d\u5f97\u5230\u76f8\u540c\u7684\u4e00\u628a\u9501\uff0c\u5b83\u6709\u4e00\u4e2a\u4e0e\u9501\u76f8\u5173\u7684\u83b7\u53d6\u8ba1\u6570\u5668\uff0c\u5982\u679c\u62e5\u6709\u9501\u7684\u67d0\u4e2a\u7ebf\u7a0b\u518d\u6b21\u5f97\u5230\u9501\uff0c\u90a3\u4e48\u83b7\u53d6\u8ba1\u6570\u5668\u5c31\u52a01\uff0c\u7136\u540e\u9501\u9700\u8981\u88ab\u91ca\u653e\u4e24\u6b21\u624d\u80fd\u83b7\u5f97\u771f\u6b63\u91ca\u653e(\u91cd\u5165\u9501)\u3002</p> <pre><code>lock.lock();\nlock.lock();\ntry {\n    i++;    \n}           \nfinally {\n    lock.unlock();\n    lock.unlock();\n}\n</code></pre>"},{"location":"MultiThread/ReentrantLock/#_2","title":"\u53ef\u4e2d\u65ad","text":"<p>\u5bf9\u4e8e\u4e0a\u8ff0\u6b7b\u9501\u73b0\u8c61\uff0c\u53ef\u4f7f\u7528Reentrantlock\u7684\u53ef\u4e2d\u65ad\u7279\u6027\u89e3\u51b3\u3002</p> <p>\u601d\u8def\u662f\uff0c\u4f7f\u7528Thread.interrupt()\u6253\u65ad\u6b7b\u9501\u7684\u7ebf\u7a0b\uff0c\u91ca\u653e\u9501\u8d44\u6e90\uff0c\u7834\u574f\u6b7b\u9501\u6761\u4ef6\u3002</p> <pre><code>ReentrantLock.lockInterruptibly()\n\nAcquires the lock unless the current thread is {Thread#interrupt} interrupted.\n</code></pre>"},{"location":"MultiThread/ReentrantLock/#_3","title":"\u53ef\u9650\u65f6","text":"<ul> <li>\u8d85\u65f6\u4e0d\u80fd\u83b7\u5f97\u9501\uff0c\u5c31\u8fd4\u56defalse\uff0c\u4e0d\u4f1a\u6c38\u4e45\u7b49\u5f85\u6784\u6210\u6b7b\u9501</li> <li>\u4f7f\u7528lock.tryLock(long timeout, TimeUnit unit)\u6765\u5b9e\u73b0\u53ef\u9650\u65f6\u9501\uff0c\u53c2\u6570\u4e3a\u65f6\u95f4\u548c\u5355\u4f4d\u3002</li> </ul> <pre><code>public class TryLockTest extends Thread {\n\n    public static ReentrantLock lock = new ReentrantLock();\n    private String name;\n\n    public TryLockTest(String name){\n        super(name);\n        this.name = name;\n    }\n\n    @Override\n    public void run() {\n        System.out.println(name + \" run()\");\n\n        try {\n            if (lock.tryLock(5, TimeUnit.SECONDS)) {\n                Thread.sleep(10000);\n            } else {\n                System.out.println(this.getName() + \" get lock failed\");\n            }\n        } catch (Exception e) {\n        } finally {\n            if (lock.isHeldByCurrentThread()) {\n                System.out.println(\"lock.isHeldByCurrentThread: \" + this.getName());\n                lock.unlock();\n            }\n        }\n    }\n\n    public static void main(String[] args) {\n        TryLockTest t1 = new TryLockTest(\"TryLockTest 1\");\n        TryLockTest t2 = new TryLockTest(\"TryLockTest 2\");\n\n        t1.start();\n        t2.start();\n    }\n}\n\n\n\u8f93\u51fa\uff1a\nTryLockTest 1 run()\nTryLockTest 2 run()\nTryLockTest 2 get lock failed   // 5\u79d2\u540e\u624d\u8f93\u51fa\uff0c\u8bf4\u660eTryLockTest2\u7b49\u5f855\u79d2\u5c31\u4e0d\u518d\u7b49\u4e86\uff0c\u6d88\u9664\u6b7b\u9501\nlock.isHeldByCurrentThread: TryLockTest 1\n\n</code></pre>"},{"location":"MultiThread/ThreadLocal/","title":"ThreadLocal","text":"<p>ThreadLocal\u4e3a\u6bcf\u4e00\u4e2a\u4f7f\u7528\u8be5\u53d8\u91cf\u7684\u7ebf\u7a0b\u90fd\u63d0\u4f9b\u4e86\u72ec\u7acb\u7684\u526f\u672c\uff0c\u53ef\u4ee5\u505a\u7ebf\u7a0b\u95f4\u7684\u6570\u636e\u9694\u79bb\uff0c\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u8bbf\u95ee\u5404\u81ea\u5185\u90e8\u7684\u526f\u672c\u53d8\u91cf\u3002</p>"},{"location":"MultiThread/ThreadLocal/#threadlocal_1","title":"ThreadLocal\u7684\u7b80\u5355\u4f7f\u7528","text":"<pre><code>import java.util.stream.IntStream;\n\npublic class ThreadLocalExample {\n    public static void main(String[] args) {\n        //\u521b\u5efaThreadLocal\u5b9e\u4f8b\n        ThreadLocal&lt;Integer&gt; tlocal = new ThreadLocal&lt;Integer&gt;(); \n        //\u521b\u5efa5\u4e2a\u7ebf\u7a0b\uff0c\u4f7f\u7528tlocal\n        IntStream.range(0, 5).forEach(i -&gt; new Thread(() -&gt; {\n            //\u6bcf\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u8bbe\u7f6etlocal\u4e92\u76f8\u53d7\u5f71\u54cd\n            tlocal.set(i);\n            System.out.println(Thread.currentThread() + \"set i \" + tlocal.get());\n            try {\n                Thread.sleep(1000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(Thread.currentThread() + \"get i \" + tlocal.get());\n        }).start()\n        );\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684ThreadLocal,\u7136\u540e\u542f\u52a8\u4e865\u4e2a\u7ebf\u7a0b\u5bf9ThreadLocal\u8fdb\u884cset\u548cget\u64cd\u4f5c\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u8f93\u51fa\u4f1a\u53d1\u73b05\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u5f7c\u6b64\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\uff0c\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u5b58\u5165threadLocal\u4e2d\u7684\u503c\u662f\u5b8c\u5168\u4e0d\u540c\u5f7c\u6b64\u72ec\u7acb\u7684\u3002 <pre><code>Thread[Thread-0,5,main]set i 0\nThread[Thread-1,5,main]set i 1\nThread[Thread-3,5,main]set i 3\nThread[Thread-2,5,main]set i 2\nThread[Thread-4,5,main]set i 4\nThread[Thread-0,5,main]get i 0\nThread[Thread-1,5,main]get i 1\nThread[Thread-4,5,main]get i 4\nThread[Thread-2,5,main]get i 2\nThread[Thread-3,5,main]get i 3\n</code></pre> <p>ThreadLocal\u9664\u4e86set\u548cget\u65b9\u6cd5\uff0c\u8fd8\u6709\u4e00\u4e2ainitialValue\u7684\u65b9\u6cd5\u3002</p> <p>initialValue()\u65b9\u6cd5\u4e3aThreadLocal\u8981\u4fdd\u5b58\u7684\u6570\u636e\u7c7b\u578b\u6307\u5b9a\u4e86\u4e00\u4e2a\u521d\u59cb\u5316\u503c\uff0c\u5728ThreadLocal\u4e2d\u9ed8\u8ba4\u8fd4\u56de\u503c\u4e3anull\uff0c\u5b9e\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a  <code>protected T initialValue() {         return null;     }</code> \u6211\u4e48\u53ef\u4ee5\u91cd\u5199initialValue\u65b9\u6cd5\u6765\u8fdb\u884c\u6570\u636e\u7684\u521d\u59cb\u5316\uff0c\u5373\u53ef\u4ee5\u4e0d\u901a\u8fc7set\u65b9\u6cd5\u6765\u7ed9ThreadLocal\u8d4b\u503c\uff0c\u5982\u4e0b\u9762\u7684\u4ee3\u7801\uff1a</p> <pre><code>ThreadLocal&lt;Object&gt; threadLocal = new ThreadLocal&lt;Object&gt;() {\n            @Override\n            protected Object initialValue() {\n                return new Object();\n            }\n        };\n\n        new Thread(() -&gt; {\n            System.out.println(threadLocal.get());\n        }).start();\n        System.out.println(threadLocal.get());\n</code></pre> <p>\u6570\u636e\u8f93\u51fa\u5982\u4e0b\uff0c\u6bcf\u4e00\u4e2a\u60f3\u901a\u8fc7get\u65b9\u6cd5\u83b7\u53d6\u5230\u7684\u503c\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002</p> <pre><code>java.lang.Object@4f90c612\njava.lang.Object@65ab7765\n</code></pre>"},{"location":"MultiThread/ThreadLocal/#threadlocal_2","title":"ThreadLocal\u6e90\u7801\u5206\u6790","text":""},{"location":"MultiThread/ThreadLocal/#sett-t","title":"set(T t)\u65b9\u6cd5","text":"<p>set\u65b9\u6cd5\u4e3b\u8981\u662f\u4e3aThreadLocal\u6307\u5b9a\u5c06\u8981\u88ab\u5b58\u50a8\u7684\u6570\u636e\uff0c\u5982\u679c\u91cd\u5199\u4e86initialValue\u65b9\u6cd5\uff0c\u5728\u4e0d\u9493\u9c7cset\u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u7684\u521d\u59cb\u503c\u662finitialValue\u65b9\u6cd5\u8ba1\u7b97\u7ed3\u679c\u3002</p> <pre><code>//ThreadLocal\u7684set\u65b9\u6cd5\npublic void set(T value) {\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n    }\n//ThreadLocal\u7684createMap\u65b9\u6cd5\nvoid createMap(Thread t, T firstValue) {\n        t.threadLocals = new ThreadLocalMap(this, firstValue);\n    }\n//ThreadLocalMap\u7684set\u65b9\u6cd5\u6e90\u7801\n private void set(ThreadLocal&lt;?&gt; key, Object value) {\n        // We don't use a fast path as with get() because it is at\n        // least as common to use set() to create new entries as\n        // it is to replace existing ones, in which case, a fast\n        // path would fail more often than not.\n\n        Entry[] tab = table;\n        int len = tab.length;\n        int i = key.threadLocalHashCode &amp; (len-1);\n\n        for (Entry e = tab[i];\n                e != null;\n                e = tab[i = nextIndex(i, len)]) {\n            ThreadLocal&lt;?&gt; k = e.get();\n\n            if (k == key) {\n                e.value = value;\n                return;\n            }\n\n            if (k == null) {\n                replaceStaleEntry(key, value, i);\n                return;\n            }\n        }\n\n        tab[i] = new Entry(key, value);\n        int sz = ++size;\n        if (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)\n            rehash();\n    }\n</code></pre> <p>set\u65b9\u6cd5\u7684\u8fd0\u884c\u6d41\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a 1. \u4f7f\u7528Thread.currentThread()\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\uff0c\u6839\u636e\u5f53\u524d\u7ebf\u7a0b\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684ThreadLocalMap\u7684\u6570\u636e\u7ed3\u6784 2. \u5982\u679cmap\u4e3anull\uff0c\u5219\u521b\u5efa\u4e00\u4e2aThreadLocalMap\uff0c\u7528\u5f53\u524dThreadLocal\u5b9e\u4f8b\u4f5c\u4e3akey\uff0c\u5c06\u8981\u5b58\u653e\u7684\u6570\u636e\u4f5c\u4e3avalue\uff0c\u5bf9\u8c61\u5230ThreadLocal\u4e2d\u5219\u662f\u521b\u5efa\u4e86\u4e00\u4e2aEntry 3. \u5982\u679cmap\u4e0d\u4e3anull\uff0c\u8c03\u7528map\u7684set\u65b9\u6cd5\uff0cset\u65b9\u6cd5\u4e2d\u4f1a\u904d\u5386\u6574\u4e2amap\u7684Entry\uff0c\u5982\u679c\u53d1\u73b0Entry\u7684Key\u4e3anull\uff0c\u5219\u76f4\u63a5\u5c06\u5176\u9010\u51fa\u5175\u5668\u4f7f\u7528\u5fc3\u5f97\u6570\u636e\u5360\u7528\u88ab\u9010\u51fa\u6570\u636e\u7684\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e3b\u8981\u662f\u4e3a\u4e86\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f 4. \u63a5\u7740\u521b\u5efa\u5fc3\u5f97Entry\uff0c\u4f7f\u7528ThreadLocal\u4f5c\u4e3aKey\uff0c\u5c06\u8981\u5b58\u653e\u7684\u6570\u636e\u4f5c\u4e3avalue 5. \u6700\u540e\u518d\u6839\u636eThreadLocalMap\u7684\u653e\u5f03\u6570\u636e\u5143\u7d20\u7684\u5927\u5c0f\u548c\u9608\u503c\u505a\u6bd4\u8f83\uff0c\u8fdb\u884c\u53ef\u4ee5\u4e3anull\u7684\u6570\u636e\u9879\u6e05\u7406\u5de5\u4f5c\u3002</p>"},{"location":"MultiThread/ThreadLocal/#gett-t","title":"get(T t)\u65b9\u6cd5","text":"<pre><code>//ThreadLocal\u7684get\u65b9\u6cd5\npublic T get() {\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null) {\n            ThreadLocalMap.Entry e = map.getEntry(this);\n            if (e != null) {\n                @SuppressWarnings(\"unchecked\")\n                T result = (T)e.value;\n                return result;\n            }\n        }\n        return setInitialValue();\n    }\n\nprivate T setInitialValue() {\n        T value = initialValue();\n        Thread t = Thread.currentThread();\n        ThreadLocalMap map = getMap(t);\n        if (map != null)\n            map.set(this, value);\n        else\n            createMap(t, value);\n        return value;\n    }\n</code></pre> <p>get\u65b9\u6cd5\u7684\u5de5\u4f5c\u6d41\u7a0b\u5982\u4e0b\uff1a 1.  \u4f7f\u7528Thread.currentThread()\u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\uff0c\u518d\u901a\u8fc7\u5f53\u524d\u7ebf\u7a0b\u83b7\u53d6\u4e0e\u4e4b\u5173\u8054\u7684ThreadLocalMap\uff0c\u5982\u679c\u83b7\u53d6\u7684\u5230map\uff0c\u5219\u4ee5\u5f53\u524dThreadLocal\u4f5c\u4e3akey\u503c\u83b7\u53d6\u5bf9\u4e8e\u7684Entry\uff0c\u5982\u679cEntry\u4e0d\u4e3anull\uff0c\u5219\u76f4\u63a5\u8fd4\u56deEntry\u7684\u503c\u3002 2.  \u5982\u679c\u901a\u8fc7\u5f53\u524d\u7ebf\u7a0b\u83b7\u53d6\u5230\u7684map\u4e3anull\uff0c\u5219\u9700\u8981\u8c03\u7528setInitialValue\u65b9\u6cd5\uff0csetInitialValue\u4e2d\u9996\u5148\u8c03\u7528initialValue\u83b7\u53d6\u521d\u59cb\u503c\uff0c\u518d\u62ff\u5230\u8fd9\u4e2a\u521d\u59cb\u503c\u540e\u8ddf\u4e0a\u9762\u7684set\u65b9\u9762\u7684\u903b\u8f91\u57fa\u672c\u6ca1\u5565\u533a\u522b\u4e86\u3002</p> <p>\u65e0\u8bba\u662fget\u65b9\u6cd5\u8fd8\u662fset\u65b9\u6cd5\uff0c\u90fd\u4e0d\u53ef\u907f\u514d\u5730\u8981\u4e0eThreadLocalMap\u548cEntry\u6253\u4ea4\u9053\uff0cThreadLocalMap\u662f\u4e00\u4e2a\u5b8c\u5168\u7c7b\u4f3c\u4e8eHashMap\u7684\u6570\u636e\u7ed3\u6784\uff0c\u4ec5\u4ec5\u7528\u4e8e\u5b58\u653e\u7ebf\u7a0b\u5b58\u653e\u5728ThreadLocal\u4e2d\u7684\u6570\u636e\u5907\u4efd\uff0cThreadLocalMap\u4e2d\u7684\u6240\u6709\u65b9\u6cd5\u5bf9\u5916\u90e8\u90fd\u662f\u4e0d\u53ef\u89c1\u7684\u3002 \u5728ThreadLocalMap\u4e2d\u7528\u4e8e\u5b58\u50a8\u6570\u636e\u7684\u662fEntry\uff0c\u5b83\u662f\u4e00\u4e2aWeakReference\u7c7b\u578b\u7684\u5b50\u7c7b\uff0c\u4e4b\u6240\u4ee5\u8fd9\u6837\u8bbe\u8ba1\u662f\u4e3a\u4e86\u80fd\u591f\u5728JVM\u53d1\u751f\u5783\u573e\u56de\u6536\u4e8b\u4ef6\u65f6\uff0c\u80fd\u591f\u81ea\u52a8\u56de\u6536\u9632\u6b62\u53d1\u73b0\u5185\u5b58\u6cc4\u6f0f\u3002</p>"},{"location":"MultiThread/ThreadLocal/#threadlocal_3","title":"ThreadLocal\u5185\u5b58\u793a\u610f\u56fe","text":"<p>\u4e0a\u9762\u5bf9\u4e8e\u65b9\u6cd5\u6d41\u7a0b\u7684\u5206\u6790\u8fd8\u662f\u663e\u5f97\u6709\u70b9\u62bd\u8c61\uff0c\u6211\u4eec\u6765\u770b\u4e0b\u9762\u8fd9\u5f20\u56fe\uff0c\u6211\u662f\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u4e0b\u6765\u7684\uff0c\u597d\u591a\u535a\u5ba2\u90fd\u5728\u5f15\u7528\u8fd9\u5f20\u56fe\uff0c\u5bf9\u4e8eThreadLocal\u8fd0\u884c\u65f6\u5185\u5b58\u8868\u73b0\u7684\u5f88\u5f62\u8c61\u3002 </p> <ul> <li>\u6bcf\u4e2athread\u4e2d\u90fd\u5b58\u5728\u4e00\u4e2amap(ThreadLocalMap), map\u7684\u7c7b\u578b\u662fThreadLocal.ThreadLocalMap\u3002</li> <li>ThreadLocalMap\u4e2d\u7684key\u4e3a\u4e00\u4e2athreadlocal\u5b9e\u4f8b\uff0cvalue\u5219\u662f\u6211\u4eec\u9700\u8981\u5b58\u50a8\u7684\u503c\u3002</li> <li>ThreadLocalMap\u4e2d\u662f\u7528\u5f31\u5f15\u7528\u5305\u542b\u7684hreadlocal\u5b9e\u4f8b\uff0c\u5f53threadlocal\u5b9e\u4f8b\u7f6e\u4e3anull\u4ee5\u540e,\u6ca1\u6709\u4efb\u4f55\u5f3a\u5f15\u7528\u6307\u5411threadlocal\u5b9e\u4f8b,\u6240\u4ee5threadlocal\u5c06\u4f1a\u88abgc\u56de\u6536\u3002</li> <li>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7684value\u5374\u4e0d\u80fd\u56de\u6536,\u56e0\u4e3a\u5b58\u5728\u4e00\u6761\u4ececurrent thread\u8fde\u63a5\u8fc7\u6765\u7684\u5f3a\u5f15\u7528. \u53ea\u6709\u5f53\u524dthread\u7ed3\u675f\u4ee5\u540e, current thread\u5c31\u4e0d\u4f1a\u5b58\u5728\u6808\u4e2d,\u5f3a\u5f15\u7528\u65ad\u5f00, Current Thread, Map, value\u5c06\u5168\u90e8\u88abGC\u56de\u6536\u3002</li> </ul> <p>\u4e4b\u524d\u770b\u5230\u7f51\u4e0a\u6709\u4eba\u95ee\u8fc7\u8fd9\u7c7b\u95ee\u9898\uff0cThreadLocalMap.Entry\u4f7f\u7528\u5f31\u5f15\u7528\uff0c\u5f53\u5806\u5185\u5b58\u5403\u7d27\u65f6\uff0c\u4f1a\u4e0d\u4f1a\u56e0\u4e3aThreadLocal\u88ab\u56de\u6536\u5bfc\u81f4\u8be5\u7ebf\u7a0b\u83b7\u53d6\u4e0d\u5230\u5bf9\u5e94\u7684\u5b9e\u4f8b\uff1f</p> <p>\u5176\u5b9e\u56e0\u4e3a\u5f53\u524dThread\u4f1a\u6301\u6709\u8fd9\u4e2aThreadLocalMap\uff0cJava\u91cc\u7684Thread\u7c7b\u6bcf\u4e00\u4e2a\u90fd\u4f1a\u4e00\u4e2aThreadLocalMap\uff0c\u8fd9\u4e2a\u662f\u5f3a\u5f15\u7528\uff0c\u867d\u7136ThreadLocalMap\u4e2d\u7684key\u662f\u5f31\u5f15\u7528\u7684ThreadLocal\uff0c\u5f53\u5185\u5b58\u5403\u7d27\u65f6\uff0c\u8fd9\u4e2amap\u4ecd\u7136\u4f1a\u6709\u4e00\u4e2a\u5f3a\u5f15\u7528\u6307\u5411\u5b83\uff0c\u6240\u4ee5gc\u5e76\u4e0d\u4f1a\u56de\u6536\u8fd9\u90e8\u5206\u5185\u5b58\uff0c\u53ea\u6709\u5f53\u5f53\u524dThread\u9000\u51fa\u540e\uff0c\u5f3a\u5f15\u7528\u65ad\u5f00\uff0c\u8fd9\u90e8\u5206\u624d\u6709\u53ef\u80fd\u4f1a\u88abGC\u56de\u6536\u3002</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/","title":"Synchronized\u5173\u952e\u5b57\u7684\u539f\u7406","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0csynchronized\u5173\u952e\u5b57\u7684\u539f\u7406</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#synchronized","title":"synchronized\u5173\u952e\u5b57","text":""},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#synchronized_1","title":"\u4ec0\u4e48\u662fsynchronized","text":"<p>JDK\u5b98\u7f51\u5bf9synchronized\u5173\u952e\u5b57\u6709\u4e2a\u6bd4\u8f83\u6743\u5a01\u7684\u89e3\u91ca\u3002</p> <p>Synchronized keyword enable a simple strategy for preventing thread interference and memory consistency errors: if an object is visible to more than one thread, all reads or writes to that object's variables ard done through synchronized methods.</p> <p>\u4e0a\u8ff0\u89e3\u91ca\u7684\u610f\u601d\u662f\uff1asynchronized\u5173\u952e\u5b57\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u7b56\u7565\u6765\u9632\u6b62\u7ebf\u7a0b\u5e72\u6270\u548c\u5185\u5b58\u4e00\u81f4\u6027\u9519\u8bef\uff0c\u5982\u679c\u4e00\u4e2a\u5bf9\u8c61\u5bf9\u591a\u4e2a\u7ebf\u7a0b\u662f\u53ef\u89c1\u7684\uff0c\u90a3\u4e48\u5bf9\u8be5\u5bf9\u8c61\u7684\u6240\u6709\u8bfb\u6216\u8005\u5199\u90fd\u5c06\u901a\u8fc7\u540c\u6b65\u7684\u65b9\u5f0f\u6765\u8fdb\u884c\uff0c\u5177\u4f53\u8868\u73b0\u5982\u4e0b\uff1a - synchronized\u5173\u952e\u5b57\u63d0\u4f9b\u4e86\u4e00\u79cd\u9501\u7684\u673a\u5236\uff0c\u80fd\u591f\u786e\u4fdd\u5171\u4eab\u53d8\u91cf\u7684\u4e92\u65a5\u8bbf\u95ee\uff0c\u4ece\u800c\u9632\u6b62\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u51fa\u73b0\u3002 - synchronized\u5173\u952e\u5b57\u5305\u62ecmonitor enter\u548cmonitor exit\u4e24\u4e2aJVM\u6307\u4ee4\uff0c\u5b83\u80fd\u591f\u4fdd\u8bc1\u5728\u4efb\u4f55\u65f6\u5019\u4efb\u4f55\u7ebf\u7a0b\u6267\u884c\u5230monitor enter\u6210\u529f\u4e4b\u524d\u90fd\u5fc5\u987b\u4ece\u4e3b\u5185\u5b58\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u800c\u4e0d\u662f\u7f13\u5b58\u4e2d\uff0c\u5728monitor exit\u8fd0\u884c\u6210\u529f\u4e4b\u540e\uff0c\u5171\u4eab\u53d8\u91cf\u88ab\u66f4\u65b0\u540e\u7684\u503c\u5fc5\u987b\u5237\u5165\u4e3b\u5185\u5b58\u3002 - synchronized\u7684\u6267\u884c\u4e25\u683c\u9075\u5b88java happens-before \u89c4\u5219\uff0c\u4e00\u4e2amonitor exit\u6307\u4ee4\u4e4b\u524d\u5fc5\u5b9a\u8981\u6709\u4e00\u4e2amonitor enter\u3002</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#synchronized_2","title":"synchronized\u5173\u952e\u5b57\u7684\u7528\u6cd5","text":"<p>synchronized\u53ef\u4ee5\u7528\u4e8e\u5bf9\u4ee3\u7801\u5757\u6216\u65b9\u6cd5\u8fdb\u884c\u4fee\u9970\uff0c\u800c\u4e0d\u80fd\u591f\u7528\u4e8e\u5bf9class\u4ee5\u53ca\u53d8\u91cf\u8fdb\u884c\u4fee\u9970\u3002</p> <ul> <li>\u540c\u6b65\u65b9\u6cd5</li> </ul> <pre><code>public synchronized void sync() {\n    //...\n}\n</code></pre> <ul> <li>\u540c\u6b65\u65b9\u6cd5\u5757</li> </ul> <pre><code>private final Object lock = new Object();\npublic void sync() {\n    synchronized(lock) {\n        //...\n    }\n}\n</code></pre> <p>\u5173\u4e8e\u540c\u6b65\u4ee3\u7801\u5757\u548c\u540c\u6b65\u65b9\u6cd5\u7684\u533a\u522b\u4e4b\u524d\u5199\u8fc7\u4e00\u4e2a\u5173\u4e8e\u8fd9\u4e2a\u5bf9\u6bd4\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u8fd9\u7bc7\u6587\u7ae0\u3002 java\u4e2d\u7684synchronized\uff08\u540c\u6b65\u4ee3\u7801\u5757\u548c\u540c\u6b65\u65b9\u6cd5\u7684\u533a\u522b\uff09</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#synchronized_3","title":"\u6df1\u5165\u5206\u6790Synchronized\u5173\u952e\u5b57","text":""},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#_1","title":"\u7ebf\u7a0b\u5806\u6808\u5206\u6790","text":"<p>synchronized\u5173\u952e\u5b57\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e92\u65a5\u673a\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u540c\u4e00\u65f6\u523b\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u540c\u6b65\u8d44\u6e90\u3002</p> <p>\u770b\u4e0b\u9762\u8fd9\u6bb5\u7a0b\u5e8f\uff1a</p> <pre><code>import java.util.concurrent.TimeUnit;\n\npublic class TestSync {\n\n    private final static Object lock = new Object();\n\n    public void accessResource() {\n        synchronized(lock) {\n            try {\n                TimeUnit.MINUTES.sleep(10);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n    public static void main(String[] args) {\n        final TestSync sync = new TestSync();\n        for(int i =0;i&lt;5;i++) {\n            new Thread(){\n                @Override\n                public void run() {\n                    sync.accessResource();\n                }   \n            }.start();\n        }\n    }\n}\n\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5accessResource\uff0c\u5e76\u4e14\u4f7f\u7528synchronized\u6765\u5bf9\u4ee3\u7801\u8fdb\u884c\u540c\u6b65\uff0c\u540c\u65f6\u5b9a\u4e49\u4e865\u4e2a\u7ebf\u7a0b\u8c03\u7528accessResource\u65b9\u6cd5\uff0c\u7531\u4e8esynchronized\u7684\u4e92\u65a5\u6027\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u5f97lock\u7684monitor\u9501\uff0c\u5176\u4ed6\u7ebf\u7a0b\u53ea\u80fd\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u7b49\u5f85\u83b7\u53d6lock\u7684monitor\u9501\u3002</p> <p>\u9488\u5bf9\u8fd9\u4e2amonitor\u9501\u6211\u4eec\u5982\u4f55\u4ece\u7ebf\u7a0b\u5806\u6808\u4fe1\u606f\u6765\u770b\u5462\uff1f</p> <p>\u5176\u5b9e\uff0cjstack\u547d\u4ee4\u5728Java\u4e2d\u53ef\u4ee5\u7528\u6765\u6253\u5370\u8fdb\u7a0b\u7684\u7ebf\u7a0b\u5806\u6808\u4fe1\u606f\u3002</p> <p>\u6211\u4eec\u6765\u8fd0\u884c\u8fd9\u4e2aJava\u7a0b\u5e8f\uff0c\u5728\u7ec8\u7aef\u901a\u8fc7top\u547d\u4ee4\u67e5\u770b\u8fd0\u884c\u8d77\u6765\u7684Java\u7a0b\u5e8f\u7684\u8fdb\u7a0bid\uff0c\u7136\u540e\u6267\u884cjstack \u2018pid\u2019\u3002</p> <p>\u6211\u4eec\u6765\u770b\u4e0b\u6253\u5370\u51fa\u6765\u7684\u4fe1\u606f\uff1a </p> <p>\u901a\u8fc7\u622a\u56fe\u53ef\u4ee5\u770b\u5230Thread-0\u6301\u6709monitor&lt;0x00000007955f2130&gt;\u7684\u9501\u5e76\u4e14\u5904\u4e8e\u4f11\u7720\u72b6\u6001\u4e2d\uff0c\u800c\u5176\u4ed6\u51e0\u4e2a\u7ebf\u7a0b\u5219\u662f\u5904\u4e8eBLOCKED\u72b6\u6001\u4e2d\uff0c\u5b83\u4eec\u662f\u5728\u7b49\u5f85\u7740\u83b7\u53d6monitor&lt;0x00000007955f2130&gt;\u7684\u9501\u3002</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#jvm","title":"JVM\u6307\u4ee4\u5206\u6790","text":"<p>\u4eceJVM\u6307\u4ee4\u89d2\u5ea6\u518d\u6765\u5206\u6790synchronized\u5173\u952e\u5b57\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528javap\u8fd9\u4e2a\u547d\u4ee4\u6765\u5bf9\u4e0a\u9762\u8fd9\u4e2aTestSync\u7c7b\u751f\u6210\u7684class\u5b57\u8282\u7801\u8fdb\u884c\u53cd\u7f16\u8bd1\uff0c\u5f97\u5230\u4e0b\u9762\u7684JVM\u6307\u4ee4\u3002</p> <pre><code>Compiled from \"TestSync.java\"\npublic class main.TestSync {\n  static {};\n    Code:\n       0: new           #3                  // class java/lang/Object\n       3: dup\n       4: invokespecial #10                 // Method java/lang/Object.\"&lt;init&gt;\":()V\n       7: putstatic     #13                 // Field lock:Ljava/lang/Object;\n      10: return\n\n  public main.TestSync();\n    Code:\n       0: aload_0\n       1: invokespecial #10                 // Method java/lang/Object.\"&lt;init&gt;\":()V\n       4: return\n\n  public void accessResource();\n    Code:\n       0: getstatic     #13                 // Field lock:Ljava/lang/Object;\n       3: dup\n       4: astore_1\n       5: monitorenter\n       6: getstatic     #20                 // Field java/util/concurrent/TimeUnit.MINUTES:Ljava/util/concurrent/TimeUnit;\n       9: ldc2_w        #26                 // long 10l\n      12: invokevirtual #28                 // Method java/util/concurrent/TimeUnit.sleep:(J)V\n      15: goto          23\n      18: astore_2\n      19: aload_2\n      20: invokevirtual #32                 // Method java/lang/InterruptedException.printStackTrace:()V\n      23: aload_1\n      24: monitorexit\n      25: goto          31\n      28: aload_1\n      29: monitorexit\n      30: athrow\n      31: return\n    Exception table:\n       from    to  target type\n           6    15    18   Class java/lang/InterruptedException\n           6    25    28   any\n          28    30    28   any\n\n  public static void main(java.lang.String[]);\n    Code:\n       0: new           #1                  // class main/TestSync\n       3: dup\n       4: invokespecial #44                 // Method \"&lt;init&gt;\":()V\n       7: astore_1\n       8: iconst_0\n       9: istore_2\n      10: goto          27\n      13: new           #45                 // class main/TestSync$1\n      16: dup\n      17: aload_1\n      18: invokespecial #47                 // Method main/TestSync$1.\"&lt;init&gt;\":(Lmain/TestSync;)V\n      21: invokevirtual #50                 // Method main/TestSync$1.start:()V\n      24: iinc          2, 1\n      27: iload_2\n      28: iconst_5\n      29: if_icmplt     13\n      32: return\n}\n</code></pre> <p>\u4ece\u4e0a\u9762\u7684\u6307\u4ee4\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u5728accessResource()\u65b9\u6cd5\u4e2d\uff0c\u5148\u540e\u51fa\u73b0\u4e86\u4e00\u4e2amonitor enter\u548c\u4e24\u4e2amonitor exit\u3002</p> <p>\u6211\u4eec\u4e3b\u8981\u9009\u53d6accessResource()\u8fd9\u90e8\u5206\u4ee3\u7801\u5757\u6765\u91cd\u70b9\u5206\u6790\u3002</p> <pre><code>public void accessResource();\n    Code:\n       0: getstatic     #13                 //\u2460\u83b7\u53d6lock\n       3: dup\n       4: astore_1\n       5: monitorenter                      //\u2461\u6267\u884cmonitorenter JVM\u6307\u4ee4\n       6: getstatic     #20                 // Field java/util/concurrent/TimeUnit.MINUTES:Ljava/util/concurrent/TimeUnit;\n       9: ldc2_w        #26                 // long 10l\n      12: invokevirtual #28                 // Method java/util/concurrent/TimeUnit.sleep:(J)V\n      15: goto          23                  //\u2462\u8df3\u8f6c\u523023\u884c\n      18: astore_2\n      19: aload_2\n      20: invokevirtual #32                 // Method java/lang/InterruptedException.printStackTrace:()V\n      23: aload_1                           //\u2463\n      24: monitorexit                       //\u2464 \u6267\u884cmonitor exit JVM\u6307\u4ee4\n      25: goto          31\n      28: aload_1\n      29: monitorexit\n      30: athrow\n      31: return\n</code></pre> <p>\u9996\u5148\u2460\u83b7\u53d6\u5230lock\u5f15\u7528\uff0c\u7136\u540e\u6267\u884c\u2461monitorenter JVM\u6307\u4ee4\uff0c\u4f11\u7720\u7ed3\u675f\u540egoto\u81f3\u2462monitorexit\u7684\u4f4d\u7f6e \uff08astore_n\u8868\u793a\u5b58\u50a8\u5f15\u7528\u5230\u672c\u5730\u53d8\u91cf\u8868\uff1baload_n\u8868\u793a\u4ece\u672c\u5730\u53d8\u91cf\u8868\u52a0\u8f7d\u5e94\u7528\uff1bgetstatic\u8868\u793a\u4ececlass\u4e2d\u83b7\u53d6\u9759\u6001\u5c5e\u6027\uff09</p> <p>monitorenter</p> <p>\u6bcf\u4e00\u4e2a\u5bf9\u8c61\u90fd\u4e0e\u4e00\u4e2amonitor\u76f8\u5173\u8054\uff0c\u4e00\u4e2amonitor\u7684lock\u7684\u9501\u53ea\u80fd\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u5728\u540c\u4e00\u65f6\u95f4\u83b7\u5f97\uff0c\u5728\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u5f97\u4e0e\u5bf9\u8c61\u5173\u8054\u7684monitor\u7684\u6240\u6709\u6743\u65f6\u4f1a\u53d1\u751f\u5982\u4e0b\u7684\u51e0\u4ef6\u4e8b\u60c5\u3002</p> <ul> <li>\u5982\u679cmonitor\u7684\u8ba1\u6570\u5668\u4e3a0\uff0c\u5219\u610f\u5473\u7740\u8be5monitor\u7684lock\u8fd8\u6ca1\u6709\u88ab\u83b7\u5f97\uff0c\uff0c\u67d0\u4e2a\u7ebf\u7a0b\u83b7\u5f97\u4e4b\u540e\u5c06\u7acb\u5373\u5bf9\u8be5\u8ba1\u6570\u5668\u52a0\u4e00\uff0c\u4ece\u6b64\u8be5\u7ebf\u7a0b\u5c31\u662f\u8fd9\u4e2amonitor\u7684\u6240\u6709\u8005\u4e86\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u5df2\u7ecf\u62e5\u6709\u8be5\u7ebf\u7a0b\u6240\u6709\u6743\u7684\u7ebf\u7a0b\u91cd\u5165\uff0c\u5219\u4f1a\u5bfc\u81f4monitor\u7684\u8ba1\u6570\u5668\u518d\u6b21\u7d2f\u52a0\u3002</li> <li>\u5982\u679cmonitor\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u6240\u62e5\u6709\uff0c\u5219\u5176\u4ed6\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u8be5monitor\u6240\u6709\u6743\u65f6\uff0c\u4f1a\u88ab\u9677\u5165\u963b\u585e\u72b6\u6001\u76f4\u5230monitor\u53d8\u4e3a0\uff0c\u624d\u80fd\u518d\u6b21\u5c1d\u8bd5\u83b7\u53d6\u5bf9monitor\u7684\u6240\u6709\u6743\u3002</li> </ul> <p>monitorexit</p> <p>\u91ca\u653e\u5bf9monitor\u7684\u6240\u6709\u6743\uff0c\u60f3\u8981\u91ca\u653e\u67d0\u4e2a\u5bf9\u8c61\u5173\u8054\u7684monitor\u6240\u6709\u6743\u7684\u524d\u63d0\u662f\uff0c\u4f60\u66fe\u7ecf\u62e5\u6709\u4e86\u6240\u6709\u6743\u3002\u91ca\u653emonitor\u6240\u6709\u6743\u7684\u8fc7\u7a0b\u6bd4\u8f83\u7b80\u5355\uff0c\u5c31\u662f\u5c06monitor\u7684\u8ba1\u6570\u5668\u51cf\u4e00\uff0c\u5982\u679c\u8ba1\u6570\u5668\u7684\u7ed3\u679c\u4e3a0\uff0c\u5219\u610f\u5473\u7740\u8be5\u7ebf\u7a0b\u4e0d\u5728\u62e5\u6709\u5bf9\u8be5monitor\u7684\u6240\u6709\u6743\uff0c\u901a\u4fd7\u5730\u8bb2\u5c31\u662f\u89e3\u9501\u3002</p>"},{"location":"MultiThread/synchronized%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%8E%9F%E7%90%86/#synchronized_4","title":"synchronized\u7684\u9501\u4f18\u5316","text":"<p>\u5728\u865a\u62df\u673a\u89c4\u8303\u5bf9monitorenter\u548cmonitorexit\u7684\u884c\u4e3a\u63cf\u8ff0\u4e2d\uff0c\u6709\u4e24\u70b9\u662f\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\uff0c\u9996\u5148\uff0csynchronized\u540c\u6b65\u5757\u5bf9\u4e8e\u540c\u4e00\u6761\u7ebf\u7a0b\u662f\u53ef\u91cd\u5165\u7684\uff0c\u4e0d\u4f1a\u51fa\u73b0\u81ea\u5df1\u9501\u6b7b\u81ea\u5df1\u7684\u95ee\u9898\u3002\u5176\u6b21\uff0c\u540c\u6b65\u5757\u5728\u5df2\u8fdb\u5165\u7684\u7ebf\u7a0b\u6267\u884c\u5b8c\u4ee5\u524d\uff0c\u4f1a\u963b\u585e\u540e\u9762\u5176\u4ed6\u7ebf\u7a0b\u7684\u8fdb\u5165\u3002</p> <p>Java\u7684\u7ebf\u7a0b\u662f\u6620\u5c04\u5230\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u4e0a\u7684\uff0c\u8981\u963b\u585e\u6216\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u90fd\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u6765\u5e2e\u5fd9\u5b8c\u6210\uff0c\u8fd9\u5c31\u9700\u8981\u4ece\u7528\u6237\u6001\u5207\u5230\u6838\u5fc3\u6001\uff0c\u56e0\u6b64\u72b6\u6001\u8f6c\u6362\u9700\u8981\u8017\u8d39\u5f88\u591a\u7684\u5904\u7406\u5668\u65f6\u95f4\uff0c\u5bf9\u4e8e\u7b80\u5355\u7684\u540c\u6b65\u5757\uff08\u5982\u88absynchronized\u4fee\u9970\u7684getter\u6216setter\u65b9\u6cd5\uff09\uff0c\u72b6\u6001\u8f6c\u6362\u6d88\u8017\u7684\u65f6\u95f4\u6709\u53ef\u80fd\u6bd4\u7528\u6237\u4ee3\u7801\u6267\u884c\u7684\u65f6\u95f4\u8fd8\u8981\u957f\u3002\u6240\u4ee5synchronized\u662fJava\u8bed\u8a00\u4e2d\u7684\u4e00\u4e2a\u91cd\u91cf\u7ea7\u7684\u64cd\u4f5c\u3002</p> <p>\u5176\u5b9e\u5927\u591a\u6570\u65f6\u5019\uff0c\u5171\u4eab\u6570\u636e\u7684\u9501\u5b9a\u72b6\u6001\u4e00\u822c\u53ea\u4f1a\u6301\u7eed\u5f88\u77ed\u7684\u4e00\u6bb5\u65f6\u95f4\uff0c\u4e3a\u4e86\u8fd9\u6bb5\u65f6\u95f4\u53bb\u6302\u8d77\u548c\u6062\u590d\u7ebf\u7a0b\u5176\u5b9e\u5e76\u4e0d\u503c\u5f97\u3002</p> <p>\u5982\u679c\u7269\u7406\u673a\u4e0a\u6709\u591a\u4e2a\u5904\u7406\u5668\uff0c\u53ef\u4ee5\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\u7684\u8bdd\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9\u540e\u9762\u6765\u7684\u7ebf\u7a0b\u201c\u7a0d\u5fae\u7b49\u4e00\u4e0b\u201d\uff0c\u4f46\u662f\u5e76\u4e0d\u653e\u5f03\u5904\u7406\u5668\u7684\u6267\u884c\u65f6\u95f4\uff0c\u770b\u770b\u6301\u6709\u9501\u7684\u7ebf\u7a0b\u4f1a\u4e0d\u4f1a\u5f88\u5feb\u91ca\u653e\u9501\u3002\u8fd9\u4e2a\u201c\u7a0d\u5fae\u7b49\u4e00\u4e0b\u201d\u7684\u8fc7\u7a0b\u5c31\u662f\u81ea\u65cb\u3002</p> <p>\u81ea\u65cb\u9501\u5728JDK 1.4\u4e2d\u5df2\u7ecf\u5f15\u5165\uff0c\u5728JDK 1.6\u4e2d\u9ed8\u8ba4\u5f00\u542f\u3002\u53ea\u662f\u5c06\u5f53\u524d\u7ebf\u7a0b\u4e0d\u505c\u5730\u6267\u884c\u5faa\u73af\u4f53\uff0c\u4e0d\u8fdb\u884c\u7ebf\u7a0b\u72b6\u6001\u7684\u6539\u53d8\uff0c\u6240\u4ee5\u54cd\u5e94\u901f\u5ea6\u66f4\u5feb\uff0c\u56e0\u4e3a\u4e0a\u9762\u521a\u8bf4\u5230\uff0c\u7ebf\u7a0b\u7684\u72b6\u6001\u5207\u6362\u4f1a\u8017\u8d39\u5f88\u591aCPU\u65f6\u95f4\u3002\u4f46\u5f53\u7ebf\u7a0b\u6570\u4e0d\u505c\u589e\u52a0\u65f6\uff0c\u6027\u80fd\u4e0b\u964d\u660e\u663e\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u6267\u884c\uff0c\u5360\u7528CPU\u65f6\u95f4\u3002\u5982\u679c\u7ebf\u7a0b\u7ade\u4e89\u4e0d\u6fc0\u70c8\uff0c\u5e76\u4e14\u4fdd\u6301\u9501\u7684\u65f6\u95f4\u6bb5\uff0c\u9002\u5408\u4f7f\u7528\u81ea\u65cb\u9501\u3002</p>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/","title":"\u4e00\u6b21\u641e\u61c2sleep\u3001wait\u3001yield\u3001join\u548cinterrupted\u7ebf\u7a0b\u76f8\u5173\u65b9\u6cd5","text":"<ul> <li>sleep()\u65b9\u6cd5  sleep\u65b9\u6cd5\u4f1a\u4f7f\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u6307\u5b9a\u6beb\u79d2\u6570\u7684\u4f11\u7720\uff0c\u6682\u505c\u6267\u884c\uff0c\u867d\u7136\u7ed9\u5b9a\u4e86\u4e00\u4e2a\u4f11\u7720\u7684\u65f6\u95f4\uff0c\u4f46\u662f\u6700\u7ec8\u8981\u4ee5\u7cfb\u7edf\u7684\u5b9a\u65f6\u5668\u548c\u8c03\u5ea6\u5668\u7684\u7cbe\u51c6\u5ea6\u4e3a\u51c6\uff0c\u4f11\u7720\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u7279\u6027\uff0c\u90a3\u5c31\u662f\u4e0d\u4f1a\u653e\u5f03monitor\u9501\u7684\u6240\u6709\u6743\u3002 sleep()\u4f7f\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u4e0d\u4f1a\u6267\u884c\u3002</li> </ul>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#threadjava-sleepnative","title":"Thread.java -&gt;sleep\uff0c\u8fd9\u662f\u4e00\u4e2anative\u65b9\u6cd5\u3002","text":"<pre><code>  public static native void sleep(long millis) throws InterruptedException;\n</code></pre>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#threadc-jvm_sleep","title":"Thread.c -&gt;JVM_Sleep","text":"<pre><code>...\nstatic JNINativeMethod methods[] = {\n    {\"start0\",           \"()V\",        (void *)&amp;JVM_StartThread},\n    {\"stop0\",            \"(\" OBJ \")V\", (void *)&amp;JVM_StopThread},\n    {\"isAlive\",          \"()Z\",        (void *)&amp;JVM_IsThreadAlive},\n    {\"suspend0\",         \"()V\",        (void *)&amp;JVM_SuspendThread},\n    {\"resume0\",          \"()V\",        (void *)&amp;JVM_ResumeThread},\n    {\"setPriority0\",     \"(I)V\",       (void *)&amp;JVM_SetThreadPriority},\n    {\"yield\",            \"()V\",        (void *)&amp;JVM_Yield},\n    {\"sleep\",            \"(J)V\",       (void *)&amp;JVM_Sleep},\n    {\"currentThread\",    \"()\" THD,     (void *)&amp;JVM_CurrentThread},\n    {\"countStackFrames\", \"()I\",        (void *)&amp;JVM_CountStackFrames},\n    {\"interrupt0\",       \"()V\",        (void *)&amp;JVM_Interrupt},\n    {\"isInterrupted\",    \"(Z)Z\",       (void *)&amp;JVM_IsInterrupted},\n    {\"holdsLock\",        \"(\" OBJ \")Z\", (void *)&amp;JVM_HoldsLock},\n    {\"getThreads\",        \"()[\" THD,   (void *)&amp;JVM_GetAllThreads},\n    {\"dumpThreads\",      \"([\" THD \")[[\" STE, (void *)&amp;JVM_DumpThreads},\n    {\"setNativeName\",    \"(\" STR \")V\", (void *)&amp;JVM_SetNativeThreadName},\n};\n...\n\n</code></pre>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#jvmcpp-jvm_sleep","title":"jvm.cpp -&gt; JVM_Sleep","text":"<pre><code>JVM_ENTRY(void, JVM_Sleep(JNIEnv* env, jclass threadClass, jlong millis))\n  JVMWrapper(\"JVM_Sleep\");\n\n  if (millis &lt; 0) {\n    THROW_MSG(vmSymbols::java_lang_IllegalArgumentException(), \"timeout value is negative\");\n  }\n\n  if (Thread::is_interrupted (THREAD, true) &amp;&amp; !HAS_PENDING_EXCEPTION) {\n    THROW_MSG(vmSymbols::java_lang_InterruptedException(), \"sleep interrupted\");\n  }\n\n  // Save current thread state and restore it at the end of this block.\n  // And set new thread state to SLEEPING.\n  JavaThreadSleepState jtss(thread);\n\n  HS_DTRACE_PROBE1(hotspot, thread__sleep__begin, millis);\n\n  if (millis == 0) {\n    // When ConvertSleepToYield is on, this matches the classic VM implementation of\n    // JVM_Sleep. Critical for similar threading behaviour (Win32)\n    // It appears that in certain GUI contexts, it may be beneficial to do a short sleep\n    // for SOLARIS\n    if (ConvertSleepToYield) {\n      os::yield();\n    } else {\n      ThreadState old_state = thread-&gt;osthread()-&gt;get_state();\n      thread-&gt;osthread()-&gt;set_state(SLEEPING);\n      os::sleep(thread, MinSleepInterval, false);\n      thread-&gt;osthread()-&gt;set_state(old_state);\n    }\n  } else {\n    ThreadState old_state = thread-&gt;osthread()-&gt;get_state();\n    thread-&gt;osthread()-&gt;set_state(SLEEPING);\n    if (os::sleep(thread, millis, true) == OS_INTRPT) {\n      // An asynchronous exception (e.g., ThreadDeathException) could have been thrown on\n      // us while we were sleeping. We do not overwrite those.\n      if (!HAS_PENDING_EXCEPTION) {\n        HS_DTRACE_PROBE1(hotspot, thread__sleep__end,1);\n        // TODO-FIXME: THROW_MSG returns which means we will not call set_state()\n        // to properly restore the thread state.  That's likely wrong.\n        THROW_MSG(vmSymbols::java_lang_InterruptedException(), \"sleep interrupted\");\n      }\n    }\n    thread-&gt;osthread()-&gt;set_state(old_state);\n  }\n  HS_DTRACE_PROBE1(hotspot, thread__sleep__end,0);\nJVM_END \n\n</code></pre> <p>\u5728JVM_Sleep\u65b9\u6cd5\u4e2d\uff0c\u901a\u8fc7thread-&gt;osthread()-&gt;get_state()\u83b7\u53d6 OSThread \u5bf9\u8c61\uff0c\u5e76\u5c06\u5176\u72b6\u6001\u8bbe\u7f6e\u4e3aSLEEPING\u7b49\u5230 sleep \u7ed3\u675f\u540e\u8bbe\u7f6e\u56de\u539f\u6765\u7684\u72b6\u6001\u3002</p>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#sleeposhpp","title":"sleep\u65b9\u6cd5\u662f\u5728os.hpp\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff1a","text":"<pre><code>static int sleep(Thread* thread, jlong ms, bool interruptable);\n</code></pre> <p>sleep\u8fd9\u4e2a\u64cd\u4f5c\u8ddf\u5177\u4f53\u7684\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u73b0\u6709\u5173\uff0c linux\u5bf9\u5e94\u76ee\u5f55\u662f\uff1ajdk-8-hotspot/src/os/linux/vm/os_linux.cpp\uff1b windows\u5bf9\u5e94\u7684\u76ee\u5f55\u662f\uff1ajdk-8-hotspot/src/os/windows/vm/os_windows.cpp\uff1b</p> <p>\u6765\u770b\u4e0bLinux\u4e0bos_windowscpp\u4e2d\u7684sleep\u65b9\u6cd5\uff1a</p> <pre><code>int os::sleep(Thread* thread, jlong ms, bool interruptable) {\n  jlong limit = (jlong) MAXDWORD;\n\n  while(ms &gt; limit) {\n    int res;\n    if ((res = sleep(thread, limit, interruptable)) != OS_TIMEOUT)\n      return res;\n    ms -= limit;\n  }\n\n  assert(thread == Thread::current(),  \"thread consistency check\");\n  OSThread* osthread = thread-&gt;osthread();\n  OSThreadWaitState osts(osthread, false /* not Object.wait() */);\n  int result;\n  if (interruptable) {\n    assert(thread-&gt;is_Java_thread(), \"must be java thread\");\n    JavaThread *jt = (JavaThread *) thread;\n    ThreadBlockInVM tbivm(jt);\n\n    jt-&gt;set_suspend_equivalent();\n    // cleared by handle_special_suspend_equivalent_condition() or\n    // java_suspend_self() via check_and_wait_while_suspended()\n\n    HANDLE events[1];\n    events[0] = osthread-&gt;interrupt_event();\n    HighResolutionInterval *phri=NULL;\n    if(!ForceTimeHighResolution)\n      phri = new HighResolutionInterval( ms );\n    if (WaitForMultipleObjects(1, events, FALSE, (DWORD)ms) == WAIT_TIMEOUT) {\n      result = OS_TIMEOUT;\n    } else {\n      ResetEvent(osthread-&gt;interrupt_event());\n      osthread-&gt;set_interrupted(false);\n      result = OS_INTRPT;\n    }\n    delete phri; //if it is NULL, harmless\n\n    // were we externally suspended while we were waiting?\n    jt-&gt;check_and_wait_while_suspended();\n  } else {\n    assert(!thread-&gt;is_Java_thread(), \"must not be java thread\");\n    Sleep((long) ms);\n    result = OS_TIMEOUT;\n  }\n  return result;\n}\n</code></pre> <p>\u83b7\u53d6 OSThread \u5bf9\u8c61\uff0c\u7136\u540e\u901a\u8fc7 OSThreadWaitState \u8bbe\u7f6e\u7ebf\u7a0b\u72b6\u6001\u4e3a\u7b49\u5f85\uff0c\u4fee\u6539\u64cd\u4f5c\u5206\u522b\u5728\u6784\u9020\u51fd\u6570\u548c\u6790\u6784\u51fd\u6570\u4e2d\u5b9e\u73b0\u3002</p>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#sleepthreadblockinvm","title":"sleep\u65b9\u6cd5\u4e2d\u7684ThreadBlockInVM","text":"<p>\u524d\u9762\u8bf4\u5230 ThreadBlockInVM \u4f1a\u68c0\u67e5\u5f53\u524d\u7ebf\u7a0b\u7528\u4e0d\u7528\u8fdb\u5165 safepoint\uff0c\u5b83\u4e3b\u8981\u7684\u903b\u8f91\u5982\u4e0b\uff1a</p> <p>\u9996\u5148\u8bbe\u7f6e Java \u7ebf\u7a0b\u72b6\u6001\uff0c\u5c06\u72b6\u6001\u52a0\u4e00\uff0c\u7531_thread_in_vm = 6\u53d8\u4e3a_thread_in_vm_trans = 7\uff0c\u4ece\u201c\u8fd0\u884cvm\u672c\u8eab\u4ee3\u7801\u201d\u5230\u201c\u76f8\u5e94\u7684\u8fc7\u5ea6\u72b6\u6001\u201d\u3002 os::is_MP()\u7528\u4e8e\u5224\u65ad\u8ba1\u7b97\u673a\u7cfb\u7edf\u662f\u5426\u4e3a\u591a\u6838\u7cfb\u7edf\uff0c\u591a\u6838\u60c5\u51b5\u4e0b\u9700\u8981\u505a\u5185\u5b58\u5c4f\u969c\u5904\u7406\uff0c\u8fd9\u662f\u4e3a\u4e86\u8ba9\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u80fd\u5b9e\u65f6\u540c\u6b65\u72b6\u6001\u3002 \u5185\u5b58\u5c4f\u969c\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662frderAccess::fence()\uff0c\u5b83\u7684\u5b9e\u73b0\u662f\u76f4\u63a5\u901a\u8fc7CPU\u6307\u4ee4\u6765\u5b9e\u73b0\uff0c\u6c47\u7f16\u6307\u4ee4\u4e3a__asm__ volatile (\"lock; addl $0,0(%%rsp)\" : : : \"cc\", \"memory\");\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4ee3\u4ef7\u6bd4\u8f83\u5927\u3002\u800c\u53e6\u5916\u4e00\u79cd\u4e3aInterfaceSupport::serialize_memory\uff0c\u7531 JVM \u6a21\u62df\u5b9e\u73b0\uff0c\u6548\u7387\u9ad8\u4e00\u70b9\u3002 \u8c03\u7528SafepointSynchronize::block\u5c1d\u8bd5\u5728\u8be5\u5b89\u5168\u70b9\u8fdb\u884c\u963b\u585e\u3002 \u8bbe\u7f6e Java \u7ebf\u7a0b\u72b6\u6001\u4e3a_thread_blocked\uff0c\u5373\u963b\u585e\u3002</p> <ul> <li>wait()\u65b9\u6cd5 \u5728\u5176\u4ed6\u7ebf\u7a0b\u8c03\u7528\u5bf9\u8c61\u7684 notify \u6216 notifyAll \u65b9\u6cd5\u524d\uff0c\u5bfc\u81f4\u5f53\u524d\u7ebf\u7a0b\u7b49\u5f85\u3002\u7ebf\u7a0b\u4f1a\u91ca\u653e\u6389\u5b83\u6240\u5360\u6709\u7684\u201c\u9501\u6807\u5fd7\u201d\uff0c\u4ece\u800c\u4f7f\u522b\u7684\u7ebf\u7a0b\u6709\u673a\u4f1a\u62a2\u5360\u8be5\u9501\u3002\u5f53\u524d\u7ebf\u7a0b\u5fc5\u987b\u62e5\u6709\u5f53\u524d\u5bf9\u8c61\u9501\u3002\u5982\u679c\u5f53\u524d \u7ebf\u7a0b\u4e0d\u662f\u6b64\u9501\u7684\u62e5\u6709\u8005\uff0c\u4f1a\u629b\u51fa IllegalMonitorStateException \u5f02\u5e38\u3002\u5524\u9192\u5f53\u524d\u5bf9\u8c61\u9501\u7684\u7b49\u5f85 \u7ebf\u7a0b\u4f7f\u7528 notify \u6216 notifyAll \u65b9\u6cd5\uff0c\u4e5f\u5fc5\u987b\u62e5\u6709\u76f8\u540c\u7684\u5bf9\u8c61\u9501\uff0c\u5426\u5219\u4e5f\u4f1a\u629b\u51fa IllegalMonitorStateException \u5f02\u5e38\u3002 wait()\u548c notify()\u5fc5\u987b\u5728 synchronized \u51fd\u6570\u6216 synchronized block \u4e2d\u8fdb\u884c\u8c03\u7528\u3002\u5982\u679c\u5728 non- synchronized \u51fd\u6570\u6216 non-synchronized block \u4e2d\u8fdb\u884c\u8c03\u7528\uff0c\u867d\u7136\u80fd\u7f16\u8bd1\u901a\u8fc7\uff0c\u4f46\u5728\u8fd0\u884c\u65f6 \u4f1a\u53d1\u751f IllegalMonitorStateException \u7684\u5f02\u5e38\u3002</li> </ul>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#wait","title":"wait\u65b9\u6cd5\u7684\u8c03\u7528\u6d41\u7a0b","text":"<p>wait\u662fJava\u4e2dObject.java\u4e2d\u7684\u65b9\u6cd5,\u8fd9\u4e2a\u540e\u9762\u8c03\u7528\u7684\u662fwait\u8fd9\u4e2anative\u65b9\u6cd5\u3002</p> <pre><code>public final void wait() throws InterruptedException {\n    wait(0);\n}\n\npublic final native void wait(long timeout) throws InterruptedException;\n</code></pre> <p>Java\u5c42\u58f0\u660e\u7684\u8fd9\u4e2await\u65b9\u6cd5\u5728Object.c\u4e2d\uff0cwait\u540c\u6837\u4e5f\u662f\u4e00\u4e2a\u6ce8\u518c\u5230JVM\u4e2d\u7684\u65b9\u6cd5\uff0c\u5177\u4f53\u7684\u5b9e\u73b0\u5728JVM_MonitorWait\u4e2d\u3002</p> <pre><code>...\nstatic JNINativeMethod methods[] = {\n    {\"hashCode\",    \"()I\",                    (void *)&amp;JVM_IHashCode},\n    {\"wait\",        \"(J)V\",                   (void *)&amp;JVM_MonitorWait},\n    {\"notify\",      \"()V\",                    (void *)&amp;JVM_MonitorNotify},\n    {\"notifyAll\",   \"()V\",                    (void *)&amp;JVM_MonitorNotifyAll},\n    {\"clone\",       \"()Ljava/lang/Object;\",   (void *)&amp;JVM_Clone},\n};\n...\n\n</code></pre> <p>jvm.cpp\u4e2d\u7684JVM_MonitorWait  </p> <pre><code>JVM_ENTRY(void, JVM_MonitorWait(JNIEnv* env, jobject handle, jlong ms))\n  JVMWrapper(\"JVM_MonitorWait\");\n  Handle obj(THREAD, JNIHandles::resolve_non_null(handle));\n  assert(obj-&gt;is_instance() || obj-&gt;is_array(), \"JVM_MonitorWait must apply to an object\");\n  JavaThreadInObjectWaitState jtiows(thread, ms != 0);\n  if (JvmtiExport::should_post_monitor_wait()) {\n    JvmtiExport::post_monitor_wait((JavaThread *)THREAD, (oop)obj(), ms);\n  }\n  ObjectSynchronizer::wait(obj, ms, CHECK);\nJVM_END\n</code></pre> <p>\u63a5\u7740\u8c03\u7528objectMonitor.cpp\u4e2d\u7684void ObjectMonitor::wait(jlong millis, bool interruptible, TRAPS)\u65b9\u6cd5\u3002</p> <p>\u8fd9\u4e2await\u65b9\u6cd5\u592a\u957f\uff0c\u5c31\u4e0d\u8d34\u4ee3\u7801\u4e86\u3002</p> <ul> <li>yield \u65b9\u6cd5 yield\u5c5e\u4e8e\u4e00\u79cd\u542f\u53d1\u5f0f\u65b9\u6cd5\uff0c\u5c82\u4f1a\u63d0\u9192\u8c03\u5ea6\u5668\u6211\u613f\u610f\u653e\u5f03\u5f53\u524dCPU\u8d44\u6e90\uff0c\u5982\u679cCPU\u8d44\u6e90\u4e0d\u7d27\u5f20\uff0c\u5219\u4f1a\u5ffd\u7565\u8fd9\u79cd\u63d0\u9192\u3002</li> </ul> <pre><code>import java.util.function.IntFunction;\nimport java.util.stream.IntStream;\n\npublic class ThreadYield {\n    public static void main(String[] args) {\n        IntStream.range(0, 2).mapToObj(new IntFunction&lt;Thread&gt;(){\n            @Override\n            public Thread apply(int value) {\n                return ThreadYield.create(value);\n            }}).forEach(new Consumer&lt;Thread&gt;() {\n                @Override\n                public void accept(Thread t) {\n                    t.start();\n                }\n            });\n    }\n\n    private static Thread create(int index) {\n        return new Thread(){\n            @Override\n            public void run() {\n                //if(index == 0) Thread.yield();\n                System.out.println(index);\n            }\n        };\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u7a0b\u5e8f\u8fd0\u884c\u5f88\u591a\u6b21,\u4f60\u4f1a\u53d1\u73b0\u8f93\u51fa\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u6709\u65f6\u5019\u662f0\u6700\u5148\u6253\u5370\u51fa\u6765\uff0c\u6709\u65f6\u5019\u662f1\u6700\u5148\u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u5f53\u4f60\u6253\u5f00\u4ee3\u7801\u7684\u6ce8\u91ca\u90e8\u5206\uff0c\u4f60\u4f1a\u53d1\u73b0\uff0c\u987a\u5e8f\u59cb\u7ec8\u662f0\uff0c1\u3002</p> <p>\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u5982\u679c\u5148\u83b7\u5f97\u4e86CPU\u8d44\u6e90\uff0c\u5b83\u4f1a\u6bd4\u8f83\u8c26\u865a\uff0c\u4e3b\u52a8\u544a\u8bc9CPU\u8c03\u5ea6\u5668\u91ca\u653e\u4e86\u539f\u672c\u5c5e\u4e8e\u81ea\u5df1\u7684\u8d44\u6e90\uff0c\u4f46\u662fyield\u77e5\u8bc6\u4e00\u4e2a\u63d0\u793a\uff0cCPU\u8c03\u5ea6\u5668\u5e76\u4e0d\u4f1a\u62c5\u4fdd\u6bcf\u6b21\u90fd\u80fd\u6ee1\u8db3yield\u63d0\u793a\u3002</p> <p>\u8c03\u7528 yield \u65b9\u6cd5\u5e76\u4e0d\u4f1a\u8ba9\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u800c\u662f\u8ba9\u7ebf\u7a0b\u91cd\u56de\u5c31\u7eea\u72b6\u6001\uff0c\u5b83\u53ea\u9700\u8981\u7b49\u5f85\u91cd\u65b0 \u83b7\u53d6 CPU \u6267\u884c\u65f6\u95f4\uff0c\u8fd9\u4e00\u70b9\u662f\u548c sleep \u65b9\u6cd5\u4e0d\u4e00\u6837\u7684\u3002</p> <ul> <li>join \u65b9\u6cd5 join\u67d0\u4e2a\u7ebf\u7a0bA\uff0c\u4f1a\u4f7f\u5f53\u524d\u7ebf\u7a0bB\u8fdb\u5165\u7b49\u5f85\uff0c\u76f4\u5230\u7ebf\u7a0bA\u7ed3\u675f\u751f\u547d\u5468\u671f\uff0c\u6216\u8005\u5230\u8fbe\u7ed9\u5b9a\u7684\u65f6\u95f4\uff0c\u90a3\u4e48\u5728\u6b64\u671f\u95f4B\u7ebf\u7a0b\u662f\u5904\u4e8eBLOCKED\u7684\uff0c\u800c\u4e0d\u662fA\u7ebf\u7a0b\u3002</li> </ul> <pre><code>import java.util.ArrayList;\nimport java.util.List;\nimport java.util.concurrent.TimeUnit;\nimport java.util.function.Consumer;\nimport java.util.function.IntFunction;\nimport java.util.stream.IntStream;\n\npublic class ThreadJoin {\n\n    public static void main(String[] args) throws InterruptedException {\n        List&lt;Thread&gt; threads = new ArrayList&lt;Thread&gt;();\n        IntStream.range(0, 2).mapToObj(new IntFunction&lt;Thread&gt;(){\n            @Override\n            public Thread apply(int value) {\n                return ThreadJoin.create(value);\n            }}).forEach(new Consumer&lt;Thread&gt;() {\n                @Override\n                public void accept(Thread t) {\n                    t.start();\n                    threads.add(t);\n                }\n            });\n\n        for(Thread thread:threads) {\n            thread.join();\n        }\n        for(int i =0;i&lt;3;i++) {\n            System.out.println(Thread.currentThread().getName() + \"#\" + i);\n            shortSleep();\n        }\n    }\n\n    private static Thread create(int seq) {\n        return new Thread(seq + \"\"){\n            @Override\n            public void run() {\n                for(int i=0;i&lt; 3;i++) {\n                    System.out.println(Thread.currentThread().getName() + \"#\" + i);\n                    shortSleep();\n                }\n            }\n        };\n    }\n\n    private static void shortSleep() {\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u4e0a\u9762\u7684\u7a0b\u5e8f\u4f60\u5c31\u4f1a\u53d1\u73b0\u7ebf\u7a0b1\u548c\u7ebf\u7a0b2\u4ea4\u66ff\u5730\u8f93\u51fa\u76f4\u5230\u5b83\u4eec\u751f\u547d\u5468\u671f\u7ed3\u675f\uff0cmain\u7ebf\u7a0b\u7684\u5faa\u73af\u624d\u4f1a\u5f00\u59cb\u6267\u884c\uff0c\u7a0b\u5e8f\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>0#0\n1#0\n0#1\n1#1\n0#2\n1#2\nmain#0\nmain#1\nmain#2\n</code></pre> <p>\u5982\u679c\u5c06join\u90e8\u5206\u7684\u4ee3\u7801\u6ce8\u91ca\u6389\uff0c\u90a3\u4e48\u4e09\u4e2a\u7ebf\u7a0b\u4f1a\u4ea4\u66ff\u5730\u8f93\u51fa\uff0c\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>0#0\nmain#0\n1#0\n1#1\n0#1\nmain#1\n0#2\n1#2\nmain#2\n</code></pre>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#interrupt","title":"interrupt\u65b9\u6cd5","text":"<p>\u5982\u4e0b\u65b9\u6cd5\u4f1a\u4f7f\u5f97\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u800c\u8c03\u7528\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\u4f1a\u6253\u65ad\u963b\u585e\u3002 - Object\u7684wait\u65b9\u6cd5 - Object\u7684wait(long)\u65b9\u6cd5 - Thread\u7684sleep(long)\u65b9\u6cd5 - Thread\u7684join\u65b9\u6cd5 - InterruptibleChannel\u7684io\u64cd\u4f5c - Selector\u7684wakeup\u65b9\u6cd5 - \u5176\u4ed6\u65b9\u6cd5</p> <p>\u4e0a\u8ff0\u82e5\u5e72\u65b9\u6cd5\u90fd\u4f1a\u4f7f\u5f97\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u82e5\u53e6\u5916\u7684\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528\u88ab\u963b\u585e\u7ebf\u7a0b\u7684interrupt\u65b9\u6cd5\uff0c\u5219\u4f1a\u6253\u65ad\u8fd9\u79cd\u963b\u585e\uff0c\u56e0\u6b64\u8fd9\u79cd\u65b9\u6cd5\u6709\u65f6\u4f1a\u88ab\u79f0\u4e3a\u53ef\u4e2d\u65ad\u65b9\u6cd5\uff0c\u4f46\u662f\uff0c\u6253\u65ad\u4e00\u4e2a\u7ebf\u7a0b\u5e76\u4e0d\u7b49\u4e8e\u8be5\u7ebf\u7a0b\u751f\u547d\u5468\u671f\u4f1a\u7ed3\u675f\uff0c\u4ec5\u4ec5\u662f\u6253\u65ad\u4e86\u5f53\u524d\u7ebf\u7a0b\u7684\u963b\u585e\u72b6\u6001\u3002</p> <p>\u4e00\u65e6\u7ebf\u7a0b\u5728\u963b\u585e\u7684\u60c5\u51b5\u4e0b\u88ab\u6253\u65ad\uff0c\u90fd\u4f1a\u629b\u51fa\u4e00\u4e2a\u79f0\u4e3aInterruptException\u7684\u5f02\u5e38\uff0c\u8fd9\u4e2a\u5f02\u5e38\u5c31\u50cf\u4e00\u4e2asignal(\u4fe1\u53f7)\u4e00\u6837\u901a\u77e5\u5f53\u524d\u7ebf\u7a0b\u88ab\u6253\u65ad\u4e86\u3002</p> <p>interrupt\u8fd9\u4e2a\u65b9\u6cd5\u5230\u4e86\u505a\u4e86\u4ec0\u4e48\u6837\u7684\u4e8b\u60c5\u5462\uff1f\u5728\u4e00\u4e2a\u7ebf\u7a0b\u5185\u5b58\u5b58\u5728\u7740\u540d\u4e3ainterrupt flag\u7684\u6807\u8bc6\uff0c\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u88abinterrupt\uff0c\u90a3\u4e48\u4ed6\u7684flag\u5c06\u88ab\u8bbe\u7f6e\u4e3atrue\uff0c\u4f46\u662f\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u6b63\u5728\u6267\u884c\u53ef\u4e2d\u65ad\u65b9\u6cd5\u88ab\u963b\u585e\u65f6\uff0c\u8c03\u7528interrupt\u65b9\u6cd5\u5c06\u5176\u4e2d\u65ad\uff0c\u8fd9\u4e2a\u65f6\u5019\u5b83\u7684flag\u4f1a\u88ab\u6e05\u9664\uff0c\u6e05\u9664\u5373\u8bbe\u7f6e\u4e3afalse\u3002</p> <p>\u5177\u4f53\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u7a0b\u5e8f\u4ee3\u7801\uff1a</p> <pre><code>import java.util.concurrent.TimeUnit;\n\npublic class ThreadInterrupt {\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread = new Thread(){\n            @Override\n            public void run() {\n                while(true) {\n                    //loop\n                }\n            }\n        };\n        thread.start();\n        TimeUnit.MILLISECONDS.sleep(2);\n        System.out.println(\"Thread is interrupted:  \" + thread.isInterrupted());\n        thread.interrupt();\n        System.out.println(\"Thread is interrupted:  \" + thread.isInterrupted());\n    }\n}\n\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>Thread is interrupted:  false\nThread is interrupted:  true\n\n</code></pre> <p>\u4e0a\u9762\u7684run\u65b9\u6cd5\u4e2d\u6211\u4eec\u5199\u4e86\u4e2a\u6b7b\u5faa\u73af\uff0c\u8fd9\u91cc\u6ca1\u6709\u4f7f\u7528sleep\u65b9\u6cd5\uff0c\u56e0\u4e3asleep\u662f\u53ef\u4e2d\u65ad\u65b9\u6cd5\uff0c\u53ef\u4e2d\u65ad\u65b9\u6cd5\u5728\u6355\u83b7InterruptException\u540e\u4f1a\u5c06\u7ebf\u7a0binterrupt\u590d\u4f4d\u3002</p> <p>\u6211\u4eec\u628a\u7a0b\u5e8f\u6539\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>import java.util.concurrent.TimeUnit;\n\npublic class ThreadInterrupt {\n\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread = new Thread(){\n            @Override\n            public void run() {\n                while(true) {\n                    try {\n                        TimeUnit.MINUTES.sleep(2);\n                    } catch (InterruptedException e) {\n                        System.out.println(\"I am be interrupted:  \" + isInterrupted());\n                    }\n                }\n            }\n        };\n        thread.setDaemon(true);\n        thread.start();\n        TimeUnit.MILLISECONDS.sleep(2);\n        System.out.println(\"Thread is interrupted:  \" + thread.isInterrupted());\n        thread.interrupt();\n        System.out.println(\"Thread is interrupted:  \" + thread.isInterrupted());\n    }\n\n}\n\n</code></pre> <p>\u7531\u4e8e\u5728run\u65b9\u6cd5\u4e2d\u4f7f\u7528\u4e86sleep\u8fd9\u4e2a\u53ef\u4e2d\u65ad\u65b9\u6cd5\uff0c\u5b83\u4f1a\u6355\u83b7\u5230\u4e2d\u65ad\u4fe1\u53f7\uff0c\u5e76\u4e14\u4f1a\u64e6\u9664interrupt\u8868\u793a\uff0c\u56e0\u6b64\u7a0b\u5e8f\u7684\u6267\u884c\u7ed3\u679c\u90fd\u4f1a\u662ffalse\u3002</p> <pre><code>Thread is interrupted:  false\nI am be interrupted:  false\nThread is interrupted:  false\n\n</code></pre>"},{"location":"MultiThread/%E4%B8%80%E6%AC%A1%E6%90%9E%E6%87%82sleep%E3%80%81wait%E3%80%81yield%E3%80%81join%E5%92%8Cinterrupted%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95/#interrupted","title":"interrupted","text":"<p>interrupted\u662f\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\uff0c\u867d\u7136\u5176\u9875\u7528\u4e8e\u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u662f\u5426\u88ab\u4e2d\u65ad\uff0c\u4f46\u662f\u5b83\u548c\u6210\u5458\u65b9\u6cd5isInterrupted\u8fd8\u662f\u6709\u5f88\u5927\u533a\u522b\u7684\uff0c\u8c03\u7528\u8be5\u65b9\u6cd5\u4f1a\u76f4\u63a5\u64e6\u9664\u7684\u7ebf\u7a0b\u7684interrupt\u6807\u8bc6\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u88ab\u6253\u65ad\u4e86\u90a3\u4e48\u7b2c\u4e00\u6b21\u8c03\u7528interrupted\u65b9\u6cd5\u4f1a\u8fd4\u56detrue\uff0c\u5e76\u4e14\u7acb\u5373\u64e6\u9664\u4e86interrupt\u6807\u8bc6\uff0c\u7b2c\u4e8c\u6b21\u5305\u62ec\u4ee5\u540e\u7684\u8c03\u7528\u6c38\u8fdc\u90fd\u4f1a\u653e\u56defalse\uff0c\u9664\u975e\u5728\u6b64\u671f\u95f4\u6709\u4e00\u6b21\u5730\u88ab\u6253\u65ad\u3002</p> <pre><code>import java.util.concurrent.TimeUnit;\n\npublic class ThreadInterrupt {\n\n    public static void main(String[] args) throws InterruptedException {\n        Thread thread = new Thread(){\n            @Override\n            public void run() {\n                while(true) {\n                    System.out.println(Thread.interrupted());\n                }\n            }\n        };\n        thread.setDaemon(true);\n        thread.start();\n        TimeUnit.MILLISECONDS.sleep(2);\n        thread.interrupt();         \n    }\n\n</code></pre> <p>\u7531\u4e8e\u4e0d\u60f3\u8981\u53d7\u5230\u53ef\u4e2d\u65ad\u65b9\u6cd5\u5982sleep\u7684\u5f71\u54cd\uff0c\u5728Thread\u7684run\u65b9\u6cd5\u4e2d\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u77ed\u6682\u7684\u4f11\u7720\u3002 \u5728\u5f88\u591afalse\u4e2d\u51fa\u73b0\u4e86\u4e00\u4e2atrue\uff0c\u4e5f\u5c31\u662finterrupted\u65b9\u6cd5\u5224\u65ad\u5230\u4e86\u5176\u88ab\u4e2d\u65ad\uff0c\u7acb\u5373\u64e6\u9664\u4e86\u4e2d\u65ad\u6807\u8bc6\u3002</p> <pre><code>...\nfalse\nfalse\ntrue\nfalse\nfalse\n...\n\n</code></pre>"},{"location":"MultiThread/%E4%BB%8EAtomicInteger%E6%9D%A5%E7%9C%8BCAS%E6%9C%BA%E5%88%B6/","title":"\u4eceAtomicInteger\u6765\u770bCAS\u673a\u5236","text":"<p>\u4ec0\u4e48\u662fCAS? \u5373\u6bd4\u8f83\u5e76\u66ff\u6362\uff0c\u5b9e\u73b0\u5e76\u53d1\u7b97\u6cd5\u65f6\u5e38\u7528\u5230\u7684\u4e00\u79cd\u6280\u672f\u3002CAS\u64cd\u4f5c\u5305\u542b\u4e09\u4e2a\u64cd\u4f5c\u6570\u2014\u2014\u5185\u5b58\u4f4d\u7f6e\u3001\u9884\u671f\u539f\u503c\u53ca\u65b0\u503c\u3002\u6267\u884cCAS\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5c06\u5185\u5b58\u4f4d\u7f6e\u7684\u503c\u4e0e\u9884\u671f\u539f\u503c\u6bd4\u8f83\uff0c\u5982\u679c\u76f8\u5339\u914d\uff0c\u90a3\u4e48\u5904\u7406\u5668\u4f1a\u81ea\u52a8\u5c06\u8be5\u4f4d\u7f6e\u503c\u66f4\u65b0\u4e3a\u65b0\u503c\uff0c\u5426\u5219\uff0c\u5904\u7406\u5668\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\u3002\u6211\u4eec\u90fd\u77e5\u9053\uff0cCAS\u662f\u4e00\u6761CPU\u7684\u539f\u5b50\u6307\u4ee4\uff08cmpxchg\u6307\u4ee4\uff09\uff0c\u4e0d\u4f1a\u9020\u6210\u6240\u8c13\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u95ee\u9898\uff0cUnsafe\u63d0\u4f9b\u7684CAS\u65b9\u6cd5\uff08\u5982compareAndSwapXXX\uff09\u5e95\u5c42\u5b9e\u73b0\u5373\u4e3aCPU\u6307\u4ee4cmpxchg\u3002</p> <p>AtomicInteger\u7684\u5b9e\u73b0\u4e2d\uff0c\u9759\u6001\u5b57\u6bb5valueOffset\u5373\u4e3a\u5b57\u6bb5value\u7684\u5185\u5b58\u504f\u79fb\u5730\u5740\uff0cvalueOffset\u7684\u503c\u5728AtomicInteger\u521d\u59cb\u5316\u65f6\uff0c\u5728\u9759\u6001\u4ee3\u7801\u5757\u4e2d\u901a\u8fc7Unsafe\u7684objectFieldOffset\u65b9\u6cd5\u83b7\u53d6\u3002\u5728AtomicInteger\u4e2d\u63d0\u4f9b\u7684\u7ebf\u7a0b\u5b89\u5168\u65b9\u6cd5\u4e2d\uff0c\u901a\u8fc7\u5b57\u6bb5valueOffset\u7684\u503c\u53ef\u4ee5\u5b9a\u4f4d\u5230AtomicInteger\u5bf9\u8c61\u4e2dvalue\u7684\u5185\u5b58\u5730\u5740\uff0c\u4ece\u800c\u53ef\u4ee5\u6839\u636eCAS\u5b9e\u73b0\u5bf9value\u5b57\u6bb5\u7684\u539f\u5b50\u64cd\u4f5c\u3002</p> <p></p> <p>AtomicInteger\u4e2d\u7684compareAndSet\u65b9\u6cd5\uff1a</p> <pre><code>      /**\n     * Atomically sets the value to the given updated value\n     * if the current value {@code ==} the expected value.\n     *\n     * @param expect the expected value\n     * @param update the new value\n     * @return {@code true} if successful. False return indicates that\n     * the actual value was not equal to the expected value.\n     */\n    public final boolean compareAndSet(int expect, int update) {\n        return unsafe.compareAndSwapInt(this, valueOffset, expect, update);\n    }\n\n</code></pre> <p>compareAndSet\u5176\u5b9e\u8c03\u7528\u7684\u662fUnSafe.java\u4e2d\u7684compareAndSwapInt</p> <pre><code>    /**\n        * Atomically update Java variable to &lt;tt&gt;x&lt;/tt&gt; if it is currently\n        * holding &lt;tt&gt;expected&lt;/tt&gt;.\n        * @return &lt;tt&gt;true&lt;/tt&gt; if successful\n        */\n    public final native boolean compareAndSwapInt(Object o, long offset,\n                                                     int expected,\n                                                      int x);\n</code></pre> <p>UnSafe.java\u5bf9\u5e94\u7684cpp\u662fUnSafe.cpp</p> <pre><code>UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))\n  UnsafeWrapper(\"Unsafe_CompareAndSwapInt\");\n  oop p = JNIHandles::resolve(obj);\n  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);\n  return (jint)(Atomic::cmpxchg(x, addr, e)) == e;\nUNSAFE_END\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230UnSafe.cpp\u4e2d\u6700\u540e\u8c03\u7528\u7684\u662fcmpxchg\u8fd9\u4e2aCPU\u6307\u4ee4\uff0c\u8fd9\u4e2a\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u3002\u7531\u4e8e\u662fCPU\u7ea7\u522b\u7684\u6307\u4ee4\uff0c\u5176\u5f00\u9500\u6bd4\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u53c2\u4e0e\u7684\u9501\u7684\u5f00\u9500\u5c0f\u3002</p> <p>ABA\u95ee\u9898\u662f\u4ec0\u4e48</p> <p>ABA \u95ee\u9898\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u4e0d\u9700\u8981\u5173\u6ce8\uff0c\u5982\u679c\u53ea\u5173\u5fc3\u7ed3\u679c\u7684\u60c5\u51b5\u4e0b\uff0c\u4f46\u662f\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6bd4\u5982\u4ea4\u6613\uff0c\u8d44\u91d1\u6d41\u52a8\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u6709\u8d44\u91d1\u6d41\u8f6c\u7684\u8bb0\u5f55\u3002</p> <p>\u5982\u4f55\u89e3\u51b3ABA\u95ee\u9898\u3002</p>"},{"location":"MultiThread/%E4%BD%BF%E7%94%A8%E5%8D%95%E4%B8%80%E7%BA%BF%E7%A8%8B%E7%BB%B4%E6%8C%81%E5%AF%B9%E8%B1%A1%E7%8A%B6%E6%80%81%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7/","title":"\u4f7f\u7528\u5355\u4e00\u7ebf\u7a0b\u7ef4\u6301\u5bf9\u8c61\u72b6\u6001\u7684\u4e00\u81f4\u6027","text":"<p>Android \u660e\u786e\u89c4\u5b9a\uff0c\u7a0b\u5e8f\u4e0d\u80fd\u5728\u4e3b\u7ebf\u7a0b\u8fdb\u884c\u8017\u65f6\u7684\u64cd\u4f5c\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 ANR\u3002\u6709\u4e9b Android \u57fa\u7840\u7684\u7a0b\u5e8f\u5458\u90fd \u4f1a\u89c6\u6b64\u89c4\u5b9a\u4e3a\u91d1\u79d1\u7389\u5f8b\uff0c\u7edd\u4e0d\u6562\u8d8a\u96f7\u6c60\u534a\u6b65\u3002\u9047\u5230\u8017\u65f6\u7684\u64cd\u4f5c\uff0c\u7a0b\u5e8f\u5458\u901a\u5e38\u90fd\u4f1a\u5c06\u5176\u653e\u5728\u540e\u53f0\u7ebf\u7a0b\uff0c\u4ee5 MediaPlayer \u4e3a\u4f8b\uff0c\u5176 setDataSource()\u548c stop()\u65b9\u6cd5\u6709\u53ef\u80fd\u4f1a\u963b\u585e\uff0c\u7b80\u5355\u7684\u5904\u7406\u65b9\u6cd5\u662f:</p> <pre><code>\npublic void play(final MediaPlayer player, final String path) { new Thread() {\n    @Override\n    public void run() {\n                player.setDataSource(path);\n                player.start(); \n            }\n        }.start(); \n    }\n\npublic void stop(final MediaPlayer player) { \n    new Thread() {\n        @Override\n        public void run() {\n                player.stop(); \n            }\n        }.start(); \n    }\n</code></pre> <p>\u8fd9\u4e2a\u65b9\u6848\u6709\u51e0\u4e2a\u95ee\u9898\u663e\u800c\u6613\u89c1: 1. \u968f\u610f\u542f\u52a8\u7ebf\u7a0b\uff0c\u5f00\u9500\u662f\u4e2a\u95ee\u9898 2. \u5982\u4e0b\u4ee3\u7801\u65e0\u6cd5\u4fdd\u8bc1\u6267\u884c\u7ed3\u679c\u7684\u6b63\u786e\u6027</p> <pre><code>public void test() {\n    MediaPlayer player = new MediaPlayer(); \n    play(player, \"http://xxx\");\n    stop(player);\n}\n</code></pre> <ol> <li>\u6700\u4e25\u91cd\u7684\u662f\uff0c\u5982\u679c MediaPlayer \u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u5bf9\u5176\u64cd\u4f5c\uff0c\u56e0\u4e3a\u6ca1\u6709\u540c\u6b65\uff0c\u540e\u679c\u4e0d\u582a\u8bbe\u60f3\u3002</li> </ol> <p>\u4e00\u4e2a\u7b80\u5355\u5b9e\u7528\u7684\u89e3\u51b3\u65b9\u6848\u662f:\u5c06\u6240\u6709\u5bf9 MediaPlayer \u7684\u64cd\u4f5c\uff0c\u90fd\u6539\u5728\u540c\u4e00\u4e2a\u7ebf\u7a0b\u5185\u6267\u884c\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u968f\u610f\u542f\u52a8\u7ebf\u7a0b\u5bfc\u81f4\u7684\u5f00\u9500\uff0c\u4e5f\u53ef\u4ee5\u4fdd\u8bc1\u4efb\u52a1\u7684\u6267\u884c\u987a\u5e8f\u4e25\u683c\u9075\u5b88\u4efb\u52a1\u7684\u89e6\u53d1\u987a\u5e8f\uff0c\u540c\u65f6\u56e0\u4e3a\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5bf9\u8c61\u64cd\u4f5c\uff0c\u5373\u4f7f\u6ca1\u6709\u540c\u6b65\uff0c\u4e5f\u4e0d\u7528\u62c5\u5fc3\u51fa\u73b0\u95ee\u9898\u3002 \u53ef\u4ee5\u5199\u4e00\u4e2a\u5305\u542b\u65e0\u9650\u5faa\u73af\u7684 Thread\uff0c\u53ef\u4ee5\u4f7f\u7528 Android \u7684 HandlerThread\uff0c\u4e5f\u76f4\u63a5\u4f7f\u7528 Java \u5e76\u53d1\u7ebf\u7a0b\u5e93 \u63d0\u4f9b\u7684 SingleThreadExecutor\uff0c\u6539\u8fdb\u540e\u7684\u65b9\u6848\u5982\u4e0b:</p> <pre><code>\nExecutor mExecutor = Executors.newSingleThreadExecutor(); \npublic void play(final MediaPlayer player, final String path) {\n    mExecutor.execute(new Runnable() {\n            @Override\n            public void run() {\n                player.setDataSource(path); \n            }\n    });\n}\n\npublic void stop(final MediaPlayer player) { \n    mExecutor.execute(new Runnable() {\n        @Override\n        public void run() {\n            player.stop(); }\n        });\n}\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/","title":"\u591a\u7ebf\u7a0b\u95f4\u901a\u4fe1","text":"<p>\u4ece6\u4e2a\u573a\u666f\u4ecb\u7ecd\u7ebf\u7a0b\u95f4\u901a\u4fe1\u3002</p> <ul> <li>\u573a\u666f\u4e00\uff1a\u4e24\u4e2a\u7ebf\u7a0b\u4ea4\u66ff\u6267\u884c</li> <li>\u573a\u666f\u4e8c\uff1a\u7b49A\u6267\u884c\u5b8c\uff0c\u518d\u6267\u884cB</li> <li>\u573a\u666f\u4e09\uff1a\u5148A\u6253\u53701\uff0c\u518d\u6253\u5370B 1\uff0c2\uff0c3\uff0c\u6700\u540e\u518d\u6253\u5370A 2\uff0c3</li> <li>\u573a\u666f\u56db\uff1aA B C\u4e09\u4e2a\u7ebf\u7a0b\u5148\u540c\u6b65\u6267\u884c\uff0c\u90fd\u6267\u884c\u5b8c\u540e\uff0c\u518d\u6267\u884c\u7ebf\u7a0bD</li> <li>\u573a\u666f\u4e94\uff1aA B C \u5404\u81ea\u5f00\u59cb\u51c6\u5907\uff0c\u90fd\u51c6\u5907\u5b8c\uff0c\u518d\u4e00\u8d77\u8fd0\u884c</li> <li>\u573a\u666f\u516d\uff1a\u5b50\u7ebf\u7a0b\u5b8c\u6210\u4efb\u52a1\u540e\uff0c\u628a\u7ed3\u679c\u56de\u4f20\u7ed9\u4e3b\u7ebf\u7a0b</li> </ul>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#_2","title":"\u573a\u666f\u4e00\uff1a\u4e24\u4e2a\u7ebf\u7a0b\u4ea4\u66ff\u6267\u884c","text":"<pre><code>    public static void case1() {\n        Thread threadA = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                printTask(\"A\");\n            }\n        });\n\n        Thread threadB = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                printTask(\"B\");\n            }\n        });\n\n        threadA.start();\n        threadB.start();\n    }\n\n    public static void printTask(String thread) {\n        int i=0;\n        while (i++ &lt; 3) {\n            try {\n                Thread.sleep(2*1000); //\u6bcf\u6b21\u4efb\u52a1\u90fd\u4f11\u7720\uff0c\u7ebf\u7a0b\u95f4\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ea4\u66ff\u6267\u884c\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            println(thread + \" printTask: \" + i);\n        }\n    }\n\n    public static void println(String msg) {\n        System.out.println(msg);\n    }\n\n\u8f93\u51fa\uff1a\n\nA printTask: 1\nB printTask: 1\nB printTask: 2\nA printTask: 2\nB printTask: 3\nA printTask: 3\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#ab","title":"\u573a\u666f\u4e8c\uff1a\u7b49A\u6267\u884c\u5b8c\uff0c\u518d\u6267\u884cB","text":"<p>\u4f7f\u7528Thread.join()\uff0c\u5c06\u5f53\u524d\u4efb\u52a1\u653e\u5230\u76ee\u6807\u4efb\u52a1\u540e\u9762\u3002</p> <pre><code>\n    public static void case2() {\n        Thread threadA = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                printTask(\"A\");\n            }\n        });\n\n        Thread threadB = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                println(\"B is waiting A\");\n                try {\n                    threadA.join(); // \u5f53\u524d\u7ebf\u7a0b\u653e\u5230A\u7ebf\u7a0b\u540e\u9762\uff0cA\u7ed3\u675f\u624d\u4f1a\u6267\u884cB\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                println(\"B start\");\n                printTask(\"B\");\n            }\n        });\n\n        threadA.start();\n        threadB.start();\n    }\n\n\u8f93\u51fa\uff1a\nB is waiting A\nA printTask: 1\nA printTask: 2\nA printTask: 3\nB start\nB printTask: 1\nB printTask: 2\nB printTask: 3\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#a1b-123a-23","title":"\u573a\u666f\u4e09\uff1a\u5148A\u6253\u53701\uff0c\u518d\u6253\u5370B 1\uff0c2\uff0c3\uff0c\u6700\u540e\u518d\u6253\u5370A 2\uff0c3","text":"<p>\u4f7f\u7528Object.wait() / notify()</p> <pre><code>public static void case3() {\n        Object lock = new Object();\n\n        Thread threadA = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                synchronized (lock) { // \u5148\u83b7\u5f97\u9501\uff0c\u624d\u80fdwait\n                    println(\"A 1\");\n\n                    try {\n                        println(\"A \u4f11\u7720\");\n                        lock.wait(); // \u4f11\u7720\u5f53\u524d\u7ebf\u7a0b\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    println(\"A \u88ab\u5524\u9192\");\n\n                    println(\"A 2\");\n                    println(\"A 3\");\n                }\n            }\n        });\n\n        Thread threadB = new Thread(new Runnable() {\n            @Override\n            public void run() {\n                synchronized (lock) {\n                    println(\"B 1\");\n                    println(\"B 2\");\n                    println(\"B 3\");\n\n                    println(\"B \u5524\u9192\u4f11\u7720\u7ebf\u7a0b\");\n                    lock.notify();\n                }\n            }\n        });\n\n        threadA.start();\n        threadB.start();\n    }\n\n\u8f93\u51fa\uff1a\nA 1\nA \u4f11\u7720\nB 1\nB 2\nB 3\nB \u5524\u9192\u4f11\u7720\u7ebf\u7a0b\nA \u88ab\u5524\u9192\nA 2\nA 3\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#a-b-cd","title":"\u573a\u666f\u56db\uff1aA B C\u4e09\u4e2a\u7ebf\u7a0b\u5148\u540c\u6b65\u6267\u884c\uff0c\u90fd\u6267\u884c\u5b8c\u540e\uff0c\u518d\u6267\u884c\u7ebf\u7a0bD","text":"<p>\u4f7f\u7528CountdownLatch\uff0c\u8ba9\u4e00\u4e2a\u7ebf\u7a0b\u7b49\u5230\u5176\u4ed6\u7ebf\u7a0b\u90fd\u7ed3\u675f\u4e86\uff0c\u518d\u6267\u884c\u3002</p> <pre><code>public static void case4() {\n        CountDownLatch countDownLatch = new CountDownLatch(3);\n\n        Thread threadA = new Thread(() -&gt; {\n            printTask(\"A\");\n            countDownLatch.countDown();\n        });\n        Thread threadB = new Thread(() -&gt; {\n            printTask(\"B\");\n            countDownLatch.countDown();\n        });\n        Thread threadC = new Thread(() -&gt; {\n            printTask(\"C\");\n            countDownLatch.countDown();\n        });\n        Thread threadD = new Thread(() -&gt; {\n            try {\n                countDownLatch.await(); // \u6267\u884c\u5230\u6b64\u5904\uff0c\u5f53\u524d\u7ebf\u7a0b\u4f1await\uff0c\u76f4\u5230CountDownLatch\u7684count\u51cf\u5c11(countDown)\u52300\uff0c\u624d\u4f1a\u6267\u884c\u540e\u9762\u7684\u64cd\u4f5c\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            printTask(\"D\");\n        });\n\n        threadA.start();\n        threadB.start();\n        threadC.start();\n        threadD.start();\n    }\n\n\u8f93\u51fa\uff1a\nA printTask: 1\nB printTask: 1\nC printTask: 1\nA printTask: 2\nC printTask: 2\nB printTask: 2\nA printTask: 3\nC printTask: 3\nB printTask: 3\nD printTask: 1 // ABC\u90fd\u7ed3\u675f\u4e86\uff0cD\u624d\u5f00\u59cb\nD printTask: 2\nD printTask: 3\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#a-b-c","title":"\u573a\u666f\u4e94\uff1aA B C \u5404\u81ea\u5f00\u59cb\u51c6\u5907\uff0c\u90fd\u51c6\u5907\u5b8c\uff0c\u518d\u4e00\u8d77\u8fd0\u884c","text":"<p>CountdownLatch\u80fd\u591f\u5012\u8ba1\u6570\uff0c\u4f46\u662f\u5f53count down\u52300\u65f6\uff0c\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u5524\u9192\uff0c\u6240\u4ee5\u4e0d\u9002\u5408\u8fd9\u4e2a\u573a\u666f\u3002</p> <p>CyclicBarrier\uff0c\u53ef\u5148\u6307\u5b9abarrier\u4e2a\u6570\uff0c\u5373\u540c\u65f6\u7b49\u5f85\u7684\u7ebf\u7a0b\u6570\uff0c\u7b49\u6240\u6709\u7ebf\u7a0b\u90fd\u51c6\u5907\u597d\uff0c\u5373\u90fdawait\uff0c\u5c31\u53ef\u4ee5\u540c\u65f6\u6267\u884c\u4e86\u3002</p> <p>\u4f7f\u7528CyclicBarrier\uff0c\u8ba9\u591a\u4e2a\u7ebf\u7a0b\u540c\u6b65\u7b49\u5f85\u3002\u7b49\u5f85\u7684\u7ebf\u7a0b\u6570\u8fbe\u5230CyclicBarrier\u7684\u9608\u503c\uff0c\u591a\u4e2a\u7ebf\u7a0b\u5c31\u540c\u65f6\u5f00\u59cb\u6267\u884c\u4efb\u52a1\u3002</p> <pre><code>public static void case5() {\n        CyclicBarrier cyclicBarrier = new CyclicBarrier(3);\n\n        for (char threadName = 'A'; threadName &lt;= 'C'; threadName++) {\n            final String name = String.valueOf(threadName);\n\n            new Thread(() -&gt; {\n                println(name + \" waiting\");\n                try {\n                    cyclicBarrier.await(); // \u5f53\u524d\u7ebf\u7a0b\u51c6\u5907\u597d\uff0c\u5f00\u59cb\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n                printTask(name);\n            }).start();\n        }\n    }\n\n\u8f93\u51fa\uff1a\nA waiting\nC waiting\nB waiting\nB printTask: 1 // ABC\u90fdwaiting\uff0c\u624d\u5f00\u59cb\u6267\u884c\nC printTask: 1\nA printTask: 1\nC printTask: 2\nB printTask: 2\nA printTask: 2\nC printTask: 3\nB printTask: 3\nA printTask: 3\n\n</code></pre>"},{"location":"MultiThread/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/#_3","title":"\u573a\u666f\u516d\uff1a\u5b50\u7ebf\u7a0b\u5b8c\u6210\u4efb\u52a1\u540e\uff0c\u628a\u7ed3\u679c\u56de\u4f20\u7ed9\u4e3b\u7ebf\u7a0b","text":"<p>Runnable\u662f\u6ca1\u6709\u8fd4\u56de\u503c\u7684\uff0c\u6240\u4ee5\u8981\u7528Callable\u3002\u7ed3\u5408FutureTask\u4f7f\u7528\u3002</p> <pre><code>public static void case6() {\n        Callable&lt;Integer&gt; callable = new Callable&lt;Integer&gt;() {\n            @Override\n            public Integer call() throws Exception {\n                println(\"start callable\");\n                int sum = 0;\n                for (int i=1;i&lt;=100;i++) {\n                    sum += i;\n                }\n\n                Thread.sleep(5000);\n                println(\"end callable\");\n                return sum;\n            }\n        };\n\n        FutureTask&lt;Integer&gt; task = new FutureTask&lt;Integer&gt;(callable);\n        new Thread(task).start(); // \u4f1a\u7acb\u5373\u6267\u884cCallable\n\n        try {\n            println(\"before task\");\n\n            // \u5982\u679cCallable\u6ca1\u6267\u884c\u5b8c\uff0cUI\u7ebf\u7a0b\u4f1a\u963b\u585e\uff0c\u76f4\u81f3Callable\u7ed3\u675f\n            println(\"result:\" + task.get()); \n\n            println(\"after task\");\n\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } catch (ExecutionException e) {\n            e.printStackTrace();\n        }\n    }\n\n\u8f93\u51fa\uff1a\nbefore task.get()\nstart callable\nend callable\nresult:5050\nafter task.get() //\u5373\u4fbfCallable\u91cc5\u79d2\u8017\u65f6\uff0c\u4f46\u662f\u4e3b\u7ebf\u7a0b\u4e5f\u8981\u7b49\u5176\u7ed3\u675f\u624d\u80fd\u5f80\u4e0b\u6267\u884c\n\n\u60c5\u51b52\uff1a\u5982\u679c\u6ce8\u91cafuture.get()\u90a3\u4e00\u884c\uff0c\u4e3b\u7ebf\u7a0b\u5c31\u4e0d\u4f1a\u7b49\u5f85\u3002\n\n\u8f93\u51fa\uff1a\nstart callable\nbefore task.get()\nafter task.get() //\u4e3b\u7ebf\u7a0b\u6ca1\u6709\u7b49\u5f85\nend callable\n\n</code></pre> <p>\u53c2\u8003\u5185\u5bb9\uff1a</p> <p>Java \u91cc\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u95f4\u901a\u4fe1\uff1f</p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/","title":"\u6df1\u5165\u89e3\u6790volatile\u5173\u952e\u5b57","text":"<p>\u6587\u7ae0\u5df2\u540c\u6b65\u53d1\u8868\u4e8e\u5fae\u4fe1\u516c\u4f17\u53f7JasonGaoH\uff0c\u6df1\u5165\u89e3\u6790volatile\u5173\u952e\u5b57</p> <p><code>volatile\u5173\u952e\u5b57</code>\u548c<code>synchronized\u5173\u952e\u5b57</code>\u4e00\u6837\uff0c\u5728Java\u591a\u7ebf\u7a0b\u5f00\u53d1\u4e2d\uff0c\u662f\u4e00\u9053\u5fc5\u987b\u8981\u8de8\u8d8a\u7684\u69db\u3002\u4e4b\u524d\u6709\u7bc7\u6587\u7ae0\u5df2\u7ecf\u5206\u6790\u8fc7<code>synchronized\u5173\u952e\u5b57</code>\u7684\u539f\u7406\uff0csynchronized\u5173\u952e\u5b57\u7684\u539f\u7406\uff0c\u8fd9\u4e00\u6b21\uff0c\u6211\u4eec\u6765\u4e00\u6b65\u4e00\u6b65\u5206\u6790\u4e0b<code>volatile\u5173\u952e\u5b57</code>\u7684\u5de5\u4f5c\u539f\u7406\u3002</p> <p>\u672c\u6587\u7bc7\u5e45\u7a0d\u5fae\u6709\u70b9\u957f\uff0c\u5e0c\u671b\u60a8\u80fd\u8010\u5fc3\u770b\u4e0b\u53bb\uff0c\u5e76\u6709\u6240\u6536\u83b7\u3002</p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#volatile","title":"volatile\u5173\u952e\u5b57\u7684\u4f7f\u7528","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u4ece\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u5165\u624b\u3002</p> <pre><code>public class VolatileFoo {\n    //init_value\u7684\u6700\u5927\u503c\n    final static int MAX = 5;\n    //init_value\u7684\u521d\u59cb\u503c\n    static int init_value = 0;\n\n    public static void main(String[] args) {\n        //\u542f\u52a8\u4e00\u4e2aReader\u7ebf\u7a0b\uff0c\u5f53\u53d1\u73b0local_value\u548cinit_value\u4e0d\u540c\u65f6\uff0c\n        //\u5219\u8f93\u51fainit_value\u88ab\u4fee\u6539\u7684\u4fe1\u606f\n        new Thread(() -&gt; {\n            int localValue = init_value;\n            while(localValue &lt; MAX) {\n                if(init_value != localValue) {\n                    System.out.println(\"this init_value is updated to \" + init_value);\n                    //\u5bf9local_value\u91cd\u65b0\u8d4b\u503c\n                    localValue = init_value;\n                }\n            }\n        },\"Readder\").start();\n\n        new Thread(() -&gt; {\n            int localValue = init_value;\n            while(localValue &lt; MAX) {\n                System.out.println(\"this init_value will be changed to \" + ++localValue);\n                //\u5bf9local_value\u91cd\u65b0\u8d4b\u503c\n                init_value = localValue;\n                try {\n                    Thread.sleep(2000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },\"Updater\").start();\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u7a0b\u5e8f\u5206\u522b\u542f\u52a8\u4e86\u4e24\u4e2a\u7ebf\u7a0b\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u5bf9\u53d8\u91cf\u8fdb\u884c\u4fee\u6539\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u5bf9\u53d8\u91cf\u8fdb\u884c\u8f93\u51fa\u3002</p> <p>\u8fd0\u884c\u7a0b\u5e8f\uff0c\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>this init_value will be changed to 1\nthis init_value is updated to 1\nthis init_value will be changed to 2\nthis init_value will be changed to 3\nthis init_value will be changed to 4\nthis init_value will be changed to 5\n</code></pre> <p>\u4ece\u8f93\u51fa\u4fe1\u606f\u6211\u4eec\u53d1\u73b0\uff0cReader\u7ebf\u7a0b\u6ca1\u6709\u611f\u77e5\u5230init_value\u7684\u53d8\u5316\uff0c\u6211\u4eec\u671f\u671b\u7684\u662f\u5728Updater\u8fdb\u7a0b\u66f4\u65b0init_value\u7684\u503c\u4e4b\u540e\uff0cReader\u8fdb\u7a0b\u80fd\u591f\u6253\u5370\u51fa\u53d8\u5316\u7684init_value\u7684\u503c\uff0c\u4f46\u7ed3\u679c\u5e76\u4e0d\u662f\u6211\u4eec\u671f\u671b\u7684\u90a3\u6837\u3002</p> <p>\u6211\u4eec\u5c1d\u8bd5\u5728init_value\u524d\u9762\u52a0\u4e0a<code>volatile</code>\u3002</p> <pre><code>static volatile int init_value = 0;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u518d\u8fd0\u884c\u4e0b\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>this init_value will be changed to 1\nthis init_value is updated to 1\nthis init_value will be changed to 2\nthis init_value is updated to 2\nthis init_value will be changed to 3\nthis init_value is updated to 3\nthis init_value will be changed to 4\nthis init_value is updated to 4\nthis init_value will be changed to 5\nthis init_value is updated to 5\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019Reader\u7ebf\u7a0b\u5c31\u80fd\u591f\u611f\u53d7\u5230init_value\u7684\u503c\u7684\u53d8\u5316\u4e86\uff0c\u5e76\u4e14\u5728\u6761\u4ef6\u4e0d\u6ee1\u8db3\u65f6\u7a0b\u5e8f\u5c31\u9000\u51fa\u4e86\u8fd0\u884c\u3002</p> <p>\u90a3\u4e48\u4e3a\u4ec0\u4e48\u52a0\u4e86\u4e2avolatile\u5c31\u6b63\u5e38\u4e86\u5462\uff0c volatile\u5173\u952e\u5b57\u7684\u4f5c\u7528\u5230\u5e95\u662f\u4ec0\u4e48\u5462\uff1f</p> <p>\u60f3\u8981\u5f7b\u5e95\u641e\u6e05\u695a<code>volatile\u5173\u952e\u5b57</code>\uff0c\u8fd8\u9700\u8981\u5177\u5907Java\u5185\u5b58\u6a21\u578b\u3001CPU\u7f13\u5b58\u6a21\u578b\u3001\u6c47\u7f16\u6307\u4ee4\u7b49\u76f8\u5173\u77e5\u8bc6\u7684\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u4e00\u6b65\u4e00\u6b65\u6765\u62c6\u89e3\u95ee\u9898\u3002</p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#cpu","title":"CPU\u7f13\u5b58\u6a21\u578b","text":"<p>\u8981\u60f3\u5bf9volatile\u6709\u6bd4\u8f83\u6df1\u523b\u7684\u7406\u89e3\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5bf9CPU\u7684\u7f13\u5b58\u6a21\u578b\u6709\u4e00\u5b9a\u7684\u8ba4\u8bc6\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u6240\u6709\u7684\u8fd0\u7b97\u64cd\u4f5c\u90fd\u662f\u7531CPU\u7684\u5bc4\u5b58\u5668\u6765\u5b8c\u6210\u7684\uff0cCPU\u6307\u4ee4\u7684\u6267\u884c\u8fc7\u7a0b\u9700\u8981\u6d89\u53ca\u6570\u636e\u7684\u8bfb\u53d6\u548c\u5199\u5165\u64cd\u4f5c\uff0cCPU\u6240\u80fd\u8bbf\u95ee\u7684\u6240\u6709\u6570\u636e\u53ea\u80fd\u662f\u8ba1\u7b97\u673a\u7684\u4e3b\u5b58\uff08\u901a\u5e38\u662f\u6307RAM\uff09\uff0c\u867d\u7136CPU\u7684\u53d1\u5c55\u9891\u7387\u4e0d\u65ad\u5f97\u5230\u63d0\u5347\uff0c\u4f46\u53d7\u5236\u4e8e\u5236\u9020\u5de5\u827a\u4ee5\u53ca\u6210\u672c\u7684\u9650\u5236\uff0c\u8ba1\u7b97\u673a\u7684\u5185\u5b58\u53cd\u5012\u5728\u8bbf\u95ee\u901f\u5ea6\u4e0a\u6ca1\u6709\u591a\u5927\u7684\u7a81\u7834\uff0c\u56e0\u6b64CPU\u7684\u5904\u7406\u901f\u5ea6\u548c\u5185\u5b58\u7684\u8bbf\u95ee\u901f\u5ea6\u4e4b\u95f4\u7684\u5dee\u8ddd\u8d8a\u62c9\u8d8a\u5927\uff0c\u901a\u5e38\u8fd9\u79cd\u5dee\u8ddd\u53ef\u4ee5\u8fbe\u5230\u4e0a\u5343\u500d\uff0c\u6781\u7aef\u60c5\u51b5\u4e0b\u751a\u81f3\u4f1a\u5728\u4e0a\u4e07\u500d\u4ee5\u4e0a\u3002</p> <p>\u7531\u4e8e\u4e24\u8fb9\u901f\u5ea6\u4e25\u91cd\u7684\u4e0d\u5bf9\u7b49\uff0c\u901a\u8fc7\u4f20\u7edfFSB\u76f4\u8fde\u5185\u5b58\u7684\u8bbf\u95ee\u65b9\u5f0f\u4f1a\u5bfc\u81f4CPU\u8d44\u6e90\u53d7\u5230\u6781\u5927\u7684\u9650\u5236\uff0c\u964d\u4f4eCPU\u6574\u4f53\u7684\u541e\u5410\u91cf\uff0c\u4e8e\u662f\u5c31\u6709\u4e86CPU\u548c\u4e3b\u5185\u5b58\u76f4\u63a5\u589e\u52a0\u7f13\u5b58\u7684\u8bbe\u8ba1\uff0c\u73b0\u5728\u7f13\u5b58\u6570\u91cf\u90fd\u53ef\u4ee5\u589e\u52a0\u52303\u7ea7\u4e86\uff0c\u6700\u9760\u8fd1CPU\u7684\u7f13\u5b58\u4e3aL1,\u7136\u540e\u4f9d\u6b21\u662fL2,L3\u548c\u4e3b\u5185\u5b58\uff0cCPU\u7f13\u5b58\u6a21\u578b\u56fe\u5982\u4e0b\u6240\u793a\uff1a  Cache\u7684\u51fa\u73b0\u662f\u4e3a\u4e86\u89e3\u51b3CPU\u76f4\u63a5\u8bbf\u95ee\u5185\u5b58\u6548\u7387\u4f4e\u4e0b\u7684\u95ee\u9898\uff0c\u7a0b\u5e8f\u5728\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u5c06\u8fd0\u7b97\u6240\u9700\u8981\u7684\u6570\u636e\u4ece\u4e3b\u5185\u5b58\u590d\u5236\u4e00\u4efd\u5230CPU Cache\u4e2d\uff0c\u8fd9\u6837CPU\u8ba1\u7b97\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u5bf9CPU Cache\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u8bfb\u53d6\u548c\u5199\u5165\uff0c\u5f53\u8fd0\u7b97\u7ed3\u675f\u4e4b\u540e\uff0c\u518d\u5c06CPU Cache\u4e2d\u6700\u65b0\u7684\u6570\u636e\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u5f53\u4e2d\uff0cCPU\u901a\u8fc7\u76f4\u63a5\u8bbf\u95eeCache\u7684\u65b9\u5f0f\u63d0\u5230\u76f4\u63a5\u8bbf\u95ee\u4e3b\u5185\u5b58\u7684\u65b9\u5f0f\u6781\u5927\u5730\u63d0\u9ad8\u4e86CPU\u7684\u541e\u5410\u80fd\u529b\uff0c\u6709\u4e2aCPU Cache\u4e4b\u540e\uff0c\u6574\u4f53\u7684CPU\u548c\u4e3b\u5185\u5b58\u4e4b\u95f4\u7684\u4ea4\u4e92\u7684\u67b6\u6784\u5927\u81f4\u5982\u4e0b\u56fe\u6240\u793a\uff1a </p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#java","title":"Java\u5185\u5b58\u6a21\u578b","text":"<p>\u7531\u4e8e\u7f13\u5b58\u7684\u51fa\u73b0\uff0c\u6781\u5927\u5730\u63d0\u9ad8\u4e86CPU\u7684\u541e\u5410\u80fd\u529b\uff0c\u4f46\u662f\u540c\u65f6\u4e5f\u5f15\u5165\u4e86\u7f13\u5b58\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002\u5728\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e2d\uff0c\u6bcf\u4e2a\u5904\u7406\u5668\u90fd\u6709\u81ea\u5df1\u7684\u7684\u9ad8\u901f\u7f13\u5b58\uff0c\u800c\u5b83\u4eec\u53c8\u5171\u4eab\u540c\u4e00\u4e3b\u5185\u5b58\uff0c\u5f53\u591a\u4e2a\u5904\u7406\u5668\u7684\u8fd0\u7b97\u4efb\u52a1\u90fd\u8bbe\u8ba1\u5230\u540c\u4e00\u5757\u5185\u5b58\u533a\u57df\u65f6\uff0c\u5c06\u53ef\u80fd\u5bfc\u81f4\u5404\u81ea\u7684\u7f13\u5b58\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u901a\u8fc7<code>\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae</code>\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u6b63\u786e\u6027\uff0c\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u4f7f\u7528\u7f13\u5b58\u4e00\u81f4\u6027\u534f\u8bae\u90fd\u5404\u4e0d\u76f8\u540c\u3002</p> <p>\u56e0\u4e3a\u5404\u79cd\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u8bbf\u95ee\u662f\u6709\u5dee\u5f02\u7684\uff0cJava\u4e3a\u4e86\u7a0b\u5e8f\u80fd\u5728\u5404\u79cd\u5e73\u53f0\u4e0b\u8fd0\u884c\u8fbe\u5230\u4e00\u81f4\u7684\u5185\u5b58\u8bbf\u95ee\u6548\u679c\uff0c\u4e8e\u662f\u5b9a\u4e49\u4e86Java\u5185\u5b58\u6a21\u578b\uff08Java Memory Mode\uff0cJMM\uff09\u6765\u5bf9\u7279\u5b9a\u5185\u5b58\u6216\u9ad8\u901f\u7f13\u5b58\u7684\u8bfb\u5199\u8bbf\u95ee\u8fc7\u7a0b\u8fdb\u884c\u62bd\u8c61\u3002</p> <p>Java\u5185\u5b58\u6a21\u578b\u5b9a\u4e49\u4e86\u7ebf\u7a0b\u548c\u4e3b\u5185\u5b58\u4e4b\u95f4\u7684\u62bd\u8c61\u5173\u7cfb\uff0c\u5177\u4f53\u5982\u4e0b\u3002 - \u5171\u4eab\u53d8\u91cf\u5b58\u50a8\u4e8e\u4e3b\u5185\u5b58\u4e4b\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u8bbf\u95ee\u3002 - \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u79c1\u6709\u7684\u5de5\u4f5c\u5185\u5b58\u548c\u672c\u5730\u5185\u5b58\u3002 - \u5de5\u4f5c\u5185\u5b58\u503c\u5b58\u50a8\u8be5\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u526f\u672c\u3002 - \u7ebf\u7a0b\u4e0d\u80fd\u76f4\u63a5\u64cd\u4f5c\u4e3b\u5185\u5b58\uff0c\u53ea\u6709\u5148\u64cd\u4f5c\u4e86\u5de5\u4f5c\u5185\u5b58\u4e4b\u540e\u624d\u80fd\u5199\u5165\u4e3b\u5185\u5b58\u3002 - \u5de5\u4f5c\u5185\u5b58\u548cJava\u5185\u5b58\u6a21\u578b\u4e00\u6837\u4e5f\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u5b83\u5176\u5b9e\u5e76\u4e0d\u5b58\u5728\uff0c\u5b83\u6db5\u76d6\u4e86\u7f13\u5b58\u3001\u5bc4\u5b58\u5668\u3001\u7f16\u8bd1\u4f18\u5316\u4ee5\u53ca\u786c\u4ef6\u7b49\u3002  <code>Java\u5185\u5b58\u6a21\u578b</code>\u5b9a\u4e49\u4e86\u4e00\u5957\u4e3b\u5185\u5b58\u548c\u5de5\u4f5c\u5185\u5b58\u7684\u4ea4\u4e92\u534f\u8bae\uff0c\u5373\u4e00\u4e2a\u53d8\u91cf\u5982\u4f55\u4ece\u4e3b\u5185\u5b58\u62f7\u8d1d\u5230\u5de5\u4f5c\u5185\u5b58\u3001\u5982\u4f55\u4ece\u5de5\u4f5c\u5185\u5b58\u540c\u6b65\u5230\u4e3b\u5185\u5b58\u4e4b\u7c7b\u7684\u5b9e\u73b0\u7ec6\u8282\u3002\u5177\u4f53\u67098\u79cd\u64cd\u4f5c\u6765\u5b8c\u6210\uff0c\u5206\u522b\u4e3alock\u3001unlock\u3001read\u3001load\u3001use\u3001assign\u3001store\u548cwrite\u3002\u9664\u6b64\u4e4b\u5916\uff0c<code>Java\u5185\u5b58\u6a21\u578b</code>\u8fd8\u89c4\u5b9a\u5728\u6267\u884c\u8fd98\u79cd\u64cd\u4f5c\u7684\u65f6\u5019\u5fc5\u987b\u6ee1\u8db38\u79cd\u89c4\u5219\uff0c\u7531\u4e8e\u7bc7\u5e45\u95ee\u9898\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\u4e86\uff0c\u5177\u4f53\u53ef\u53c2\u770b\u6df1\u5165\u7406\u89e3Java\u865a\u62df\u673a\u7b2c12\u7ae0\u7684Java\u5185\u5b58\u6a21\u578b\u4e0e\u7ebf\u7a0b\u3002</p> <p><code>Java\u5185\u5b58\u6a21\u578b</code>\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u5176\u4e0e\u8ba1\u7b97\u673a\u786c\u4ef6\u7684\u7ed3\u6784\u5e76\u4e0d\u5b8c\u5168\u4e00\u6837\uff0c\u6bd4\u5982\u8ba1\u7b97\u673a\u7269\u7406\u5185\u5b58\u4e0d\u4f1a\u5b58\u5728\u6808\u5185\u5b58\u548c\u5806\u5185\u5b58\u7684\u5212\u5206\uff0c\u65e0\u8bba\u662f\u5806\u5185\u5b58\u8fd8\u662f\u865a\u62df\u673a\u6808\u5185\u5b58\u90fd\u4f1a\u5bf9\u5e94\u5230\u7269\u7406\u7684\u4e3b\u5185\u5b58\uff0c\u5f53\u7136\u4e5f\u6709\u4e00\u90e8\u5206\u5806\u6808\u5185\u5b58\u6570\u636e\u53ef\u80fd\u4f1a\u5b58\u5165CPU Cache\u5bc4\u5b58\u5668\u4e2d\u3002\u5177\u4f53\u53ef\u53c2\u8003\u4e0b\u56fe\uff1a </p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#volatile_1","title":"\u5bf9\u4e8evolatile\u53d8\u91cf\u7684\u7279\u6b8a\u89c4\u5219","text":"<p>\u4ecb\u7ecd\u4e86<code>CPU\u7f13\u5b58\u6a21\u578b</code>\u4ee5\u53ca<code>Java\u5185\u5b58\u6a21\u578b</code>\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u6765\u8bf4<code>volatile\u5173\u952e\u5b57</code>\uff0c\u8fd9\u6837\u66f4\u80fd\u52a0\u6df1\u6211\u4eec\u5bf9\u4e8e<code>volatile\u5173\u952e\u5b57</code>\u7684\u7406\u89e3\u3002 <code>volatile\u5173\u952e\u5b57</code>\u662fJava\u865a\u62df\u673a\u63d0\u4f9b\u7684\u6700\u8f7b\u91cf\u7ea7\u7684\u540c\u6b65\u673a\u5236\uff0c\u5f88\u591a\u4eba\u7531\u4e8e\u5bf9\u5b83\u7406\u89e3\u4e0d\u591f\uff0c\u5f80\u5f80\u66f4\u613f\u610f\u4f7f\u7528synchronized\u6765\u505a\u540c\u6b65\u3002</p> <p><code>Java\u5185\u5b58\u6a21\u578b</code>\u5bf9<code>volatile\u5173\u952e\u5b57</code>\u5b9a\u4e49\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u8bbf\u95ee\u89c4\u5219\uff0c\u5f53\u4e00\u4e2a\u53d8\u91cf\u88abvolatile\u4fee\u9970\u540e\uff0c\u5b83\u5c06\u5177\u5907\u4e24\u79cd\u7279\u6027\uff0c\u6216\u8005\u8bf4volatile\u5177\u6709\u4e0b\u5217\u4e24\u5c42\u8bed\u4e49\uff1a</p> <ul> <li>\u7b2c\u4e00\u3001\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u8bfb\u53d6\u65f6\u7684\u53ef\u89c1\u6027\uff0c \u5373\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\uff0c \u8fd9\u65b0\u503c\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u6765\u8bf4\u662f\u7acb\u5373\u53ef\u89c1\u7684\u3002 (volatile \u89e3\u51b3\u4e86\u7ebf\u7a0b\u95f4\u5171\u4eab\u53d8\u91cf\u7684\u53ef\u89c1\u6027\u95ee\u9898)\u3002</li> <li>\u7b2c\u4e8c\u3001\u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c \u963b\u6b62\u7f16\u8bd1\u5668\u5bf9\u4ee3\u7801\u7684\u4f18\u5316\u3002</li> </ul> <p>\u9488\u5bf9\u7b2c\u4e00\u70b9\uff0c<code>volatile</code>\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u8bfb\u53d6\u65f6\u7684\u53ef\u89c1\u6027\uff0c\u5177\u4f53\u8868\u73b0\u4e3a\uff1a - \u7b2c\u4e00\uff1a \u4f7f\u7528 volatile \u5173\u952e\u5b57\u4f1a\u5f3a\u5236\u5c06\u5728\u67d0\u4e2a\u7ebf\u7a0b\u4e2d\u4fee\u6539\u7684\u5171\u4eab\u53d8\u91cf\u7684\u503c\u7acb\u5373\u5199\u5165\u4e3b\u5185\u5b58\u3002 - \u7b2c\u4e8c\uff1a \u4f7f\u7528 volatile \u5173\u952e\u5b57\u7684\u8bdd\uff0c \u5f53\u7ebf\u7a0b 2 \u8fdb\u884c\u4fee\u6539\u65f6\uff0c \u4f1a\u5bfc\u81f4\u7ebf\u7a0b 1 \u7684\u5de5\u4f5c\u5185\u5b58\u4e2d\u53d8\u91cf\u7684\u7f13\u5b58\u884c\u65e0\u6548\uff08\u53cd\u6620\u5230\u786c\u4ef6\u5c42\u7684\u8bdd\uff0c \u5c31\u662f CPU \u7684 L1\u6216\u8005 L2 \u7f13\u5b58\u4e2d\u5bf9\u5e94\u7684\u7f13\u5b58\u884c\u65e0\u6548); - \u7b2c\u4e09\uff1a \u7531\u4e8e\u7ebf\u7a0b 1 \u7684\u5de5\u4f5c\u5185\u5b58\u4e2d\u53d8\u91cf\u7684\u7f13\u5b58\u884c\u65e0\u6548\uff0c \u6240\u4ee5\u7ebf\u7a0b 1\u518d\u6b21\u8bfb\u53d6\u53d8\u91cf\u7684\u503c\u65f6\u4f1a\u53bb\u4e3b\u5b58\u8bfb\u53d6\u3002</p> <p>\u57fa\u4e8e\u8fd9\u4e00\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u7ecf\u5e38\u4f1a\u770b\u5230\u6587\u7ae0\u4e2d\u6216\u8005\u4e66\u672c\u4e2d\u4f1a\u8bf4volatile \u80fd\u591f\u4fdd\u8bc1\u53ef\u89c1\u6027\u3002</p> <p>volatile \u80fd\u591f\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u4f46\u662fvolatile\u4e0d\u80fd\u4fdd\u8bc1\u7a0b\u5e8f\u7684\u539f\u5b50\u6027\u3002</p> <pre><code>public class VolatileTest {\n    public static volatile int race = 0;\n\n    public static void increase() {\n        race ++;\n    }\n    private static final int THREAD_COUNT = 20;\n\n    public static void main(String[] args) {\n        Thread[] threads = new Thread[THREAD_COUNT];\n        for(int i =0 ;i&lt;THREAD_COUNT;i++) {\n            threads[i] = new Thread(() -&gt;{\n                for(int j =0;j&lt; 10000;j++) {\n                    increase();\n                }\n            });\n            threads[i].start();\n        }\n\n        while(Thread.activeCount() &gt; 1)\n            Thread.yield();\n\n        System.out.println(race);\n    }\n}\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u53d1\u8d77\u4e8620\u4e2a\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u5bf9race\u53d8\u91cf\u8fdb\u884c10000\u6b21\u81ea\u589e\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u6bb5\u4ee3\u7801\u80fd\u591f\u6b63\u786e\u5e76\u53d1\u7684\u8bdd\uff0c\u6700\u540e\u8f93\u51fa\u7684\u7ed3\u679c\u5e94\u8be5\u662f200000\u3002\u6211\u4eec\u8fd0\u884c\u5b8c\u8fd9\u6bb5\u4ee3\u7801\u4e4b\u540e\uff0c\u5e76\u6ca1\u6709\u83b7\u5f97\u671f\u671b\u7684\u7ed3\u679c\uff0c\u800c\u4e14\u53d1\u73b0\u6bcf\u6b21\u8fd0\u884c\u7a0b\u5e8f\u3002\u8f93\u51fa\u7684\u7ed3\u679c\u90fd\u4e0d\u4e00\u6837\uff0c\u90fd\u662f\u4e00\u4e2a\u5c0f\u4e8e200000\u7684\u6570\u5b57\u3002</p> <p>\u95ee\u9898\u5c31\u51fa\u5728\u81ea\u589e\u8fd0\u7b97\u201drace++\u201c\u4e4b\u4e2d\uff0c\u6211\u4eec\u7528javap\u53cd\u7f16\u8bd1\u8fd9\u6bb5\u4ee3\u7801\u540e\u53d1\u73b0\u53ea\u6709\u4e00\u884c\u4ee3\u7801\u7684increase()\u65b9\u6cd5\u5728Class\u6587\u4ef6\u4e2d\u662f\u75314\u6761\u5b57\u8282\u7801\u6307\u4ee4\u6784\u6210\u7684\u3002</p> <pre><code>  public static void increase();\n    Code:\n       0: getstatic     #13                 // Field race:I\n       3: iconst_1\n       4: iadd\n       5: putstatic     #13                 // Field race:I\n       8: return\n</code></pre> <p>\u4ece\u5b57\u8282\u7801\u5c42\u9762\u4e0a\u5f88\u5bb9\u6613\u5206\u6790\u51fa\u539f\u56e0\u4e86\uff1a\u5f53getstatic\u6307\u4ee4\u628arace\u7684\u503c\u53d6\u5230\u64cd\u4f5c\u6808\u65f6\uff0cvolatile\u5173\u952e\u5b57\u4fdd\u8bc1\u4e86race\u7684\u503c\u6b64\u65f6\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u5728\u6267\u884ciconst_1\u3001iAdd\u8fd9\u4e9b\u6307\u4ee4\u7684\u65f6\u5019\uff0c\u5176\u4ed6\u7ebf\u7a0b\u53ef\u80fd\u5df2\u7ecf\u628arace\u7684\u503c\u52a0\u5927\u4e86\uff0c\u800c\u5728\u64cd\u4f5c\u6808\u8ba2\u7684\u503c\u5c31\u53d8\u6210\u4e86\u8fc7\u671f\u7684\u6570\u636e\uff0c\u6240\u4ee5putstati\u6307\u4ee4\u6267\u884c\u540e\u5c31\u53ef\u80fd\u628a\u8f83\u5c0f\u7684\u503c\u540c\u6b65\u56de\u4e3b\u5185\u5b58\u4e2d\u53bb\u4e86\u3002</p> <p>\u5176\u5b9e\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7\u5b57\u8282\u7801\u6765\u5206\u6790\u8fd9\u4e2a\u95ee\u9898\u662f\u4e0d\u4e25\u8c28\u7684\uff0c\u56e0\u4e3a\u5373\u4f7f\u7f16\u8bd1\u51fa\u6765\u7684\u53ea\u6709\u4e00\u6761\u5b57\u8282\u6307\u4ee4\uff0c\u4e5f\u5e76\u4e0d\u610f\u5473\u6267\u884c\u8fd9\u6761\u6307\u4ee4\u5c31\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u3002\u4e00\u6761\u5b57\u8282\u7801\u6307\u4ee4\u5728\u89e3\u91ca\u6267\u884c\u65f6\uff0c\u89e3\u91ca\u5668\u5c06\u8981\u8fd0\u884c\u8bb8\u591a\u884c\u4ee3\u7801\u624d\u80fd\u5b9e\u73b0\u5b83\u7684\u8bed\u4e49\uff0c\u5982\u679c\u662f\u7f16\u8bd1\u6267\u884c\uff0c\u4e00\u6761\u5b57\u8282\u7801\u6307\u4ee4\u4e5f\u53ef\u80fd\u8f6c\u5316\u6210\u82e5\u5e72\u6761\u672c\u5730\u673a\u5668\u7801\u6307\u4ee4\u3002\u5173\u4e8e\u89e3\u91ca\u6267\u884c\u548c\u7f16\u8bd1\u6267\u884c\uff0c\u6211\u4eec\u8fd8\u4f1a\u518d\u8bb2\u5230\u3002</p> <p>\u7531\u4e8evolatile\u53d8\u91cf\u53ea\u80fd\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u5728\u4e0d\u7b26\u5408\u4ee5\u4e0b\u4e24\u6761\u89c4\u5219\u7684\u8fd0\u7b97\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4ecd\u7136\u8981\u901a\u8fc7\u52a0\u9501\uff08synchronized\u6216java.util.concurrent\u4e2d\u7684\u539f\u5b50\u7c7b\uff09\u6765\u4fdd\u8bc1\u539f\u5b50\u6027\u3002 - \u8fd0\u8f93\u7ed3\u679c\u5e76\u4e0d\u4f9d\u8d56\u53d8\u91cf\u7684\u5f53\u524d\u503c\uff0c\u6216\u8005\u80fd\u591f\u786e\u4fdd\u53ea\u6709\u5355\u4e00\u7684\u7ebf\u7a0b\u4fee\u6539\u53d8\u91cf\u7684\u503c\u3002 - \u53d8\u91cf\u4e0d\u9700\u8981\u4e0e\u5176\u4ed6\u72b6\u6001\u53d8\u91cf\u5171\u540c\u53c2\u4e0e\u4e0d\u53d8\u7ea6\u675f\u3002</p> <p>\u7c7b\u4f3c\u4e0b\u9762\u7684\u573a\u666f\u5c31\u65f6\u5019\u91c7\u7528volatile\u6765\u63a7\u5236\u5e76\u53d1\u3002</p> <pre><code>volatile boolean shutdownRequested;\npublic void shutdown() {\n    shutdownRequested = true;\n}\npublic void doWork() {\n    while(!shutdownRequested) {\n        //do stuff\n    }\n}\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u60f3\u8ba9\u4e0a\u9762\u7684\u90a3\u4e2a\u81ea\u589e\u64cd\u4f5c\u4fdd\u6301\u539f\u5b50\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528AtomicInteger\uff0c\u5177\u4f53\u7a0b\u5e8f\u5982\u4e0b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u505a\u4ecb\u7ecd\u4e86\u3002</p> <pre><code>import java.util.concurrent.atomic.AtomicInteger;\n\npublic class VolatileTest {\n//  public static volatile int race = 0;\n    public static AtomicInteger race =new  AtomicInteger(0);\n\n    public static void increase() {\n//      race ++;\n        race.incrementAndGet();\n    }\n    private static final int THREAD_COUNT = 20;\n\n    public static void main(String[] args) {\n        Thread[] threads = new Thread[THREAD_COUNT];\n        for(int i =0 ;i&lt;THREAD_COUNT;i++) {\n            threads[i] = new Thread(() -&gt;{\n                for(int j =0;j&lt; 10000;j++) {\n                    increase();\n                }\n            });\n            threads[i].start();\n        }\n        while(Thread.activeCount() &gt; 1)\n            Thread.yield();\n\n        System.out.println(race.get());\n    }\n}\n</code></pre> <p>\u56de\u5230<code>volatile\u5173\u952e\u5b57</code>\u7684\u7b2c\u4e8c\u5c42\u8bed\u4e49\uff1a\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u3002 \u666e\u901a\u7684\u53d8\u91cf\u4ec5\u4ec5\u4f1a\u4fdd\u8bc1\u5728\u8be5\u65b9\u6cd5\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d\u6240\u6709\u4f9d\u8d56\u8d4b\u503c\u7ed3\u679c\u7684\u5730\u65b9\u90fd\u80fd\u83b7\u53d6\u5230\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u800c\u4e0d\u80fd\u4fdd\u8bc1\u53d8\u91cf\u8d4b\u503c\u64cd\u4f5c\u7684\u987a\u5e8f\u4e0e\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u7684\u6267\u884c\u987a\u5e8f\u4e00\u81f4\u3002</p> <p>\u6211\u4eec\u7528\u4e00\u6bb5\u4f2a\u4ee3\u7801\u6765\u5e2e\u52a9\u4e0b\u7406\u89e3\uff1a</p> <pre><code>Map configOptions;\nchar[] configText;\n//\u6b64\u53d8\u91cf\u5fc5\u987b\u5b9a\u4e49\u4e3avolatile\nvolatile boolean initialized = false;\n\n//\u5047\u8bbe\u4e00\u4e0b\u4ee3\u7801\u5728\u7ebf\u7a0bA\u4e2d\u6267\u884c\n//\u6a21\u62df\u8bfb\u53d6\u914d\u7f6e\u4fe1\u606f\uff0c\u5f53\u8bfb\u53d6\u5b8c\u6210\u540e\u5c06initialized\u8bbe\u7f6e\u4e3atrue\u4ee5\u901a\u77e5\u5176\u4ed6\u7ebf\u7a0b\u914d\u7f6e\u53ef\u7528\nconfigOptions = new HashMap();\nconfigText = readConfigFile(fileName);\nprocessCongigOptions(configText,configOptions);\ninitialized = true\n\n//\u5047\u8bbe\u4e00\u4e0b\u4ee3\u7801\u5728\u7ebf\u7a0bB\u4e2d\u6267\u884c\n//\u7b49\u5f85initialized\u4e3atrue\uff0c\u4ee3\u8868\u7ebf\u7a0bA\u5df2\u7ecf\u5427\u914d\u7f6e\u4fe1\u606f\u521d\u59cb\u5316\u5b8c\u6210\nwhile(!initialized) {\n    sleep();\n}\n//\u4f7f\u7528\u7ebf\u7a0bA\u4e2d\u521d\u59cb\u5316\u597d\u7684\u914d\u7f6e\u4fe1\u606f\ndoSomethingWithConfig();\n</code></pre> <p>\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\u5982\u679c\u5b9a\u4e49\u7684initialized\u6ca1\u6709\u4f7f\u7528volatile\u6765\u4fee\u9970\uff0c\u5c31\u53ef\u80fd\u4f1a\u7531\u4e8e\u6307\u4ee4\u91cd\u6392\u5e8f\u7684\u4f18\u5316\uff0c\u5bfc\u81f4\u4f4d\u4e8e\u7ebf\u7a0bA\u4e2d\u6700\u540e\u4e00\u53e5\u4ee3\u7801<code>initialized = true</code>\u88ab\u63d0\u524d\u6267\u884c\uff08\u8fd9\u91cc\u867d\u7136\u4f7f\u7528Java\u4f5c\u4e3a\u4f2a\u4ee3\u7801\uff0c\u4f46\u6240\u6307\u7684\u91cd\u6392\u5e8f\u4f18\u5316\u662f\u673a\u5668\u7ea7\u7684\u4f18\u5316\u64cd\u4f5c\uff0c\u63d0\u524d\u6267\u884c\u65f6\u503c\u8fd9\u53e5\u8bdd\u5bf9\u4e8e\u7684\u6c47\u7f16\u4ee3\u7801\u88ab\u63d0\u524d\u6267\u884c\uff09\uff0c\u8fd9\u6837\u5728\u7ebf\u7a0bB\u4e2d\u4f7f\u7528\u914d\u7f6e\u4fe1\u606f\u7684\u4ee3\u7801\u5c31\u53ef\u80fd\u51fa\u73b0\u9519\u8bef\uff0c\u800cvolatile\u80fd\u907f\u514d\u6b64\u7c7b\u60c5\u51b5\u7684\u53d1\u751f\u3002</p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#volatile_2","title":"volatile\u5173\u952e\u5b57\u6df1\u5165\u89e3\u6790","text":"<p>\u4e0a\u9762\u8bb2\u5230<code>volatile\u5173\u952e\u5b57\u7684\u4e24\u5c42\u8bed\u4e49</code>\uff0c\u90a3\u4e48volatile\u4fdd\u8bc1\u53ef\u89c1\u6027\u4ee5\u53ca\u6709\u5e8f\u6027\u5230\u5e95\u662f\u5982\u4f55\u505a\u5230\u7684\u5462\uff1f\u5b83\u7684\u5e95\u5c42\u903b\u8f91\u662f\u4ec0\u4e48\u5462\uff1f</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u83b7\u5f97Java\u7a0b\u5e8f\u7684\u6c47\u7f16\u4ee3\u7801\uff0c\u901a\u8fc7\u6bd4\u8f83\u53d8\u91cf\u52a0\u5165volatile\u4fee\u9970\u548c\u672a\u52a0\u5165volatile\u4fee\u9970\u7684\u533a\u522b\u3002</p> <p>\u8fd9\u91cc\u4e3b\u8981\u4f7f\u7528\u7684\u662fHSDIS\u63d2\u4ef6\uff0cHSDIS\u662f\u4e00\u4e2aSun\u5b98\u65b9\u63a8\u8350\u7684HotSpot\u865a\u62df\u673aJIT\u7f16\u8bd1\u4ee3\u7801\u7684\u53cd\u6c47\u7f16\u63d2\u4ef6\uff0c\u7f51\u4e0a\u6709\u5173\u4e8e\u8fd9\u4e2a\u63d2\u4ef6\u7684\u4e0b\u8f7d\uff0c\u4e0d\u8fc7\u6709\u7684\u94fe\u63a5\u5df2\u7ecf\u5931\u6548\uff0c\u6211\u8fd9\u91cc\u662f\u4ece\u8fd9\u91cc\u83b7\u53d6\u7684\uff0chsdis\uff0c\u518d\u628a\u8fd9\u4e2aclone\u4e0b\u6765\u4e4b\u540e\uff0c\u7f16\u8bd1\u6210\u529f\u4e4b\u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u62f7\u8d1d\u5230jre\u7684server\u76ee\u5f55,\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u8fd9\u4e2arepo\u4e2dREADME\u6587\u4ef6\uff0c\u91cc\u9762\u5199\u7684\u5f88\u8be6\u7ec6\u3002</p> <pre><code>sudo cp build/macosx-amd64/hsdis-amd64.dylib /Library/Java/JavaVirtualMachines/jdk1.8.0_131.jdk/Contents/Home/jre/lib/server/\n</code></pre> <p>\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u53cd\u6c47\u7f16\u4e86\u3002</p> <pre><code>public class Singleton {\n    private static Singleton instance;\n\n    public static Singleton getInstance() {\n        if(instance ==null) {\n            synchronized(Singleton.class) {\n                if(instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n        return instance;\n    }\n\n    public static void main(String[] args) {\n        Singleton.getInstance();\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u8fd9\u4e2a\u662f\u6211\u4eec\u5c1d\u8bd5\u53cd\u6c47\u7f16\u7684\u7a0b\u5e8f\u4ee3\u7801\uff0c\u5982\u679c\u662f\u547d\u4ee4\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u4e2a\u6307\u4ee4\u3002</p> <pre><code>java -XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly Singleton\n</code></pre> <p>\u5982\u679c\u662feclipse\uff0c\u5728\u4e0b\u56fe\u7684VM arguments\u4e2d\u6dfb\u52a0<code>XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly</code>,\u7136\u540e\u8fd0\u884c\u7a0b\u5e8f\uff0c\u8fd9\u6837\u5728\u63a7\u5236\u53f0\u5c31\u4f1a\u8f93\u51fa\u6c47\u7f16\u4ee3\u7801\u3002  \u7a0b\u5e8f\u8fd0\u884c\u540e\uff0c\u5728\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\u5f88\u591a\u5185\u5bb9,\u7531\u4e8e\u8f93\u51fa\u592a\u5927\uff0c\u6240\u4ee5\u622a\u53d6\u4e86\u524d\u9762\u4e00\u6bb5\u8f93\u51fa\u3002</p> <pre><code>Java HotSpot(TM) 64-Bit Server VM warning: PrintAssembly is enabled; turning on DebugNonSafepoints to gain additional output\nLoaded disassembler from /Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/jre/lib/server/hsdis-amd64.dylib\nDecoding compiled method 0x0000000112e9ad50:\nCode:\n[Disassembling for mach='i386:x86-64']\n[Entry Point]\n[Constants]\n  # {method} {0x000000010ce1f000} 'hashCode' '()I' in 'java/lang/String'\n  #           [sp+0x40]  (sp of caller)\n  0x0000000112e9aec0: mov    0x8(%rsi),%r10d\n  0x0000000112e9aec4: shl    $0x3,%r10\n  0x0000000112e9aec8: cmp    %rax,%r10\n  0x0000000112e9aecb: jne    0x0000000112de0e60  ;   {runtime_call}\n  0x0000000112e9aed1: data16 data16 nopw 0x0(%rax,%rax,1)\n  0x0000000112e9aedc: data16 data16 xchg %ax,%ax\n[Verified Entry Point]\n  0x0000000112e9aee0: mov    %eax,-0x14000(%rsp)\n  .....\n</code></pre> <p>\u5f97\u5230\u8fd9\u4e2a\u8f93\u51fa\u4e4b\u540e\uff0c\u6211\u4f7f\u7528<code>Singleton</code>\u5168\u5c40\u641c\u7d22\u4e86\u4e0b\uff0c\u53d1\u73b0\u8fd8\u65e0\u7ed3\u679c\u3002  \u53cd\u7f16\u8bd1\u7684\u5374\u6ca1\u6709\u5f97\u5230\u76f8\u5e94\u7684\u5185\u5bb9\uff0c\u8fd9\u662f\u4ec0\u4e48\u95ee\u9898\u5462\uff1f \u5e26\u7740\u8fd9\u4e2a\u95ee\u9898Google\u4e86\u597d\u4e45\uff0c\u7ec8\u4e8e\u641e\u660e\u767d\u539f\u56e0\u4e86\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u53c8\u8981\u6765\u8865\u5145\u4e9b\u865a\u62df\u673a\u7f16\u8bd1\u7684\u77e5\u8bc6\u4e86\u3002  \u6211\u4eec\u5728\u4f7f\u7528<code>java -version</code>\u67e5\u770bJDK\u7248\u672c\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u770b\u5230\u6700\u540e\u6709\u4e2a<code>mixed mode</code>\uff0c\u8fd9\u91cc\u5176\u5b9e\u8868\u660e\u7684\u662fJava \u865a\u62df\u673a\u7684\u7f16\u8bd1\u65b9\u5f0f\uff0c\u5728HotSpot\u865a\u62df\u673a\u4e2d\uff0c\u63d0\u4f9b\u4e86\u4e24\u79cd\u7f16\u8bd1\u6a21\u5f0f\uff1a\u89e3\u91ca\u6267\u884c \u548c \u5373\u65f6\u7f16\u8bd1\uff08JIT\uff0cJust-In-Time\uff09\uff0c\u5373\u65f6\u7f16\u8bd1\u4e5f\u53ef\u4ee5\u79f0\u4e3a\u7f16\u8bd1\u6267\u884c\uff0c\u89e3\u91ca\u6267\u884c\u5373\u9010\u6761\u7ffb\u8bd1\u5b57\u8282\u7801\u4e3a\u53ef\u8fd0\u884c\u7684\u673a\u5668\u7801\uff0c\u800c\u5373\u65f6\u7f16\u8bd1\u5219\u4ee5\u65b9\u6cd5\u4e3a\u5355\u4f4d\u5c06\u5b57\u8282\u7801\u7ffb\u8bd1\u6210\u673a\u5668\u7801\u3002</p> <p>\u6211\u4eec\u5728\u53cd\u7f16\u8bd1Singleton\u8fd9\u4e2a\u7c7b\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u865a\u62df\u673a\u4f7f\u7528\u7684\u662f\u89e3\u91ca\u6267\u884c\uff0c\u8fd9\u6837\u6211\u4eec\u662f\u5f97\u4e0d\u5230\u6c47\u7f16\u4ee3\u7801\u7684\u3002\u5728\u6df1\u5165\u7406\u89e3Java\u865a\u62df\u673a\u4e00\u4e66\u4e2d\u4ecb\u7ecd\u53ef\u4ee5\u52a0\u4e0a<code>-Xcomp</code>\u6765\u89e6\u53d1JIT\u7f16\u8bd1\uff0c\u4f46\u662f\u6211\u7528\u7684\u662fJDK1.8\uff0c\u8fd9\u4e2a -Xcomp`\u5df2\u7ecf\u88ab\u79fb\u9664\u4e86\uff0c\u5177\u4f53\u54ea\u4e2a\u7248\u672c\u88ab\u79fb\u9664\u4e86\uff0c\u76ee\u524d\u6211\u4e5f\u6ca1\u4ed4\u7ec6\u7814\u7a76\u8fc7\u4e86\u3002</p> <p>\u90a3\u8981\u600e\u6837\u624d\u80fd\u89e6\u53d1JIT\u7f16\u8bd1\u5462\uff1f\u7b54\u6848\u662f\u5faa\u73af\u3002\u901a\u8fc7\u8db3\u591f\u591a\u6b21\u6570\u7684\u5faa\u73af\u6765\u89e6\u53d1JIT\u7f16\u8bd1\u3002\u6211\u4eec\u9700\u8981\u786e\u4fdd\u5199\u7684Java\u65b9\u6cd5\u88ab\u8c03\u7528\u7684\u6b21\u6570\u8db3\u591f\u591a\uff0c\u4ee5\u89e6\u53d1C1\uff08\u5ba2\u6237\u7aef\uff09\u7f16\u8bd1\uff0c\u5e76\u5927\u7ea610000\u6b21\u89e6\u53d1C2\uff08\u670d\u52a1\u5668\uff09\u7f16\u8bd1\u5668\u5e76\u6253\u5f00\u9ad8\u7ea7\u4f18\u5316\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u8981\u60f3\u67e5\u770b\u6c47\u7f16\u4ee3\u7801\uff0c\u6211\u4eec\u6240\u5199\u7684Java\u6e90\u4ee3\u7801\u6587\u4ef6\u4e0d\u80fd\u592a\u8fc7\u4e8e\u7b80\u5355\uff0c\u8981\u8db3\u591f\u590d\u6742\u3002</p> <p>\u6ce8\u610f\uff1aC1\uff0cC2\u90fd\u662fHotSpot\u865a\u62df\u673a\u5185\u7f6e\u7684\u5373\u65f6\u7f16\u8bd1\u5668\u3002C1\uff1a\u5373Client\u7f16\u8bd1\u5668\uff0c\u9762\u5411\u5bf9\u542f\u52a8\u6027\u80fd\u6709\u8981\u6c42\u7684\u5ba2\u6237\u7aefGUI\u7a0b\u5e8f\uff0c\u91c7\u7528\u7684\u4f18\u5316\u624b\u6bb5\u6bd4\u8f83\u7b80\u5355\uff0c\u56e0\u6b64\u7f16\u8bd1\u7684\u65f6\u95f4\u8f83\u77ed\u3002C2\uff1a\u5373Server\u7f16\u8bd1\u5668\uff0c\u9762\u5411\u5bf9\u6027\u80fd\u5cf0\u503c\u6709\u8981\u6c42\u7684\u670d\u52a1\u7aef\u7a0b\u5e8f\uff0c\u91c7\u7528\u7684\u4f18\u5316\u624b\u6bb5\u590d\u6742\uff0c\u56e0\u6b64\u7f16\u8bd1\u65f6\u95f4\u957f\uff0c\u4f46\u662f\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u6027\u80fd\u66f4\u597d\u3002</p> <pre><code>public class Singleton {\n    private static Singleton instance;\n\n    public static Singleton getInstance() {\n        if(instance ==null) {\n            synchronized(Singleton.class) {\n                if(instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n        return instance;\n    }\n\n    public static void main(String[] args) {\n        for(int i=0;i&lt;100;i++) {\n            print();\n        }\n    }\n    private static void print() {\n        for(int i =0;i&lt;=1000;i++) {\n            Singleton.getInstance();\n        }\n    }\n}\n</code></pre> <p>\u4e8e\u662f\u6211\u5728\u4ee3\u7801\u91cc\u52a0\u4e0a\u4e86\u4e24\u5c42\u5faa\u73af\uff0c\u7136\u540e\u5728\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e9b\u6c47\u7f16\u4ee3\u7801\u3002</p> <p>\u8fd9\u6b21\u53d1\u73b0\u7ec8\u4e8e\u80fd\u5f97\u5230Singleton\u76f8\u5173\u7684\u6c47\u7f16\u4ee3\u7801\u4e86\u3002</p> <p>\u4e8e\u662f\u6211\u4eec\u5206\u522b\u7f16\u8bd1\u4e86\u4e24\u6b21\uff0c\u7b2c\u4e00\u4e2a\u662f\u6ca1\u6709\u4f7f\u7528volatile\u5173\u952e\u5b57\u4fee\u9970instance\uff0c\u7b2c\u4e8c\u4e2a\u662f\u4f7f\u7528volatile\u5173\u952e\u5b57\uff0c\u7136\u540e\u6211\u4eec\u5206\u522b\u53d6\u51fa<code>Singleton::getInstance</code>\u8fd9\u4e00\u6bb5\u6765\u8fdb\u884c\u6bd4\u8f83\u3002</p> <pre><code> // \u672a\u4f7f\u7528volatile\u4fee\u9970\n  0x000000010d29e931: movabs $0x7955f12a8,%rsi  ;   {oop(a 'java/lang/Class' = 'main/Singleton')}\n  0x000000010d29e93b: mov    %rax,%r10\n  0x000000010d29e93e: shr    $0x3,%r10\n  0x000000010d29e942: mov    %r10d,0x68(%rsi)\n  0x000000010d29e946: shr    $0x9,%rsi\n  0x000000010d29e94a: movabs $0xfe403000,%rax\n  0x000000010d29e954: movb   $0x0,(%rsi,%rax,1)  ;*putstatic instance\n                                                ; - main.Singleton::getInstance@24 (line 10)\n</code></pre> <pre><code>// \u4f7f\u7528volatile\u4fee\u9970\n 0x000000011435394f: movabs $0x7955f12a8,%rsi  ;   {oop(a 'java/lang/Class' = 'main/Singleton')}\n  0x0000000114353959: mov    %rax,%r10\n  0x000000011435395c: shr    $0x3,%r10\n  0x0000000114353960: mov    %r10d,0x68(%rsi)\n  0x0000000114353964: shr    $0x9,%rsi\n  0x0000000114353968: movabs $0x10db6e000,%rax\n  0x0000000114353972: movb   $0x0,(%rsi,%rax,1)\n  0x0000000114353976: lock addl $0x0,(%rsp)     ;*putstatic instance\n                                                ; - main.Singleton::getInstance@24 (line 10)\n</code></pre> <p>\u867d\u7136\u5bf9\u4e8e\u6c47\u7f16\u6307\u4ee4\u4e86\u89e3\u4e0d\u591a\uff0c\u4f46\u8fd8\u662f\u80fd\u4ece\u4e24\u4e2a\u5bf9\u6bd4\u4e2d\u770b\u51fa\u5dee\u5f02\u6240\u5728\u3002 \u5f88\u660e\u663e\uff0c\u5728<code>movb   $0x0,(%rsi,%rax,1)</code> \u4e4b\u540e\uff0c\u52a0\u4e86volatile\u4fee\u9970\u7684\u6c47\u7f16\u4ee3\u7801\u540e\u9762\u591a\u4e86\u4e00\u6761\u6c47\u7f16\u6307\u4ee4<code>lock addl $0x0,(%rsp)</code>\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u5185\u5b58\u5c4f\u969c\uff0c\u6307\u4ee4\u91cd\u6392\u65f6\u4e0d\u80fd\u628a\u540e\u9762\u7684\u6307\u4ee4\u91cd\u6392\u5e8f\u5230\u5185\u5b58\u5c4f\u969c\u4e4b\u524d\u7684\u4f4d\u7f6e\uff0c\u5f53\u53ea\u6709\u4e00\u4e2aCPU\u8bbf\u95ee\u5185\u5b58\u65f6\uff0c\u5e76\u4e0d\u9700\u8981\u5185\u5b58\u5c4f\u969c\uff0c\u5f53\u5982\u679c\u6709\u4e24\u4e2a\u6216\u591a\u4e2aCPU\u8bbf\u95ee\u540c\u4e00\u5757\u5185\u5b58\uff0c\u4e14\u5176\u4e2d\u6709\u4e00\u4e2a\u5728\u89c2\u6d4b\u53e6\u4e00\u4e2a\uff0c\u5c31\u9700\u8981\u5185\u5b58\u5c4f\u969c\u6765\u4fdd\u8bc1\u4e00\u81f4\u6027\u4e86\u3002<code>lock addl $0x0,(%rsp)</code> \u8868\u793a\u628arsp\u7684\u5bc4\u5b58\u5668\u7684\u503c\u52a00\uff0c\u8fd9\u663e\u7136\u662f\u4e00\u4e2a\u7a7a\u64cd\u4f5c\uff0c\u5173\u952e\u5728\u4e8elock\u524d\u7f00\u3002  \u67e5\u8be2IA32\u624b\u518c\uff0clock\u524d\u7f00\u4f1a\u5f3a\u5236\u6267\u884c\u539f\u5b50\u64cd\u4f5c\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u662f\u7684\u672cCPU\u7684Cache\u5199\u5165\u4e86\u5185\u5b58\uff0c\u8be5\u5199\u5165\u52a8\u4f5c\u4f1a\u5f15\u8d77\u522b\u7684CPU\u65e0\u6548\u5316\u5176Cache\u3002\u6240\u6709\u901a\u8fc7\u8fd9\u6837\u4e00\u4e2a\u7a7a\u64cd\u4f5c\uff0c\u53ef\u8ba9\u524d\u9762volatile\u53d8\u91cf\u7684\u4fbf\u662f\u5bf9\u5176\u4ed6CPU\u53ef\u89c1\u3002</p> <p>\u90a3\u4e3a\u4ec0\u4e48\u8bf4\u5b83\u80fd\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u5462\uff1f\u4ece\u786c\u4ef6\u67b6\u6784\u4e0a\u8bb2\uff0c\u6307\u4ee4\u91cd\u6392\u5e8f\u662f\u6307CPU\u91c7\u7528\u4e86\u8fd0\u884c\u5c06\u591a\u6761\u6307\u4ee4\u4e0d\u6309\u7a0b\u5e8f\u89c4\u5b9a\u7684\u987a\u5e8f\u5206\u5f00\u53d1\u9001\u7ed9\u5404\u76f8\u5e94\u7684\u70b9\u4e86\u5355\u5143\u5904\u7406\uff0c\u4f46\u5e76\u4e0d\u662f\u6307\u4ee4\u4efb\u610f\u91cd\u6392\uff0cCPU\u9700\u8981\u80fd\u6b63\u786e\u5904\u7406\u6307\u4ee4\u4f9d\u8d56\u60c5\u51b5\u4ee5\u4fdd\u969c\u7a0b\u5e8f\u80fd\u5f97\u51fa\u6b63\u786e\u7684\u6267\u884c\u7ed3\u679c\u3002<code>lock addl $0x0,(%rsp)</code> \u6307\u4ee4\u628a\u4fee\u6539\u540c\u6b65\u5230\u5185\u5b58\u65f6\uff0c\u610f\u5473\u7740\u6240\u6709\u4e4b\u524d\u7684\u64cd\u4f5c\u90fd\u5df2\u7ecf\u6267\u884c\u5b8c\u6210\uff0c\u8fd9\u6837\u4fbf\u5f62\u6210\u4e86\" \u6307\u4ee4\u91cd\u6392\u5e8f\u65e0\u6cd5\u8d8a\u8fc7\u5185\u5b58\u5c4f\u969c\"\u7684\u6548\u679c\u3002</p> <p>\u603b\u7ed3\u6765\u8bf4\uff0c\u5185\u5b58\u5c4f\u969c\u6709\u4e24\u4e2a\u4f5c\u7528\uff1a \u5148\u4e8e\u8fd9\u4e2a\u5185\u5b58\u5c4f\u969c\u7684\u6307\u4ee4\u5fc5\u987b\u5148\u6267\u884c\uff0c \u540e\u4e8e\u8fd9\u4e2a\u5185\u5b58\u5c4f\u969c\u7684\u6307\u4ee4\u5fc5\u987b\u540e\u6267\u884c\u3002 \u5982\u679c\u4f60\u7684\u5b57\u6bb5\u662fvolatile\uff0c\u5728\u8bfb\u6307\u4ee4\u524d\u63d2\u5165\u8bfb\u5c4f\u969c\uff0c\u53ef\u4ee5\u8ba9\u9ad8\u901f\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u5931\u6548\uff0c\u91cd\u65b0\u4ece\u4e3b\u5185\u5b58\u52a0\u8f7d\u6570\u636e\u3002\u5728\u5199\u6307\u4ee4\u4e4b\u540e\u63d2\u5165\u5199\u5c4f\u969c\uff0c\u80fd\u8ba9\u5199\u5165\u7f13\u5b58\u7684\u6700\u65b0\u6570\u636e\u5199\u56de\u5230\u4e3b\u5185\u5b58\u3002</p> <p>\u5173\u4e8evolatile\u5173\u952e\u5b57\u7684\u4ecb\u7ecd\u5c31\u5230\u8fd9\u91cc\u4e86\uff0c\u611f\u8c22\uff0c\u5982\u679c\u89c9\u5f97\u8fd8\u53ef\u4ee5\u8bf7\u5e2e\u5fd9\u70b9\u4e2a\u8d5e\uff0c\u6709\u95ee\u9898\u6b22\u8fce\u7559\u8a00\u8ba8\u8bba\u3002</p> <p>\u539f\u6587\u94fe\u63a5</p>"},{"location":"MultiThread/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/#_1","title":"\u53c2\u8003","text":"<p>[\u6df1\u5165\u7406\u89e3Java\u865a\u62df\u673a] [Java\u9ad8\u5e76\u53d1\u7f16\u7a0b\u8be6\u89e3]</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/","title":"\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u8be6\u89e3","text":"<p>\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u751f\u547d\u5468\u671f\u3002</p> <p>\u5728\u89e3\u91ca\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u4e4b\u524d\uff0c\u8bf7\u5927\u5bb6\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u7ebf\u7a0b\u5728\u6267\u884cstart\u65b9\u6cd5\u540e\u5c31\u4ee3\u8868\u7ebf\u7a0b\u5df2\u7ecf\u5f00\u59cb\u6267\u884c\u4e86\u5417\uff1f</p> <p></p> <p>\u7531\u4e0a\u56fe\u6240\u77e5\uff0c\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u5927\u4f53\u53ef\u4ee5\u5206\u4e3a5\u4e2a\u4e3b\u8981\u7684\u9636\u6bb5\uff1a - NEW - RUNNABLE - RUNNING - BLOCKED - TERMINATED</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/#new","title":"\u7ebf\u7a0b\u7684NEW\u72b6\u6001","text":"<p>\u5f53\u6211\u4eec\u4f7f\u7528\u5173\u952e\u5b57new\u521b\u5efa\u4e00\u4e2aThread\u5bf9\u8c61\u65f6\uff0c\u6b64\u65f6\u5b83\u5e76\u4e0d\u5904\u4e8e\u6267\u884c\u72b6\u6001\uff0c\u56e0\u4e3a\u6ca1\u6709\u8c03\u7528start\u65b9\u6cd5\u542f\u52a8\u8be5\u7ebf\u7a0b\uff0c\u90a3\u4e48\u7ebf\u7a0b\u7684\u72b6\u6001\u672aNEW\u72b6\u6001\uff0c\u51c6\u786e\u5730\u8bf4\uff0c\u5b83\u53ea\u662fThread\u5bf9\u8c61\u7684\u72b6\u6001\uff0c\u56e0\u4e3a\u5728\u6ca1\u6709start\u4e4b\u524d\uff0c\u8be5\u7ebf\u7a0b\u6839\u672c\u4e0d\u5b58\u5728\uff0c\u4e0e\u4f60\u4f7f\u7528\u5173\u952e\u5b57new \u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7684Java\u5bf9\u8c61\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\u3002</p> <p>NEW\u72b6\u6001\u901a\u8fc7start\u65b9\u6cd5\u8fdb\u5165RUNNABLE\u72b6\u6001\u3002</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/#runnable","title":"\u7ebf\u7a0b\u7684RUNNABLE\u72b6\u6001","text":"<p>\u7ebf\u7a0b\u5bf9\u8c61\u8fdb\u5165RUNNABLE\u72b6\u6001\u5fc5\u987b\u8c03\u7528start\u65b9\u6cd5\uff0c\u90a3\u4e48\u6b64\u65f6\u624d\u662f\u771f\u6b63\u5730\u5728JVM\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u7ebf\u7a0b\u4e00\u7ecf\u542f\u52a8\u5c31\u53ef\u4ee5\u7acb\u5373\u5f97\u5230\u6267\u884c\u561b\uff1f\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0c\u7ebf\u7a0b\u7684\u8fd0\u884c\u4e0e\u5426\u548c\u8fdb\u7a0b\u4e00\u6837\u8981\u542c\u547d\u4e8eCPU\u7684\u8c03\u5ea6\uff0c\u90a3\u4e48\u6211\u4eec\u628a\u8fd9\u4e2a\u4e2d\u95f4\u72b6\u6001\u79f0\u4e3a\u53ef\u6267\u884c\u72b6\u6001\uff08RUNNABLE\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u5177\u5907\u6267\u884c\u7684\u8d44\u683c\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u771f\u6b63\u5730\u6267\u884c\u6c14\u5566\u800c\u662f\u7b49\u5f85CPU\u7684\u8c03\u5ea6\u3002</p> <p>\u7531\u4e8e\u5b58\u5728RUNNING\u72b6\u6001\uff0c\u6240\u4f9d\u4e0d\u4f1a\u76f4\u63a5\u8fdb\u5165BLOCKED\u72b6\u6001\u548cTERMINATED\u72b6\u6001\uff0c\u5373\u4f7f\u662f\u5728\u7ebf\u7a0b\u7684\u6267\u884c\u903b\u8f91\u4e2d\u8c03\u7528wait\uff0csleep\u6216\u8005\u5176\u4ed6block\u7684IO\u64cd\u4f5c\u7b49\uff0c\u4e5f\u5fc5\u987b\u5148\u83b7\u5f97CPU\u7684\u8c03\u5ea6\u6267\u884c\u6743\u624d\u53ef\u4ee5\uff0c\u4e25\u683c\u6765\u8bb2\uff0cRUNNABLE\u7684\u7ebf\u7a0b\u53ea\u80fd\u610f\u5916\u7ec8\u6b62\u6216\u8005\u8fdb\u5165RUNNING\u72b6\u6001\u3002</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/#running","title":"\u7ebf\u7a0b\u7684RUNNING\u72b6\u6001","text":"<p>\u4e00\u65e6CPU\u901a\u8fc7\u8f6e\u8be2\u6216\u8005\u5176\u4ed6\u65b9\u5f0f\u4ece\u4efb\u52a1\u53ef\u6267\u884c\u961f\u5217\u4e2d\u9009\u4e2d\u4e86\u7ebf\u7a0b\uff0c\u90a3\u4e48\u6b64\u65f6\u5b83\u624d\u80fd\u771f\u6b63\u5730\u6267\u884c\u81ea\u5df1\u7684\u903b\u8f91\u4ee3\u7801\uff0c\u9700\u8981\u8bf4\u7684\u4e00\u70b9\u662f\u4e00\u4e2a\u6b63\u5728RUNNING\u72b6\u6001\u7684\u7ebf\u7a0b\u8bd5\u8bd5\u4e0a\u4e5f\u662fRUNNABLE\u7684\uff0c\u4f46\u662f\u53cd\u8fc7\u6765\u5219\u4e0d\u6210\u7acb\u3002</p> <p>\u5728\u8be5\u72b6\u6001\u4e2d\uff0c\u7ebf\u7a0b\u7684\u4e13\u9898\u53ef\u4ee5\u53d1\u751f\u5982\u4e0b\u7684\u72b6\u6001\u8f6c\u6362\u3002 - \u76f4\u63a5\u8fdb\u5165TERMINATED\u72b6\u6001\uff0c\u6bd4\u5982\u8c03\u7528JDK\u5df2\u7ecf\u4e0d\u63a8\u8350\u4f7f\u7528\u7684stop\u65b9\u6cd5\u6216\u8005\u5224\u65ad\u67d0\u4e2a\u903b\u8f91\u6807\u8bc6 - \u8fdb\u5165BLOCKED\u72b6\u6001\uff0c\u6bd4\u5982\u8c03\u7528\u4e86sleep\uff0c\u6216\u8005wait\u65b9\u6cd5\u800c\u8fdb\u5165\u4e86waitSet\u4e2d\u3002 - \u8fdb\u884c\u67d0\u4e2a\u963b\u585e\u7684IO\u64cd\u4f5c\uff0c\u6bd4\u5982\u56e0\u7f51\u7edc\u6570\u636e\u9540\u950c\u800c\u8fdb\u5165\u4e86BLOCKED\u72b6\u6001\u3002 - \u83b7\u53d6\u67d0\u4e2a\u9501\u8d44\u6e90\uff0c\u4ece\u800c\u52a0\u5165\u5230\u8be5\u9501\u7684\u963b\u585e\u961f\u5217\u4e2d\u800c\u8fdb\u5165\u4e86BLOCKED\u72b6\u6001\u3002 - \u7531\u4e8eCPU\u7684\u8c03\u7528\u5668\u8f6e\u8be2\u4f7f\u8be5\u7ebf\u7a0b\u653e\u5f03\u6267\u884c\uff0c\u8fdb\u5165RUNNALE\u72b6\u6001\u3002 - \u7ebf\u7a0b\u4e3b\u52a8\u8c03\u7528yield\u65b9\u6cd5\uff0c\u653e\u5f03CPU\u6267\u884c\u6743\uff0c\u8fdb\u5165RUNNABLE\u72b6\u6001\u3002</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/#blocked","title":"\u7ebf\u7a0b\u7684BLOCKED\u72b6\u6001","text":"<p>\u7ebf\u7a0b\u5728BLOCKED\u72b6\u6001\u4e2d\u53ef\u4ee5\u5207\u6362\u81f3\u5982\u4e0b\u51e0\u4e2a\u72b6\u6001\u3002 - \u76f4\u63a5\u8fdb\u5165TERMINATED\u72b6\u6001\uff0c\u6bd4\u5982\u8c03\u7528JDK\u5df2\u7ecf\u4e0d\u63a8\u8350\u4f7f\u7528\u7684stop\u65b9\u6cd5\u6216\u8005\u610f\u5916\u6b7b\u4ea1\uff08JVM crash\uff09\u3002 - \u7ebf\u7a0b\u963b\u585e\u7684\u64cd\u4f5c\u7ed3\u675f\uff0c\u6bd4\u5982\u8bfb\u53d6\u4e86\u60f3\u8981\u7684\u6570\u7ec4\u5b57\u8282\u8fdb\u5165\u5230RUNNABLE\u72b6\u6001\u3002 - \u7ebf\u7a0b\u5b8c\u6210\u4e86\u6307\u5b9a\u65f6\u95f4\u7684\u4f11\u7720\uff0c\u8fdb\u5165\u5230\u4e86RUNNABLE\u72b6\u6001\u3002 - Wait\u4e2d\u7684\u7ebf\u7a0b\u88ab\u5176\u4ed6\u7ebf\u7a0bnotify/notifyall\u5524\u9192\uff0c\u8fdb\u5165RUNNABLE\u72b6\u6001\u3002 - \u7ebf\u7a0b\u83b7\u53d6\u5230\u6765\u4e86\u67d0\u4e2a\u9501\u8d44\u6e90\uff0c\u8fdb\u5165RUNNABLE\u72b6\u6001\u3002 - \u73b0\u5728\u5728\u963b\u585e\u8fc7\u7a0b\u4e2d\u88ab\u6253\u65ad\uff0c\u6bd4\u5982\u5176\u4ed6\u7ebf\u7a0b\u8c03\u7528\u4e86interrupt\u65b9\u6cd5\uff0c\u8fdb\u5165RUNNABLE\u72b6\u6001\u3002</p>"},{"location":"MultiThread/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E8%AF%A6%E8%A7%A3/#terminated","title":"\u7ebf\u7a0b\u7684TERMINATED\u72b6\u6001","text":"<p>TERMINATED\u662f\u4e00\u4e2a\u7ebf\u7a0b\u7684\u6700\u7ec8\u72b6\u6001\uff0c\u5728\u8be5\u72b6\u6001\u4e2d\u7ebf\u7a0b\u4e0d\u4f1a\u5207\u6362\u5230\u5176\u4ed6\u4efb\u4f55\u72b6\u6001\uff0c\u7ebf\u7a0b\u8fdb\u5165TERMINATED\u72b6\u6001\uff0c\u610f\u5473\u7740\u7ebf\u7a0b\u5c06\u4e0d\u4f1a\u5207\u6362\u5230\u5176\u4ed6\u4efb\u4f55\u72b6\u6001\uff0c\u7ebf\u7a0b\u8fdb\u5165TERMINATED\u72b6\u6001\uff0c\u610f\u5473\u7740\u8be5\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u90fd\u7ed3\u675f\u4e86\uff0c\u4e0b\u5217\u8fd9\u4e9b\u60c5\u51b5\u5c06\u4f1a\u4f7f\u7ebf\u7a0b\u8fdb\u5165TERMINATED\u72b6\u6001\u3002</p> <ul> <li>\u7ebf\u7a0b\u8fd0\u884c\u6b63\u5e38\u7ed3\u675f\uff0c\u7ed3\u675f\u751f\u547d\u5468\u671f\u3002</li> <li>\u7ebf\u7a0b\u8fd0\u884c\u51fa\u9519\u610f\u5916\u7ed3\u675f\u3002</li> <li>JVM Crash\uff0c\u5bfc\u81f4\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u7ed3\u675f\u3002</li> </ul>"},{"location":"Network/HTTP%E4%B8%8EHTTPS%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/","title":"HTTP\u4e0eHTTPS\u6709\u4ec0\u4e48\u533a\u522b","text":""},{"location":"Network/HTTP%E4%B8%8EHTTPS%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/#httphttpsmd","title":"HTTP\u4e0eHTTPS\u6709\u4ec0\u4e48\u533a\u522b.md","text":"<p>HTTPS \u662f\u4e00\u79cd\u901a\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\u7684\u4f20\u8f93\u534f\u8bae\u3002HTTPS \u7ecf\u7531 HTTP \u8fdb\u884c\u901a\u4fe1\uff0c\u4f46\u5229\u7528 SSL/TLS \u6765\u52a0\u5bc6\u6570\u636e\u5305\u3002HTTPS \u5f00\u53d1\u7684\u4e3b\u8981\u76ee\u7684\uff0c\u662f\u63d0\u4f9b\u5bf9\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u8eab\u4efd\u8ba4\u8bc1\uff0c\u4fdd\u62a4\u4ea4\u6362\u6570\u636e\u7684\u9690\u79c1\u4e0e\u5b8c\u6574\u6027\u3002</p> <p>HTPPS \u548c HTTP \u7684\u6982\u5ff5:</p> <p>HTTPS(\u5168\u79f0:Hypertext Transfer Protocol over Secure Socket Layer)\uff0c\u662f\u4ee5\u5b89\u5168\u4e3a\u76ee\u6807\u7684 HTTP \u901a\u9053\uff0c\u7b80\u5355\u8bb2\u662f HTTP \u7684\u5b89\u5168\u7248\u3002\u5373 HTTP \u4e0b\u52a0\u5165 SSL \u5c42\uff0cHTTPS \u7684\u5b89\u5168\u57fa\u7840\u662f SSL\uff0c \u56e0\u6b64\u52a0\u5bc6\u7684\u8be6\u7ec6\u5185\u5bb9\u5c31\u9700\u8981 SSL\u3002\u5b83\u662f\u4e00\u4e2a URI scheme(\u62bd\u8c61\u6807\u8bc6\u7b26\u4f53\u7cfb)\uff0c\u53e5\u6cd5\u7c7b\u540c http: \u4f53\u7cfb\u3002\u7528\u4e8e\u5b89\u5168\u7684 HTTP \u6570\u636e\u4f20\u8f93\u3002https:URL \u8868\u660e\u5b83\u4f7f\u7528\u4e86 HTTP\uff0c\u4f46 HTTPS \u5b58\u5728\u4e0d\u540c\u4e8e HTTP \u7684\u9ed8\u8ba4\u7aef\u53e3\u53ca\u4e00\u4e2a\u52a0\u5bc6/\u8eab\u4efd\u9a8c\u8bc1\u5c42(\u5728 HTTP \u4e0e TCP \u4e4b\u95f4)\u3002\u8fd9\u4e2a\u7cfb\u7edf\u7684\u6700\u521d\u7814\u53d1\u7531\u7f51\u666f\u516c\u53f8\u8fdb\u884c\uff0c\u63d0\u4f9b\u4e86\u8eab\u4efd\u9a8c\u8bc1\u4e0e\u52a0\u5bc6\u901a\u8baf\u65b9\u6cd5\uff0c\u73b0\u5728\u5b83\u88ab\u5e7f\u6cdb\u7528\u4e8e\u4e07\u7ef4\u7f51\u4e0a\u5b89\u5168\u654f\u611f\u7684\u901a\u8baf\uff0c\u4f8b\u5982\u4ea4\u6613\u652f\u4ed8\u65b9\u9762\u3002</p> <p>\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae (HTTP-Hypertext transfer protocol) \u662f\u4e00\u79cd\u8be6\u7ec6\u89c4\u5b9a\u4e86\u6d4f\u89c8\u5668\u548c\u4e07\u7ef4\u7f51\u670d \u52a1\u5668\u4e4b\u95f4\u4e92\u76f8\u901a\u4fe1\u7684\u89c4\u5219\uff0c\u901a\u8fc7\u56e0\u7279\u7f51\u4f20\u9001\u4e07\u7ef4\u7f51\u6587\u6863\u7684\u6570\u636e\u4f20\u9001\u534f\u8bae\u3002</p> <p>HTTPS \u534f\u8bae\u9700\u8981\u5230 CA \u7533\u8bf7\u8bc1\u4e66\uff0c\u4e00\u822c\u514d\u8d39\u8bc1\u4e66\u5f88\u5c11\uff0c\u9700\u8981\u4ea4\u8d39\u3002HTTP \u662f\u8d85\u6587\u672c\u4f20\u8f93\u534f\u8bae\uff0c HTTPS \u5219\u662f\u5177\u6709\u5b89\u5168\u6027\u7684 SSL \u52a0\u5bc6\u4f20\u8f93\u534f\u8bae HTTP \u548c HTPPS \u4f7f\u7528\u7684\u662f\u5b8c\u5168\u4e0d \u540c\u7684\u8fde\u63a5\u65b9\u5f0f\u7528\u7684\u7aef\u53e3\u4e5f\u4e0d\u4e00\u6837,\u524d\u8005\u662f 80,\u540e\u8005\u662f 443\u3002HTTP \u7684\u8fde\u63a5\u5f88\u7b80\u5355,\u662f\u65e0\u72b6\u6001\u7684 HTTPS \u534f\u8bae\u662f\u7531 SSL + HTTP \u534f\u8bae\u6784\u5efa\u7684\u53ef\u8fdb\u884c\u52a0\u5bc6\u4f20\u8f93\u3001\u8eab\u4efd\u8ba4\u8bc1\u7684\u7f51\u7edc\u534f\u8bae\u8981\u6bd4 HTTP \u534f\u8bae\u5b89\u5168 </p> <p>HTTPS \u89e3\u51b3\u7684\u95ee\u9898: 1. \u4fe1\u4efb\u4e3b\u673a\u7684\u95ee\u9898. \u91c7\u7528 HTTPS \u7684 Server \u5fc5\u987b\u4ece CA \u7533\u8bf7\u4e00\u4e2a\u7528\u4e8e\u8bc1\u660e\u670d\u52a1\u5668\u7528\u9014\u7c7b\u578b\u7684\u8bc1\u4e66. \u6539\u8bc1\u4e66\u53ea\u6709\u7528\u4e8e\u5bf9\u5e94\u7684 Server \u7684\u65f6\u5019,\u5ba2\u6237\u5ea6\u624d\u4fe1\u4efb\u6b21\u4e3b\u673a\uff1b 2. \u9632\u6b62\u901a\u8baf\u8fc7\u7a0b\u4e2d\u7684\u6570\u636e\u7684\u6cc4\u5bc6\u548c\u88ab\u7a9c\u6539</p> <p>HTTP \u4e0e HTTPS \u5728\u5199\u6cd5\u4e0a\u7684\u533a\u522b\u4e5f\u662f\u524d\u7f00\u7684\u4e0d\u540c\uff0c\u5ba2\u6237\u7aef\u5904\u7406\u7684\u65b9\u5f0f\u4e5f\u4e0d\u540c\uff0c\u5177\u4f53\u8bf4\u6765: \u5982\u679c URL \u7684\u534f\u8bae\u662f HTTP\uff0c\u5219\u5ba2\u6237\u7aef\u4f1a\u6253\u5f00\u4e00\u6761\u5230\u670d\u52a1\u7aef\u7aef\u53e3 80(\u9ed8\u8ba4)\u7684\u8fde\u63a5\uff0c\u5e76\u5411\u5176\u53d1\u9001\u8001\u7684 HTTP \u8bf7\u6c42\u3002 \u5982\u679c URL \u7684\u534f\u8bae\u662f HTTPS\uff0c\u5219\u5ba2\u6237\u7aef\u4f1a\u6253\u5f00\u4e00\u6761\u5230\u670d\u52a1\u7aef\u7aef\u53e3 443 (\u9ed8\u8ba4)\u7684\u8fde\u63a5\uff0c\u7136\u540e\u4e0e\u670d\u52a1\u5668\u63e1\u624b\uff0c\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u4e0e\u670d\u52a1\u5668\u4ea4\u6362\u4e00\u4e9b SSL \u7684\u5b89\u5168\u53c2\u6570\uff0c\u9644\u4e0a\u52a0\u5bc6\u7684 HTTP \u8bf7\u6c42\u3002 </p> <p>\u6240\u4ee5\u4f60\u53ef\u4ee5\u770b\u5230\uff0cHTTPS \u6bd4 HTTP \u591a\u4e86\u4e00\u5c42\u4e0e SSL \u7684\u8fde\u63a5\uff0c\u8fd9\u4e5f\u5c31\u662f\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef SSL \u63e1\u624b\u7684\u8fc7\u7a0b\uff0c\u6574\u4e2a\u8fc7\u7a0b\u4e3b\u8981\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c:\u4ea4\u6362\u534f\u8bae\u7248\u672c\u53f7 \u9009\u62e9\u4e00\u4e2a\u4e24\u7aef\u90fd\u4e86\u89e3\u7684\u5bc6\u7801 \u5bf9\u4e24\u7aef\u7684\u8eab\u4efd\u8fdb\u884c\u8ba4\u8bc1 \u751f\u6210\u4e34\u65f6\u7684\u4f1a\u8bdd\u5bc6\u94a5\uff0c\u4ee5\u4fbf\u52a0\u5bc6\u4fe1\u9053\u3002 </p> <p>SSL \u63e1\u624b\u662f\u4e00\u4e2a\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u66f4\u591a\u5173\u4e8e SSL \u63e1\u624b\u7684\u8fc7\u7a0b\u7ec6\u8282 \u53ef\u4ee5\u53c2\u8003 TLS/SSL \u63e1\u624b\u8fc7\u7a0b\u3002 SSL/TSL \u7684\u5e38\u89c1\u5f00\u6e90\u5b9e\u73b0\u662f OpenSSL\uff0cOpenSSL \u662f\u4e00\u4e2a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u8f6f\u4ef6\u5e93\u5305\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5305\u6765\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\uff0c\u907f\u514d\u7a83\u542c\uff0c\u540c\u65f6\u786e\u8ba4\u53e6\u4e00\u7aef\u8fde\u63a5\u8005\u7684\u8eab\u4efd\u3002\u8fd9\u4e2a\u5305\u5e7f\u6cdb\u88ab \u5e94\u7528\u5728\u4e92\u8054\u7f51\u7684\u7f51\u9875\u670d\u52a1\u5668\u4e0a\u3002 \u66f4\u591a\u6e90\u4e8e OpenSSL \u7684\u6280\u672f\u7ec6\u8282\u53ef\u4ee5\u53c2\u8003 OpenSSL\u3002</p>"},{"location":"Network/HTTP%E4%B8%8EHTTPS%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/#http10http11","title":"HTTP1.0\u548cHTTP1.1\u7684\u4e00\u4e9b\u533a\u522b","text":"<p>HTTP1.0 \u6700\u65e9\u5728\u7f51\u9875\u4e2d\u4f7f\u7528\u662f\u5728 1996 \u5e74\uff0c\u90a3\u4e2a\u65f6\u5019\u53ea\u662f\u4f7f\u7528\u4e00\u4e9b\u8f83\u4e3a\u7b80\u5355\u7684\u7f51\u9875\u4e0a\u548c\u7f51\u7edc \u8bf7\u6c42\u4e0a\uff0c\u800c HTTP1.1 \u5219\u5728 1999 \u5e74\u624d\u5f00\u59cb\u5e7f\u6cdb\u5e94\u7528\u4e8e\u73b0\u5728\u7684\u5404\u5927\u6d4f\u89c8\u5668\u7f51\u7edc\u8bf7\u6c42\u4e2d\uff0c\u540c\u65f6 HTTP1.1 \u4e5f\u662f\u5f53\u524d\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684 HTTP \u534f\u8bae\u3002 </p> <p>\u4e3b\u8981\u533a\u522b\u4e3b\u8981\u4f53\u73b0\u5728:</p> <ol> <li>\u7f13\u5b58\u5904\u7406\uff0c\u5728 HTTP1.0 \u4e2d\u4e3b\u8981\u4f7f\u7528 header \u91cc\u7684 If-Modified-Since,Expires \u6765\u505a \u4e3a\u7f13\u5b58\u5224\u65ad\u7684\u6807\u51c6\uff0cHTTP1.1 \u5219\u5f15\u5165\u4e86\u66f4\u591a\u7684\u7f13\u5b58\u63a7\u5236\u7b56\u7565\u4f8b\u5982 Entity tag\uff0c If-Unmodified-Since, If-Match, If-None-Match \u7b49\u66f4\u591a\u53ef\u4f9b\u9009\u62e9\u7684\u7f13\u5b58\u5934\u6765\u63a7\u5236\u7f13 \u5b58\u7b56\u7565\u3002</li> <li>\u5e26\u5bbd\u4f18\u5316\u53ca\u7f51\u7edc\u8fde\u63a5\u7684\u4f7f\u7528\uff0cHTTP1.0 \u4e2d\uff0c\u5b58\u5728\u4e00\u4e9b\u6d6a\u8d39\u5e26\u5bbd\u7684\u73b0\u8c61\uff0c\u4f8b\u5982\u5ba2\u6237\u7aef\u53ea\u662f\u9700\u8981\u67d0\u4e2a\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\uff0c\u800c\u670d\u52a1\u5668\u5374\u5c06\u6574\u4e2a\u5bf9\u8c61\u9001\u8fc7\u6765\u4e86\uff0c\u5e76\u4e14\u4e0d\u652f\u6301\u65ad\u70b9\u7eed\u4f20\u529f\u80fd\uff0cHTTP1.1 \u5219\u5728\u8bf7\u6c42\u5934\u5f15\u5165\u4e86 range \u5934\u57df\uff0c\u5b83\u5141\u8bb8\u53ea\u8bf7\u6c42\u8d44\u6e90\u7684\u67d0\u4e2a\u90e8\u5206\uff0c \u5373\u8fd4\u56de\u7801\u662f 206(Partial Content)\uff0c\u8fd9\u6837\u5c31\u65b9\u4fbf\u4e86\u5f00\u53d1\u8005\u81ea\u7531\u7684\u9009\u62e9\u4ee5\u4fbf\u4e8e\u5145\u5206\u5229\u7528\u5e26\u5bbd\u548c\u8fde\u63a5\u3002</li> <li>\u9519\u8bef\u901a\u77e5\u7684\u7ba1\u7406\uff0c\u5728 HTTP1.1 \u4e2d\u65b0\u589e\u4e86 24 \u4e2a\u9519\u8bef\u72b6\u6001\u54cd\u5e94\u7801\uff0c\u5982 409(Conflict) \u8868\u793a\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0e\u8d44\u6e90\u7684\u5f53\u524d\u72b6\u6001\u53d1\u751f\u51b2\u7a81;410(Gone)\u8868\u793a\u670d\u52a1\u5668\u4e0a\u7684\u67d0\u4e2a\u8d44 \u6e90\u88ab\u6c38\u4e45\u6027\u7684\u5220\u9664\u3002</li> <li>Host \u5934\u5904\u7406\uff0c\u5728 HTTP1.0 \u4e2d\u8ba4\u4e3a\u6bcf\u53f0\u670d\u52a1\u5668\u90fd\u7ed1\u5b9a\u4e00\u4e2a\u552f\u4e00\u7684 IP \u5730\u5740\uff0c\u56e0\u6b64,\u8bf7\u6c42\u6d88\u606f\u4e2d\u7684 URL \u5e76\u6ca1\u6709\u4f20\u9012\u4e3b\u673a\u540d(hostname)\u3002\u4f46\u968f\u7740\u865a\u62df\u4e3b\u673a\u6280\u672f\u7684\u53d1\u5c55\uff0c \u5728\u4e00\u53f0\u7269\u7406\u670d\u52a1\u5668\u4e0a\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u865a\u62df\u4e3b\u673a(Multi-homed Web Servers)\uff0c\u5e76\u4e14\u5b83 \u4eec\u5171\u4eab\u4e00\u4e2a IP \u5730\u5740\u3002HTTP1.1 \u7684\u8bf7\u6c42\u6d88\u606f\u548c\u54cd\u5e94\u6d88\u606f\u90fd\u5e94\u652f\u6301 Host \u5934\u57df\uff0c\u4e14\u8bf7\u6c42\u6d88\u606f\u4e2d\u5982\u679c\u6ca1\u6709 Host \u5934\u57df\u4f1a\u62a5\u544a\u4e00\u4e2a\u9519\u8bef(400 Bad Request)\u3002 5\u3001\u957f\u8fde\u63a5\uff0cHTTP 1.1 \u652f\u6301\u957f\u8fde\u63a5(PersistentConnection)\u548c\u8bf7\u6c42\u7684\u6d41\u6c34\u7ebf (Pipelining)\u5904\u7406\uff0c\u5728\u4e00\u4e2a TCP \u8fde\u63a5\u4e0a\u53ef\u4ee5\u4f20\u9001\u591a\u4e2a HTTP \u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u51cf\u5c11\u4e86\u5efa\u7acb\u548c\u5173\u95ed\u8fde\u63a5\u7684\u6d88\u8017\u548c\u5ef6\u8fdf\uff0c\u5728 HTTP1.1 \u4e2d\u9ed8\u8ba4\u5f00\u542f Connection: keep-alive\uff0c\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5f25\u8865\u4e86 HTTP1.0 \u6bcf\u6b21\u8bf7\u6c42\u90fd\u8981\u521b\u5efa\u8fde\u63a5\u7684\u7f3a\u70b9\u3002</li> </ol>"},{"location":"Network/HTTP%E4%B8%8EHTTPS%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/#spdy","title":"SPDY","text":"<p>\u5728\u8bb2 Http1.1 \u548c Http2.0 \u7684\u533a\u522b\u4e4b\u524d\uff0c\u8fd8\u9700\u8981\u8bf4\u4e0b SPDY\uff0c\u5b83\u662f HTTP1.x \u7684\u4f18\u5316\u65b9\u6848: 2012 \u5e74 google \u5982\u4e00\u58f0\u60ca\u96f7\u63d0\u51fa\u4e86 SPDY \u7684\u65b9\u6848\uff0c\u4f18\u5316\u4e86 HTTP1.X \u7684\u8bf7\u6c42\u5ef6\u8fdf\uff0c\u89e3\u51b3\u4e86 HTTP1.X \u7684\u5b89\u5168\u6027\uff0c\u5177\u4f53\u5982\u4e0b:</p> <ol> <li>\u964d\u4f4e\u5ef6\u8fdf\uff0c\u9488\u5bf9 HTTP \u9ad8\u5ef6\u8fdf\u7684\u95ee\u9898\uff0cSPDY \u4f18\u96c5\u7684\u91c7\u53d6\u4e86\u591a\u8def\u590d\u7528(multiplexing)\u3002 \u591a\u8def\u590d\u7528\u901a\u8fc7\u591a\u4e2a\u8bf7\u6c42 stream \u5171\u4eab\u4e00\u4e2a tcp \u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u89e3\u51b3\u4e86 HOL blocking \u7684 \u95ee\u9898\uff0c\u964d\u4f4e\u4e86\u5ef6\u8fdf\u540c\u65f6\u63d0\u9ad8\u4e86\u5e26\u5bbd\u7684\u5229\u7528\u7387\u3002</li> <li>\u8bf7\u6c42\u4f18\u5148\u7ea7(request prioritization)\u3002\u591a\u8def\u590d\u7528\u5e26\u6765\u4e00\u4e2a\u65b0\u7684\u95ee\u9898\u662f\uff0c\u5728\u8fde\u63a5 \u5171\u4eab\u7684\u57fa\u7840\u4e4b\u4e0a\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5173\u952e\u8bf7\u6c42\u88ab\u963b\u585e\u3002SPDY \u5141\u8bb8\u7ed9\u6bcf\u4e2a request \u8bbe\u7f6e\u4f18\u5148 \u7ea7\uff0c\u8fd9\u6837\u91cd\u8981\u7684\u8bf7\u6c42\u5c31\u4f1a\u4f18\u5148\u5f97\u5230\u54cd\u5e94\u3002\u6bd4\u5982\u6d4f\u89c8\u5668\u52a0\u8f7d\u9996\u9875\uff0c\u9996\u9875\u7684 html \u5185\u5bb9\u5e94 \u8be5\u4f18\u5148\u5c55\u793a\uff0c\u4e4b\u540e\u624d\u662f\u5404\u79cd\u9759\u6001\u8d44\u6e90\u6587\u4ef6\uff0c\u811a\u672c\u6587\u4ef6\u7b49\u52a0\u8f7d\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u7528\u6237\u80fd \u7b2c\u4e00\u65f6\u95f4\u770b\u5230\u7f51\u9875\u5185\u5bb9\u3002</li> <li>header \u538b\u7f29\u3002\u524d\u9762\u63d0\u5230 HTTP1.x \u7684 header \u5f88\u591a\u65f6\u5019\u90fd\u662f\u91cd\u590d\u591a\u4f59\u7684\u3002\u9009\u62e9\u5408\u9002 \u7684\u538b\u7f29\u7b97\u6cd5\u53ef\u4ee5\u51cf\u5c0f\u5305\u7684\u5927\u5c0f\u548c\u6570\u91cf\u3002</li> <li>\u57fa\u4e8e HTTPS \u7684\u52a0\u5bc6\u534f\u8bae\u4f20\u8f93\uff0c\u5927\u5927\u63d0\u9ad8\u4e86\u4f20\u8f93\u6570\u636e\u7684\u53ef\u9760\u6027\u3002</li> <li>\u670d\u52a1\u7aef\u63a8\u9001(server push)\uff0c\u91c7\u7528\u4e86 SPDY \u7684\u7f51\u9875\uff0c\u4f8b\u5982\u6211\u7684\u7f51\u9875\u6709\u4e00\u4e2a sytle.css \u7684\u8bf7\u6c42\uff0c\u5728\u5ba2\u6237\u7aef\u6536\u5230 sytle.css \u6570\u636e\u7684\u540c\u65f6\uff0c\u670d\u52a1\u7aef\u4f1a\u5c06 sytle.js \u7684\u6587\u4ef6\u63a8\u9001\u7ed9\u5ba2\u6237 \u7aef\uff0c\u5f53\u5ba2\u6237\u7aef\u518d\u6b21\u5c1d\u8bd5\u83b7\u53d6 sytle.js \u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u5230\uff0c\u4e0d\u7528\u518d\u53d1\u8bf7\u6c42\u4e86\u3002</li> </ol> <p>SPDY \u4f4d\u4e8e HTTP \u4e4b\u4e0b\uff0cTCP \u548c SSL \u4e4b\u4e0a\uff0c\u8fd9\u6837\u53ef\u4ee5\u8f7b\u677e\u517c\u5bb9\u8001\u7248\u672c\u7684 HTTP \u534f\u8bae(\u5c06 HTTP1.x \u7684\u5185\u5bb9\u5c01\u88c5\u6210\u4e00\u79cd\u65b0\u7684 frame \u683c\u5f0f)\uff0c\u540c\u65f6\u53ef\u4ee5\u4f7f\u7528\u5df2\u6709\u7684 SSL \u529f\u80fd\u3002</p>"},{"location":"Network/HTTP%E4%B8%8EHTTPS%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/#http20http1x","title":"HTTP2.0\u548cHTTP1.X\u76f8\u6bd4\u7684\u65b0\u7279\u6027","text":"<ol> <li>\u65b0\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f(Binary Format)\uff0cHTTP1.x \u7684\u89e3\u6790\u662f\u57fa\u4e8e\u6587\u672c\u3002\u57fa\u4e8e\u6587\u672c\u534f\u8bae\u7684 \u683c\u5f0f\u89e3\u6790\u5b58\u5728\u5929\u7136\u7f3a\u9677\uff0c\u6587\u672c\u7684\u8868\u73b0\u5f62\u5f0f\u6709\u591a\u6837\u6027\uff0c\u8981\u505a\u5230\u5065\u58ee\u6027\u8003\u8651\u7684\u573a\u666f\u5fc5\u7136 \u5f88\u591a\uff0c\u4e8c\u8fdb\u5236\u5219\u4e0d\u540c\uff0c\u53ea\u8ba4 0 \u548c 1 \u7684\u7ec4\u5408\u3002\u57fa\u4e8e\u8fd9\u79cd\u8003\u8651 HTTP2.0 \u7684\u534f\u8bae\u89e3\u6790\u51b3\u5b9a \u91c7\u7528\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u5b9e\u73b0\u65b9\u4fbf\u4e14\u5065\u58ee\u3002</li> <li>\u591a\u8def\u590d\u7528(MultiPlexing)\uff0c\u5373\u8fde\u63a5\u5171\u4eab\uff0c\u5373\u6bcf\u4e00\u4e2a request \u90fd\u662f\u662f\u7528\u4f5c\u8fde\u63a5\u5171\u4eab\u673a \u5236\u7684\u3002\u4e00\u4e2a request \u5bf9\u5e94\u4e00\u4e2a id\uff0c\u8fd9\u6837\u4e00\u4e2a\u8fde\u63a5\u4e0a\u53ef\u4ee5\u6709\u591a\u4e2a request\uff0c\u6bcf\u4e2a\u8fde\u63a5\u7684 request \u53ef\u4ee5\u968f\u673a\u7684\u6df7\u6742\u5728\u4e00\u8d77\uff0c\u63a5\u6536\u65b9\u53ef\u4ee5\u6839\u636e request \u7684 id \u5c06 request \u518d\u5f52\u5c5e \u5230\u5404\u81ea\u4e0d\u540c\u7684\u670d\u52a1\u7aef\u8bf7\u6c42\u91cc\u9762\u3002</li> <li>header \u538b\u7f29\uff0c\u5982\u4e0a\u6587\u4e2d\u6240\u8a00\uff0c\u5bf9\u524d\u9762\u63d0\u5230\u8fc7 HTTP1.x \u7684 header \u5e26\u6709\u5927\u91cf\u4fe1\u606f\uff0c\u800c \u4e14\u6bcf\u6b21\u90fd\u8981\u91cd\u590d\u53d1\u9001\uff0cHTTP2.0 \u4f7f\u7528 encoder \u6765\u51cf\u5c11\u9700\u8981\u4f20\u8f93\u7684 header \u5927\u5c0f\uff0c\u901a\u8baf \u53cc\u65b9\u5404\u81ea cache \u4e00\u4efd header fields \u8868\uff0c\u65e2\u907f\u514d\u4e86\u91cd\u590d header \u7684\u4f20\u8f93\uff0c\u53c8\u51cf\u5c0f\u4e86\u9700 \u8981\u4f20\u8f93\u7684\u5927\u5c0f\u3002</li> <li>\u670d\u52a1\u7aef\u63a8\u9001(server push)\uff0c\u540c SPDY \u4e00\u6837\uff0cHTTP2.0 \u4e5f\u5177\u6709 server push \u529f\u80fd\u3002</li> </ol> <p>\u95ee\u9898\uff1a</p> <ol> <li>HTTPS\u73af\u5883\u4e0b\uff0c\u80fd\u5426\u4f7f\u7528ip\u901a\u4fe1\uff1f</li> <li>HTTPS\u73af\u5883\u4e0b\uff0c\u4fee\u6539\u7cfb\u7edf\u65f6\u95f4\uff0c\u80fd\u591f\u6b63\u5e38\u901a\u4fe1\uff1f</li> </ol> <p>\u56e0\u4e3aHTTPS\u901a\u4fe1\uff0c\u4f1a\u5728\u5ba2\u6237\u7aef\u5b89\u88c5\u4e00\u4e2a\u6570\u5b57\u8bc1\u4e66\uff0cIO\u65f6\uff0c\u4f1a\u6821\u9a8c\u901a\u4fe1\u4fe1\u606f\u662f\u5426\u7b26\u5408\u8bc1\u4e66\u91cc\u7684\u5185\u5bb9\u3002 \u95ee\u98981\u4e2d\uff0c\u56e0\u4e3a\u8bc1\u4e66\u4f1a\u6821\u9a8c\u57df\u540d\uff0c\u4f46\u662fip\u6ca1\u6709\u57df\u540d\uff0c\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528ip\u662f\u65e0\u6cd5\u901a\u4fe1\u7684\u3002 \u95ee\u98982\u4e2d\uff0c\u56e0\u4e3a\u8bc1\u4e66\u4f1a\u6821\u9a8c\u6709\u6548\u671f\uff0c\u5ba2\u6237\u7aef\u4fee\u6539\u7cfb\u7edf\u65f6\u95f4\u53ef\u80fd\u4f7f\u5f97\u6539\u540e\u7684\u65f6\u95f4\u8d85\u8fc7\u8bc1\u4e66\u6709\u6548\u671f\uff0c\u5c31\u4f1a\u65e0\u6cd5\u901a\u8fc7\u6821\u9a8c\uff0c\u6545\u800c\u65e0\u6cd5\u901a\u4fe1\u3002</p>"},{"location":"Network/Https/","title":"HTTPS","text":"<p>\u95ee\u9898\uff1a</p> <ol> <li>HTTPS\u73af\u5883\u4e0b\uff0c\u80fd\u5426\u4f7f\u7528ip\u901a\u4fe1\uff1f</li> <li>HTTPS\u73af\u5883\u4e0b\uff0c\u4fee\u6539\u7cfb\u7edf\u65f6\u95f4\uff0c\u80fd\u591f\u6b63\u5e38\u901a\u4fe1\uff1f</li> </ol> <p>\u56e0\u4e3aHTTPS\u901a\u4fe1\uff0c\u4f1a\u5728\u5ba2\u6237\u7aef\u5b89\u88c5\u4e00\u4e2a\u6570\u5b57\u8bc1\u4e66\uff0cIO\u65f6\uff0c\u4f1a\u6821\u9a8c\u901a\u4fe1\u4fe1\u606f\u662f\u5426\u7b26\u5408\u8bc1\u4e66\u91cc\u7684\u5185\u5bb9\u3002 \u95ee\u98981\u4e2d\uff0c\u56e0\u4e3a\u8bc1\u4e66\u4f1a\u6821\u9a8c\u57df\u540d\uff0c\u4f46\u662fip\u6ca1\u6709\u57df\u540d\uff0c\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528ip\u662f\u65e0\u6cd5\u901a\u4fe1\u7684\u3002 \u95ee\u98982\u4e2d\uff0c\u56e0\u4e3a\u8bc1\u4e66\u4f1a\u6821\u9a8c\u6709\u6548\u671f\uff0c\u5ba2\u6237\u7aef\u4fee\u6539\u7cfb\u7edf\u65f6\u95f4\u53ef\u80fd\u4f7f\u5f97\u6539\u540e\u7684\u65f6\u95f4\u8d85\u8fc7\u8bc1\u4e66\u6709\u6548\u671f\uff0c\u5c31\u4f1a\u65e0\u6cd5\u901a\u8fc7\u6821\u9a8c\uff0c\u6545\u800c\u65e0\u6cd5\u901a\u4fe1\u3002</p> <p>https\u4e3a\u4ec0\u4e48\u8981\u7528\u5230\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u53ea\u6709\u4e00\u79cd\u4e0d\u53ef\u4ee5\u5417\uff1f</p> <p>\u8fd9\u5b9e\u9645\u4e0a\u8003\u5bdf3\u4e2a\u70b9\uff0c\u4e00\u4e2a\u662f\u4ec0\u4e48\u662f\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4e00\u4e2a\u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\u3002\u8fd8\u6709\u4e00\u4e2a\u662fhttps\u7684\u539f\u7406\u3002</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u6548\u7387\u9ad8\uff0c\u7b97\u6cd5\u516c\u5f00\u3001\u8ba1\u7b97\u91cf\u5c0f\u3001\u52a0\u5bc6\u901f\u5ea6\u5feb\u3001\u52a0\u5bc6\u6548\u7387\u9ad8\u3002\u7f3a\u70b9\u662f\u79d8\u94a5\u7684\u7ba1\u7406\u548c\u5206\u53d1\u975e\u5e38\u56f0\u96be\uff0c\u4e0d\u591f\u5b89\u5168\u3002\u5728\u6570\u636e\u4f20\u9001\u524d\uff0c\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u5fc5\u987b\u5546\u5b9a\u597d\u79d8\u94a5\uff0c\u7136\u540e\u53cc\u65b9\u90fd\u5fc5\u987b\u8981\u4fdd\u5b58\u597d\u79d8\u94a5\uff0c\u5982\u679c\u4e00\u65b9\u7684\u79d8\u94a5\u88ab\u6cc4\u9732\uff0c\u90a3\u4e48\u52a0\u5bc6\u4fe1\u606f\u4e5f\u5c31\u4e0d\u5b89\u5168\u4e86\u3002</p> <p>\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u4e24\u4e2a\u5bc6\u94a5\u6765\u8fdb\u884c\u52a0\u5bc6\u548c\u89e3\u5bc6\uff0c\u8fd9\u4e24\u4e2a\u79d8\u94a5\u662f\u516c\u5f00\u5bc6\u94a5\uff08\u7b80\u79f0\u516c\u94a5\uff09\u548c\u79c1\u6709\u5bc6\u94a5\uff08\u7b80\u79f0\u79c1\u94a5\uff09\uff0c\u5373\u5e38\u8bf4\u7684\u201c\u516c\u94a5\u52a0\u5bc6\uff0c\u79c1\u94a5\u89e3\u5bc6\u201d\u6216\u201c\u79c1\u94a5\u52a0\u5bc6\uff0c\u516c\u94a5\u89e3\u5bc6\u201d\u3002\u79c1\u94a5\u53ea\u80fd\u7531\u4e00\u65b9\u5b89\u5168\u4fdd\u7ba1\uff0c\u4e0d\u80fd\u5916\u6cc4\uff0c\u800c\u516c\u94a5\u5219\u53ef\u4ee5\u53d1\u7ed9\u4efb\u4f55\u8bf7\u6c42\u5b83\u7684\u4eba\u3002 \u975e\u5bf9\u79f0\u52a0\u5bc6\u4f7f\u7528\u8fd9\u5bf9\u5bc6\u94a5\u4e2d\u7684\u4e00\u4e2a\u8fdb\u884c\u52a0\u5bc6\uff0c\u800c\u89e3\u5bc6\u5219\u9700\u8981\u53e6\u4e00\u4e2a\u5bc6\u94a5\u3002\u5b89\u5168\u6027\u66f4\u9ad8\uff0c\u516c\u94a5\u662f\u516c\u5f00\u7684\uff0c\u79d8\u94a5\u662f\u81ea\u5df1\u4fdd\u5b58\u7684\uff0c\u4e0d\u9700\u8981\u5c06\u79c1\u94a5\u7ed9\u522b\u4eba\u3002\u975e\u5bf9\u79f0\u52a0\u5bc6\u9700\u8981\u901a\u8fc7\u8bc1\u4e66\u6765\u9a8c\u8bc1\u516c\u94a5\u7684\u5408\u6cd5\u6027\u3002</p> <p>https\u7684\u79d8\u94a5\u662f\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4f46\u662f\u5bf9\u79f0\u52a0\u5bc6\u89e3\u51b3\u4e0d\u4e86\u79d8\u94a5\u7684\u4f20\u8f93\u95ee\u9898\uff0c\u6240\u4ee5\u5f15\u5165\u975e\u5bf9\u79f0\u52a0\u5bc6\u9700\u8981\u901a\u8fc7\u8bc1\u4e66\u6765\u9a8c\u8bc1\u516c\u94a5\u7684\u5408\u6cd5\u6027</p> <p>https\u670d\u52a1\u7aef\u53d1\u9001\u5230\u5ba2\u6237\u7aef\u7684\u8bc1\u4e66\uff0c\u5982\u679c\u4e0d\u53bb\u68c0\u67e5\u6709\u6548\u6027\u53ef\u4ee5\u5417\uff0c\u76f4\u63a5\u901a\u8fc7\u8ba4\u8bc1\u53ef\u4ee5\u5417\uff0c\u4e3a\u4ec0\u4e48\uff1f</p> <p>\u3010\u53c2\u8003\u3011\uff1a\u4e0d\u53ef\u4ee5\uff0c\u8bc1\u4e66\u53ef\u4ee5\u4f2a\u9020\uff0c\u8fd8\u6709\u8bc1\u4e66\u662f\u5426\u8fc7\u671f\uff0c\u8bc1\u4e66\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f\uff1a\u7533\u8bf7\u8005\u516c\u94a5\u3001\u7533\u8bf7\u8005\u7684\u7ec4\u7ec7\u4fe1\u606f\u548c\u4e2a\u4eba\u4fe1\u606f\u3001\u7b7e\u53d1\u673a\u6784 CA \u7684\u4fe1\u606f\u3001\u6709\u6548\u65f6\u95f4\u3001\u8bc1\u4e66\u5e8f\u5217\u53f7\u7b49\u4fe1\u606f\u7684\u660e\u6587\uff0c\u540c\u65f6\u5305\u542b\u4e00\u4e2a\u7b7e\u540d\u3002\u4e0d\u53bb\u6821\u9a8c\uff0c\u5bb9\u6613\u88ab\u4e2d\u95f4\u4eba\u653b\u51fb\u3002</p>"},{"location":"Network/TCP/","title":"TCP","text":"<p>TCP \u4e3a\u4ec0\u4e48\u4e09\u6b21\u63e1\u624b\u800c\u4e0d\u662f\u4e24\u6b21\u63e1\u624b</p>"},{"location":"PerformanceOptimization/ANR%E5%88%86%E6%9E%90/","title":"ANR\u5206\u6790","text":"<p>ANR(Application Not responding)\u3002Android\u4e2d\uff0c\u4e3b\u7ebf\u7a0b(UI\u7ebf\u7a0b)\u5982\u679c\u5728\u89c4\u5b9a\u65f6\u5185\u6ca1\u6709\u5904\u7406\u5b8c\u76f8\u5e94\u5de5\u4f5c\uff0c\u5c31\u4f1a\u51fa\u73b0ANR\u3002\u5177\u4f53\u6765\u8bf4\uff0cANR\u4f1a\u5728\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e2d\u51fa\u73b0: 1. \u8f93\u5165\u4e8b\u4ef6(\u6309\u952e\u548c\u89e6\u6478\u4e8b\u4ef6)5s\u5185\u6ca1\u88ab\u5904\u7406 2. BroadcastReceiver\u7684\u4e8b\u4ef6(onRecieve\u65b9\u6cd5)\u5728\u89c4\u5b9a\u65f6\u95f4\u5185\u6ca1\u5904\u7406\u5b8c(\u524d\u53f0\u5e7f\u64ad\u4e3a10s\uff0c\u540e\u53f0\u5e7f\u64ad\u4e3a60s) 3. service \u524d\u53f020s\u540e\u53f0200s\u672a\u5b8c\u6210\u542f\u52a8 4. ContentProvider\u7684publish\u572810s\u5185\u6ca1\u8fdb\u884c\u5b8c</p> <p>AndroidANR\u95ee\u9898\u603b\u7ed3</p>"},{"location":"PerformanceOptimization/App%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/","title":"App\u7684\u6027\u80fd\u4f18\u5316\u7cfb\u5217\u6587\u7ae0","text":""},{"location":"PerformanceOptimization/App%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/#_1","title":"\u5b9e\u8df5","text":"<p>Feed\u6d41\u4e0a\u7684\u4f18\u5316\u5b9e\u8df5</p> <p>\u6027\u80fd\u5206\u6790\u76f8\u5173\u547d\u4ee4\u548c\u5de5\u5177\u4ecb\u7ecd</p> <p>\u5982\u4f55\u4f18\u5316Activity\u542f\u52a8\u901f\u5ea6 </p> <p>\u4e00\u79cdActivity\u9884\u52a0\u8f7d\u7684\u65b9\u6cd5 </p> <p>\u5728provider\u521d\u59cb\u5316\u7684\u65f6\u5019\u5982\u4f55\u5904\u7406\u8017\u65f6\u64cd\u4f5c</p>"},{"location":"PerformanceOptimization/App%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/#_2","title":"\u4e13\u9898\uff08\u5f85\u5b8c\u5584\uff09","text":"<p>\u7ed8\u5236\u4f18\u5316</p> <p>\u542f\u52a8\u4f18\u5316 </p> <p>\u5185\u5b58\u4f18\u5316</p> <p>\u7a33\u5b9a\u6027\u4f18\u5316</p> <p>ANR\u5206\u6790</p> <p>\u8017\u7535\u4f18\u5316</p> <p>\u5b89\u88c5\u5305\u4f18\u5316</p> <p>\u56fe\u7247\u4f18\u5316</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/","title":"Feed\u6d41\u4e0a\u7684\u4f18\u5316\u5b9e\u8df5","text":"<p>\u4e4b\u524d\u4e00\u76f4\u8d1f\u8d23\u5c0f\u7ea2\u4e66\u7684\u5173\u6ce8Feed\u7684\u8fed\u4ee3\u5de5\u4f5c\uff0c\u56e0\u4e3a\u4e00\u76f4\u662f\u5728\u5b8c\u6210\u65b0\u529f\u80fd\u7684\u8fed\u4ee3\u5de5\u4f5c\uff0c\u5bf9\u4e8eFeed\u7684\u6027\u80fd\u548c\u6d88\u8d39\u4f53\u9a8c\u5c31\u6ca1\u6709\u7279\u522b\u5173\u6ce8\uff0c\u52a0\u4e0a\u5bf9\u4e8e\u8fd9\u5757\u4e1a\u52a1\u7684\u4e00\u4e9b\u76d1\u63a7\u4e5f\u6ca1\u6709\u843d\u5730\uff0c\u6240\u4ee5\u957f\u671f\u5bf9\u4e8e\u8fd9\u5757\u7684\u6027\u80fd\u57fa\u672c\u4e0a\u5c31\u662f\u4e00\u4e2a\u5ffd\u89c6\u7684\u72b6\u6001\u3002\u968f\u7740\u4e1a\u52a1\u8d8a\u6765\u8d8a\u590d\u6742\uff0c\u529f\u80fd\u8d8a\u6765\u8d8a\u591a\uff0c\u6536\u5230\u597d\u591a\u53cd\u9988\u90fd\u662f\u8bf4\u5173\u6ce8\u9875\u9762\u7684\u6ed1\u52a8\u4f53\u9a8c\u5f88\u4e0d\u597d\uff0c\u4e8e\u662f\u51b3\u5b9a\u5bf9\u5173\u6ce8Feed\u505a\u4e00\u4e2a\u6027\u80fd\u4f18\u5316\u3002</p> <p>\u8fd9\u91cc\u5148\u4ece\u4f18\u5316\u8bf4\u8d77\uff0c\u4e4b\u524d\u5728\u7f51\u4e0a\u770b\u5230\u4e00\u4e2a\u5173\u4e8e\u4f18\u5316\u7684\u5206\u7c7b\uff0c\u89c9\u5f97\u5f88\u6709\u9053\u7406\u3002</p> <p>\u8bf7\u770b\u4e0b\u9762\u8fd9\u5f20\u56fe\uff1a </p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#_1","title":"\u5173\u4e8e\u4f18\u5316","text":"<p>\u4f18\u5316\u6574\u4f53\u53ef\u4ee5\u5206\u4e3a\u4e24\u5927\u7c7b\uff0c\u8f6f\u4f18\u5316\u548c\u786c\u4f18\u5316\u3002\u90a3\u4e48\u4ec0\u4e48\u662f\u8f6f\u4f18\u5316\u5462\uff1f\u8f6f\u4f18\u5316\u5e76\u4e0d\u4f1a\u6539\u53d8\u67d0\u6bb5\u4ee3\u7801\u7684\u6267\u884c\u6548\u7387\uff0c\u800c\u662f\u901a\u8fc7\u8c03\u6574\u8fd9\u6bb5\u4ee3\u7801\u7684\u6267\u884c\u65f6\u673a\uff0c\u6765\u4f18\u5316\u6574\u4f53\u4ee3\u7801\u7684\u8fd0\u884c\u6027\u80fd\u3002\u8f6f\u4f18\u5316\u91cc\u7531\u5206\u4e3a\u4e09\u5927\u7c7b\uff0c\u5206\u522b\u4e3a\u9884\u52a0\u8f7d\uff0c\u5f02\u6b65\u52a0\u8f7d\u548c\u61d2\u52a0\u8f7d\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#_2","title":"\u8f6f\u4f18\u5316","text":"<ul> <li>\u9884\u52a0\u8f7d \u8fd9\u51e0\u79cd\u52a0\u8f7d\u65b9\u5f0f\u90fd\u5f88\u597d\u7406\u89e3\uff0c\u6539\u53d8\u7684\u90fd\u662f\u6267\u884c\u65f6\u673a\uff0c\u9884\u52a0\u8f7d\u5c31\u662f\u63d0\u524d\u52a0\u8f7d\uff0c\u628a\u4e00\u4e9b\u91cd\u8981\u7684\u6570\u636e\u63d0\u524d\u52a0\u8f7d\u597d\uff0c\u7b49\u5230\u5408\u9002\u7684\u65f6\u673a\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5c55\u793a\u7ed9\u7528\u6237\uff0c\u800c\u4e0d\u662f\u5728\u8fd9\u4e2a\u5408\u9002\u7684\u65f6\u673a\u624d\u53bb\u52a0\u8f7d\u6570\u636e\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7ed9\u7528\u6237\u5730\u611f\u89c9\u662f\u52a0\u8f7d\u53d8\u5feb\u4e86\u3002</li> <li>\u5f02\u6b65\u52a0\u8f7d \u800c\u5f02\u6b65\u52a0\u8f7d\u5728Android\u4e2d\u5219\u5f88\u5e38\u89c1\u4e86\uff0c\u79fb\u52a8\u5e94\u7528\u4e2d\u6709\u4e3b\u7ebf\u7a0b\u7684\u6982\u5ff5\uff0c\u4e3b\u7ebf\u7a0b\u9700\u8981\u5b9e\u65f6\u5730\u5bf9\u7528\u6237\u7684\u64cd\u4f5c\u4e88\u4ee5\u53cd\u9988\uff0c\u8fd9\u79cd\u53cd\u9988\u8981\u975e\u5e38\u53ca\u65f6\uff0c\u5426\u5219\u5c31\u4f1a\u8ba9\u7528\u6237\u89c9\u5f97\u5361\u987f\u3002\u56e0\u6b64\uff0c\u4e3b\u7ebf\u7a0b\u7684\u5de5\u4f5c\u4e0d\u5b9c\u6709\u8017\u65f6\u64cd\u4f5c\uff0c\u800c\u4e14\u5bf9\u4e8e\u4e00\u4e9b\u6267\u884c\u6bd4\u8f83\u6162\u7684\u4ee3\u7801\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u540c\u6b65\u6267\u884c\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u5b83\u653e\u5230\u5f02\u6b65\u7ebf\u7a0b\u53bb\u6267\u884c\u3002</li> <li>\u61d2\u52a0\u8f7d \u6700\u540e\u5c31\u662f\u61d2\u52a0\u8f7d\u4e86\uff0c\u61d2\u52a0\u8f7d\u5c31\u662f\u628a\u4e00\u4e9b\u4e0d\u662f\u9700\u8981\u7acb\u5373\u5c55\u793a\u7684\u4e1c\u897f\u5f80\u540e\u653e\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u624b\u673a\u6027\u80fd\uff0c\u5185\u5b58\u662f\u6709\u9650\u7684\uff0c\u6709\u4e9b\u529f\u80fd\u7528\u6237\u4e0d\u662f\u9700\u8981\u9a6c\u4e0a\u770b\u5230\uff0c\u5219\u53ef\u4ee5\u8003\u8651\u5728\u540e\u7eed\u7684\u67d0\u4e2a\u9002\u5f53\u7684\u65f6\u673a\u6267\u884c\u52a0\u8f7d\u3002</li> </ul>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#_3","title":"\u786c\u4f18\u5316","text":"<p>\u63a5\u4e0b\u6765\u8bf4\u8bf4\u786c\u4f18\u5316\uff0c\u786c\u4f18\u5316\u8fd9\u4e2a\u4e1c\u897f\u5c31\u6bd4\u8f83\u504f\u7ec6\u8282\u4e86\u3002\u4e00\u6bb5\u903b\u8f91\uff0c\u6211\u4eec\u7528\u4e24\u5c42\u5faa\u73af\u5b9e\u73b0\uff0c\u529f\u80fd\u80af\u5b9a\u662fOK\u7684\uff0c\u4f46\u662f\u5982\u679c\u5728\u5b9e\u73b0\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7528\u4e00\u5c42\u5faa\u73af\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\uff0c\u8fd9\u6837\u4e0d\u5c31\u63d0\u9ad8\u4e86\u8fd9\u6bb5\u4ee3\u7801\u7684\u8fd0\u884c\u6548\u7387\u4e86\u3002\u8fd9\u79cd\u65b9\u5f0f\u7684\u4f18\u5316\u5c31\u662f\u786c\u4f18\u5316\u4e86\uff0c\u5173\u4e8e\u786c\u4f18\u5316\u5f80\u5f80\u6ca1\u6709\u5177\u4f53\u7684\u65b9\u6cd5\uff0c\u5f88\u591a\u90fd\u662f\u5404\u79cd\u89c1\u4ec1\u89c1\u667a\uff0c\u901a\u8fc7\u8c03\u6574\u4ee3\u7801\u7684\u903b\u8f91\u6765\u63d0\u9ad8\u8fd0\u884c\u6548\u7387\u90fd\u53ef\u4ee5\u79f0\u4e3a\u786c\u4f18\u5316\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#feed","title":"Feed\u6d41\u4e0a\u7684\u95ee\u9898\u53d1\u73b0\u548c\u89e3\u51b3","text":"<p>\u5f88\u591a\u4eba\u4f1a\u8bf4\uff0c\u4e0a\u9762\u8bf4\u4e86\u8fd9\u4e48\u591a\u8f6f\u4f18\u5316\u548c\u786c\u4f18\u5316\uff0c\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u522b\u6025\uff0c\u6211\u4eec\u6162\u6162\u6765\u8bf4\u3002\u4e0a\u9762\u8bf4\u7684\u7b97\u662f\u4e00\u79cd\u5bf9\u4e8e\u4f18\u5316\u7684\u6307\u5bfc\u601d\u60f3\u5427\uff0c\u4e0b\u6b21\u6211\u4eec\u9047\u5230\u7c7b\u4f3c\u7684\u95ee\u9898\u53ef\u4ee5\u4ece\u8fd9\u51e0\u4e2a\u7ef4\u5ea6\u6765\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u6211\u4eec\u8981\u505a\u4f18\u5316\uff0c\u9996\u5148\u80af\u5b9a\u662f\u8981\u53d1\u73b0\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u5bf9\u75c7\u4e0b\u836f\u3002</p> <p>\u6211\u4e4b\u524d\u4e3b\u8981\u5904\u7406\u7684\u662fFeed\u6d41\u7684\u5361\u987f\u4f18\u5316\uff0c\u6240\u4ee5\u6211\u57fa\u672c\u4e0a\u90fd\u662f\u901a\u8fc7Android Studio\u7684Profiler\u5de5\u5177\u6765\u67e5\u770b\u95ee\u9898\uff0c\u73b0\u5728Profiler\u7684\u4f53\u9a8c\u76f8\u5bf9\u4e4b\u524d\u529f\u80fd\u7b97\u662f\u66f4\u52a0\u5f3a\u5927\u4e86\uff0c\u6211\u6bcf\u6b21\u90fd\u662f\u4f7f\u7528Profiler\u6765\u5c1d\u8bd5\u6293\u4e00\u4e0bFeed\u6d41\u6ed1\u52a8\u65f6\u7684\u4ee3\u7801\u6267\u884c\u60c5\u51b5\u3002 \u7136\u540e\u4e00\u4e2a\u4e00\u4e2a\u67e5\u770b\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\u6211\u4eec\u7684\u8017\u65f6\u662f\u5728\u54ea\u4e9b\u5730\u65b9\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#profiler","title":"\u901a\u8fc7Profiler\u53d1\u73b0\u7684\u95ee\u9898","text":"<p>\u901a\u8fc7Profiler\u53d1\u73b0\u4e86\u4ee5\u4e0b\u51e0\u70b9\u95ee\u9898\uff1a 1. \u53d1\u73b0\u6709\u4e00\u4e9b\u6bd4\u8f83\u8017\u65f6\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u56fe\u6587\u7b14\u8bb0\u4e0a\u7684\u6ee4\u955c\u7684\u56de\u6536\u65b9\u6cd5\u6bd4\u8f83\u8017\u65f6\uff0c\u9488\u5bf9\u8fd9\u6837\u7684\u53ef\u4ee5\u8003\u8651\u505a\u8fd9\u4e2arelease\u64cd\u4f5c\u653e\u5230\u5f02\u6b65\u91cc\u9762\u53bb\uff1b 2. \u53e6\u5916\u4e5f\u53d1\u73b0\u4e00\u4e9b\u4e1a\u52a1\u7684\u6253\u70b9\u4f1a\u5728OnBindViewHolder\u4e2d\u8c03\u7528\u7684\u5f88\u9891\u7e41\uff0c\u867d\u7136\u70b9\u4f4d\u6570\u636e\u7684\u53d1\u9001\u662f\u5728\u5f02\u6b65\u7ebf\u7a0b\u91cc\uff0c\u4f46\u662f\u5728\u53d1\u9001\u6570\u636e\u4e4b\u524d\u4f1a\u6709\u6570\u636e\u7684\u62fc\u88c5\u64cd\u4f5c\uff0c\u591a\u5c11\u4f1a\u6709\u4e9b\u6027\u80fd\u635f\u8017\uff0c\u800c\u4e14\u6253\u70b9\u8fd9\u4e00\u7c7b\u6570\u636e\u5b8c\u5168\u53ef\u4ee5\u653e\u5230\u5f02\u6b65\u7ebf\u7a0b\u4e2d\u53bb\uff0c\u56e0\u4e3a\u8fd9\u79cd\u6253\u70b9\u5e76\u4e0d\u9700\u8981\u5f88\u9ad8\u7684\u5b9e\u65f6\u6027\uff1b 3. \u5bf9\u4e8e\u4e00\u4e9b\u8de8\u8fdb\u7a0b\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u4eceContext\u4e2d\u62ffService\u83b7\u53d6WiFi\u72b6\u6001\uff0c\u8fd9\u79cd\u5728onBind\u4e2d\u56de\u8c03\u662f\u975e\u5e38\u4e0d\u597d\u7684\uff0c\u6240\u4ee5\u9488\u5bf9\u8fd9\u4e2a\u6211\u4eec\u53ea\u9700\u8981\u6784\u9020\u4e00\u4e2a\u5e7f\u64ad\u6765\u76d1\u542cWIFI\u72b6\u6001\u53d8\u5316\u5373\u53ef\uff0c\u7136\u540e\u6bcf\u6b21\u53ea\u9700\u8981\u62ff\u90a3\u4e2a\u8bb0\u5f55\u597d\u7684\u7f51\u7edc\u72b6\u6001\u53d8\u91cf\u5373\u53ef 4. \u8fd8\u6709\u5173\u4e8e\u89c6\u9891\u7b14\u8bb0\u7684\u5904\u7406\uff0c\u6211\u4eec\u9700\u8981\u6839\u636eRecyclerView\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\u5f53\u524ditem\u4e2d\u7684\u89c6\u9891start\uff0cstop\u548cprepare\u505a\u76f8\u5e94\u7684\u8c03\u6574\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53RecyclerView\u5904\u4e8e\u6ed1\u52a8\u72b6\u6001\u662f\u4e0d\u5e94\u8be5\u53bbprepare\u548cstart\u7684\uff0c\u800c\u4e14\u4e5f\u4e0d\u5e94\u8be5\u521b\u5efa\u64ad\u653e\u5668\u5b9e\u4f8b\u548cTexture View\u7684\uff1b 5. \u6700\u540e\uff0c\u901a\u8fc7Profiler\u6211\u4eec\u8fd8\u53d1\u73b0TextView\u7684setText\u662f\u5f88\u8017\u65f6\u7684\uff0c\u5f53\u6211\u4eec\u590d\u6742\u591a\u884c\u6587\u672c\u7684\u60c5\u51b5\u65f6\uff0cTextView\u53bbsetText\u7684\u65f6\u5019\u9700\u8981\u8fdb\u884c\u590d\u6742\u7684\u6d4b\u91cf\uff0c\u5728\u6d4b\u91cf\u5b8c\u4e4b\u540e\u8fd8\u9700\u8981\u7ed8\u5236\uff0c\u6240\u4ee5\u9488\u5bf9\u8fd9\u4e2a\u573a\u666f\u53ef\u4ee5\u8003\u8651\u4f7f\u7528StaticLayout\u5bf9Feed\u6d41\u4e2d\u7684\u6587\u672c\u4f5c\u9884\u6e32\u67d3\uff0c\u5173\u4e8eStaticLayout\u7684\u6559\u7a0b\u7f51\u4e0a\u4e5f\u6709\u4e0d\u5c11\uff0c\u540e\u9762\u6709\u65f6\u95f4\u6211\u4e5f\u4f1a\u62bd\u7a7a\u5199\u4e0b\u5173\u4e8e\u8fd9\u5757\u7684\u5b9e\u8df5\u3002</p> <p>\u4e0a\u9762\u90fd\u662f\u901a\u8fc7Profiler\u6765\u53d1\u73b0\u7684\u4e00\u4e9b\u95ee\u9898\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#view","title":"View\u5c42\u7ea7","text":"<p>\u53e6\u5916\u8fd8\u6709\u4e00\u4e9b\u7b97\u662f\u57fa\u7840\u7684\u4f18\u5316\u5427\u3002\u56e0\u4e3aView\u7684\u5c42\u7ea7\u968f\u7740Feed\u6d41\u7684\u4e1a\u52a1\u53d8\u5f97\u8d8a\u6765\u8d8a\u6df1\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u53ef\u80fd\u5730\u51cf\u5c11View\u7684\u5c42\u7ea7\uff0c\u540c\u65f6\u4e5f\u5c3d\u91cf\u51cf\u5c11View\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528ConstraintLayout\uff0c\u4f46\u662fConstraintLayout\u8fd9\u4e2a\u4e1c\u897f\u8981\u614e\u7528\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u8fed\u4ee3\u6bd4\u8f83\u5feb\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u4f7f\u7528ConstraintLayout\u4f1a\u589e\u52a0\u6211\u4eec\u7684\u7ef4\u62a4\u6210\u672c\uff0c\u800c\u4e14\u4f1a\u6709\u4e00\u4e9b\u6bd4\u8f83\u5751\u7684\u95ee\u9898\u3002</p> <p>\u5173\u4e8eView\u5c42\u7ea7\u7684\u7f29\u51cf\u57fa\u672c\u6ca1\u5565\u53ef\u8bb2\u7684\uff0c\u5c3d\u91cf\u7528merge\u548cViewStub\uff0c\u8fd9\u4e2a\u5c31\u662f\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u53bb\u6d88\u9664\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u5c42\u7ea7\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#recyclerview","title":"RecyclerView\u7f13\u5b58\u7684\u5229\u7528","text":"<p>\u6700\u540e\uff0c\u6211\u4eec\u4e5f\u5c1d\u8bd5\u4e86\u4eceRecyclerView\u7f13\u5b58\u7684\u89d2\u5ea6\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cRecyclerView\u9ed8\u8ba4\u4f1a\u6709\u56db\u7ea7\u7f13\u5b58\u7684\u6982\u5ff5\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53\u6211\u4eec\u7684RecyclerView\u7684\u5361\u7247\u6491\u6ee1\u5c4f\u5e55\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8fdb\u5165\u8be5\u9875\u9762\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7684RecyclerView\u4f1a\u5148\u521b\u5efaViewHolder\uff0c\u7136\u540e\u518dbind\u8fd9\u4e2aViewHolder\uff0c\u7136\u540e\u5f53\u6211\u4eec\u5411\u4e0b\u6ed1\u52a8\u7684\u65f6\u5019\uff0c\u4f1a\u518d\u6b21\u521b\u5efa\u4e00\u4e2aViewHolder\uff0c\u63a5\u7740\u518d\u6267\u884cBind\u64cd\u4f5c\uff0c\u53ea\u6709\u5f53\u6211\u4eec\u7684RecycledView Pool\u7684\u6c60\u5b50\u6ee1\u4e86\u4e4b\u540e\u624d\u4e0d\u4f1a\u7ee7\u7eed\u521b\u5efaViewHolder\uff0c\u5f80\u540e\u7684\u6ed1\u52a8RecyclerViwe\u5c31\u53ea\u4f1a\u6267\u884cbind\u64cd\u4f5c\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2aOnCreateViewHolder\u9700\u8981\u4ecexml\u91cc\u53bb\u89e3\u6790view\uff0c\u5e76\u4e14\u521b\u5efa\u8fd9\u4e2aViewHolder\uff0c\u8fd9\u4e2a\u521b\u5efa\u5bf9\u4e8e\u6211\u4eec\u7684\u6ed1\u52a8\u662f\u4f1a\u6709\u6027\u80fd\u635f\u8017\uff0c\u5176\u5b9e\u8fd8\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u8fd9\u4e2a\u5361\u7247\u592a\u590d\u6742\u4e86\u3002</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u63d0\u524d\u521b\u5efa\u4e00\u4e9bViewHolder\uff0c\u653e\u5230ViewHolder\u7684\u6c60\u5b50\u91cc\u53bb\uff0c\u8fd9\u6837\u6211\u4eec\u5728\u6ed1\u52a8\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u5148Create\u518dBind\u4e86\u3002</p> <p>\u63d0\u524d\u521b\u5efaViewHolder\uff0c\u5728\u4e3b\u7ebf\u7a0bIdle\u7684\u72b6\u6001\u4e0b\u63d0\u524d\u521b\u5efaViewHolder\u653e\u5230RecycledViewPool\u4e2d\uff0c\u8fd9\u4e2apool\u7684size\u9ed8\u8ba4\u662f5\u3002    <code>java     recyclerView.setRecycledViewPool(RecyclerView.RecycledViewPool().apply {         LightExecutor.postIdle(Runnable {             repeat(5) {                 //RecycledViewPool \u9ed8\u8ba4size\u4e3a5\u4e2a\uff0cRecyclerView\u5185\u90e8\u4f1a\u6709\u5224\u65ad\uff0c\u5982\u679c\u6ee1\u4e86\u4e0d\u4f1acreate                 //\u6ce8\u610f\u8fd9\u91cc\u53d6\u5f97\u662ftypePool\u7684\u5012\u6570\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u4f4d\u7f6e\uff0c\u9700\u8981\u4fdd\u8bc1\u6ce8\u518c\u7684\u65f6\u5019\u89c6\u9891\u5361\u7247\u548c\u7b14\u8bb0\u5728\u6700\u540e\u4e24\u4e2a\u4f4d\u7f6e                 putRecycledView(mAdapter.createViewHolder(followFeedRecyclerView, mAdapter.typePool.size -1))                 putRecycledView(mAdapter.createViewHolder(followFeedRecyclerView, mAdapter.typePool.size -2))             }         })     })</code></p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#_4","title":"\u7ed3\u679c","text":"<p>\u5728\u505a\u5b8c\u8fd9\u4e9b\u4f18\u5316\u4e4b\u540e\uff0c\u5728Feed\u6d41\u4e0a\u7684\u5361\u987f\u5c31\u6709\u5f88\u5927\u6539\u5584\u4e86\uff0c\u53e6\u5916\uff0c\u5bf9\u4e8e\u4e1a\u52a1\u4fa7\u7684\u6307\u6807\u4e5f\u6709\u4e00\u5b9a\u7684\u6570\u636e\u63d0\u5347\u3002</p>"},{"location":"PerformanceOptimization/Feed%E6%B5%81%E4%B8%8A%E7%9A%84%E4%BC%98%E5%8C%96%E5%AE%9E%E8%B7%B5/#_5","title":"\u540e\u7eed","text":"<p>\u5bf9\u4e8e\u8fd9\u5757\u4e1a\u52a1\u7684\u6027\u80fd\u76d1\u63a7\u53ef\u4ee5\u5b9e\u65bd\u8d77\u6765\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u6211\u4eec\u5c3d\u65e9\u53d1\u73b0\u5361\u987f\u95ee\u9898\uff0c\u53e6\u5916\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u4f18\u5316\u7684\u70b9\u5176\u5b9e\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u6df1\u6316\uff0c\u6bd4\u5982\u524d\u521b\u5efaViewHolder\u662f\u5426\u53ef\u4ee5\u4f7f\u7528AsyncLayoutInflator\u8fdb\u884cinflate\uff0c\u8fd8\u6709\u9488\u5bf9\u6587\u672c\u7684\u9884\u6e32\u67d3\u53ef\u4ee5\u8003\u8651\u62bd\u6210\u7ec4\u4ef6\u5f62\u5f0f\uff0c\u65b9\u4fbf\u5176\u4ed6\u4e1a\u52a1\u4f7f\u7528\u3002</p> <p>\u611f\u8c22\u60a8\u7684\u9605\u8bfb\uff0c\u5982\u679c\u89c9\u5f97\u6211\u7684\u6587\u7ae0\u5bf9\u4f60\u6709\u5e2e\u52a9\uff0c\u8bf7\u5e2e\u5fd9\u70b9\u8d5e\uff0c\u6709\u95ee\u9898\u53ef\u4ee5\u8bc4\u8bba\u7559\u8a00\u3002</p>"},{"location":"PerformanceOptimization/%E4%B8%80%E7%A7%8DActivity%E9%A2%84%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%96%B9%E6%B3%95/","title":"\u4e00\u79cdActivity\u9884\u52a0\u8f7d\u7684\u65b9\u6cd5","text":"<p>\u4e00\u822c\u67d0\u4e2a Activity \u754c\u9762\u6253\u5f00\u8fc7\u7a0b\u5305\u62ec\u5982\u4e0b\u9636\u6bb5:</p> <ol> <li>\u4ece\u53d1\u8d77\u6253\u5f00\u547d\u4ee4\u201cstartActivity\u201d\u5230\u51fa\u73b0\u8be5\u754c\u9762\u6240\u5728\u7a97\u53e3\u52a8\u753b\u524d \u2014 \u5982\u679c\u8be5\u9636\u6bb5\u65f6\u95f4\u8f83\u957f\uff0c\u7ed9\u7528\u6237\u7684\u611f\u89c9\u5c31\u662f \u70b9\u51fb\u540e\u6709\u4e00\u4e2a\u7b49\u5f85\u65f6\u95f4\uff0c\u4f1a\u89c9\u5f97\u673a\u5668\u53cd\u5e94\u6162\u3002</li> <li>\u7a97\u53e3\u52a8\u753b\u8fc7\u7a0b \u2014 \u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\uff0c\u5728 startActivity \u65f6\u6307\u5b9a\u65e7\u7a97\u53e3\u548c\u65b0\u7a97\u53e3\u7684\u52a8\u753b\uff0c\u597d\u7684\u52a8\u753b\u4e5f\u4f1a\u7ed9\u7528\u6237\u5f88\u5feb\u7684\u611f\u89c9\u3002</li> <li>\u7a97\u53e3\u52a8\u753b\u5b8c\u6210\u540e\u5230\u6570\u636e\u52a0\u8f7d\u5b8c\u6210\u548c\u73b0\u5b9e\u6570\u636e\u7684\u754c\u9762\u5c55\u73b0\u51fa\u6765 \u2014 \u8fd9\u4e2a\u4e3b\u8981\u5305\u62ec\u7a97\u53e3\u4e2d\u6240\u6709 view \u7684 inflate \u65f6\u95f4\uff0c\u4f7f\u7528\u7684\u6240\u6709\u8d44\u6e90\u7684\u52a0\u8f7d\u65f6\u95f4\u548c\u5177\u4f53\u6570\u636e\u7684 load \u65f6\u95f4\u7b49\u3002</li> </ol> <p>\u4e3a\u4e86\u63d0\u5347\u65b0\u754c\u9762\u6253\u5f00\u901f\u5ea6\uff0c\u6211\u4eec\u4e00\u822c\u901a\u8fc7\u4fee\u6539\u81ea\u5df1\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\uff0c\u6bd4\u5982\u51cf\u5c11 view \u5c42\u6b21\uff0c\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u7f13\u5b58\u673a\u5236\uff0c\u591a\u7ebf\u7a0b\uff0c\u9884\u52a0\u8f7d\u7b49\u65b9\u6cd5\u3002\u4ee5\u4e0a\u65b9\u6cd5\u90fd\u662f\u5728\u81ea\u5df1\u7684\u8fdb\u7a0b\u542f\u52a8\u540e\u6765\u505a\u7684\uff0c\u4f46\u5bf9\u5982\u4e0b\u8fd9\u79cd\u60c5\u51b5\u4e0d\u592a\u9002\u7528:\u5373\u7528\u6237\u6253\u5f00\u67d0\u4e2a activity\uff0c\u4f46\u8be5 activity \u6240\u5728\u7684\u8fdb\u7a0b\u8fd8\u6ca1\u6709\u521b\u5efa\u548c\u542f\u52a8\u65f6\uff0c\u8fd9\u65f6\u53ef\u80fd\u9700\u8981\u66f4\u957f\u7684\u7b49\u5f85\u65f6\u95f4\u3002</p> <p>\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd activity \u7684\u9884\u52a0\u8f7d\u65b9\u6cd5\uff0c\u5e76\u5c1d\u8bd5\u907f\u514d\u4ee5\u4e0a\u95ee\u9898\uff0c\u5148\u8d34\u51fa\u4ee3\u7801\uff0c\u540e\u9762\u518d\u8be6\u7ec6\u4ecb\u7ecd\uff1a</p> <pre><code>public class PreloadService extends IntentService {\n    private final static String TAG = \"PreloadService\"; \n    public final static String EXTRA_PRELOAD = \"preload\"; \n    private static boolean sHasPreload = false;\n\n    private static class LocalActivityRecord extends Binder { \n        LocalActivityRecord(String _id, Intent _intent) {\n            id = _id;\n            intent = _intent; \n        }\n        final String id;\n        Intent intent; \n    }\n\n    public PreloadService() {\n        super(\"PreloadService\");\n    }\n\n    @Override\n    protected void onHandleIntent(Intent intent) {\n        Log.i(TAG, \"PreloadService onHandleIntent...\"); \n        if (sHasPreload) {\n            return; \n        }\n        ActivityThread activityThread = ActivityThread.currentActivityThread();\n        if (activityThread == null) { //4.0 ~ 4.2 \u4e0a ActivityThread \u7684\u5bf9\u8c61\u662f ThreadLocal \u7684\uff0c\u5f53\u524d\u7ebf\u7a0b\u4e2d \u65e0\u6cd5\u83b7\u53d6\uff0c\u6240\u4ee5\u53ea\u80fd\u5728 mainThread \u4e2d\u83b7\u53d6\n        final Looper mainLooper = Looper.getMainLooper(); \n        Handler mainHandler = new Handler(mainLooper); \n        mainHandler.post(new Runnable() {\n\n            @Override\n            public void run() {\n                activityThread = ActivityThread.currentActivityThread();\n                final ActivityThread finalActivityThread = activityThread; \n                new Thread(new Runnable() {\n                    @Override\n                    public void run() {\n                        doPreload(finalActivityThread); }\n                    }).start(); \n                }\n            }); \n        } else {\n            doPreload(activityThread); \n        }\n        sHasPreload = true; \n    }\n\n    private void doPreload(ActivityThread activityThread) {\n        Intent activityIntent = null;\n        Activity activity = null;\n        if (XXXActivity.sShouldPreload) { //\u5982\u679c\u771f\u6b63\u7684\u542f\u52a8\u6b63\u5728\u8fd0\u884c\uff0c\u9884\u52a0\u8f7d\u5c31\u4e0d\u9700\n            activityIntent = new Intent(getApplicationContext(), XXXActivity.class);\n            activityIntent.putExtra(EXTRA_PRELOAD, true);\n            String id = XXXActivity.class.getName();\n            LocalActivityRecord activityRecord = new LocalActivityRecord(id, activityIntent); \n            activity = activityThread.startActivityNow(null, activityRecord.id, activityRecord.intent,\n            activityThread.resolveActivityInfo(activityRecord.intent), activityRecord, null, null); \n            if (activity != null) {\n                activityThread.performResumeActivity(activityRecord, true);\n                activityThread.performDestroyActivity(activityRecord, true); \n            }\n        } \n    }\n}\n</code></pre> <p>\u542f\u52a8\u9884\u52a0\u8f7d</p> <pre><code>\nIntent intent = new Intent(getApplicationContext(), PreloadService.class); \ncontext.startService(intent);\n</code></pre> <p>\u57fa\u672c\u539f\u7406</p> <p>\u5f53 activity \u6240\u5728\u8fdb\u7a0b\u8fd8\u6ca1\u6709\u542f\u52a8\u65f6\uff0c\u7528\u6237\u5982\u679c\u6253\u5f00\u67d0\u4e2a activity\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u8fd9\u4e2a\u8fdb\u7a0b\uff0c\u8981\u5c06 activity \u4f7f\u7528 \u7684 class\uff0cxml\uff0cresource \u7b49\u4ece apk \u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6709\u5927\u91cf\u7684 io\uff0c\u662f\u6bd4\u8f83\u8017\u65f6\u7684\u3002\u6587\u4e2d\u7684\u9884\u52a0 \u8f7d\u65b9\u5f0f\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <ol> <li>\u9996\u5148\u5c06 PreloadService \u653e\u5728\u4e0e\u9884\u52a0\u8f7d activity \u76f8\u540c\u7684\u8fdb\u7a0b\u5185</li> <li>\u5728 PreloadService \u4e2d\u83b7\u53d6\u5f53\u524d\u8fdb\u7a0b\u4e2d\u552f\u4e00\u7528\u6765\u521b\u5efa activity \u7684\u5e95\u5c42\u7684\u7ba1\u7406\u7c7b:ActivityThread \u7684\u5bf9\u8c61</li> <li>ActivityThread \u53ef\u4ee5\u6839\u636e intent \u521b\u5efa intent \u4e2d\u5236\u5b9a\u7684 activity \u5bf9\u8c61\uff0cActivity activity = activityThread.startActivityNow(...intent...)</li> <li>\u8fd9\u6837\u7cfb\u7edf\u4f1a\u521b\u5efa\u8be5 activity\uff0c\u5e76\u4e14\u8c03\u7528\u4e86 activity \u7684 onCreate\uff0c\u8fd9\u6837\u5c31\u4f1a\u628a activity \u7684 contentView \u52a0\u8f7d\u8fdb \u6765\uff0c\u5982\u679c\u5728 onCreate \u4e2d\u8c03\u7528\u4e86 fragmentManager.addFragment\uff0c\u8fd9\u65f6 fragment \u7684 create \u751f\u547d\u5468\u671f\u51fd\u6570\u4e5f \u4f1a\u8c03\u7528</li> <li>\u56e0\u4e3a\u80fd\u591f\u4f7f\u5f97 activity \u52a0\u8f7d\u7684\u66f4\u5f7b\u5e95\uff0c\u518d\u8c03\u7528 activityThread.performResumeActivity(activityRecord, true)\uff0c\u8fd9\u6837\u4f1a\u8c03\u7528 activity \u7684 onResume\uff0c\u540c\u6837\u7684 fragment \u7684\u4e5f\u4f1a\u8c03\u7528</li> <li>\u4e3a\u4e86\u80fd\u591f\u4f7f\u5f97\u9884\u52a0\u8f7d\u7684 activity \u53ef\u4ee5\u88ab\u56de\u6536\uff0c\u9700\u8981\u8c03\u7528 activityThread.performDestroyActivity(activityRecord, true)\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5c06 activity \u4ece activityThread \u4e2d\u79fb\u9664</li> <li>\u901a\u8fc7\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u5728\u7528\u6237\u70b9\u51fb\u4e4b\u524d\u53ef\u4ee5\u505a\u9884\u52a0\u8f7d</li> </ol>"},{"location":"PerformanceOptimization/%E4%B8%80%E7%A7%8DFragment%E6%87%92%E5%8A%A0%E8%BD%BD%E7%9A%84%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5/","title":"\u4e00\u79cdFragment\u61d2\u52a0\u8f7d\u7684\u4f18\u5316\u7b56\u7565","text":"<p>\u4e4b\u524d\u5728\u505a\u91cd\u6784\u7684\u65f6\u5019\uff0c\u9700\u8981\u68b3\u7406\u9996\u9875\u7684\u4ee3\u7801\u903b\u8f91\uff0c\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6211\u53d1\u73b0\u6211\u4eec\u7684 App \u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u90fd\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u6240\u6709\u7684\u9875\u9762\u6846\u67b6\uff0c\u9664\u4e86\u9996\u9875\u4e4b\u5916\uff0c\u8fd8\u5305\u62ec\u3010\u5546\u57ce\u9875\u3011\u3001\u3010\u6d88\u606f\u9875\u3011\u548c\u3010\u4e2a\u4eba\u9875\u3011\u3002</p> <p>\u56e0\u4e3a\u9996\u9875\u9ed8\u8ba4\u91c7\u7528ViewPager\u4f5c\u4e3a\u5bb9\u6613\u6765\u627f\u8f7dapp\u7684\u56db\u4e2a\u9875\u9762\u5207\u6362\uff0c\u5f53\u9996\u9875ViewPager\u7684offsetScreenPageLimit\u4e3a3\u65f6\uff0c\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u5f53\u524d\u9875\u9762\u7684\u540e\u4e09\u4e2a\u9875\u9762\u3002</p> <p></p> <p>\u9488\u5bf9\u8fd9\u79cd\u60c5\u51b5\uff0c\u8003\u8651\u505a\u5ef6\u8fdf\u52a0\u8f7d\uff0c\u4e8e\u662f\u628aoffsetScreenPageLimit\u8bbe\u7f6e\u4e3a1\u3002</p> <p>\u5f53\u5c06offsetScreenPageLimit\u8bbe\u7f6e\u4e3a1\u7684\u65f6\u5019\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u9608\u503c\u7684\u9875\u9762\u4f1a\u88ab\u9500\u6bc1\u3002</p> <p>\u4e8e\u662f\u91cd\u5199\u4e86ViewPager\u4e2dAdapter\u7684\u9875\u9762\u7684\u521b\u5efa\u548c\u9500\u6bc1\u903b\u8f91\uff0c\u5229\u7528Fragment\u7684show/hide \u6765\u505a\u7279\u6b8a\u5904\u7406\uff0c\u4fdd\u8bc1\u5df2\u7ecf\u521b\u5efa\u8fc7\u7684\u9875\u9762\u4e0d\u4f1a\u91cd\u590d\u521b\u5efa\u3002</p> <pre><code>class IndexPagerAdapter @Inject constructor(private val fm: FragmentManager,\n                                            @Named(\"IndexAdapterFragments\") val fragments: ArrayList&lt;Fragment&gt;\n) : FragmentPagerAdapter(fm) {\n\n    override fun getCount(): Int = fragments.size\n    override fun getItem(position: Int): Fragment = fragments[position]\n\n    override fun instantiateItem(container: ViewGroup, position: Int): Any {\n        val fragment = super.instantiateItem(container, position) as Fragment\n        fm.beginTransaction().show(fragment).commitAllowingStateLoss()\n        return fragment\n    }\n\n    override fun destroyItem(container: ViewGroup, position: Int, obj: Any) {\n        fm.beginTransaction().hide(obj as Fragment).commitAllowingStateLoss()\n    }\n\n    override fun getItemPosition(item: Any): Int {\n        return POSITION_UNCHANGED\n    }\n}\n\n</code></pre>"},{"location":"PerformanceOptimization/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u53162/5 -- \u5185\u5b58\u4f18\u5316","text":""},{"location":"PerformanceOptimization/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/#_1","title":"\u5185\u5b58\u5360\u7528\u5206\u6790\u5de5\u5177","text":"<ol> <li>Memory Monitor\uff1a\u4ea4\u4e92\u8fc7\u7a0b\u4e2d\uff0c\u65b9\u4fbf\u67e5\u770b\u5185\u5b58\u6ce2\u52a8\u60c5\u51b5</li> <li>Heap Viewer\uff1a\u65b9\u4fbf\u67e5\u770b\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5185\u5b58\u5927\u81f4\u5206\u914d\u72b6\u51b5</li> <li>Allocation Tracker\uff1a\u66f4\u7ec6\u81f4\uff0c\u53ef\u4ee5\u8ddf\u8e2a\u5e94\u7528\u7684\u5185\u5b58\u5206\u914d\uff0c\u5e76\u5217\u51fa\u8c03\u7528\u5806\u6808</li> </ol> <p>\u53ef\u501f\u52a9\u4e0a\u97623\u4e2a\u5de5\u5177\u67e5\u770b\u5185\u5b58\u7684\u5206\u914d\u60c5\u51b5\uff0c\u6bd4\u5982\u5206\u6790\u5927\u5bf9\u8c61\u3001\u5185\u5b58\u9891\u7e41GC\u7b49\u3002\u5982\u679c\u9047\u5230\u5927\u5bf9\u8c61\uff0c\u6bd4\u5982Bitmap\uff0c\u53ef\u4ee5\u4f7f\u7528BitmapFactory.Options\u76f8\u5173\u6280\u672f(inSampleSize)\u538b\u7f29\u56fe\u50cf\u518d\u52a0\u8f7d\u3002</p> <p>Allocation Tracker \u754c\u9762:</p> <p></p>"},{"location":"PerformanceOptimization/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/#_2","title":"\u5185\u5b58\u6cc4\u6f0f\u5206\u6790\u5de5\u5177","text":"<ol> <li>LeakCanary \uff08\u5f00\u6e90\u5e93\u4e00\u8282\u5df2\u7ecf\u4ecb\u7ecd\uff09</li> <li>MAT \u5de5\u5177</li> </ol>"},{"location":"PerformanceOptimization/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/#mat","title":"MAT","text":"<p>Android Studio\u5bfc\u51fa\u7684hprof\u6587\u4ef6\u662fDalvik\u683c\u5f0f\u7684\uff0c\u9700\u8981\u8f6c\u6362\u6210J2SE hprof\u624d\u80fd\u88abMAT\u4f7f\u7528\u3002\u8f83\u9ad8\u7248\u672cStudio\u5728Capture\u4e00\u680f\u4e5f\u53ef\u4ee5\u5bfc\u51fa\u6807\u51c6\u7684hprof\u3002</p> <p>\u4f7f\u7528Android SDK\u81ea\u5e26\u7684\u8f6c\u6362\u5de5\u5177hprof-conv, \u8f6c\u6362\u547d\u4ee4\uff1a</p> <pre><code>./hprof-conv path/file.hprof exitPath/heap-converted.hprof\n</code></pre> <p>\u5de5\u5177\u6240\u5728\u76ee\u5f55\uff1a</p> <pre><code>../Android/sdk/platform-tools/hprof-conv\n</code></pre>"},{"location":"PerformanceOptimization/%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/","title":"\u542f\u52a8\u4f18\u5316","text":""},{"location":"PerformanceOptimization/%E5%90%AF%E5%8A%A8%E4%BC%98%E5%8C%96/#_1","title":"\u542f\u52a8\u4f18\u5316","text":"<p>\u4f60\u77e5\u9053android\u7684MessageQueue.IdleHandler\u5417\uff1f</p> <ul> <li>\u767d\u5c4f prewindow  cleartask</li> <li>\u200c\u591a\u8fdb\u7a0b\u521d\u59cb\u5316sdk,\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u4f1a\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u542c\u4e91sdk</li> <li>\u5f02\u6b65\u521d\u59cb\u5316\uff0c\u7ebf\u7a0b\u6c60\u4e32\u884c\uff0cidle handler,\u63a8\u9001\uff0cweb\u8d44\u6e90\u5ef6\u8fdf\u521d\u59cb\u5316</li> </ul>"},{"location":"PerformanceOptimization/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/","title":"\u56fe\u7247\u4f18\u5316","text":"<ul> <li>LruCache</li> <li>DiskLruCache</li> <li>\u56fe\u50cf\u663e\u793a\u539f\u7406</li> </ul>"},{"location":"PerformanceOptimization/%E5%9C%A8provider%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%97%B6%E5%80%99%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E8%80%97%E6%97%B6%E6%93%8D%E4%BD%9C/","title":"\u5728provider\u521d\u59cb\u5316\u7684\u65f6\u5019\u5982\u4f55\u5904\u7406\u8017\u65f6\u64cd\u4f5c","text":"<p>\u5982\u679c Provider \u5728 onCreate()\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u505a\u4e00\u4e9b\u8017\u65f6\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u6570\u636e\u7684\u521d\u59cb\u5316\uff0c\u6e05\u7406\u6570\u636e\u5e93\u4e2d\u7684\u5783\u573e\u6570 \u636e\uff0c\u6216\u8005\u91cd\u5efa\u6570\u636e\u7684\u7d22\u5f15\u7b49\u7b49\uff0c\u50cf\u8fd9\u4e00\u7c7b\u7684\u64cd\u4f5c\u53ef\u4ee5\u653e\u5230\u4e00\u4e2a\u540e\u53f0\u7ebf\u7a0b\u987a\u5e8f\u6267\u884c\u3002</p> <p>\u4ee3\u7801\uff1a</p> <pre><code>\nprivate HandlerThread mBackgroundThread; private Handler mBackgroundHandler;\n\n@Override\npublic boolean onCreate() {\n    super.onCreate();\n    mBackgroundThread = new HandlerThread(\"ProviderWorker\", Process.THREAD_PRIORITY_BACKGROUND);\n    mBackgroundThread.start();\n\n    mBackgroundHandler = new Handler(mBackgroundThread.getLooper()) {\n        @Override\n        public void handleMessage(Message msg) {\n            performBackgroundTask(msg.what, msg.obj); }\n    };\n    // \u4efb\u52a1\u5728\u540e\u53f0\u7ebf\u7a0b\u987a\u5e8f\u6267\u884c \n    scheduleBackgroundTask(BACKGROUND_TASK_INITIALIZE); \n    scheduleBackgroundTask(BACKGROUND_TASK_UPDATE_LOCALE);\n    scheduleBackgroundTask(BACKGROUND_TASK_UPDATE_SEARCH_INDEX); \n    return true;\n}\n\nprotected void scheduleBackgroundTask(int task) { \n    mBackgroundHandler.sendEmptyMessage(task);\n}\n\n// \u5728\u7ebf\u7a0b\u4e2d\u5904\u7406\u8017\u65f6\u7684\u64cd\u4f5c\nprotected void performBackgroundTask(int task, Object arg) {\n    switch (task) { \n        case BACKGROUND_TASK_INITIALIZE: {\n                doInitialize();\n                break; \n            }\n        case BACKGROUND_TASK_UPDATE_LOCALE: { \n            doIUpdateLocale();\n            break; \n        }\n        case BACKGROUND_TASK_UPDATE_SEARCH_INDEX: { \n            doIUpdateSearchIndex();\n            break; \n        }\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u628a\u8017\u65f6\u64cd\u4f5c\u653e\u5728\u540e\u53f0\u7ebf\u7a0b\u5904\u7406\uff0c\u4f7f\u5f97 provider \u7684 onCreate()\u4e0d\u4f1a\u6267\u884c\u5f88\u957f\u65f6\u95f4\uff0cprovider \u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\uff0c\u5f00\u59cb\u5904\u7406 query/insert/update/delete \u7684\u64cd\u4f5c\u3002</p> <p>\u5047\u5982 query/insert/update/delete \u7b49\u6570\u636e\u5e93\u64cd\u4f5c\u53d1\u751f\u5728\u540e\u53f0\u7684\u4efb\u52a1\u7ed3\u675f\u4e4b\u540e\uff0c\u8fd9\u6837\u505a\u770b\u8d77\u6765\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c \u4f46\u662f\u5f88\u6709\u53ef\u80fd doInitialize()\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u5c31\u4f1a\u6709\u8fdb\u7a0b\u6765\u64cd\u4f5c\u6570\u636e\u5e93\u3002</p> <p>\u63a5\u4e0b\u6765\u9700\u8981\u5bf9\u6211\u4eec\u7684\u5b9e\u73b0\u505a\u4e00\u4e0b\u6539\u8fdb\uff0c \u6765\u786e\u4fdd\u6570\u636e\u5e93\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u524d query/insert/update/delete \u7b49\u6570\u636e\u5e93 \u64cd\u4f5c \u4e0d\u4f1a\u88ab\u6267\u884c</p> <p>\u5047\u8bbe\u5728 doInitialize()\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u51c6\u5907\u597d\u53ef\u4ee5\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u800c\u5728 doIUpdateSearchIndex() \u4e4b\u540e\u6211\u4eec\u624d\u5141\u8bb8 \u5199\u64cd\u4f5c\u3002</p> <p>\u5047\u5982 query/insert/update/delete \u7b49\u6570\u636e\u5e93\u64cd\u4f5c\u53d1\u751f\u5728\u540e\u53f0\u7684\u4efb\u52a1\u7ed3\u675f\u4e4b\u540e\uff0c\u8fd9\u6837\u505a\u770b\u8d77\u6765\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c \u4f46\u662f\u5f88\u6709\u53ef\u80fd doInitialize()\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u5c31\u4f1a\u6709\u8fdb\u7a0b\u6765\u64cd\u4f5c\u6570\u636e\u5e93\u3002</p> <p>\u63a5\u4e0b\u6765\u9700\u8981\u5bf9\u6211\u4eec\u7684\u5b9e\u73b0\u505a\u4e00\u4e0b\u6539\u8fdb\uff0c \u6765\u786e\u4fdd\u6570\u636e\u5e93\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u524d query/insert/update/delete \u7b49\u6570\u636e\u5e93 \u64cd\u4f5c \u4e0d\u4f1a\u88ab\u6267\u884c\u3002</p> <p>\u5047\u8bbe\u5728 doInitialize()\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u51c6\u5907\u597d\u53ef\u4ee5\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u800c\u5728 doIUpdateSearchIndex() \u4e4b\u540e\u6211\u4eec\u624d\u5141\u8bb8 \u5199\u64cd\u4f5c</p> <pre><code>\nprivate HandlerThread mBackgroundThread; \nprivate Handler mBackgroundHandler;\n\nprivate volatile CountDownLatch mReadAccessLatch; \nprivate volatile CountDownLatch mWriteAccessLatch; \n    @Override\n    public boolean onCreate() {\n    super.onCreate();\n    // The provider is closed for business until fully initialized mReadAccessLatch = new CountDownLatch(1); mWriteAccessLatch = new CountDownLatch(1);\n    mBackgroundThread = new HandlerThread(\"ProviderWorker\", Process.THREAD_PRIORITY_BACKGROUND);\n    mBackgroundThread.start();\n    mBackgroundHandler = new Handler(mBackgroundThread.getLooper()) {\n        @Override\n            public void handleMessage(Message msg) { \n                performBackgroundTask(msg.what, msg.obj);\n        } };\n    scheduleBackgroundTask(BACKGROUND_TASK_INITIALIZE); \n    scheduleBackgroundTask(BACKGROUND_TASK_UPDATE_LOCALE); \n    scheduleBackgroundTask(BACKGROUND_TASK_UPDATE_SEARCH_INDEX); \n    scheduleBackgroundTask(BACKGROUND_TASK_OPEN_WRITE_ACCESS);\n}\n\nprotected void scheduleBackgroundTask(int task) { \n    mBackgroundHandler.sendEmptyMessage(task);\n}\n\n// \u5728\u7ebf\u7a0b\u4e2d\u5904\u7406\u8017\u65f6\u7684\u64cd\u4f5c\nprotected void performBackgroundTask(int task, Object arg) {\n    switch (task) {\n    case BACKGROUND_TASK_INITIALIZE: {\n        doInitialize(); \n        mReadAccessLatch.countDown();\n        mReadAccessLatch = null;\n        break; \n    }\n    case BACKGROUND_TASK_UPDATE_LOCALE: { \n        doIUpdateLocale();\n        break; \n    }\n    case BACKGROUND_TASK_UPDATE_SEARCH_INDEX: { \n        doIUpdateSearchIndex();\n        break; \n    }\n    case BACKGROUND_TASK_OPEN_WRITE_ACCESS: { \n        mWriteAccessLatch.countDown();\n        mWriteAccessLatch = null;\n        break; \n    }\n}\n</code></pre> <p>\u6211\u4eec\u65b0\u589e\u52a0\u4e86\u4e24\u4e2a\u8ba1\u6570\u5668 mReadAccessLatch \u548c mWriteAccessLatch\uff0c\u521d\u59cb\u5316\u503c\u90fd\u4e3a 1\uff0cdoInitialize()\u7ed3\u675f \u4e4b\u540e mReadAccessLatch \u8d4b\u503c\u4e3a null\uff0c\u6240\u6709\u540e\u53f0\u4efb\u52a1\u7ed3\u675f\u4e4b\u540e mWriteAccessLatch \u8d4b\u503c\u4e3a null\uff0c \u8fd9\u6837\u5728 query/insert/update/delete \u4e4b\u524d\u5148\u5224\u65ad\u4e00\u4e0b\u8ba1\u6570\u5668\u5c31\u53ef\u4ee5\u77e5\u9053\u662f\u5426\u53ef\u4ee5\u6267\u884c\u8be5\u64cd\u4f5c\u4e86\u3002</p> <pre><code>private void waitForAccess(CountDownLatch latch) { \n    if (latch == null) {\n        return; \n    }\n    while (true) { \n        try {\n            latch.await();\n            return;\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt(); }\n        } \n    }\n\n@Override\npublic Uri insert(Uri uri, ContentValues values) {\n    waitForAccess(mWriteAccessLatch); return doInsert();\n}\n\n@Override\npublic int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {\n    waitForAccess(mWriteAccessLatch);\n    return doUpdate(); \n}\n\n@Override\npublic int delete(Uri uri, String selection, String[] selectionArgs) {\n    waitForAccess(mWriteAccessLatch); \n    return doDelete();\n}\n\n@Override\npublic Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder, CancellationSignal cancellationSignal) {\n    waitForAccess(mReadAccessLatch);\n    return doQuery(); \n}\n</code></pre> <p>\u5728\u6570\u636e\u5e93\u64cd\u4f5c\u4e4b\u524d\u589e\u52a0 waitForAccess()\uff0c\u8fd9\u6837\u5728\u6570\u636e\u5e93\u521d\u59cb\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u8fdb\u7a0b\u5bf9\u6570\u636e\u5e93\u7684\u5199\u64cd \u4f5c\uff0c\u5f53\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\uff0c\u6240\u6709\u88ab\u963b\u585e\u7684\u64cd\u4f5c\u518d\u88ab\u6267\u884c\u3002</p>"},{"location":"PerformanceOptimization/%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96Activity%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6/","title":"\u5982\u4f55\u4f18\u5316Activity\u542f\u52a8\u901f\u5ea6","text":"<p>\u5728\u4e00\u4e9b\u4f4e\u914d\u624b\u673a\u4e0a\uff0c\u6211\u4eec\u7ecf\u5e38\u4f1a\u9047\u5230\u767d\u5c4f\u6216\u8005\u9875\u9762\u5207\u6362\u5361\u987f\u7b49\u73b0\u8c61\uff0c\u8fd9\u4e9b\u90fd\u662f Activity \u542f\u52a8\u901f\u5ea6\u6162\u7684\u8868\u73b0\uff0c\u672c\u6587\u5c06\u5206\u4eab\u4e00\u4e9b\u5c0f\u7c73\u7cfb\u7edf\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4f18\u5316 Activity \u542f\u52a8\u901f\u5ea6\u7684\u7ecf\u9a8c\u3002</p> <p>\u6211\u4eec\u628a\u4f18\u5316\u5206\u4e3a\u4e24\u7c7b\uff0c\u5206\u522b\u53eb\u505a\u786c\u4f18\u5316\u548c\u8f6f\u4f18\u5316\uff0c\u5148\u6765\u8bf4\u8bf4\u8f6f\u4f18\u5316\u3002</p> <p>\u8f6f\u4f18\u5316: \u662f\u6307\u901a\u8fc7\u4e00\u4e9b\u7279\u6b8a\u7684\u65b9\u5f0f\u6765\u8fbe\u5230\u4f18\u5316\u7684\u6548\u679c\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e00\u822c\u4f1a\u5c3d\u53ef\u80fd\u5730\u5c11\u4fee\u6539\u539f\u4ee3\u7801\u7684\u7ed3\u6784\u548c\u903b\u8f91\u3002</p> <p>\u4e00\u822c\u4e3b\u8981\u7528\u4ee5\u4e0b\u51e0\u79cd\u8f6f\u4f18\u5316\u7684\u65b9\u6cd5:</p> <ol> <li>\u9884\u52a0\u8f7d</li> <li>\u5f02\u6b65\u52a0\u8f7d:\u8d39\u65f6\u7684\u975e UI \u64cd\u4f5c\u653e\u5230\u53e6\u4e00\u4e2a Thread</li> <li>\u5ef6\u8fdf\u52a0\u8f7d:\u53ef\u4ee5\u5ef6\u8fdf\u5c55\u793a\u7684 UI \u64cd\u4f5c\u653e\u5230 IdleHandler \u4e2d</li> </ol>"},{"location":"PerformanceOptimization/%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96Activity%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6/#_1","title":"\u5ef6\u8fdf\u52a0\u8f7d","text":"<pre><code>\npublic class BaseActivity extends Activity { \n    private boolean mDelayFinished = false;\n\n@Override\nprotected void onCreate(final Bundle savedInstanceState) {\n        super.onCreate (savedInstanceState); \n        mDelayFinished = false;\n\n        Looper.myQueue().addIdleHandler(new IdleHandler() { \n            @Override\n            public boolean queueIdle() {\n                onCreateDelay(savedInstanceState); \n                onStartDelay() ;\n                onResumeDelay();\n                mDelayFinished = true;\n                return false; \n            }\n    });\n}\n\nprotected void onCreateDelay(Bundle bundle) {\n    // TODO : \u53ef\u4ee5\u5ef6\u8fdf\u5c55\u793a\u7684 UI \u64cd\u4f5c \n}\nprotected void onStartDelay() { }\nprotected void onResumeDelay() { }\nprotected void onPauseDelay() { }\nprotected void onStopDelay() { }\nprotected void onDestroyDelay() { }\n\n@Override\nprotected void onResume() {\n    super.onResume();\n    if (mDelayFinished) {\n        onResumeDelay(); \n    }\n} \n@Override\nprotected void onPause() { \n    super.onPause();\n    if (mDelayFinished) { \n        onPauseDelay();\n    } \n}\n@Override\nprotected void onStop() {\n    super.onStop () ;\n    if (mDelayFinished) {\n        onStopDelay() ; \n    }\n} \n@Override\nprotected void onDestroy() { \n    super.onDestroy();\n    if (mDelayFinished) { \n        onDestroyDelay();\n    } \n}\n}\n</code></pre> <p>Looper.myQueue().addIdleHandler \u80fd\u591f\u4fdd\u8bc1\u64cd\u4f5c\u5728 Activity \u542f\u52a8\u5b8c\u6210\u4e4b\u540e\u518d\u6267 \u884c\uff0c\u5b50\u7c7b\u53ea\u8981\u628a\u53ef\u4ee5\u5ef6\u8fdf\u52a0\u8f7d\u7684 UI \u64cd\u4f5c\u653e\u5230\u5bf9\u5e94\u7684*Delay()\u5373\u53ef\u3002</p> <p>\u786c\u4f18\u5316</p> <p>\u6df1\u7a76\u4ee3\u7801\u7684\u7ec6\u8282\uff0c\u901a\u8fc7\u67e5\u770b trace \u6587\u4ef6\uff0c\u4e00\u6b65\u6b65\u5730\u4f18\u5316\u5230\u6781\u81f4\u3002</p> <ol> <li>\u53bb\u9664\u8017\u65f6\u7684\u56fe\u7247\uff0c\u6570\u636e\u5e93\u7b49\u64cd\u4f5c</li> <li>\u7cbe\u7b80\u5e03\u5c40\uff0c\u51cf\u5c11\u5c42\u6b21\uff0c\u5c3d\u53ef\u80fd\u591a\u5730\u4f7f\u7528 ViewStub</li> <li>\u4e00\u4e9b\u8d39\u65f6\u7684\u521d\u59cb\u5316\u64cd\u4f5c\u63d0\u524d\u5230\u8fdb\u7a0b\u521d\u59cb\u5316\u6267\u884c</li> <li>\u4f18\u5316\u4e3b\u9898\u52a0\u8f7d\u8d44\u6e90\u7684\u901f\u5ea6</li> <li>\u4f18\u5316 Activity.installDecor \u901f\u5ea6</li> <li>\u4e00\u4e9b\u65b9\u6cd5\u7684\u4f18\u5316\uff0c\u4f8b\u5982 Long.valueof\uff0cspareArray\uff0c\u5177\u4f53\u6709\u66f4\u597d\u7684\u6027\u80fd </li> <li>\u8c03\u6574\u5207\u6362\u52a8\u753b\u6548\u679c</li> </ol> <p>\u786c\u4f18\u5316\u9700\u8981\u6709\u4e00\u5b9a\u8010\u5fc3\uff0c\u4e00\u6b65\u6b65\u627e\u5230\u95ee\u9898\u7684\u6839\u6e90\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u662f\u6211\u4eec\u66f4\u4e3b\u5f20\u7684\u4f18\u5316 \u65b9\u5f0f\uff0c\u8fd9\u79cd\u4f18\u5316\u5c31\u9700\u8981\u5bf9\u539f\u4ee3\u7801\u7684\u7ed3\u6784\u548c\u903b\u8f91\u505a\u6bd4\u8f83\u5927\u6539\u52a8\u3002</p>"},{"location":"PerformanceOptimization/%E5%AE%89%E8%A3%85%E5%8C%85%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u53165/5 -- \u5b89\u88c5\u5305\u4f18\u5316","text":"<ul> <li>\u6253\u5305\u65f6\uff0c\u5bf9\u4ee3\u7801\u548c\u8d44\u6e90\u8fdb\u884c\u6df7\u6dc6\u3001\u538b\u7f29</li> <li>\u4f7f\u7528Lint\u5220\u9664\u5197\u4f59\u8d44\u6e90</li> <li>\u91c7\u7528\u5408\u9002\u7684\u56fe\u7247\u7f16\u7801\u683c\u5f0f\uff0c\u6ca1\u5fc5\u8981\u90fd\u662f\u9ad8\u6e05</li> <li>\u4f7f\u7528WebP\u56fe\u7247\u683c\u5f0f</li> </ul>"},{"location":"PerformanceOptimization/%E5%AE%89%E8%A3%85%E5%8C%85%E4%BC%98%E5%8C%96/#_1","title":"\u771f\u5b9e\u9879\u76ee\u5b9e\u9645\u64cd\u4f5c","text":"<ul> <li>\u5254\u9664\u65e0\u7528so\u6587\u4ef6,\u6574\u7406\u51faso\u6587\u4ef6\u7ef4\u62a4\u5217\u8868\uff0c\u51cf\u5c11\u7ea62M</li> <li>\u5254\u9664\u65e0\u7528\u8d44\u6e90\u6587\u4ef6,\u901a\u8fc7gradle\u81ea\u52a8\u68c0\u6d4b,\u548c\u4ee3\u7801\u4f18\u5316\u5bf9\u9f50(\u4f46\u662f\u4f1a\u5b58\u5728\u5faa\u73af\u5f15\u7528, \u9700\u8981\u4eba\u4e3a\u53c2\u4e0e)</li> <li>\u5f15\u5165AndResGuard , \u6df7\u6dc6\u8d44\u6e90\u6587\u4ef6\u8def\u5f84\u548c\u6587\u4ef6\u540d\u79f0, \u5927\u5e45\u51cf\u5c11\u4e86resources.arsc \u7d22\u5f15\u6587\u4ef6\u7684\u4f53\u79ef, \u51cf\u5c112M</li> <li>\u4ec5\u652f\u6301armeabi-v7a\u4e00\u79cdCPU ABI\u6307\u4ee4\u96c6(\u517c\u5bb9\u8fd0\u884c x86, x86_64, arm64-v8a), \u4ee5\u540e\u4e0d\u5728\u652f\u6301 armeabi(\u5e02\u573a\u5360\u6709\u7387\u51e0\u4e4e\u4e3a0), \u51cf\u5c11\u7ea62.5M</li> <li>\u56fe\u7247\u76f8\u4f3c\u5ea6\u68c0\u6d4b\u7b97\u6cd5(\u91c7\u7528\u611f\u77e5\u54c8\u5e0c\u7b97\u6cd5 dHash), \u627e\u51fa\u56fe\u7247\u76ee\u5f55\u4e2d\u6240\u6709\u76f8\u540c\u7684\u56fe\u7247(\u6d77\u660e\u8ddd\u79bb = 0 , \u6b64\u5904\u7684\u6d77\u660e\u8ddd\u79bb\u53ef\u4ee5\u7406\u89e3\u4e3a\u76f8\u4f3c\u7a0b\u5ea6, \u503c\u8d8a\u5c0f\u8d8a\u76f8\u4f3c), \u51cf\u5c11\u7ea61.5M</li> <li>\u538b\u7f29\u56fe\u7247, \u91c7\u7528ImageOptim, \u6709\u635f\u538b\u7f2970%</li> <li>\u4f18\u5316\u4ee3\u7801\u6df7\u6dc6 , \u5c06\u4e4b\u524d\u672a\u6df7\u6dc6\u548c\u6df7\u6dc6\u529b\u5ea6\u4e0d\u591f\u7684\u7ec4\u4ef6, \u5c3d\u91cf\u6df7\u6dc6</li> <li>RN\u8d44\u6e90\u9884\u52a0\u8f7d , \u8282\u7ea6\u7ea61M, \u79fb\u9664\u65e0\u7528\u6ee4\u955c\u6587\u4ef6\u3002</li> </ul>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/","title":"\u6027\u80fd\u6709\u5173\u7684\u5173\u952e\u8bcd:\u5185\u5b58\uff0cANR\uff0c\u5361\u987f\uff0c\u8017\u7535\uff0c\u91cd\u65b0\u52a0\u8f7d","text":""},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_1","title":"\u76f8\u5173\u547d\u4ee4","text":"<ol> <li>top -m 20\uff0c\u5217\u51fa\u7cfb\u7edf\u4e2d top 20 \u8017 cpu \u7684\u8fdb\u7a0b\u4fe1\u606f\uff0c\u4f1a\u6301\u7eed\u66f4\u65b0</li> <li>adb shell dumpstate\uff0cdump \u51fa\u7cfb\u7edf\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5f53\u524d\u72b6\u6001\uff0c\u4e3b\u8981\u5206\u6790 anr \u76f8\u5173\u7684\u95ee\u9898</li> <li>adb shell dumpsys\uff0cdump \u51fa\u7cfb\u7edf\u4e2d\u6240\u5305\u542b\u7684\u6240\u6709 android \u76f8\u5173\u7684\u5b9e\u4f8b\uff0c\u6bd4\u5982\u6709\u54ea\u4e9b Provider\uff0c Activity \u6808\uff0c\u6ce8\u518c\u7684 receiver\uff0c\u8fdb\u7a0b\uff0c\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0cApp \u4fe1\u606f\u7b49</li> <li>adb shell dumpsys meminfo XXXX(\u5305\u540d)\uff0c\u6253\u5370\u51fa\u67d0\u4e2a apk \u5f53\u524d\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5</li> <li>MAT\uff0c\u7528\u6765\u5206\u6790\u5185\u5b58\u65b9\u9762\u7684\u6d88\u8017</li> <li>traceview\uff0c\u53ef\u4ee5\u5206\u6790\u7a0b\u5e8f\u8fd0\u884c\u7684\u4e00\u6bb5\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u51fd\u6570\u6240\u4f7f\u7528\u7684\u65f6\u95f4\u60c5\u51b5\u3002\u9700\u8981\u7684\u6253\u70b9\u51fd\u6570: Debug.startMethodTracing(); Debug.stopMethodTracing()</li> <li>ADT\u4e2d\u7684dump view hierarchy from UIAutomtor\uff0c\u8be5\u5de5\u5177\u53ef\u4ee5dump\u51fa\u5f53\u524d\u754c\u9762\u7684view\u5c42\u6b21\u7ed3\u6784\uff0c\u4e0d\u8fc7\u5b83\u4e0d\u4f1a\u663e\u793a\u81ea\u5b9a\u4e49\u7684 view \u7c7b\u540d\uff0c\u800c\u663e\u793a\u57fa\u7840\u7684\u51e0\u4e2a view \u76f8\u5173\u7684\u7c7b\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7\u5728 view \u4e0a\u8bbe\u7f6econtentDescription \u5c5e\u6027\u6765\u6307\u5b9a\u662f\u54ea\u4e2a view</li> <li>adb logcat + grep -i \"XXXX\", \u6309\u9700\u8f93\u51fa log \u4fe1\u606f</li> <li>adb shell ps | grep XXX\uff0c\u5bdf\u770b\u8fdb\u7a0b\u4fe1\u606f\uff0c\u53ef\u4ee5\u627e\u5230\u8fdb\u7a0b\u53f7</li> <li>\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e9b\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e9b\u547d\u4ee4\u653e\u5230~/.bashrc \u6587\u4ef6\u4e2d\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u4efb\u610f shell \u4e0b\u76f4\u63a5\u4f7f\u7528\u4e86\u3002\u6bd4\u5982:     10.1  \u5feb\u901f\u4ece\u5f53\u524d\u76ee\u5f55\u4e0b\u9012\u5f52\u67e5\u627e\u6587\u4ef6:\u4f8b\u5982:\u627e\u5230\u6587\u4ef6\u540d\u4e2d\u6709 Manager \u7684\u6587\u4ef6: ff manager</li> </ol> <pre><code>    function ff() {\n        find . | grep -i --color \"$@\" \n    }\n</code></pre> <pre><code>10.2 git \u5feb\u901f\u66f4\u65b0\u4ee3\u7801\uff0c\u4f8b\u5982:gpull\n</code></pre> <pre><code>function gpull(){\n    git pull --rebase \n}\n</code></pre> <pre><code>10.3 \u5bdf\u770b\u6570\u636e\u5e93\u4e2d\u5b58\u50a8 date \u7684 long \u578b\u5bf9\u5e94\u7684\u65f6\u95f4\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u4e2d\u5b58\u7684\u662f 1391334196940\uff0c\u53ef\u4ee5\u7528 dd @1391334196 (\u53bb\u9664\u539f\u503c\u7684\u540e\u4e09\u4f4d)\n</code></pre> <p>alias dd='date +\"%F,%T\" -d'</p> <pre><code>10.4 \u67e5\u770b\u5185\u5b58\uff0c\u6bd4\u5982:meminfo com.miui.miuilite\n</code></pre> <pre><code>function meminfo(){\n    adb shell dumpsys meminfo $1 \n}\n\n</code></pre> <pre><code>10.5 pull \u51fa\u67d0\u4e2a\u7a0b\u5e8f\u7684\u6570\u636e\u5e93\uff0c\u6bd4\u5982:pulldb com.miui.miuilite ~/tmp/tmp/\n</code></pre> <pre><code>\nfunction pulldb(){\n    adb pull /data/data/\"$1\"/databases $2\n}\n</code></pre> <ol> <li>\u9012\u5f52\u67e5\u627e\u4ece\u5f53\u524d\u76ee\u5f55\u5f00\u59cb\uff0c\u6587\u4ef6\u4e2d\u5305\u542b\u67d0\u4e9b\u5b57\u7b26\u4e32\u7684\u6240\u6709\u6587\u4ef6\u53ca\u5176\u6240\u5728\u884c:\u5927\u5c0f\u5199\u654f\u611f:grep -r \"XXXX\" . \u6216\u8005 \u5927\u5c0f\u5199\u4e0d\u654f\u611f:grep -i -r \"XXXX\" . Logcat \u4e2d\u6bd4\u8f83\u6709\u7528\u7684\u51e0\u4e2a\u53c2\u6570:</li> <li>adb logcat \u6253\u5370\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u53f7:adb logcat -v thread</li> <li>adb logcat \u6253\u5370\u8fdb\u7a0b\uff0c\u7ebf\u7a0b\u548c Tag: adb logcat -v threadtime</li> </ol> <p>\u8fd9\u4e24\u4e2a\u547d\u4ee4\u53ef\u4ee5\u628a\u8fdb\u7a0b\u53f7\u548c\u7ebf\u7a0b\u53f7\u6253\u5370\u51fa\u6765\uff0c\u518d\u7528\u4e0a grep\uff0c\u53ef\u4ee5\u6253\u5370\u51fa\u67d0\u4e2a\u8fdb\u7a0b\u8f93\u51fa\u7684\u6240\u6709 log\u3002\u8fd9\u4e2a\u5bf9 \u4e8e\u90a3\u4e9b log \u4fe1\u606f\u5f88\u591a\u7684\u624b\u673a\u4f1a\u5f88\u597d\u7528\u3002</p>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#anr_1","title":"ANR\u5206\u6790","text":"<p>ANR \u7684\u5206\u6790\u4e00\u822c\u9700\u8981\u4e24\u4e2a\u6587\u4ef6:\u53d1\u751f anr \u65f6\u7684 log \u6587\u4ef6\uff0c\u53d1\u751f anr \u65f6\u751f\u6210\u7684 trace \u6587\u4ef6\u3002trace \u6587\u4ef6\u53ef\u4ee5\u901a \u8fc7 adb shell dumpstate \u6765\u83b7\u53d6\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5230\u7cfb\u7edf\u7684/data/anr/\u76ee\u5f55\u83b7\u53d6</p> <ol> <li>Log \u6587\u4ef6:log \u6587\u4ef6\u4e2d\u641c\u7d22 anr\uff0c\u627e\u5230\u51fa\u73b0 anr \u65f6 cpu \u5728\u6bcf\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u770b\u770b\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u767e \u5206\u6bd4</li> <li>CPU usage from .. ago \u548c CPU usage from ... later \u4e4b\u95f4\u7684\u8868\u793a\u51fa\u73b0 anr \u4e4b\u524d\u7684 cpu \u4f7f\u7528\u60c5\u51b5\u3002 CPU usage from ... later \u4e4b\u540e\u7684\u8868\u793a\u51fa\u73b0 anr \u4e4b\u540e\u7684 cpu \u4f7f\u7528\u60c5\u51b5</li> <li>\u770b anr \u51fa\u73b0\u4e4b\u524d\u7684 cpu \u4f7f\u7528\u60c5\u51b5\u7684\"TOTAL:\"\u90e8\u5206\uff0c\u5982\u679c\u63a5\u8fd1 100%\uff0c\u5219\u8868\u793a\u662f\u7531\u4e8e cpu \u4f7f\u7528\u8fc7\u591a\uff0c \u9965\u997f\u6240\u81f4\u3002\u5982\u679c\u79bb 100%\u76f8\u5dee\u5f88\u5927\uff0c\u5219\u53ef\u80fd\u662f UI \u7ebf\u7a0b\u51fa\u73b0\u6b7b\u9501\u6240\u81f4</li> <li>Trace \u6587\u4ef6:trace \u6587\u4ef6\u751f\u6210\u65b9\u6cd5:adb shell dumpsate &gt; ~/temp/trace.txt</li> <li>trace \u6587\u4ef6\u4e2d\u627e\u5230\u201cCmd line: \u8fdb\u7a0b\u540d\u201d\u7684\u90e8\u5206\uff0c\u770b\u770b\u81ea\u5df1\u8fdb\u7a0b\u4e2d\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5f53\u524d\u72b6\u6001\u3002</li> <li>tid=1 \u7684\u4e3a UI \u7ebf\u7a0b\uff0c\u770b\u770b\u5b83\u7684\u72b6\u6001\u3002\u5982\u679c\u662f blocked \u6216\u8005 wait on\uff0c\u5219\u8868\u793a\u88ab\u9501\u4f4f\u4e86\uff0c\u770b\u770b\u9501\u5728\u54ea \u91cc\u3002\u5982\u679c\u662f Suspend\uff0c\u5219\u8868\u793a\u88ab\u6302\u8d77\u4e86</li> <li>\u5982\u679c UI \u7ebf\u7a0b\u6ca1\u88ab\u9501\u4f4f\uff0c\u800c\u662f\u505c\u5728\u67d0\u4e2a\u51fd\u6570\u8c03\u7528\u4e0a\uff0c\u5219\u8bf4\u660e\u8be5\u51fd\u6570\u8f83\u8017\u65f6\u3002\u53ef\u4ee5\u8bbe\u6cd5\u5c06\u8be5\u51fd\u6570\u653e\u5230 \u975eUI\u7ebf\u7a0b\u3002</li> <li>\u5982\u679c UI \u7ebf\u7a0b\u4e2d\u7684\u51fd\u6570\u6ca1\u88ab\u9501\u4f4f\uff0c\u4e14\u4e0d\u662f\u8017\u65f6\u51fd\u6570\uff0c\u800c\u4e14\u6bcf\u6b21 dump \u65f6\u90fd\u5728\u8fd9\u6bb5\u4ee3\u7801\u9644\u8fd1\uff0c\u4e14\u8fdb\u7a0b \u603b\u662f\u5360\u5927\u91cf\u7684 cpu\uff0c\u5219\u53ef\u80fd\u662f\u8be5\u51fd\u6570\u9644\u8fd1\u51fa\u73b0\u4e86\u6b7b\u5faa\u73af\u3002</li> </ol>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_2","title":"\u5185\u5b58\u5206\u6790","text":"<p>\u4f7f\u7528 MAT \u7684\u597d\u5904 1. MAT \u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u67d0\u4e2a\u8fdb\u7a0b\u4e2d\u6240\u6709\u7684\u5bf9\u8c61\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u5bf9\u8c61\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u800c\u4e14\u9488\u5bf9\u6bcf\u4e2a\u5bf9\u8c61\uff0cMAT \u53ef\u4ee5\u627e\u51fa\u5bf9\u8be5\u5bf9\u8c61\u7684\u6240\u6709\u5f15\u7528\uff0c\u56de\u6536\u8def\u5f84\u7b49\u3002 2. \u53ef\u4ee5\u627e\u51fa\u6bcf\u4e2a\u7c7b\u521b\u5efa\u4e86\u591a\u5c11\u4e2a\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u5360\u4e86\u591a\u5c11\u5185\u5b58\u3002MAT \u4e2d\u53ef\u4ee5\u901a\u8fc7\u7c7b\u540d\u6216\u5305\u540d\u6765\u8fc7 \u6ee4\uff0c\u4e5f\u53ef\u4ee5\u6309\u5360\u7528\u5185\u5b58\u7684\u5927\u5c0f\u6765\u6392\u5e8f\u7b49\u3002 3. \u53ef\u4ee5\u8fdb\u884c\u5185\u5b58\u6cc4\u9732\u7684\u5206\u6790\uff0c\u6bd4\u5982\u5982\u679c\u786e\u5b9a\u5728\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u67d0\u4e2a\u7c7b\u53ea\u80fd\u6709\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5982\u679c\u6709\u591a\u4e2a\u4e86\uff0c\u5219 \u53ef\u4ee5\u5224\u65ad\u51fa\u4e4b\u524d\u7684\u90a3\u4e2a\u6ca1\u6709\u88ab\u91ca\u653e\u3002\u6bd4\u5982\u5207\u6362\u8bed\u8a00\u6216\u6a2a\u7ad6\u5c4f\u5207\u6362\u65f6 activity \u6cc4\u9732</p> <p>\u4f7f\u7528 MAT \u6765\u5206\u6790\u67d0\u4e2a\u64cd\u4f5c\u5bfc\u81f4\u7684\u5185\u5b58\u53d8\u5316\u3002\u6b65\u9aa4: 1. \u64cd\u4f5c\u524d\uff0c\u5148 dump \u51fa hprof file\uff0c\u6bd4\u5982\u540d\u79f0\u4e3a hprof1 2. \u64cd\u4f5c\u540e\uff0cdump \u51fa hprof file\uff0c\u6bd4\u5982\u540d\u79f0\u4e3a hprof2 3. \u627e\u5230 hprof1 \u4e2d\u6240\u6709\u7684 bitmap(\u5148\u641c\u7d22 Bitmap \u5bf9\u8c61\uff0c\u7136\u540e\u9009\u62e9 list object -&gt; with incoming references)\uff0c\u4ea7\u751f\u6587\u4ef6 hprof1_bitmap_object 4. \u627e\u5230 hprof2 \u4e2d\u6240\u6709\u7684 bitmap(\u5148\u641c\u7d22 Bitmap \u5bf9\u8c61\uff0c\u7136\u540e\u9009\u62e9 list object -&gt; with incoming references)\uff0c\u4ea7\u751f\u6587\u4ef6 hprof2_bitmap_object 5. \u5bf9 hprof1_bitmap_object \u8fdb\u884c Export to TXT\uff0c\u4fdd\u5b58\u6587\u4ef6 before.txt 6. \u5bf9 hprof2_bitmap_object \u8fdb\u884c Export to TXT\uff0c\u4fdd\u5b58\u6587\u4ef6 after.txt 7. \u4f7f\u7528 linux \u7684 diff \u547d\u4ee4:diff before.txt after.txt 8. diff \u547d\u4ee4\u5217\u51fa\u65b0\u589e\u7684 Bitmap \u5bf9\u8c61\u4fe1\u606f:\u6bd4\u5982: &lt; android.graphics.Bitmap @ 0x42a29e90| 48 | 147,520 9. ... 10. &gt; android.graphics.Bitmap @ 0x4177cf40|  48 | 100,304 11.  12. \u6839\u636e\u5217\u51fa\u7684\u5bf9\u8c61\u503c\uff08\u6bd4\u5982\uff1a0x42a29e90\uff09\uff0c\u5bf9\u4e8e\u65b0\u589e\u7684\u5bf9\u8c61 0x42a29e90 \u5230 hprof2 \u4e2d\u901a\u8fc7Find Object by Address(\u653e\u5927\u955c\u6309\u94ae)\u641c\u7d22\u51fa\u8be5\u5bf9\u8c61 A 13. \u67e5\u770b A \u7684 gc \u8def\u5f84:Path to GC Roots -&gt; exclude weak/soft references \u5c31\u53ef\u4ee5\u627e\u5230 Bitmap \u5bf9\u8c61 A \u7684\u5f15\u7528\u60c5\u51b5</p>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_3","title":"\u8017\u7535\u5206\u6790","text":"<ul> <li>CPU\u65b9\u9762</li> <li>\u53ef\u4ee5\u901a\u8fc7 top \u547d\u4ee4\u89c2\u5bdf\u4e00\u6bb5\u65f6\u95f4\u5185\u54ea\u4e9b\u8fdb\u7a0b\u5360\u7528 cpu \u6bd4\u8f83\u591a\uff0c\u5728\u4ec0\u4e48\u64cd\u4f5c\u6216\u73af\u5883\u4e0b\u4f1a\u589e\u5927\uff0c\u4ec0\u4e48\u65f6 \u5019\u4e0b\u964d\u3002\u6700\u597d\u7ed3\u5408 log\uff0c\u6548\u679c\u4f1a\u66f4\u597d\u3002</li> <li>\u786e\u5b9a\u8fdb\u7a0b\u540e\uff0c\u518d\u7ed3\u5408\u64cd\u4f5c/\u73af\u5883\u53d8\u5316/log \u4fe1\u606f\u7b49\uff0c\u5927\u4f53\u731c\u51fa cpu \u6d88\u8017\u4e3b\u8981\u4ea7\u751f\u5728\u54ea\u4e2a\u6a21\u5757\u6216\u54ea\u4e2a\u529f \u80fd\u3002</li> <li>\u7f29\u5c0f\u8303\u56f4\u540e\uff0c\u7136\u540e\u5c31\u624b\u52a8\u52a0 log \u4e86\u3002log \u4e3b\u8981\u7528\u6765\u6253\u5370\u51fa\u67d0\u4e2a\u51fd\u6570\u6216\u4ee3\u7801\u6bb5\u8fd0\u884c\u65f6\u6d88\u8017\u7684\u65f6\u95f4\u3002</li> <li>\u5982\u679c\u60f3\u77e5\u9053\u8fd9\u4e2a\u51fd\u6570\u4ece\u54ea\u91cc\u8c03\u8fc7\u6765\u7684\uff0c\u53ef\u4ee5\u7528 Log.(TAG, msg, new Exception())\u6253\u5370\u51fa\u8c03\u7528\u6808\u3002\u5bf9 \u4e8e\u653e\u5728\u4e00\u4e9b\u7ebf\u7a0b\u4e2d\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u901a\u8fc7\u8fd9\u4e2a\u8c03\u7528\u6808\u53ef\u80fd\u8fd8\u65e0\u6cd5\u627e\u5230\u8c03\u7528\u7684\u6839\u7ed3\u70b9\uff0c\u53ef\u4ee5\u5728\u8be5\u7ebf\u7a0b\u4e0a\u4e00 \u5c42\u8c03\u7528\u7684\u5730\u65b9\u518d\u6253\u5370\u8c03\u7528\u6808\u3002</li> <li> <p>\u5728\u5f85\u673a\u60c5\u51b5\u4e0b\uff0c\u9891\u7e41\u7684\u5bf9 cpu \u8fdb\u884c wake up \u4f1a\u6bd4\u8f83\u8017\u7535:\u53ef\u4ee5\u901a\u8fc7 adb shell dumpsys \u547d\u4ee4\u627e\u51fa\u5f53 \u524d\u6ce8\u518c\u4e86\u54ea\u4e9b alarm \u4ee5\u53ca alarm \u7684\u7c7b\u578b\uff0c\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528\u7cfb\u7edf\u7761\u7720\u72b6\u6001\u4e0b\u5524\u9192\u7cfb\u7edf\u7684\u7c7b\u578b</p> </li> <li> <p>\u5c4f\u5e55\u65b9\u9762 \u5c4f\u5e55\u7684\u8017\u7535\u4e3b\u8981\u662f\u754c\u9762\u5237\u65b0\u6240\u81f4\uff0c\u53ef\u4ee5\u5728\u5f00\u53d1\u8005\u6a21\u5f0f\u4e0b\u6253\u5f00\u201c\u663e\u793a\u9762(surface)\u66f4\u65b0\u201d\u5f00\u5173\u540e\uff0c\u518d\u89c2 \u5bdf\u6240\u6709\u754c\u9762\u4e0b\uff0c\u5728\u6ca1\u6709\u64cd\u4f5c\u548c\u52a8\u753b\u65f6\uff0c\u662f\u5426\u6709\u754c\u9762\u5237\u65b0\uff0c\u5982\u679c\u6709\uff0c\u5c3d\u91cf\u5173\u95ed\u8fd9\u4e9b\u4e0d\u5fc5\u8981\u7684\u5237\u65b0\u3002</p> </li> </ul>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_4","title":"\u91cd\u65b0\u52a0\u8f7d\u5206\u6790\u65b9\u6cd5","text":"<ol> <li>\u5c3d\u91cf\u627e\u51fa\u54ea\u79cd\u60c5\u51b5\u4e0b\u4f1a\u51fa\u73b0\u91cd\u65b0\u52a0\u8f7d\uff0c\u8fdb\u884c\u64cd\u4f5c\u901a\u8fc7\u89c2\u5bdf log \u7684\u65b9\u5f0f\u6765\u627e\u89c4\u5f8b:\u5982\u679c\u662f\u8fdb\u7a0b\u88ab kill, \u53ef\u4ee5\u901a\u8fc7 adb logcat | grep ActivityManager \u6765\u89c2\u5bdf\u8fdb\u7a0b\u7684\u53d8\u5316\u60c5\u51b5\u3002\u5982\u679c\u662f\u81ea\u5df1\u7684 activity \u88ab destory\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0 log \u7684\u65b9\u5f0f\u6765\u770b\u3002</li> <li>\u901a\u8fc7 adb shell dumpsys \u628a\u5f53\u524d\u7cfb\u7edf\u4e2d\u7684 activity \u7b49\u4fe1\u606f dump \u51fa\u6765\u540e\uff0c\u5206\u6790\u81ea\u5df1\u7684 activity \u7684\u4e00\u4e9b \u72b6\u6001\uff0c\u5c24\u5176\u5173\u6ce8\u201cProcesses in Current Activity Manager State:\u201d\u90e8\u5206\u91cc\u7684\u4fe1\u606f\u3002\u8fd9\u91cc\u9762\u7684\u4fe1\u606f\u5bf9\u5206 \u6790\u7531\u4e8e lowmemorykiller \u5bfc\u81f4\u7684\u52a0\u8f7d\u5f88\u6709\u5e2e\u52a9\u3002</li> </ol> <p>\u8fdb\u7a0b\u88ab kill \u6709\u5982\u4e0b\u539f\u56e0: 1. restartPackage \u5bfc\u81f4\u8be5 apk \u4e2d\u7684\u6240\u6709 process \u90fd\u88ab kill 2. lowmemorykiller\u673a\u5236 3. sd \u5361 unmount \u65f6\uff0c\u5982\u679c\u67d0\u4e2a\u8fdb\u7a0b\u4e2d\u6709\u6253\u5f00 sd \u5361\u4e2d\u67d0\u4e2a\u6587\u4ef6\u800c\u6ca1\u6709\u5173\u95ed\u65f6\uff0c\u8be5\u8fdb\u7a0b\u4f1a\u88ab kill 4. \u5f53 A \u8fdb\u7a0b\u88ab kill \u65f6\uff0c\u5982\u679c\u6709 B \u8fdb\u7a0b\u901a\u8fc7 ContentProvider \u673a\u5236\u4e0e A \u6709\u8fde\u63a5\uff0c\u5219 B \u8fdb\u7a0b\u4e5f\u4f1a\u88ab kill 5. \u4e09\u661f\u6709\u4e9b\u624b\u673a\u4e0a\uff0c\u8c03\u7528\u4e00\u952e\u6e05\u7406\u540e\uff0c\u518d\u6253\u5f00\u6e05\u7406\u7684\u5e94\u7528\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u6216\u8005\u518d\u56de\u684c\u9762\u65f6\u684c\u9762\u91cd\u65b0\u52a0 \u8f7d\u3002\u89e3\u51b3\u65b9\u6848:\u684c\u9762\u8fdb\u7a0b\u4e2d\u8981\u6709 service\uff0c\u4e0d\u4e00\u5b9a\u975e\u5f97\u662f forground service</p>"},{"location":"PerformanceOptimization/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/#_5","title":"\u5361\u987f\u5206\u6790","text":"<ol> <li>\u6253\u5f00\u5e27\u7387\uff0c\u5982\u679c\u53ea\u89c2\u5bdf\u81ea\u5df1\u7a0b\u5e8f\u7684\u5e27\u7387\u53d8\u5316\uff0c\u53ef\u4ee5\u5728\u81ea\u5df1\u7684 view \u4e0a draw \u51fa\u6765\u6216\u8005\u901a\u8fc7 log \u7684\u5f62\u5f0f \u6253\u5370\u51fa\u6765</li> <li>\u5982\u679c\u8981\u89c2\u5bdf\u5176\u4ed6\u7a0b\u5e8f\u7684\u5e27\u7387\u53d8\u5316\uff0c\u5fc5\u8981\u7684\u8bdd\u81ea\u5df1\u53ef\u4ee5\u7f16\u4e2a\u7cfb\u7edf\uff0c\u7f16\u8bd1\u524d\u628a\u7cfb\u7edf\u7684\u5e27\u7387\u663e\u793a\u5f00\u5173\u6253 \u5f00\u3002\u5177\u4f53\u5728:framework \u4e0b ViewRootImpl.java \u4e0b\u7684 DEBUG_FPS \u5f00\u5173\u6253\u5f00\u5373\u53ef\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u7bc7 \u6587\u7ae0\u4ecb\u7ecd\u7684\u65b9\u6cd5(\u4e0d\u8fc7\u6211\u8fd8\u6ca1\u6709\u4eb2\u81ea\u8bd5\u8fc7): http://blog.csdn.net/jinzhuojun/article/details/10428435</li> <li>\u5bf9\u4e8e\u754c\u9762\u64cd\u4f5c\u7684\u5361\u987f\uff0c\u53ef\u4ee5\u901a\u8fc7 adb logcat | grep \"dalvikvm\"\uff0c\u89c2\u5bdf\u5728\u64cd\u4f5c\u65f6\u6709\u5173 dalvikvm-heap \u548c gc \u76f8\u5173\u7684\u4fe1\u606f\uff0c\u5982\u679c\u5b58\u5728\u8bf4\u660e\u6709 bitmap \u7b49\u76f8\u5173\u7684\u5927\u5757\u5185\u5b58\u7533\u8bf7\u548c\u91ca\u653e\uff0c\u8fd9\u79cd\u5728\u754c\u9762\u64cd\u4f5c\u65f6\u5c3d\u91cf \u907f\u514d\u624d\u662f</li> <li>\u754c\u9762\u5c42\u6570:\u5c42\u6570\u8d8a\u591a\uff0c\u753b\u8fd9\u4e00\u5c4f\u65f6\u9700\u8981\u65f6\u95f4\u5c31\u8d8a\u591a\uff0c\u5c3d\u91cf\u51cf\u5c11\u5c42\u6570\u3002\u53ef\u4ee5\u901a\u8fc7 hierarchyviewer \u6765 \u5206\u6790\u3002\u540c\u65f6\u9700\u8981\u6ce8\u610f window \u76f8\u5173\u7684 flag \u548c windowWallpaper \u7b49\u3002</li> </ol>"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u53163/5 -- \u7a33\u5b9a\u6027\u4f18\u5316","text":"<ul> <li>Java\u5c42Crash\u76d1\u63a7</li> <li>Native\u5c42Crash\u76d1\u63a7</li> <li>ANR \u5206\u6790</li> </ul>"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/#javacrash","title":"Java\u5c42Crash\u76d1\u63a7","text":"<p>\u8fd9\u4e2a\u6bd4\u8f83\u7b80\u5355\uff0c\u6ce8\u518c\u4e00\u4e2aUncaughtExceptionHandler\uff0c\u53d1\u751fcrash\u65f6\uff0c\u8be5Handler\u4f1a\u6355\u83b7\u5f02\u5e38\u3002/Users/hai/Documents/Document/my_blog/KnowledgeSummary/README.md</p> <p>\u56e0\u4e3a\u5e94\u7528\u5df2\u7ecf\u53d1\u751f\u5f02\u5e38\uff0c\u6240\u4ee5\u6355\u83b7\u5f02\u5e38\u540e\u53ef\u4ee5\u5148\u4fdd\u5b58\u5728\u672c\u5730\uff0c\u7b49\u4e0b\u6b21\u5e94\u7528\u542f\u52a8\u4e14\u7f51\u7edc\u6b63\u5e38\u65f6\uff0c\u624d\u53d1\u5230\u5206\u6790\u5e73\u53f0\u3002</p>"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/#nativecrash","title":"Native\u5c42Crash\u76d1\u63a7","text":"<p>Native\u5c42\u53d1\u751fcrash\u65f6\uff0c\u4f1a\u901a\u8fc7\u4fe1\u53f7\u673a\u5236\uff08\u4e00\u79cd\u91cd\u8981\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u673a\u5236\uff09\u4f20\u9012\u5f02\u5e38\u4fe1\u606f\uff0c\u5373Linux\u5185\u6838\u4f1a\u751f\u6210\u9519\u8bef\u4fe1\u53f7\u5e76\u901a\u77e5\u5f53\u524d\u8fdb\u7a0b\u3002\u5e94\u7528\u8fdb\u7a0b\u63a5\u6536\u5230\u9519\u8bef\u4fe1\u53f7\u540e\uff0c\u53ef\u4ee5\u6355\u83b7\u8be5\u4fe1\u53f7\u5e76\u6267\u884c\u5bf9\u5e94\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u3002</p> <p>Linux\u6709\u4e00\u7c7b\u4e13\u95e8\u7528\u4e8e\u63cf\u8ff0Crash\u7684\u4fe1\u53f7\uff0c\u5176\u4e2d\uff0c\u5728Android\u7cfb\u7edf\u4e0a\uff0cNative\u5c42\u6700\u5e38\u89c1\u7684\u5bfc\u81f4Crash\u7684\u4fe1\u53f7\u91cf\u5982\u4e0b\uff1a</p> \u4fe1\u53f7 \u4e00\u822c\u5bfc\u81f4\u6b64\u9519\u8bef\u7684\u539f\u56e0 SIGILL \u6267\u884c\u4e86\u975e\u6cd5\u6307\u4ee4\u3001\u53ef\u6267\u884c\u6587\u4ef6\u51fa\u9519\u3001\u5806\u6808\u6ea2\u51fa\u7b49\u60c5\u51b5 SIGABRT \u8c03\u7528abort\u51fd\u6570\u751f\u6210 SIGBUS \u8bbf\u95ee\u975e\u6cd5\u5730\u5740\uff0c\u5305\u62ec\u5185\u5b58\u5730\u5740\u5bf9\u9f50\uff08alignment\uff09\u51fa\u9519 SIGFPE \u7b97\u672f\u8fd0\u7b97\u9519\u8bef\uff0c\u5982\u6ea2\u51fa\u6216\u96640\u7b49 SIGSEGV \u8bbf\u95ee\u4e0d\u5c5e\u4e8e\u81ea\u5df1\u7684\u5b58\u50a8\u7a7a\u95f4\u6216\u8bbf\u95ee\u53ea\u8bfb\u5b58\u50a8\u7a7a\u95f4 SIGPIPE \u7ba1\u9053\u5f02\u5e38\u3002\u901a\u5e38\u5728\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65f6\u4ea7\u751f"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/#anr","title":"ANR \u5206\u6790","text":"<p>ANR\uff0c\u5373Application not responding\uff0c\u5e94\u7528\u65e0\u54cd\u5e94\u3002</p>"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/#3anr","title":"\u5e38\u89c13\u79cdANR\u7c7b\u578b\uff1a","text":"<p>1.KeyDispatch Timeout</p> <p>\u6700\u5e38\u89c1\uff0c\u5e94\u7528\u5bf9\u8f93\u5165\u4e8b\u4ef65\u79d2\u5185\u65e0\u54cd\u5e94\uff0c\u6bd4\u5982\u6309\u952e\u3001\u89e6\u6478\u3002</p> <p>2.Broadcast Timeout</p> <p>\u5e7f\u64ad\u63a5\u6536\u5668\u5728\u6307\u5b9a\u65f6\u95f4\u5185\uff08\u7cfb\u7edf\u9ed8\u8ba410\u79d2\uff09\u6ca1\u6709\u5904\u7406\u5b8c\uff0c\u4e14\u6ca1\u6709\u7ed3\u675f\u6267\u884conReceive()\u3002</p> <p>3.Service Timeout</p> <p>\u51fa\u73b0\u6982\u7387\u8f83\u5c0f\u3002\u662f\u6307Service\u5728\u6307\u5b9a\u65f6\u95f4\u5185\uff08\u7cfb\u7edf\u9ed8\u8ba420\u79d2\uff09\u6ca1\u6709\u5904\u7406\u5b8c\u3002</p>"},{"location":"PerformanceOptimization/%E7%A8%B3%E5%AE%9A%E6%80%A7%E4%BC%98%E5%8C%96/#anr-log","title":"ANR log","text":"<p>\u5173\u952e\u8bcd\u89e3\u91ca\uff1a</p> <ul> <li>ANR in: \u53d1\u751fANR\u7684\u5177\u4f53\u7c7b</li> <li>PID: \u53d1\u751fANR\u7684\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u6b64\u65f6\u4f1a\u751f\u6210trace\u6587\u4ef6</li> <li>Reason: \u53d1\u751fANR\u7684\u539f\u56e0</li> <li>CPU usage: CPU\u4f7f\u7528\u60c5\u51b5</li> </ul> <p>log \u793a\u4f8b\uff1a</p> <pre><code>ANR in com.utils.myapplication (com.utils.myapplication/.MainActivity)\n\n PID: 30234\n\n Reason: Input dispatching timed out (com.utils.myapplication/com.utils.myapplication.MainActivity, Waiting to send non-key event because the touched window has not finished processing certain input events that were delivered to it over 500.0ms ago.  Wait queue length: 4.  Wait queue head age: 6125.4ms.)\n\n Load: 6.74 / 6.71 / 6.8\n\n CPU usage from 278670ms to 0ms ago (2018-03-26 20:26:47.043 to 2018-03-26 20:31:25.712):\n   4.8% 1526/system_server: 2.9% user + 1.8% kernel / faults: 25652 minor 3 major\n   2.2% 575/surfaceflinger: 0.9% user + 1.2% kernel / faults: 13 minor\n   2% 10531/logd: 2% user + 0% kernel / faults: 81 minor\n   0.9% 736/adbd: 0.1% user + 0.7% kernel / faults: 7917 minor\n   0.9% 2249/com.android.systemui: 0.6% user + 0.2% kernel / faults: 210 minor\n   0.8% 29537/kworker/u8:6: 0% user + 0.8% kernel\n   0.6% 18098/com.tencent.mobileqq: 0.3% user + 0.3% kernel / faults: 308 minor\n   0.6% 402/msm-core:sampli: 0% user + 0.6% kernel\n   0.6% 22978/kworker/u8:5: 0% user + 0.6% kernel\n   0.6% 25159/kworker/u8:3: 0% user + 0.6% kernel\n   0.5% 3/ksoftirqd/0: 0% user + 0.5% kernel\n   0.4% 12/ksoftirqd/1: 0% user + 0.4% kernel\n   0.4% 5160/mdss_fb0: 0% user + 0.4% kernel\n   0.4% 7/rcu_preempt: 0% user + 0.4% kernel\n   0.4% 2199/VosMCThread: 0% user + 0.4% kernel\n   0.4% 589/mm-pp-dpps: 0.1% user + 0.2% kernel\n   0.3% 1//init: 0.1% user + 0.1% kernel / faults: 2675 minor\n   0.3% 23831/kworker/0:4: 0% user + 0.3% kernel\n   0.3% 41/smem_native_rpm: 0% user + 0.3% kernel\n   0.2% 5279/perfd: 0.1% user + 0.1% kernel / faults: 2 minor\n   0.2% 22527/kworker/0:1: 0% user + 0.2% kernel\n   0.2% 2813/mcd: 0.1% user + 0% kernel\n   0.2% 323/cfinteractive: 0% user + 0.2% kernel\n   0.2% 574/servicemanager: 0% user + 0.1% kernel\n   0.2% 1699/com.tencent.mobileqq:MSF: 0.1% user + 0% kernel / faults: 132 minor\n   0.2% 747/thermal-engine: 0% user + 0.1% kernel\n   0.1% 18885/com.tencent.mobileqq:TMAssistantDownloadSDKService: 0.1% user + 0% kernel / faults: 260 minor\n   0.1% 2586/wpa_supplicant: 0% user + 0% kernel / faults: 5 minor\n   0.1% 29566/kworker/0:2: 0% user + 0.1% kernel\n   0.1% 25031/kworker/1:1: 0% user + 0.1% kernel\n   0.1% 804/qfp-daemon: 0% user + 0% kernel / faults: 23 minor\n   0.1% 32581/com.tencent.mm: 0% user + 0% kernel / faults: 323 minor\n   0% 2887/com.miui.home: 0% user + 0% kernel / faults: 1288 minor\n   0% 5249/logcat: 0% user + 0% kernel\n   0% 790/cnss-daemon: 0% user + 0% kernel\n   0% 29239/kworker/u8:0: 0% user + 0% kernel\n   0% 46/irq/260-cpr3: 0% user + 0% kernel\n   0% 2197/wlan_logging_th: 0% user + 0% kernel\n   0% 32534/com.tencent.mm:push: 0% user + 0% kernel / faults: 171 minor\n   0% 16/ksoftirqd/2: 0% user + 0% kernel\n   0% 25216/kworker/1:2: 0% user + 0% kernel\n   0% 781/netd: 0% user + 0% kernel / faults: 943 minor\n   0% 10780/com.miui.analytics: 0% user + 0% kernel / faults: 245 minor\n   0% 27/dsps_smd_trans_: 0% user + 0% kernel\n   0% 726/jbd2/dm-1-8: 0% user + 0% kernel\n   0% 468/perfd: 0% user + 0% kernel / faults: 10 minor\n   0% 3049/com.miui.daemon: 0% user + 0% kernel / faults: 198 minor\n   0% 3123/com.miui.whetstone: 0% user + 0% kernel / faults: 38 minor 1 major\n   0% 26520/kworker/3:4: 0% user + 0% kernel\n   0% 20/ksoftirqd/3: 0% user + 0% kernel\n   0% 2456/com.android.phone: 0% user + 0% kernel / faults: 25 minor\n   0% 3257/com.miui.securitycenter.remote: 0% user + 0% kernel / faults: 153 minor 1 major\n   0% 3545/com.miui.powerkeeper:service: 0% user + 0% kernel / faults: 24 minor\n   0% 656/sensors.qcom: 0% user + 0% kernel / faults: 56 minor\n   0% 967/rild: 0% user + 0% kernel / faults: 17 minor\n   0% 1115/com.android.defcontainer: 0% user + 0% kernel / faults: 607 minor\n   0% 2836/irq/22-408000.q: 0% user + 0% kernel\n   0% 4022/com.xiaomi.metoknlp: 0% user + 0% kernel / faults: 187 minor\n   0% 29821/com.xiaomi.market: 0% user + 0% kernel / faults: 359 minor\n   0% 807/time_daemon: 0% user + 0% kernel / faults: 20 minor\n   0% 2946/com.xiaomi.xmsf: 0% user + 0% kernel / faults: 12 minor\n   0% 3068/com.android.nfc: 0% user + 0% kernel\n\n</code></pre>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u53161/5 -- \u7ed8\u5236\u4f18\u5316","text":"<ul> <li>Android\u7cfb\u7edf\u663e\u793a\u539f\u7406</li> <li>\u5e03\u5c40\u4f18\u5316</li> <li>\u907f\u514d\u8fc7\u5ea6\u7ed8\u5236</li> <li>\u542f\u52a8\u4f18\u5316</li> <li>\u5408\u7406\u5237\u65b0\u673a\u5236</li> <li>\u63d0\u5347\u52a8\u753b\u6027\u80fd</li> <li>\u6ed1\u52a8\u5361\u987f</li> <li>\u5de5\u5177\u7bc7</li> </ul> <p>\u6587\u5b57\u9884\u6e32\u67d3</p>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#android","title":"Android\u7cfb\u7edf\u663e\u793a\u539f\u7406","text":"<p>\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5e94\u7528\u5c42\u901a\u8fc7Measure\u3001Layout\u3001Draw\uff0c\u4ea7\u751fSurface\u7f13\u5b58\u6570\u636e\u3002\u7136\u540e\u901a\u8fc7\u8fdb\u7a0b\u95f4\u901a\u4fe1(\u533f\u540d\u5171\u4eab\u5185\u5b58 SharedClient)\uff0c\u628a\u7f13\u5b58\u6570\u636e\u4ea4\u7ed9\u7cfb\u7edf\u5c42\uff0c\u5229\u7528SurfaceFlinger\u628a\u6570\u636e\u6e32\u67d3\u5230\u5c4f\u5e55\u3002</p> <p>Android\u7684\u56fe\u5f62\u663e\u793a\u7cfb\u7edf\u91c7\u7528Client/Server\u67b6\u6784\u3002\u5176\u4e2d\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u662fClient\uff0c\u7cfb\u7edf\u662fServer\u3002</p> <p>\u6bcf\u4e2a\u5e94\u7528\u548cSurfaceFlinger\u4e4b\u95f4\uff0c\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2aSharedClient\uff0c\u5373\u4e00\u4e2aSharedClient\u5bf9\u5e94\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u3002\u800c\u6bcf\u4e2aSharedClient\u4e2d\uff0c\u6700\u591a\u53ef\u521b\u5efa31\u4e2aSharedBufferStack\uff0c\u5373SharedClient\u5305\u542bSharedBufferStack\u7684\u96c6\u5408\u3002\u5176\u4e2d\uff0c\u6bcf\u4e2aSurface\u90fd\u5bf9\u5e94\u4e00\u4e2aSharedBufferStack\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2aWindow\u3002\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u540c\u65f6\u505a\u591a\u5305\u542b31\u4e2a\u7a97\u53e3\u3002</p> <p></p> <p>\u8981\u63d0\u9ad8\u663e\u793a\u9875\u9762\u663e\u793a\u6548\u7387\uff0c\u4e00\u822c\u6709\u4e24\u4e2a\u624b\u6bb5\uff1a</p> <ol> <li>\u51cf\u5c11\u5e03\u5c40\u5c42\u7ea7\uff0c\u5373\u5e03\u5c40\u4f18\u5316</li> <li>\u907f\u514d\u8fc7\u5ea6\u7ed8\u5236</li> </ol>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_1","title":"\u5e03\u5c40\u4f18\u5316","text":""},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_2","title":"\u68c0\u6d4b\u5de5\u5177","text":"<p>1.Hierarchy Viewer</p> <p>Tools -&gt; Android -&gt; Android Device Monitor\u4e2d\uff0c\u6253\u5f00Hierarchy Viewer\u3002 \u53ef\u76d1\u6d4b\u5bf9\u7a0b\u5e8f\u5f53\u524d\u9875\u9762\u5e03\u5c40\u60c5\u51b5\u3002\u53ef\u67e5\u770b\u5e03\u5c40\u7684\u5c42\u7ea7\u548c\u6bcf\u4e2a\u8282\u70b9\u7684\u8017\u65f6\u60c5\u51b5\u3002</p> <p>2.Android Lint</p> <p>\u626b\u63cf\u89c4\u5219\u548c\u7f3a\u9677\u7ea7\u522b\u53ef\u5728 File-&gt;Settings-&gt;Inspections-&gt;Android Lint \u4e2d\u914d\u7f6e\u3002</p> <p>\u914d\u7f6e\u9879\uff1a</p> <ul> <li>TooDeepLayout: \u8868\u793a\u5e03\u5c40\u592a\u6df1\uff0c\u9ed8\u8ba4\u8d85\u8fc710\u5c42\u63d0\u793a\uff1b</li> <li>TooManyViews: \u63a7\u4ef6\u592a\u591a\uff0c\u9ed8\u8ba4\u8d85\u8fc780\u4e2a\u63a7\u4ef6\u4f1a\u63d0\u793a\u8be5\u95ee\u9898\uff1b</li> </ul> <p>\u542f\u52a8lint\u540e\uff0cStudio\u4f1a\u7ed9\u51fa\u626b\u63cf\u7ed3\u679c\u3002\u6839\u636e\u7ed3\u679c\u4f18\u5316\u5bf9\u5e94\u5e03\u5c40\u6587\u4ef6\u5373\u53ef\u3002</p>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_3","title":"\u4f18\u5316\u65b9\u6cd5","text":"<p>\u53ef\u4ece3\u4e2a\u65b9\u9762\u4f18\u5316\u5e03\u5c40\u3002</p> <p>1.\u51cf\u5c11\u5e03\u5c40\u5c42\u7ea7</p> <p>\u53ef\u4ee5\u4f7f\u7528 merge \u6807\u7b7e\u3001RelativeLayout\u6216ConstraintLayout\u7b49\u3002\u5f88\u7b80\u5355\uff0c\u4e0d\u7528\u7ec6\u8bf4\u3002</p> <p>2.\u63d0\u9ad8\u663e\u793a\u901f\u5ea6</p> <p>\u53ef\u4ee5\u4f7f\u7528ViewStub\uff0c\u521d\u59cb\u72b6\u6001\u4e0d\u4f1a\u52a0\u8f7d\u663e\u793aViewStub\u6307\u5b9a\u7684\u5e03\u5c40\u3002\u53ea\u6709\u5f53ViewStub\u663e\u793a\u65f6\uff0c\u6216\u8c03\u7528ViewStub.infalte()\u65f6\uff0c\u5176\u6307\u5b9a\u7684\u5e03\u5c40\u624d\u4f1a\u88ab\u52a0\u8f7d\u548c\u5b9e\u4f8b\u5316\u3002\u5e38\u7528\u4e8e\u7f51\u7edc\u5f02\u5e38\u63d0\u793a\u7b49\u60c5\u51b5\u3002</p> <p>3.\u5e03\u5c40\u7684\u590d\u7528</p> <p>\u901a\u7528\u7684\u5e03\u5c40\uff0c\u53ef\u4ee5\u4f7f\u7528 include \u6807\u7b7e\u3002</p>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_4","title":"\u907f\u514d\u8fc7\u5ea6\u7ed8\u5236","text":"<p>\u8fc7\u5ea6\u7ed8\u5236\uff1aOverdraw\uff0c\u6307\u5c4f\u5e55\u4e0a\u67d0\u4e2a\u50cf\u7d20\u5728\u540c\u4e00\u5e27\u7684\u65f6\u95f4\u5185\u88ab\u7ed8\u5236\u591a\u6b21\u3002</p> <p>\u8fc7\u5ea6\u7ed8\u5236\u7684\u4e3b\u8981\u539f\u56e0\uff1a</p> <ul> <li>XML\u5e03\u5c40\uff1a\u63a7\u4ef6\u6709\u91cd\u53e0\u4e14\u90fd\u8bbe\u7f6e\u80cc\u666f</li> <li>View\u81ea\u7ed8\uff1aView.onDraw()\u91cc\u540c\u4e00\u533a\u57df\u88ab\u7ed8\u5236\u591a\u6b21</li> </ul> <p>\u5982\u679c\u63a7\u4ef6\u91cd\u53e0\u591a\u5c42\uff0c\u7ed8\u5236\u6bcf\u4e00\u5c42\u65f6\uff0c\u90fd\u4f1a\u5bfc\u81f4\u8be5\u533a\u57df\u88ab\u7ed8\u5236\u3002\u8fd9\u79cd\u53e0\u52a0\u5c31\u5f88\u5bb9\u6613\u5bfc\u81f4\u8fc7\u5ea6\u7ed8\u5236\u3002</p> <p>\u68c0\u6d4b\u65b9\u6cd5\uff1a</p> <ul> <li>Hierarchy Viewer\uff1a\u67e5\u770b\u5e03\u5c40\u5c42\u7ea7\uff0c\u964d\u4f4e\u5c42\u7ea7\uff1b</li> <li>\u624b\u673a\u8bbe\u7f6e\u4e2d\u201cGPU\u8fc7\u5ea6\u91cd\u7ed8\u201d\uff1a\u901a\u8fc7\u989c\u8272\u7c97\u7565\u5224\u65adOverdraw\u60c5\u51b5\u3002</li> </ul> <p>\u65e0\u8272\uff1a\u6ca1\u6709\u8fc7\u6e21\u7ed8\u5236\uff0c\u6bcf\u4e2a\u50cf\u7d20\u7ed8\u52361\u6b21\uff1b \u84dd\u8272\uff1a\u6bcf\u4e2a\u50cf\u7d20\u591a\u7ed8\u52361\u6b21\uff1b \u7eff\u8272\uff1a\u6bcf\u4e2a\u50cf\u7d20\u591a\u7ed8\u52362\u6b21\uff1b \u6de1\u7ea2\u8272\uff1a\u6bcf\u4e2a\u50cf\u7d20\u591a\u7ed8\u52363\u6b21\uff1b \u6df1\u7ea2\u8272\uff1a\u6bcf\u4e2a\u50cf\u7d20\u591a\u7ed8\u52364\u6b21\u6216\u66f4\u591a\uff1b</p>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_5","title":"\u542f\u52a8\u4f18\u5316","text":"<p>\u542f\u52a8\u5206\u4e24\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>\u51b7\u542f\u52a8\uff1a\u7cfb\u7edf\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\uff0c\u5148\u521b\u5efaApplication\uff0c\u518d\u521b\u5efaMainActivity</li> <li>\u70ed\u542f\u52a8\uff1a\u4ece\u5df2\u6709\u7684\u8fdb\u7a0b\u4e2d\u542f\u52a8\uff0c\u6240\u4ee5\u4e0d\u4f1a\u518d\u521b\u5efaApplication\uff0c\u800c\u662f\u76f4\u63a5\u521b\u5efaMainActivity</li> </ul> <p>\u542f\u52a8\u8017\u65f6\u76d1\u6d4b\u65b9\u6cd5\uff1a</p> <ol> <li>adb\u547d\u4ee4\uff1aadb shell am start -W [packageName]/[packageName.AppStartActivity]</li> <li>\u4ee3\u7801\u6253\u70b9\uff1a\u6253\u51fa\u542f\u52a8\u8fc7\u7a0b\u4e2d\u76f8\u5173\u65b9\u6cd5\u8017\u65f6\u60c5\u51b5\uff0c\u66f4\u5177\u4f53</li> </ol> <pre><code>\u5199\u4e86\u4e2a\u7b80\u5355\u7684demo\uff0cadb shell\u67e5\u770b\u542f\u52a8\u8017\u65f6\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a\n\nStarting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=your_package/.MainActivity }\nStatus: ok\nActivity: your_package/.MainActivity\nThisTime: 680\nTotalTime: 680\nWaitTime: 696\nComplete\n</code></pre> <ul> <li>TotalTime\uff1a\u5e94\u7528\u7684\u542f\u52a8\u65f6\u95f4\uff0c\u5305\u62ec1)\u521b\u5efa\u8fdb\u7a0b + 2)Application\u521d\u59cb\u5316 + 3)Activity\u521d\u59cb\u5316\u5230\u754c\u9762\u663e\u793a</li> </ul> <p>add \u542f\u52a8\u4f18\u5316\u4e4b\u524d\u7684\u7ecf\u9a8c</p>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_6","title":"\u5408\u7406\u5237\u65b0\u673a\u5236","text":"<ol> <li>\u63a7\u5236\u5237\u65b0\u9891\u7387\uff1a\u6bd4\u5982\u8fdb\u5ea6\u6761\u7b49View\uff0c\u6570\u636e\u53d8\u5316\u4e0d\u52301%\uff0c\u6ca1\u5fc5\u8981\u5237\u65b0View</li> <li>\u907f\u514d\u6ca1\u5fc5\u8981\u7684\u5237\u65b0\uff1a\u6bd4\u5982\u6570\u636e\u6ca1\u53d8\u5316\u3001View\u4e0d\u53ef\u89c1\uff0c\u5c31\u6ca1\u5fc5\u8981\u5237\u65b0\uff0c\u4f46\u662fView\u4ece\u4e0d\u53ef\u89c1\u5230\u53ef\u89c1\uff0c\u5fc5\u987b\u8981\u5237\u65b0\u4e00\u6b21</li> <li>\u907f\u514d\u540e\u53f0\u7ebf\u7a0b\u5f71\u54cd\uff1a\u540e\u53f0\u7ebf\u7a0b\u867d\u7136\u4e0d\u4f1a\u76f4\u63a5\u5f71\u54cdUI\u7ebf\u7a0b\uff0c\u4f46\u662f\u5982\u679c\u540e\u53f0\u7ebf\u7a0b\u5f00\u9500\u8fc7\u5927\uff0c\u5360\u7528CPU\u8fc7\u9ad8\uff0c\u5bfc\u81f4\u7cfb\u7edfGC\u9891\u7e41\u3001CPU\u65f6\u95f4\u7247\u7d27\u5f20\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u754c\u9762\u5361\u987f\u3002\u5178\u578b\u6848\u4f8b\uff1a\u6ed1\u52a8RecyclerView\uff0c\u5982\u679c\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\u4e0b\u8f7d\u5f88\u591a\u56fe\u7247\uff0c\u53ef\u80fd\u5bfc\u81f4RecyclerView\u5361\u987f\u3002\u5efa\u8bae\u662f\u76d1\u542cRecyclerView\u7684OnScrollListener\uff0c\u6ed1\u52a8\u6216Fling\u65f6\u6682\u505c\u56fe\u7247\u4e0b\u8f7d\u7ebf\u7a0b\u5de5\u4f5c\uff0c\u7b49\u6ed1\u52a8\u7ed3\u675f\u518d\u5f00\u59cb\u3002</li> <li>\u7f29\u5c0f\u5237\u65b0\u533a\u57df\uff1a1\uff09\u81ea\u5b9a\u4e49View\u53ef\u4ee5\u66f4\u65b0\u5c40\u90e8\u533a\u57df\uff0cView.invalidate(Rect dirty)\uff1b2\uff09\u5bb9\u5668\u4e2d\u67d0\u4e2aItem\u53d1\u751f\u53d8\u5316\uff0c\u53ea\u9700\u66f4\u65b0\u5f53\u524dItem\uff0c\u6bd4\u5982notifyItemChanged(int position)</li> </ol>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_7","title":"\u63d0\u5347\u52a8\u753b\u6027\u80fd","text":"<p>\u5c3d\u91cf\u4f7f\u7528\u5c5e\u6027\u52a8\u753b\u3002</p> <p>Android\u76843\u79cd\u52a8\u753b\uff1a</p> <p>1\uff09\u5e27\u52a8\u753b\uff1a</p> <p>\u5c06\u4e00\u5e27\u5e27\u56fe\u7247\u6309\u987a\u5e8f\u663e\u793a\u51fa\u6765\u3002\u53ef\u7528AnimationDrawable\u5b9a\u4e49\u5e27\u52a8\u753b\u3002\u56e0\u4e3a\u52a8\u753b\u8fc7\u7a0b\u6d89\u53ca\u56fe\u7247\u591a\uff0c\u662f\u6548\u679c\u6700\u5dee\u7684\u4e00\u79cd\u52a8\u753b\u3002</p> <p>2\uff09\u8865\u95f4\u52a8\u753b\uff1a</p> <p>\u5bf9View\u8fdb\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\u6765\u6539\u53d8\u663e\u793a\u6548\u679c\u3002\u8865\u95f4\u52a8\u753b\u4e0d\u9700\u8981\u5b9a\u4e49\u52a8\u753b\u8fc7\u7a0b\u4e2d\u7684\u6bcf\u4e00\u5e27\uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u5f00\u59cb\u548c\u7ed3\u675f\u5173\u952e\u5e27\u7684\u5185\u5bb9\uff0c\u4e4b\u95f4\u7684\u6548\u679c\u81ea\u52a8\u751f\u6210\u3002</p> <p>\u8865\u95f4\u52a8\u753b\u652f\u63014\u79cd\u52a8\u753b\u6a21\u5f0f\uff1aAlphaAnimation\u3001ScaleAnimation\u3001TranslationAnimation\u3001RotateAnimation\u3002</p> <pre><code>Animation rotateAnim = new RotateAnimation(0, 360,\n                Animation.RELATIVE_TO_SELF, 0.5f,\n                Animation.RELATIVE_TO_SELF, 0.5f);\n        Animation scaleAnim = new ScaleAnimation(0f, 1f, 0f, 1f,\n                Animation.RELATIVE_TO_SELF, 0.5f,\n                Animation.RELATIVE_TO_SELF, 0.5f);\n\n        AnimationSet animationSet = new AnimationSet(true);\n        animationSet.addAnimation(rotateAnim);\n        animationSet.addAnimation(scaleAnim);\n        animationSet.setDuration(2000);\n        imageView.setAnimation(animationSet);\n</code></pre> <p>\u5982\u679c\u4f7f\u7528TraceView\u68c0\u6d4b\u52a8\u753b\u8fc7\u7a0b\u65b9\u6cd5[Calls + Recur Calls]\u60c5\u51b5\u5c31\u80fd\u53d1\u73b0\uff0c\u628a\u6570\u636e\u9001\u5230\u663e\u793a\u5668\u66f4\u65b0DisplayList\u7684\u65b9\u6cd5(View.updateDisplayListIfDirty()) \u8c03\u7528\u9891\u7e41\uff0c\u8fd9\u5c31\u5bfc\u81f4\u8865\u95f4\u52a8\u753b\u65f6View\u91cd\u7ed8\u975e\u5e38\u9891\u7e41\u3002</p> <p>3\uff09\u5c5e\u6027\u52a8\u753b\uff1a</p> <p>\u7531Android3.0(API 11)\u5f00\u59cb\u652f\u6301\u3002\u901a\u8fc7\u4fee\u6539\u52a8\u753b\u7684\u5b9e\u9645\u5c5e\u6027\u6765\u5b9e\u73b0\u52a8\u753b\u6548\u679c\u3002\u5c5e\u6027\u52a8\u753b\u662f\u4e00\u4e2a\u975e\u5e38\u5168\u9762\u7684\u6846\u67b6\uff0c\u51e0\u4e4e\u652f\u6301\u628a\u4efb\u4f55\u5bf9\u8c61\u53d8\u6210\u52a8\u753b\u3002</p> <p>\u5982\u679c\u4f7f\u7528TraceView\u68c0\u6d4b\u52a8\u753b\u8fc7\u7a0b\u65b9\u6cd5[Calls + Recur Calls]\u80fd\u53d1\u73b0\uff0c\u76f8\u6bd4\u8865\u95f4\u52a8\u753b\uff0c\u5c5e\u6027\u52a8\u753b\u7684\u5237\u65b0\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u660e\u663e\u51cf\u5c11\u3002</p> <pre><code>ObjectAnimator scaleX = ObjectAnimator.ofFloat(imageView, \"scaleX\", 0, 1);\n        ObjectAnimator rotation = ObjectAnimator.ofFloat(imageView, \"rotation\", 0f, 360f);\n\n        AnimatorSet animatorSet = new AnimatorSet();\n        animatorSet.setDuration(2000);\n        animatorSet.play(scaleX).with(rotation);\n        animatorSet.start();\n</code></pre>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#_8","title":"\u6ed1\u52a8\u5361\u987f","text":"<p>\u4ece\u4e24\u4e2a\u65b9\u9762\u5b9a\u4f4d\uff1a</p> <ol> <li> <p>\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\uff0cbind\u76f8\u5173\u65b9\u6cd5\u662f\u4e0d\u662f\u505a\u4e86\u5927\u91cf\u6570\u636e\u64cd\u4f5c\uff0c\u5f71\u54cd\u4e86UI\u7ebf\u7a0b\uff1b\u53ef\u4ee5\u901a\u8fc7TraceView\u67e5\u770b\u65b9\u6cd5\u8017\u65f6\u60c5\u51b5</p> </li> <li> <p>\u6ed1\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u662f\u5426\u6709\u5927\u91cfGC\u60c5\u51b5\uff1b\u53ef\u4ee5\u901a\u8fc7Memory Monitor\u3001Heap Viewer\u7b49\u5de5\u5177\u67e5\u770b\u662f\u5426\u5b58\u5728\u5185\u5b58\u6296\u52a8\uff1b</p> </li> </ol>"},{"location":"PerformanceOptimization/%E7%BB%98%E5%88%B6%E4%BC%98%E5%8C%96/#-traceview","title":"\u5de5\u5177\u7bc7--TraceView","text":"<p>\u53ef\u67e5\u770b\u65b9\u6cd5\u8c03\u7528\u6b21\u6570\u3001\u65b9\u6cd5\u6267\u884c\u8017\u65f6\u3002</p> <p>\u8c03\u7528\u6b21\u6570\u53ef\u770b[Calls + Recur Calls]\u5217\u3002\u8865\u95f4\u52a8\u753b\u4e00\u8282\u4e2d\u5df2\u7ecf\u63d0\u5230\u8fc7\u3002</p>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u53164/5 -- \u8017\u7535\u4f18\u5316","text":"<ul> <li>\u8017\u7535\u68c0\u67e5\u5de5\u5177</li> <li>\u8017\u7535\u4e09\u5927\u5757</li> <li>\u5e38\u7528\u4f18\u5316\u65b9\u6848</li> </ul>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#_1","title":"\u8017\u7535\u68c0\u67e5\u5de5\u5177","text":"<p>BatteryHistorian</p> <p>\u53ef\u76f4\u89c2\u5c55\u793a\u624b\u673a\u7684\u8017\u7535\u8fc7\u7a0b\u3002</p>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#_2","title":"\u8017\u7535\u4e09\u5927\u5757","text":"<p>\u624b\u673a\u8017\u7535\u4e09\u5927\u5757\uff1a</p> <ul> <li>\u5c4f\u663e</li> <li>CPU</li> <li>\u8bed\u97f3\u901a\u8bdd\u548c\u7528\u6237\u6d41\u91cf</li> </ul>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#_3","title":"\u5c4f\u663e","text":"<p>\u5e94\u7528\u5185\u8c03\u8282\u4eae\u5ea6\u4e0d\u5408\u9002\uff0c\u4e00\u822c\u7531\u7cfb\u7edf\u63a7\u5236\u3002</p>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#cpu","title":"CPU","text":"<p>Linux\u5185\u6838\u63d0\u4f9b5\u4e2d\u53d8\u9891\u6a21\u5f0f\uff0c\u4e0d\u540c\u6a21\u5f0f\u4e0b\uff0cCPU\u8fd0\u884c\u9891\u7387\u4e0d\u540c\uff0c\u529f\u8017\u4e5f\u4e0d\u540c\u3002\u4f46\u662f\u9700\u8981\u5728Root\u6743\u9650\u4e0b\u624d\u80fd\u6539\u53d8\u9891\u6a21\u5f0f\u3002</p>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#_4","title":"\u8bed\u97f3\u901a\u8bdd\u548c\u8702\u7a9d\u6d41\u91cf","text":"<p>WiFi\u4e0b\u6570\u636e\u901a\u4fe1\u6bd4\u8702\u7a9d\u6d41\u91cf\u529f\u8017\u4f4e\uff0c\u6240\u4ee5\u5c3d\u91cf\u5728WiFi\u4e0b\u8fdb\u884c\u6570\u636e\u901a\u4fe1\u3002</p> <p>\u8702\u7a9d\u4e0b\uff0c\u5c3d\u91cf\u964d\u4f4e\u7f51\u7edc\u8bf7\u6c42\u9891\u7387\u3002</p>"},{"location":"PerformanceOptimization/%E8%80%97%E7%94%B5%E4%BC%98%E5%8C%96/#_5","title":"\u5e38\u7528\u4f18\u5316\u65b9\u6848","text":"<p>1.\u6d6e\u70b9\u8fd0\u7b97\u6bd4\u6574\u6570\u8fd0\u7b97\u66f4\u6d88\u8017CPU\u65f6\u95f4\u7247\uff0c\u8017\u7535\u4e5f\u4f1a\u589e\u52a0\u3002</p> <p>\u907f\u5f00\u6d6e\u70b9\u8fd0\u7b97\u7684\u65b9\u6cd5\uff1a * \u9664\u6cd5\u53d8\u4e58\u6cd5 * \u5145\u5206\u5229\u7528\u79fb\u4f4d * \u5229\u7528arm neon\u6307\u4ee4\u96c6\u505a\u5e76\u884c\u8fd0\u7b97\uff0c\u9700\u8981arm v7\u53ca\u4ee5\u4e0a\u67b6\u6784CPU\u624d\u652f\u6301</p> <p>2.\u907f\u514dWakeLock\u4f7f\u7528\u4e0d\u5f53</p> <p>\u4f7f\u7528\u5b8cWakeLock\uff0c\u8981\u53ca\u65f6\u91ca\u653e\u3002</p> <p>3.\u4f7f\u7528JobScheduler</p> <p>\u4f7f\u7528JobScheduler\u5728\u6ee1\u8db3\u4e00\u4e9b\u573a\u666f\u4e0b\u624d\u6267\u884c\u4efb\u52a1\uff0c\u533a\u5206\u4efb\u52a1\u7684\u91cd\u8981\u6027\u548c\u7d27\u6025\u6027\u3002\u6bd4\u5982WIFI\u4e0b\u624d\u8fdb\u884cLog\u7684\u53d1\u9001\u3001\u5145\u7535\u65f6\u624d\u8fdb\u884c\u6570\u636e\u7684\u5907\u4efd\u7b49\u7b49\u3002</p>"}]}